<!DOCTYPE html><html lang="en" class="" style="scroll-padding:60px"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>UMA Catalysis Tutorial - FAIR Chemistry Documentation</title><meta property="og:title" content="UMA Catalysis Tutorial - FAIR Chemistry Documentation"/><meta name="generator" content="mystmd"/><meta name="keywords" content=""/><meta name="image" content="/build/vib.0-3108e0682b2bf05fbb952db933022aed.gif"/><meta property="og:image" content="/build/vib.0-3108e0682b2bf05fbb952db933022aed.gif"/><link rel="stylesheet" href="/build/_assets/app-2K3KGISG.css"/><link rel="stylesheet" href="/build/_assets/thebe-core-VKVHG5VY.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jupyter-matplotlib@0.11.3/css/mpl_widget.css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css" integrity="sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ" crossorigin="anonymous"/><link rel="icon" href="/favicon.ico"/><link rel="stylesheet" href="/myst-theme.css"/><script>
  const savedTheme = localStorage.getItem("myst:theme");
  const theme = window.matchMedia("(prefers-color-scheme: light)").matches ? 'light' : 'dark';
  const classes = document.documentElement.classList;
  const hasAnyTheme = classes.contains('light') || classes.contains('dark');
  if (!hasAnyTheme) classes.add(savedTheme ?? theme);
</script></head><body class="m-0 transition-colors duration-500 bg-white dark:bg-stone-900"><div class="myst-skip-to-article fixed top-1 left-1 h-[0px] w-[0px] focus-within:z-40 focus-within:h-auto focus-within:w-auto bg-white overflow-hidden focus-within:p-2 focus-within:ring-1" aria-label="skip to content options"><a href="#skip-to-frontmatter" class="myst-skip-to-link block px-2 py-1 text-black underline">Skip to article frontmatter</a><a href="#skip-to-article" class="myst-skip-to-link block px-2 py-1 text-black underline">Skip to article content</a></div><dialog id="myst-no-css" style="position:fixed;left:0px;top:0px;width:100%;height:100vh;font-size:4rem;padding:1rem;color:black;background:white"><strong>Site not loading correctly?</strong><p>This may be due to an incorrect <code>BASE_URL</code> configuration. See<!-- --> <a href="https://mystmd.org/guide/deployment#deploy-base-url">the MyST Documentation</a> <!-- -->for reference.</p><script>
    (() => {
            // Test for has-styling variable set by the MyST stylesheet
            const node = document.currentScript.parentNode;
            const hasCSS = window.getComputedStyle(node).getPropertyValue("--has-styling");
            if (hasCSS === ""){
                    node.showModal();
            }

    })()
</script></dialog><div class="myst-top-nav bg-white/80 backdrop-blur dark:bg-stone-900/80 shadow dark:shadow-stone-700 p-3 md:px-8 sticky w-full top-0 z-30 h-[60px]"><nav class="myst-top-nav-bar flex items-center justify-between flex-nowrap max-w-[1440px] mx-auto"><div class="flex flex-row xl:min-w-[19.5rem] mr-2 sm:mr-7 justify-start items-center shrink-0"><div class="block xl:hidden"><button class="myst-top-nav-menu-button flex items-center justify-center border-stone-400 text-stone-800 hover:text-stone-900 dark:text-stone-200 hover:dark:text-stone-100 w-10 h-10"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem"><path fill-rule="evenodd" d="M3 6.75A.75.75 0 0 1 3.75 6h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 6.75ZM3 12a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 12Zm0 5.25a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75a.75.75 0 0 1-.75-.75Z" clip-rule="evenodd"></path></svg><span class="sr-only">Open Menu</span></button></div><a class="myst-home-link flex items-center ml-3 dark:text-white w-fit md:ml-5 xl:ml-7" href="/"><div class="myst-home-link-logo mr-3 flex items-center dark:bg-white dark:rounded px-1"><img src="/build/fair_chem_logo_v2-8db274e987822faff08820502b8c23f7.png" class="h-9" alt="FAIR Chemistry Documentation" height="2.25rem"/></div><span class="text-md sm:text-xl tracking-tight sm:mr-5 sr-only">Made with MyST</span></a></div><div class="flex items-center flex-grow w-auto"><div class="flex-grow hidden text-md lg:block"><div class="myst-top-nav-item relative inline-block mx-2 grow-0"><a class="inline-flex items-center justify-center w-full mx-2 py-1 text-md font-medium dark:text-white focus:outline-none focus-visible:ring-2 focus-visible:ring-white focus-visible:ring-opacity-75" href="/quickstart">Quickstart</a></div><div class="myst-top-nav-item relative inline-block mx-2 grow-0"><a class="inline-flex items-center justify-center w-full mx-2 py-1 text-md font-medium dark:text-white focus:outline-none focus-visible:ring-2 focus-visible:ring-white focus-visible:ring-opacity-75" href="/install">Docs</a></div><div class="myst-top-nav-item relative inline-block mx-2 grow-0"><a class="inline-flex items-center justify-center w-full mx-2 py-1 text-md font-medium dark:text-white focus:outline-none focus-visible:ring-2 focus-visible:ring-white focus-visible:ring-opacity-75" href="/uma-tutorial">Tutorial</a></div><div class="myst-top-nav-item relative inline-block mx-2 grow-0"><a href="https://facebook-fairchem-uma-demo.hf.space/" target="_blank" rel="noopener noreferrer" class="inline-flex items-center justify-center w-full mx-2 py-1 text-md font-medium dark:text-white focus:outline-none focus-visible:ring-2 focus-visible:ring-white focus-visible:ring-opacity-75">Demo</a></div><div class="myst-top-nav-item relative inline-block mx-2 grow-0"><a href="https://github.com/facebookresearch/fairchem" target="_blank" rel="noopener noreferrer" class="inline-flex items-center justify-center w-full mx-2 py-1 text-md font-medium dark:text-white focus:outline-none focus-visible:ring-2 focus-visible:ring-white focus-visible:ring-opacity-75">Github</a></div><div class="myst-top-nav-dropdown relative inline-block mx-2 grow-0" data-headlessui-state=""><div class="inline-block"><button class="inline-flex items-center justify-center w-full py-1 mx-2 font-medium rounded-md text-md text-stone-900 dark:text-white focus:outline-none focus-visible:ring-2 focus-visible:ring-white focus-visible:ring-opacity-75" id="headlessui-menu-button-:R735cp:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><span>Help</span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem" class="ml-2 -mr-1 text-violet-200 hover:text-violet-100"><path fill-rule="evenodd" d="M12.53 16.28a.75.75 0 0 1-1.06 0l-7.5-7.5a.75.75 0 0 1 1.06-1.06L12 14.69l6.97-6.97a.75.75 0 1 1 1.06 1.06l-7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div></div></div><div class="flex-grow block"></div><button type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:R75cp:" data-state="closed" class="myst-search-bar flex items-center h-10 aspect-square sm:w-64 text-left text-gray-600 dark:text-gray-300 border border-gray-300 dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-gray-700 myst-search-bar-disabled hover:ring-blue-500 dark:hover:ring-blue-500 hover:border-blue-500 dark:hover:border-blue-500"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="p-2.5 h-10 w-10 aspect-square"><path fill-rule="evenodd" d="M10.5 3.75a6.75 6.75 0 1 0 0 13.5 6.75 6.75 0 0 0 0-13.5ZM2.25 10.5a8.25 8.25 0 1 1 14.59 5.28l4.69 4.69a.75.75 0 1 1-1.06 1.06l-4.69-4.69A8.25 8.25 0 0 1 2.25 10.5Z" clip-rule="evenodd"></path></svg><span class="myst-search-text-placeholder hidden sm:block grow">Search</span><div aria-hidden="true" class="myst-search-shortcut items-center hidden mx-1 font-mono text-sm text-gray-600 dark:text-gray-300 sm:flex gap-x-1"><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none hide-mac">CTRL</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none show-mac">⌘</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none ">K</kbd><script>
;(() => {
const script = document.currentScript;
const root = script.parentElement;

const isMac = /mac/i.test(
      window.navigator.userAgentData?.platform ?? window.navigator.userAgent,
    );
root.querySelectorAll(".hide-mac").forEach(node => {node.classList.add(isMac ? "hidden" : "block")});
root.querySelectorAll(".show-mac").forEach(node => {node.classList.add(!isMac ? "hidden" : "block")});
})()</script></div></button><button class="myst-theme-button theme rounded-full aspect-square border border-stone-700 dark:border-white hover:bg-neutral-100 border-solid overflow-hidden text-stone-700 dark:text-white hover:text-stone-500 dark:hover:text-neutral-800 w-10 h-10 mx-3" title="Toggle theme between light and dark mode" aria-label="Toggle theme between light and dark mode"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="myst-theme-moon-icon h-full w-full p-0.5 hidden dark:block"><path fill-rule="evenodd" d="M9.528 1.718a.75.75 0 0 1 .162.819A8.97 8.97 0 0 0 9 6a9 9 0 0 0 9 9 8.97 8.97 0 0 0 3.463-.69.75.75 0 0 1 .981.98 10.503 10.503 0 0 1-9.694 6.46c-5.799 0-10.5-4.7-10.5-10.5 0-4.368 2.667-8.112 6.46-9.694a.75.75 0 0 1 .818.162Z" clip-rule="evenodd"></path></svg><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="myst-theme-sun-icon h-full w-full p-0.5 dark:hidden"><path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386-1.591 1.591M21 12h-2.25m-.386 6.364-1.591-1.591M12 18.75V21m-4.773-4.227-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0Z"></path></svg></button><div class="block sm:hidden"></div><div class="hidden sm:block"></div></div></nav></div><div class="myst-primary-sidebar fixed xl:article-grid grid-gap xl:w-full xl:pointer-events-none overflow-auto max-xl:w-[75vw] max-xl:max-w-[350px] max-xl:!top-0 max-xl:h-screen hidden z-10" style="top:60px"><div class="myst-primary-sidebar-pointer pointer-events-auto xl:col-margin-left flex-col overflow-hidden max-xl:h-full hidden xl:flex"><div class="myst-primary-sidebar-nav flex-grow py-6 overflow-y-auto primary-scrollbar"><nav aria-label="Navigation" class="myst-primary-sidebar-topnav overflow-y-hidden transition-opacity lg:hidden ml-3 xl:ml-0 mr-3 max-w-[350px]"><div class="w-full px-1 dark:text-white font-medium"><a class="myst-primary-sidebar-item-short p-2 my-1 rounded-lg hover:bg-slate-300/30 block break-words focus:outline outline-blue-200 outline-2 rounded" href="/quickstart">Quickstart</a><a class="myst-primary-sidebar-item-short p-2 my-1 rounded-lg hover:bg-slate-300/30 block break-words focus:outline outline-blue-200 outline-2 rounded" href="/install">Docs</a><a class="myst-primary-sidebar-item-short p-2 my-1 rounded-lg hover:bg-slate-300/30 block break-words focus:outline outline-blue-200 outline-2 rounded" href="/uma-tutorial">Tutorial</a><a href="https://facebook-fairchem-uma-demo.hf.space/" target="_blank" rel="noopener noreferrer" class="myst-primary-sidebar-item-short p-2 my-1 rounded-lg hover:bg-slate-300/30 block break-words focus:outline outline-blue-200 outline-2 rounded">Demo</a><a href="https://github.com/facebookresearch/fairchem" target="_blank" rel="noopener noreferrer" class="myst-primary-sidebar-item-short p-2 my-1 rounded-lg hover:bg-slate-300/30 block break-words focus:outline outline-blue-200 outline-2 rounded">Github</a><div data-state="closed" class="w-full"><div class="myst-primary-sidebar-item flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><a class="myst-primary-sidebar-item-title py-2 grow" href="/">Help</a><button class="myst-primary-sidebar-item-child self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R1ipsp:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="myst-primary-sidebar-item-icon transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R1ipsp:" hidden="" class="myst-primary-sidebar-item-content pl-3 pr-[2px] collapsible-content"></div></div></div></nav><div class="my-3 border-b-2 lg:hidden"></div><nav aria-label="Table of Contents" class="myst-primary-sidebar-toc flex-grow overflow-y-hidden transition-opacity ml-3 xl:ml-0 mr-3 max-w-[350px]"><div class="myst-toc w-full px-1 dark:text-white"><a title="fairchem" class="block break-words focus:outline outline-blue-200 outline-2 rounded myst-toc-item p-2 my-1 rounded-lg hover:bg-slate-300/30 font-bold" href="/">fairchem</a><div data-state="closed" class="w-full"><div class="myst-toc-item flex flex-row w-full gap-2 pl-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Quickstart" class="block break-words rounded py-2 grow cursor-pointer">Quickstart</div><button class="self-stretch flex items-center flex-none px-1 rounded-l-md group hover:bg-slate-300/30 focus-visible:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:Rmpsp:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:Rmpsp:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="open" class="w-full"><div class="myst-toc-item flex flex-row w-full gap-2 pl-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="AI/ML Models &amp; Usage" class="block break-words rounded py-2 grow font-semibold text-blue-800 dark:text-blue-200 cursor-pointer">AI/ML Models &amp; Usage</div><button class="self-stretch flex items-center flex-none px-1 rounded-l-md group hover:bg-slate-300/30 focus-visible:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:Rupsp:" aria-expanded="true" data-state="open"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="open" id="radix-:Rupsp:" class="pl-3 pr-[2px] collapsible-content"><a title="UMA Models" class="block break-words focus:outline outline-blue-200 outline-2 rounded myst-toc-item p-2 my-1 rounded-lg hover:bg-slate-300/30" href="/uma">UMA Models</a><a title="GNNs for Chemistry" class="block break-words focus:outline outline-blue-200 outline-2 rounded myst-toc-item p-2 my-1 rounded-lg hover:bg-slate-300/30" href="/intro">GNNs for Chemistry</a><div data-state="closed" class="w-full"><div class="myst-toc-item flex flex-row w-full gap-2 pl-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><a title="Common Tasks" class="block break-words focus:outline outline-blue-200 outline-2 rounded py-2 grow" href="/summary">Common Tasks</a><button class="self-stretch flex items-center flex-none px-1 rounded-l-md group hover:bg-slate-300/30 focus-visible:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R3kupsp:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R3kupsp:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="open" class="w-full"><div class="myst-toc-item flex flex-row w-full gap-2 pl-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><a title="UMA Tutorials" class="block break-words focus:outline outline-blue-200 outline-2 rounded py-2 grow font-semibold text-blue-800 dark:text-blue-200" href="/summary-1">UMA Tutorials</a><button class="self-stretch flex items-center flex-none px-1 rounded-l-md group hover:bg-slate-300/30 focus-visible:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R4kupsp:" aria-expanded="true" data-state="open"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="open" id="radix-:R4kupsp:" class="pl-3 pr-[2px] collapsible-content"><a title="UMA Intro Tutorial" class="block break-words focus:outline outline-blue-200 outline-2 rounded myst-toc-item p-2 my-1 rounded-lg hover:bg-slate-300/30" href="/uma-tutorial">UMA Intro Tutorial</a><a title="UMA Catalysis Tutorial" aria-current="page" class="block break-words focus:outline outline-blue-200 outline-2 rounded myst-toc-item p-2 my-1 rounded-lg myst-toc-item-exact bg-blue-300/30 active" href="/uma-catalysis-tutorial">UMA Catalysis Tutorial</a></div></div><a title="Generative Models" class="block break-words focus:outline outline-blue-200 outline-2 rounded myst-toc-item p-2 my-1 rounded-lg hover:bg-slate-300/30" href="/generative-models">Generative Models</a></div></div><a title="FAIR Chemistry Papers" class="block break-words focus:outline outline-blue-200 outline-2 rounded myst-toc-item p-2 my-1 rounded-lg hover:bg-slate-300/30" href="/fair-chemistry-papers">FAIR Chemistry Papers</a><div data-state="closed" class="w-full"><div class="myst-toc-item flex flex-row w-full gap-2 pl-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Organic Molecules" class="block break-words rounded py-2 grow cursor-pointer">Organic Molecules</div><button class="self-stretch flex items-center flex-none px-1 rounded-l-md group hover:bg-slate-300/30 focus-visible:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R1epsp:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R1epsp:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="myst-toc-item flex flex-row w-full gap-2 pl-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Heterogeneous Catalysis" class="block break-words rounded py-2 grow cursor-pointer">Heterogeneous Catalysis</div><button class="self-stretch flex items-center flex-none px-1 rounded-l-md group hover:bg-slate-300/30 focus-visible:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R1mpsp:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R1mpsp:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="myst-toc-item flex flex-row w-full gap-2 pl-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Inorganic Materials" class="block break-words rounded py-2 grow cursor-pointer">Inorganic Materials</div><button class="self-stretch flex items-center flex-none px-1 rounded-l-md group hover:bg-slate-300/30 focus-visible:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R1upsp:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R1upsp:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="myst-toc-item flex flex-row w-full gap-2 pl-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="MOFs for Direct Air Capture" class="block break-words rounded py-2 grow cursor-pointer">MOFs for Direct Air Capture</div><button class="self-stretch flex items-center flex-none px-1 rounded-l-md group hover:bg-slate-300/30 focus-visible:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R26psp:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R26psp:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="myst-toc-item flex flex-row w-full gap-2 pl-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Learn More" class="block break-words rounded py-2 grow cursor-pointer">Learn More</div><button class="self-stretch flex items-center flex-none px-1 rounded-l-md group hover:bg-slate-300/30 focus-visible:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R2epsp:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R2epsp:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div></div></nav></div><div class="myst-primary-sidebar-footer flex-none py-6 transition-all duration-700 translate-y-6 opacity-0 ml-3 xl:ml-0 mr-3 max-w-[350px]"><a class="myst-made-with-myst flex mx-auto text-gray-700 w-fit hover:text-blue-700 dark:text-gray-200 dark:hover:text-blue-400" href="https://mystmd.org/made-with-myst" target="_blank" rel="noreferrer"><svg style="width:24px;height:24px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" stroke="none"><g id="icon"><path fill="currentColor" d="M23.8,54.8v-3.6l4.7-0.8V17.5l-4.7-0.8V13H36l13.4,31.7h0.2l13-31.7h12.6v3.6l-4.7,0.8v32.9l4.7,0.8v3.6h-15
          v-3.6l4.9-0.8V20.8H65L51.4,53.3h-3.8l-14-32.5h-0.1l0.2,17.4v12.1l5,0.8v3.6H23.8z"></path><path fill="#F37726" d="M47,86.9c0-5.9-3.4-8.8-10.1-8.8h-8.4c-5.2,0-9.4-1.3-12.5-3.8c-3.1-2.5-5.4-6.2-6.8-11l4.8-1.6
          c1.8,5.6,6.4,8.6,13.8,8.8h9.2c6.4,0,10.8,2.5,13.1,7.5c2.3-5,6.7-7.5,13.1-7.5h8.4c7.8,0,12.7-2.9,14.6-8.7l4.8,1.6
          c-1.4,4.9-3.6,8.6-6.8,11.1c-3.1,2.5-7.3,3.7-12.4,3.8H63c-6.7,0-10,2.9-10,8.8"></path></g></svg><span class="self-center ml-2 text-sm">Made with MyST</span></a></div></div></div><main class="article-grid grid-gap"><article class="article-grid subgrid-gap col-screen article content"><div class="hidden"></div><div id="skip-to-frontmatter" aria-label="article frontmatter" class="myst-fm-block mb-8 pt-9"><div class="myst-fm-block-header flex items-center mb-5 h-6 text-sm font-light"><div class="flex-grow"></div><div class="myst-fm-block-badges"><a href="https://github.com/facebookresearch/fairchem" title="GitHub Repository: facebookresearch/fairchem" target="_blank" rel="noopener noreferrer" class="myst-fm-github-link text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="myst-fm-github-icon inline-block mr-1 opacity-60 hover:opacity-100"><path d="M12 2.5c-5.4 0-9.8 4.4-9.8 9.7 0 4.3 2.8 8 6.7 9.2.5.1.7-.2.7-.5v-1.8c-2.4.5-3.1-.6-3.3-1.1-.1-.3-.6-1.1-1-1.4-.3-.2-.8-.6 0-.6s1.3.7 1.5 1c.9 1.5 2.3 1.1 2.8.8.1-.6.3-1.1.6-1.3-2.2-.2-4.4-1.1-4.4-4.8 0-1.1.4-1.9 1-2.6-.1-.2-.4-1.2.1-2.6 0 0 .8-.3 2.7 1 .8-.2 1.6-.3 2.4-.3.8 0 1.7.1 2.4.3 1.9-1.3 2.7-1 2.7-1 .5 1.3.2 2.3.1 2.6.6.7 1 1.5 1 2.6 0 3.7-2.3 4.6-4.4 4.8.4.3.7.9.7 1.8V21c0 .3.2.6.7.5 3.9-1.3 6.6-4.9 6.6-9.2 0-5.4-4.4-9.8-9.8-9.8z"></path></svg></a></div><a href="https://github.com/facebookresearch/fairchem/edit/main/docs/uma_tutorials/uma_catalysis_tutorial.md" title="Edit This Page" target="_blank" rel="noopener noreferrer" class="myst-fm-edit-link text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem" class="myst-fm-edit-icon inline-block mr-1 opacity-60 hover:opacity-100"><path stroke-linecap="round" stroke-linejoin="round" d="m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"></path></svg></a><div class="myst-fm-downloads-dropdown relative flex inline-block mx-1 grow-0" data-headlessui-state=""><button class="myst-fm-downloads-button relative ml-2 -mr-1" id="headlessui-menu-button-:Rs8ucp:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><span class="sr-only">Downloads</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem" class="myst-fm-downloads-icon"><title>Download</title><path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"></path></svg></button></div><button class="myst-fm-launch-button inline-flex size-[24px] hover:text-[#E18435] items-center justify-center" aria-label="Launch in external computing interface" title="Launch in external computing interface" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:Re8ucp:" data-state="closed"><svg width="15" height="15" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg" class="myst-fm-launch-icon"><path d="M6.85357 3.85355L7.65355 3.05353C8.2981 2.40901 9.42858 1.96172 10.552 1.80125C11.1056 1.72217 11.6291 1.71725 12.0564 1.78124C12.4987 1.84748 12.7698 1.97696 12.8965 2.10357C13.0231 2.23018 13.1526 2.50125 13.2188 2.94357C13.2828 3.37086 13.2779 3.89439 13.1988 4.44801C13.0383 5.57139 12.591 6.70188 11.9464 7.34645L7.49999 11.7929L6.35354 10.6465C6.15827 10.4512 5.84169 10.4512 5.64643 10.6465C5.45117 10.8417 5.45117 11.1583 5.64643 11.3536L7.14644 12.8536C7.34171 13.0488 7.65829 13.0488 7.85355 12.8536L8.40073 12.3064L9.57124 14.2572C9.65046 14.3893 9.78608 14.4774 9.9389 14.4963C10.0917 14.5151 10.2447 14.4624 10.3535 14.3536L12.3535 12.3536C12.4648 12.2423 12.5172 12.0851 12.495 11.9293L12.0303 8.67679L12.6536 8.05355C13.509 7.19808 14.0117 5.82855 14.1887 4.58943C14.2784 3.9618 14.2891 3.33847 14.2078 2.79546C14.1287 2.26748 13.9519 1.74482 13.6035 1.39645C13.2552 1.04809 12.7325 0.871332 12.2045 0.792264C11.6615 0.710945 11.0382 0.721644 10.4105 0.8113C9.17143 0.988306 7.80189 1.491 6.94644 2.34642L6.32322 2.96968L3.07071 2.50504C2.91492 2.48278 2.75773 2.53517 2.64645 2.64646L0.646451 4.64645C0.537579 4.75533 0.484938 4.90829 0.50375 5.0611C0.522563 5.21391 0.61073 5.34954 0.742757 5.42876L2.69364 6.59928L2.14646 7.14645C2.0527 7.24022 2.00002 7.3674 2.00002 7.50001C2.00002 7.63261 2.0527 7.75979 2.14646 7.85356L3.64647 9.35356C3.84173 9.54883 4.15831 9.54883 4.35357 9.35356C4.54884 9.1583 4.54884 8.84172 4.35357 8.64646L3.20712 7.50001L3.85357 6.85356L6.85357 3.85355ZM10.0993 13.1936L9.12959 11.5775L11.1464 9.56067L11.4697 11.8232L10.0993 13.1936ZM3.42251 5.87041L5.43935 3.85356L3.17678 3.53034L1.80638 4.90074L3.42251 5.87041ZM2.35356 10.3535C2.54882 10.1583 2.54882 9.8417 2.35356 9.64644C2.1583 9.45118 1.84171 9.45118 1.64645 9.64644L0.646451 10.6464C0.451188 10.8417 0.451188 11.1583 0.646451 11.3535C0.841713 11.5488 1.1583 11.5488 1.35356 11.3535L2.35356 10.3535ZM3.85358 11.8536C4.04884 11.6583 4.04885 11.3417 3.85359 11.1465C3.65833 10.9512 3.34175 10.9512 3.14648 11.1465L1.14645 13.1464C0.95119 13.3417 0.951187 13.6583 1.14645 13.8535C1.34171 14.0488 1.65829 14.0488 1.85355 13.8536L3.85358 11.8536ZM5.35356 13.3535C5.54882 13.1583 5.54882 12.8417 5.35356 12.6464C5.1583 12.4512 4.84171 12.4512 4.64645 12.6464L3.64645 13.6464C3.45119 13.8417 3.45119 14.1583 3.64645 14.3535C3.84171 14.5488 4.1583 14.5488 4.35356 14.3535L5.35356 13.3535ZM9.49997 6.74881C10.1897 6.74881 10.7488 6.1897 10.7488 5.5C10.7488 4.8103 10.1897 4.25118 9.49997 4.25118C8.81026 4.25118 8.25115 4.8103 8.25115 5.5C8.25115 6.1897 8.81026 6.74881 9.49997 6.74881Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></button></div><h1 class="myst-fm-block-title mb-0">UMA Catalysis Tutorial</h1><header class="myst-fm-authors-affiliations mt-4 not-prose"><div class="myst-fm-authors-list"><span class="myst-fm-author font-semibold text-sm myst-fm-author-item inline-block"><button class="myst-fm-author-popover focus:shadow-[0_0_0_2px] focus:shadow-black outline-none hover:underline" aria-label="Author Details" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:R78ucp:" data-state="closed"><span class="myst-fm-author-name">FAIR Chemistry &amp; Collaborators</span></button></span></div></header></div><div class="block my-10 lg:sticky lg:z-10 lg:h-0 lg:pt-0 lg:my-0 lg:ml-10 lg:col-margin-right" style="top:60px"><nav></nav></div><div class="myst-jp-nb-toolbar sticky top-[60px] pb-[14px] flex justify-end w-full z-20 pointer-events-none"><div class="myst-jp-nb-toolbar-inner flex p-1 m-1 space-x-1 border rounded-full shadow pointer-events-auto border-stone-300 bg-white/80 dark:bg-stone-900/80 backdrop-blur"><div class="myst-jp-nb-toolbar-power rounded"><button class="myst-jp-nb-toolbar-power-btn flex text-center rounded-full cursor-pointer text-stone-800 dark:text-white hover:opacity-100 opacity-60" aria-label="start compute environment"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="inline-block w-6 h-6 align-top"><title>Launch kernel</title><path stroke-linecap="round" stroke-linejoin="round" d="M5.636 5.636a9 9 0 1 0 12.728 0M12 3v9"></path></svg></button></div></div></div><div id="skip-to-article"></div><p>Author: Zack Ulissi (Meta, CMU), with help from AI coding agents / LLMs</p><p>Original paper: Bjarne Kreitz et al. JPCC (2021)</p><h2 id="overview" class="relative group"><span class="heading-text">Overview</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#overview" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>This tutorial demonstrates how to use the Universal Model for Atoms (UMA) machine learning potential to perform comprehensive catalyst surface analysis. We replicate key computational workflows from <cite class="" data-state="closed"><a href="https://doi.org/10.1021/acs.jpcc.0c09985" target="_blank" rel="noreferrer" class="hover-link">“Microkinetic Modeling of CO₂ Desorption from Supported Multifaceted Ni Catalysts”</a></cite> by Bjarne Kreitz (now faculty at Georgia Tech!), showing how ML potentials can accelerate computational catalysis research.</p><aside class="myst-admonition myst-admonition-note my-5 shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-gray-50/10 dark:bg-stone-800 overflow-hidden myst-admonition-default rounded border-l-4 border-blue-500 note"><div class="myst-admonition-header m-0 font-medium py-1 flex min-w-0 text-lg text-blue-600 bg-blue-50 dark:bg-slate-900"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="myst-admonition-header-icon inline-block pl-2 mr-2 self-center flex-none text-blue-600"><path stroke-linecap="round" stroke-linejoin="round" d="m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"></path></svg><div class="myst-admonition-header-text text-neutral-900 dark:text-white grow self-center overflow-hidden break-words">Learning Objectives</div></div><div class="myst-admonition-body px-4 py-1"><p>By the end of this tutorial, you will be able to:</p><ul><li><p>Optimize bulk crystal structures and extract lattice constants</p></li><li><p>Calculate surface energies using linear extrapolation methods</p></li><li><p>Construct Wulff shapes to predict nanoparticle morphologies</p></li><li><p>Compute adsorption energies with zero-point energy corrections</p></li><li><p>Study coverage-dependent binding phenomena</p></li><li><p>Calculate reaction barriers using the nudged elastic band (NEB) method</p></li><li><p>Apply D3 dispersion corrections to improve accuracy</p></li></ul></div></aside><aside class="myst-admonition myst-admonition-tip my-5 shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-gray-50/10 dark:bg-stone-800 overflow-hidden myst-admonition-default rounded border-l-4 border-green-600 tip"><div class="myst-admonition-header m-0 font-medium py-1 flex min-w-0 text-lg text-green-600 bg-green-50 dark:bg-slate-900"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="myst-admonition-header-icon inline-block pl-2 mr-2 self-center flex-none text-green-600"><path stroke-linecap="round" stroke-linejoin="round" d="m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"></path></svg><div class="myst-admonition-header-text text-neutral-900 dark:text-white grow self-center overflow-hidden break-words">About UMA-S-1P1</div></div><div class="myst-admonition-body px-4 py-1"><p>The <strong>UMA-S-1P1</strong> model is a state-of-the-art universal machine learning potential trained on the OMat24, OC20, OMol25, ODAC23, and OMC25 datasets, covering diverse materials and surface chemistries. It provides ~1000× speedup over DFT while maintaining reasonable accuracy for screening studies. Here we’ll use the UMA-s-1p1 checkpoint which is the small (=faster) 1.1 version released in June. The UMA-s-1p1 checkpoint is open science with a lightweight license that users have to agree to through Huggingface.</p><p>You can read more about the UMA models here: <a target="_blank" rel="noreferrer" href="https://arxiv.org/abs/2506.23971" class="link whitespace-nowrap"><span class="link-text whitespace-normal">https://<wbr/>arxiv<wbr/>.org<wbr/>/abs<wbr/>/2506<wbr/>.23971</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="link-icon"><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"></path></svg></a></p></div></aside><h2 id="installation-and-setup" class="relative group"><span class="heading-text">Installation and Setup</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#installation-and-setup" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>This tutorial uses a number of helpful open source packages:</p><ul><li><p><code>ase</code> - Atomic Simulation Environment</p></li><li><p><code>fairchem</code> - FAIR Chemistry ML potentials (formerly OCP)</p></li><li><p><code>pymatgen</code> - Materials analysis</p></li><li><p><code>matplotlib</code> - Visualization</p></li><li><p><code>numpy</code> - Numerical computing</p></li><li><p><code>torch-dftd</code> - Dispersion corrections
among many others!</p></li></ul><h3 id="huggingface-setups" class="relative group"><span class="heading-text">Huggingface setups</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#huggingface-setups" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>You need to get a HuggingFace account and request access to the UMA models.</p><p>You need a Huggingface account, request access to <a target="_blank" rel="noreferrer" href="https://huggingface.co/facebook/UMA" class="link whitespace-nowrap"><span class="link-text whitespace-normal">https://<wbr/>huggingface<wbr/>.co<wbr/>/facebook<wbr/>/UMA</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="link-icon"><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"></path></svg></a>, and to create a Huggingface token at <a target="_blank" rel="noreferrer" href="https://huggingface.co/settings/tokens/" class="link whitespace-nowrap"><span class="link-text whitespace-normal">https://<wbr/>huggingface<wbr/>.co<wbr/>/settings<wbr/>/tokens/</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="link-icon"><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"></path></svg></a> with these permission:</p><p>Permissions: Read access to contents of all public gated repos you can access</p><p>Then, add the token as an environment variable using <code>huggingface-cli login</code>:</p><div id="Op44Pg6p0A" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Enter token via huggingface-cli
! huggingface-cli login</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="0oqr4OZurOYp2N8Wj5ffW" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><p>or you can set the token via HF_TOKEN variable:</p><div id="SKdsqXtCn3" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Set token via env variable
import os

os.environ[&quot;HF_TOKEN&quot;] = &quot;MYTOKEN&quot;</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="GgkOx2yIrYFJkKN9fnKfm" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><h3 id="fair-chemistry-uma-installation" class="relative group"><span class="heading-text">FAIR Chemistry (UMA) installation</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#fair-chemistry-uma-installation" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>It may be enough to use <code>pip install fairchem-core</code>. This gets you the latest version on PyPi (<a target="_blank" rel="noreferrer" href="https://pypi.org/project/fairchem-core/" class="link whitespace-nowrap"><span class="link-text whitespace-normal">https://<wbr/>pypi<wbr/>.org<wbr/>/project<wbr/>/fairchem<wbr/>-core/</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="link-icon"><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"></path></svg></a>)</p><p>Here we install some sub-packages. This can take 2-5 minutes to run.</p><div id="J7G9RVlqkj" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">! pip install fairchem-core[docs] fairchem-data-oc fairchem-applications-cattsunami x3dase</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="IkW-O-4gFyfh5EgFWNyhX" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="Nre8gT3gGb" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Check that packages are installed
!pip list | grep fairchem</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="4RLHTNUOqYbeAwXZrGg_Y" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>fairchem-applications-cattsunami   1.1.2.dev169+g4ae8d4a0
fairchem-core                      2.14.0
fairchem-data-oc                   1.0.3.dev169+g4ae8d4a0
fairchem-data-omat                 0.2.1.dev74+g4ae8d4a0
</span></code></pre></div></div></div></div><div id="elDRUWyA37" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">import fairchem.core

fairchem.core.__version__</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="ELv91ma6oFh3K_7bHr8DA" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-text" class="font-mono text-sm whitespace-pre-wrap myst-jp-safe-output-text"><code><span>&#x27;2.14.0&#x27;</span></code></div></div></div><h2 id="package-imports" class="relative group"><span class="heading-text">Package imports</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#package-imports" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>First, let’s import all necessary libraries and initialize the UMA-S-1P1 predictor:</p><div id="LEzv0AXVHZ" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">from pathlib import Path

import ase.io
import matplotlib.pyplot as plt
import numpy as np
from ase import Atoms
from ase.build import bulk
from ase.constraints import FixBondLengths
from ase.io import write
from ase.mep import interpolate
from ase.mep.dyneb import DyNEB
from ase.optimize import FIRE, LBFGS
from ase.vibrations import Vibrations
from ase.visualize import view
from fairchem.core import FAIRChemCalculator, pretrained_mlip
from fairchem.data.oc.core import (
    Adsorbate,
    AdsorbateSlabConfig,
    Bulk,
    MultipleAdsorbateSlabConfig,
    Slab,
)
from pymatgen.analysis.wulff import WulffShape
from pymatgen.core import Lattice, Structure
from pymatgen.core.surface import SlabGenerator
from pymatgen.io.ase import AseAtomsAdaptor
from torch_dftd.torch_dftd3_calculator import TorchDFTD3Calculator

# Set up output directory structure
output_dir = Path(&quot;ni_tutorial_results&quot;)
output_dir.mkdir(exist_ok=True)

# Create subdirectories for each part
part_dirs = {
    &quot;part1&quot;: &quot;part1-bulk-optimization&quot;,
    &quot;part2&quot;: &quot;part2-surface-energies&quot;,
    &quot;part3&quot;: &quot;part3-wulff-construction&quot;,
    &quot;part4&quot;: &quot;part4-h-adsorption&quot;,
    &quot;part5&quot;: &quot;part5-coverage-dependence&quot;,
    &quot;part6&quot;: &quot;part6-co-dissociation&quot;,
}

for key, dirname in part_dirs.items():
    (output_dir / dirname).mkdir(exist_ok=True)

# Create subdirectories for different facets in part2
for facet in [&quot;111&quot;, &quot;100&quot;, &quot;110&quot;, &quot;211&quot;]:
    (output_dir / part_dirs[&quot;part2&quot;] / f&quot;ni{facet}&quot;).mkdir(exist_ok=True)

# Initialize the UMA-S-1P1 predictor
print(&quot;\nLoading UMA-S-1P1 model...&quot;)
predictor = pretrained_mlip.get_predict_unit(&quot;uma-s-1p1&quot;)
print(&quot;✓ Model loaded successfully!&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="a1mIlzDH721yLUU2WS7jd" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>
Loading UMA-S-1P1 model...
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>WARNING:root:device was not explicitly set, using device=&#x27;cuda&#x27;.
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>✓ Model loaded successfully!
</span></code></pre></div></div></div></div><p>It is somewhat time consuming to run this. We’re going to use a small number of bulks for the testing of this documentation, but otherwise run all of the results for the actual documentation.</p><div id="eaxh4bAMAB" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">import os

fast_docs = os.environ.get(&quot;FAST_DOCS&quot;, &quot;false&quot;).lower() == &quot;true&quot;
if fast_docs:
    num_sites = 2
    relaxation_steps = 20
else:
    num_sites = 5
    relaxation_steps = 300</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="vEEgBnR92s5HyH4X3QAw5" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><hr class="py-2 my-5 translate-y-2"/><h2 id="part-1-bulk-crystal-optimization" class="relative group"><span class="heading-text">Part 1: Bulk Crystal Optimization</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#part-1-bulk-crystal-optimization" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><h3 id="introduction" class="relative group"><span class="heading-text">Introduction</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#introduction" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Before studying surfaces, we need to determine the equilibrium lattice constant of bulk Ni. This is crucial because surface energies and adsorbate binding depend strongly on the underlying lattice parameter.</p><h3 id="theory" class="relative group"><span class="heading-text">Theory</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#theory" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>For FCC metals like Ni, the lattice constant <strong>a</strong> defines the unit cell size. The experimental value for Ni is <strong>a = 3.524 Å</strong> at room temperature. We’ll optimize both atomic positions and the cell volume to find the ML potential’s equilibrium structure.</p><div id="SkWO6ci3A3" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Create initial FCC Ni structure
a_initial = 3.52  # Å, close to experimental
ni_bulk = bulk(&quot;Ni&quot;, &quot;fcc&quot;, a=a_initial, cubic=True)

print(f&quot;Initial lattice constant: {a_initial:.2f} Å&quot;)
print(f&quot;Number of atoms: {len(ni_bulk)}&quot;)

# Set up calculator for bulk optimization
calc = FAIRChemCalculator(predictor, task_name=&quot;omat&quot;)
ni_bulk.calc = calc

# Use ExpCellFilter to allow cell relaxation
from ase.filters import ExpCellFilter

ecf = ExpCellFilter(ni_bulk)

# Optimize with LBFGS
opt = LBFGS(
    ecf,
    trajectory=str(output_dir / part_dirs[&quot;part1&quot;] / &quot;ni_bulk_opt.traj&quot;),
    logfile=str(output_dir / part_dirs[&quot;part1&quot;] / &quot;ni_bulk_opt.log&quot;),
)
opt.run(fmax=0.05, steps=relaxation_steps)

# Extract results
cell = ni_bulk.get_cell()
a_optimized = cell[0, 0]
a_exp = 3.524  # Experimental value
error = abs(a_optimized - a_exp) / a_exp * 100

print(f&quot;\n{&#x27;=&#x27;*50}&quot;)
print(f&quot;Experimental lattice constant: {a_exp:.2f} Å&quot;)
print(f&quot;Optimized lattice constant:    {a_optimized:.2f} Å&quot;)
print(f&quot;Relative error:                {error:.2f}%&quot;)
print(f&quot;{&#x27;=&#x27;*50}&quot;)

ase.io.write(str(output_dir / part_dirs[&quot;part1&quot;] / &quot;ni_bulk_relaxed.cif&quot;), ni_bulk)

# Store results for later use
a_opt = a_optimized</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="c5MXmFtv7qllcyb8BCZ6p" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>Initial lattice constant: 3.52 Å
Number of atoms: 4
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/tmp/ipykernel_9713/3959847705.py:15: DeprecationWarning: Use FrechetCellFilter for better convergence w.r.t. cell variables.
  ecf = ExpCellFilter(ni_bulk)
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>
==================================================
Experimental lattice constant: 3.52 Å
Optimized lattice constant:    3.52 Å
Relative error:                0.25%
==================================================
</span></code></pre></div></div></div></div><aside class="myst-admonition myst-admonition-tip my-5 shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-gray-50/10 dark:bg-stone-800 overflow-hidden myst-admonition-default rounded border-l-4 border-green-600 dropdown, tip"><div class="myst-admonition-header m-0 font-medium py-1 flex min-w-0 text-lg text-green-600 bg-green-50 dark:bg-slate-900"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="myst-admonition-header-icon inline-block pl-2 mr-2 self-center flex-none text-green-600"><path stroke-linecap="round" stroke-linejoin="round" d="m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"></path></svg><div class="myst-admonition-header-text text-neutral-900 dark:text-white grow self-center overflow-hidden break-words">Missing UMA access?</div></div><div class="myst-admonition-body px-4 py-1"><p>Don’t have access to UMA yet? You can still explore this calculation!</p><p><a class="link" href="/example_configs/ni_bulk.xyz">Download example Ni bulk structure</a> and test it in the <a target="_blank" rel="noreferrer" href="https://facebook-fairchem-uma-demo.hf.space/" class="link whitespace-nowrap"><span class="link-text whitespace-normal">UMA demo (no login required)</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="link-icon"><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"></path></svg></a> to see how the model predicts properties for bulk Ni.</p></div></aside><aside class="myst-admonition myst-admonition-tip my-5 shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-gray-50/10 dark:bg-stone-800 overflow-hidden myst-admonition-default rounded border-l-4 border-green-600 tip"><div class="myst-admonition-header m-0 font-medium py-1 flex min-w-0 text-lg text-green-600 bg-green-50 dark:bg-slate-900"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="myst-admonition-header-icon inline-block pl-2 mr-2 self-center flex-none text-green-600"><path stroke-linecap="round" stroke-linejoin="round" d="m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"></path></svg><div class="myst-admonition-header-text text-neutral-900 dark:text-white grow self-center overflow-hidden break-words">Understanding the Results</div></div><div class="myst-admonition-body px-4 py-1"><p>UMA-s-1p1 using the <code>omat</code> task name will predict lattice constants at the PBE level of DFT. For metals, PBE typically predicts lattice constants within 1-2% of experimental values.</p><p>Small discrepancies arise from:</p><ul><li><p>Training data biases (if your structure is far from OMAT24)</p></li><li><p>Temperature effects (0 K vs room temperature). You can do a quasi-harmonic analysis to include finite temperature effects if desired.</p></li><li><p>Quantum effects not captured by the underlying DFT/PBE simulations</p></li></ul><p>For surface calculations, using the ML-optimized lattice constant maintains internal consistency.</p></div></aside><aside class="myst-admonition myst-admonition-note my-5 shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-gray-50/10 dark:bg-stone-800 overflow-hidden myst-admonition-default rounded border-l-4 border-blue-500 note"><div class="myst-admonition-header m-0 font-medium py-1 flex min-w-0 text-lg text-blue-600 bg-blue-50 dark:bg-slate-900"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="myst-admonition-header-icon inline-block pl-2 mr-2 self-center flex-none text-blue-600"><path stroke-linecap="round" stroke-linejoin="round" d="m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"></path></svg><div class="myst-admonition-header-text text-neutral-900 dark:text-white grow self-center overflow-hidden break-words">Comparison with Paper</div></div><div class="myst-admonition-body px-4 py-1"><p><strong>Paper (Table 1):</strong> Ni lattice constant = 3.524 Å (experimental reference)</p><p>The UMA-S-1P1 model with OMAT provides excellent agreement with experiment, as would be expected for the PBE functional for simple BCC Ni. The underlying calculations for OMat24 and the original results cited in the paper should be very similar (both PBE), so the fact that the results are a little closer to experiment than the original results is within the numerical noise of the ML model.</p></div></aside><aside class="myst-admonition myst-admonition-seealso my-5 shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-gray-50/10 dark:bg-stone-800 overflow-hidden myst-admonition-default rounded border-l-4 border-green-600 seealso"><div class="myst-admonition-header m-0 font-medium py-1 flex min-w-0 text-lg text-green-600 bg-green-50 dark:bg-slate-900"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="myst-admonition-header-icon inline-block pl-2 mr-2 self-center flex-none text-green-600"><path stroke-linecap="round" stroke-linejoin="round" d="m12.75 15 3-3m0 0-3-3m3 3h-7.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"></path></svg><div class="myst-admonition-header-text text-neutral-900 dark:text-white grow self-center overflow-hidden break-words">Further exploration</div></div><div class="myst-admonition-body px-4 py-1"><p>Try modifying the following parameters and observe the effects:</p><ol start="1"><li><p><strong>Task name</strong>: The original paper re-relaxed the structures at the RPBE level of theory before continuing. Try that with the UMA-s-1p1 model (using the oc20 task name) and see if it matters here.</p></li><li><p><strong>Initial guess</strong>: Change <code>a_initial</code> to 3.0 or 4.0 Å. Does the optimizer still converge to the same value?</p></li><li><p><strong>Convergence criterion</strong>: Tighten <code>fmax</code> to 0.01 eV/Å. How many more steps are required?</p></li><li><p><strong>Different metals</strong>: Replace <code>&quot;Ni&quot;</code> with <code>&quot;Cu&quot;</code>, <code>&quot;Pd&quot;</code>, or <code>&quot;Pt&quot;</code>. Compare predicted vs experimental lattice constants.</p></li><li><p><strong>Cell shape</strong>: Remove <code>cubic=True</code> and allow the cell to distort. Does FCC remain stable?</p></li></ol></div></aside><hr class="py-2 my-5 translate-y-2"/><h2 id="part-2-surface-energy-calculations" class="relative group"><span class="heading-text">Part 2: Surface Energy Calculations</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#part-2-surface-energy-calculations" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><h3 id="introduction-1" class="relative group"><span class="heading-text">Introduction</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#introduction-1" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Surface energy (γ) quantifies the thermodynamic cost of creating a surface. It determines surface stability, morphology, and catalytic activity. We’ll calculate γ for four low-index Ni facets: (111), (100), (110), and (211).</p><h3 id="theory-1" class="relative group"><span class="heading-text">Theory</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#theory-1" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>The surface energy is defined as:</p><div id="hlm9gV9BdU" class="flex my-5 group"><div class="flex-grow overflow-x-auto overflow-y-hidden"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>γ</mi><mo>=</mo><mfrac><mrow><msub><mi>E</mi><mtext>slab</mtext></msub><mo>−</mo><mi>N</mi><mo>⋅</mo><msub><mi>E</mi><mtext>bulk</mtext></msub></mrow><mrow><mn>2</mn><mi>A</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\gamma = \frac{E_{\text{slab}} - N \cdot E_{\text{bulk}}}{2A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0463em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span><span class="mord mathnormal">A</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">slab</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">bulk</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></div><div class="relative self-center flex-none pl-2 m-0 text-right select-none"><a class="no-underline text-inherit hover:text-inherit text-inherit hover:text-inherit select-none hover:underline" href="#hlm9gV9BdU" title="Link to this Equation" aria-label="Link to this Equation">(<!-- -->1<!-- -->)</a></div></div><p>where:</p><ul><li><p><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>E</mi><mtext>slab</mtext></msub></mrow><annotation encoding="application/x-tex">E_{\text{slab}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">slab</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> = total energy of the slab</p></li><li><p><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span></span> = number of atoms in the slab</p></li><li><p><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>E</mi><mtext>bulk</mtext></msub></mrow><annotation encoding="application/x-tex">E_{\text{bulk}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">bulk</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> = bulk energy per atom</p></li><li><p><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></span> = surface area</p></li><li><p>Factor of 2 accounts for two surfaces (top and bottom)</p></li></ul><p><strong>Challenge</strong>: Direct calculation suffers from quantum size effects, and if you were doing DFT calculations small numerical errors in the simulation or from the K-point grid sampling can lead to small (but significant) errors in the bulk lattice energy.</p><p><strong>Solution</strong>: It is fairly common when calculating surface energies to use the bulk energy from a bulk relaxation in the above equation. However, because DFT often has some small numerical noise in the predictions from k-point convergence, this might lead to the wrong surface energy. Instead, two more careful schemes are either:</p><ol start="1"><li><p>Calculate the energy of a bulk structure oriented to each slab to maximize cancellation of small numerical errors or</p></li><li><p>Calculate the energy of multiple slabs at multiple thicknesses and extrapolate to zero thickness. The intercept will be the surface energy, and the slope will be a fitted bulk energy. A benefit of this approach is that it also forces us to check that we have a sufficiently thick slab for a well defined surface energy; if the fit is non-linear we need thicker slabs.</p></li></ol><p>We’ll use the linear extrapolation method here as it’s more likely to work in future DFT studies if you use this code!</p><h3 id="step-1-setup-and-bulk-energy-reference" class="relative group"><span class="heading-text">Step 1: Setup and Bulk Energy Reference</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#step-1-setup-and-bulk-energy-reference" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>First, we’ll set up the calculation parameters and get the bulk energy reference:</p><div id="BlNjQNo2Dh" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Calculate surface energies for all facets
facets = [(1, 1, 1), (1, 0, 0), (1, 1, 0), (2, 1, 1)]
surface_energies = {}
surface_energies_SI = {}
all_fit_data = {}

# Get bulk energy reference (only need to do this once)
E_bulk_total = ni_bulk.get_potential_energy()
N_bulk = len(ni_bulk)
E_bulk_per_atom = E_bulk_total / N_bulk

print(f&quot;Bulk energy reference:&quot;)
print(f&quot;  Total energy: {E_bulk_total:.2f} eV&quot;)
print(f&quot;  Number of atoms: {N_bulk}&quot;)
print(f&quot;  Energy per atom: {E_bulk_per_atom:.6f} eV/atom&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="OOnxuxVfXrJBc19HX_Alu" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>Bulk energy reference:
  Total energy: -21.97 eV
  Number of atoms: 4
  Energy per atom: -5.491441 eV/atom
</span></code></pre></div></div></div></div><h3 id="step-2-generate-and-relax-slabs" class="relative group"><span class="heading-text">Step 2: Generate and Relax Slabs</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#step-2-generate-and-relax-slabs" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Now we’ll loop through each facet, generating slabs at three different thicknesses:</p><div id="Q4L8M04gb9" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Convert bulk to pymatgen structure for slab generation
adaptor = AseAtomsAdaptor()
ni_structure = adaptor.get_structure(ni_bulk)

for facet in facets:
    facet_str = &quot;&quot;.join(map(str, facet))
    print(f&quot;\n{&#x27;=&#x27;*60}&quot;)
    print(f&quot;Calculating Ni({facet_str}) surface energy&quot;)
    print(f&quot;{&#x27;=&#x27;*60}&quot;)

    # Calculate for three thicknesses
    thicknesses = [4, 6, 8]  # layers
    n_atoms_list = []
    energies_list = []

    for n_layers in thicknesses:
        print(f&quot;\n  Thickness: {n_layers} layers&quot;)

        # Generate slab
        slabgen = SlabGenerator(
            ni_structure,
            facet,
            min_slab_size=n_layers * a_opt / np.sqrt(sum([h**2 for h in facet])),
            min_vacuum_size=10.0,
            center_slab=True,
        )
        pmg_slab = slabgen.get_slabs()[0]
        slab = adaptor.get_atoms(pmg_slab)
        slab.center(vacuum=10.0, axis=2)

        print(f&quot;    Atoms: {len(slab)}&quot;)

        # Relax slab (no constraints - both surfaces free)
        calc = FAIRChemCalculator(predictor, task_name=&quot;omat&quot;)
        slab.calc = calc
        opt = LBFGS(slab, logfile=None)
        opt.run(fmax=0.05, steps=relaxation_steps)

        E_slab = slab.get_potential_energy()
        n_atoms_list.append(len(slab))
        energies_list.append(E_slab)
        print(f&quot;    Energy: {E_slab:.2f} eV&quot;)

    # Linear regression: E_slab = slope * N + intercept
    coeffs = np.polyfit(n_atoms_list, energies_list, 1)
    slope = coeffs[0]
    intercept = coeffs[1]

    # Extract surface energy from intercept
    cell = slab.get_cell()
    area = np.linalg.norm(np.cross(cell[0], cell[1]))
    gamma = intercept / (2 * area)  # eV/Å²
    gamma_SI = gamma * 16.0218  # J/m²

    print(f&quot;\n  Linear fit:&quot;)
    print(f&quot;    Slope:     {slope:.6f} eV/atom (cf. bulk {E_bulk_per_atom:.6f})&quot;)
    print(f&quot;    Intercept: {intercept:.2f} eV&quot;)
    print(f&quot;\n  Surface energy:&quot;)
    print(f&quot;    γ = {gamma:.6f} eV/Å² = {gamma_SI:.2f} J/m²&quot;)

    # Store results and fit data
    surface_energies[facet] = gamma
    surface_energies_SI[facet] = gamma_SI
    all_fit_data[facet] = {
        &quot;n_atoms&quot;: n_atoms_list,
        &quot;energies&quot;: energies_list,
        &quot;slope&quot;: slope,
        &quot;intercept&quot;: intercept,
    }</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="EeZtiZFisx8gPK2SiqqsE" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>
============================================================
Calculating Ni(111) surface energy
============================================================

  Thickness: 4 layers
    Atoms: 4
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>    Energy: -20.69 eV

  Thickness: 6 layers
    Atoms: 6
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>    Energy: -31.67 eV

  Thickness: 8 layers
    Atoms: 8
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>    Energy: -42.66 eV

  Linear fit:
    Slope:     -5.492960 eV/atom (cf. bulk -5.491441)
    Intercept: 1.28 eV

  Surface energy:
    γ = 0.120067 eV/Å² = 1.92 J/m²

============================================================
Calculating Ni(100) surface energy
============================================================

  Thickness: 4 layers
    Atoms: 8
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>    Energy: -42.16 eV

  Thickness: 6 layers
    Atoms: 12
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>    Energy: -64.12 eV

  Thickness: 8 layers
    Atoms: 16
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>    Energy: -86.09 eV

  Linear fit:
    Slope:     -5.491521 eV/atom (cf. bulk -5.491441)
    Intercept: 1.78 eV

  Surface energy:
    γ = 0.143731 eV/Å² = 2.30 J/m²

============================================================
Calculating Ni(110) surface energy
============================================================

  Thickness: 4 layers
    Atoms: 8
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>    Energy: -41.36 eV

  Thickness: 6 layers
    Atoms: 12
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>    Energy: -63.34 eV

  Thickness: 8 layers
    Atoms: 16
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>    Energy: -85.30 eV

  Linear fit:
    Slope:     -5.492427 eV/atom (cf. bulk -5.491441)
    Intercept: 2.57 eV

  Surface energy:
    γ = 0.147336 eV/Å² = 2.36 J/m²

============================================================
Calculating Ni(211) surface energy
============================================================

  Thickness: 4 layers
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>    Atoms: 8
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>    Energy: -39.69 eV

  Thickness: 6 layers
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>    Atoms: 12
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>    Energy: -61.61 eV

  Thickness: 8 layers
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>    Atoms: 16
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>    Energy: -83.58 eV

  Linear fit:
    Slope:     -5.485733 eV/atom (cf. bulk -5.491441)
    Intercept: 4.20 eV

  Surface energy:
    γ = 0.138877 eV/Å² = 2.23 J/m²
</span></code></pre></div></div></div></div><h3 id="step-3-visualize-linear-fits" class="relative group"><span class="heading-text">Step 3: Visualize Linear Fits</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#step-3-visualize-linear-fits" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Let’s visualize the linear extrapolation for all four facets:</p><div id="ZKC0dyyWJi" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Visualize linear fits for all facets
fig, axes = plt.subplots(2, 2, figsize=(12, 10))
axes = axes.flatten()

for idx, facet in enumerate(facets):
    ax = axes[idx]
    data = all_fit_data[facet]

    # Plot data points
    ax.scatter(
        data[&quot;n_atoms&quot;],
        data[&quot;energies&quot;],
        s=100,
        color=&quot;steelblue&quot;,
        marker=&quot;o&quot;,
        zorder=3,
        label=&quot;Calculated&quot;,
    )

    # Plot fit line
    n_range = np.linspace(min(data[&quot;n_atoms&quot;]) - 5, max(data[&quot;n_atoms&quot;]) + 5, 100)
    E_fit = data[&quot;slope&quot;] * n_range + data[&quot;intercept&quot;]
    ax.plot(
        n_range,
        E_fit,
        &quot;r--&quot;,
        linewidth=2,
        label=f&#x27;Fit: {data[&quot;slope&quot;]:.2f}N + {data[&quot;intercept&quot;]:.2f}&#x27;,
    )

    # Formatting
    facet_str = f&quot;Ni({facet[0]}{facet[1]}{facet[2]})&quot;
    ax.set_xlabel(&quot;Number of Atoms&quot;, fontsize=11)
    ax.set_ylabel(&quot;Slab Energy (eV)&quot;, fontsize=11)
    ax.set_title(
        f&quot;{facet_str}: γ = {surface_energies_SI[facet]:.2f} J/m²&quot;,
        fontsize=12,
        fontweight=&quot;bold&quot;,
    )
    ax.legend(fontsize=9)
    ax.grid(True, alpha=0.3)

plt.tight_layout()
plt.savefig(
    str(output_dir / part_dirs[&quot;part2&quot;] / &quot;surface_energy_fits.png&quot;),
    dpi=300,
    bbox_inches=&quot;tight&quot;,
)
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="iWQcNxsuW1ap1nf2uX3sL" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-image"><img src="/build/34ef9df633346ff7882cd91ef8afd315.png" alt="&lt;Figure size 1200x1000 with 4 Axes&gt;"/></div></div></div><h3 id="step-4-compare-with-literature" class="relative group"><span class="heading-text">Step 4: Compare with Literature</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#step-4-compare-with-literature" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Finally, let’s compare our calculated surface energies with DFT literature values:</p><div id="OfhfAlMCp7" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">print(f&quot;\n{&#x27;=&#x27;*70}&quot;)
print(&quot;Comparison with DFT Literature (Tran et al., 2016)&quot;)
print(f&quot;{&#x27;=&#x27;*70}&quot;)
lit_values = {
    (1, 1, 1): 1.92,
    (1, 0, 0): 2.21,
    (1, 1, 0): 2.29,
    (2, 1, 1): 2.24,
}  # J/m²

for facet in facets:
    facet_str = f&quot;Ni({facet[0]}{facet[1]}{facet[2]})&quot;
    calc = surface_energies_SI[facet]
    lit = lit_values[facet]
    diff = abs(calc - lit) / lit * 100
    print(f&quot;{facet_str:&lt;10} {calc:&gt;8.2f} J/m²  (Lit: {lit:.2f}, Δ={diff:.1f}%)&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="9Y4C7S62sBYjab5YbNxaP" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>
======================================================================
Comparison with DFT Literature (Tran et al., 2016)
======================================================================
Ni(111)        1.92 J/m²  (Lit: 1.92, Δ=0.2%)
Ni(100)        2.30 J/m²  (Lit: 2.21, Δ=4.2%)
Ni(110)        2.36 J/m²  (Lit: 2.29, Δ=3.1%)
Ni(211)        2.23 J/m²  (Lit: 2.24, Δ=0.7%)
</span></code></pre></div></div></div></div><aside class="myst-admonition myst-admonition-tip my-5 shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-gray-50/10 dark:bg-stone-800 overflow-hidden myst-admonition-default rounded border-l-4 border-green-600 dropdown, tip"><div class="myst-admonition-header m-0 font-medium py-1 flex min-w-0 text-lg text-green-600 bg-green-50 dark:bg-slate-900"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="myst-admonition-header-icon inline-block pl-2 mr-2 self-center flex-none text-green-600"><path stroke-linecap="round" stroke-linejoin="round" d="m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"></path></svg><div class="myst-admonition-header-text text-neutral-900 dark:text-white grow self-center overflow-hidden break-words">Missing UMA access?</div></div><div class="myst-admonition-body px-4 py-1"><p>Don’t have access to UMA yet? You can still explore this calculation!</p><p><a class="link" href="/example_configs/ni111_slab.xyz">Download example Ni(111) slab structure</a> and test it in the <a target="_blank" rel="noreferrer" href="https://facebook-fairchem-uma-demo.hf.space/" class="link whitespace-nowrap"><span class="link-text whitespace-normal">UMA demo (no login required)</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="link-icon"><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"></path></svg></a> to see how the model predicts energies for Ni surfaces.</p></div></aside><aside class="myst-admonition myst-admonition-note my-5 shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-gray-50/10 dark:bg-stone-800 overflow-hidden myst-admonition-default rounded border-l-4 border-blue-500 note"><div class="myst-admonition-header m-0 font-medium py-1 flex min-w-0 text-lg text-blue-600 bg-blue-50 dark:bg-slate-900"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="myst-admonition-header-icon inline-block pl-2 mr-2 self-center flex-none text-blue-600"><path stroke-linecap="round" stroke-linejoin="round" d="m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"></path></svg><div class="myst-admonition-header-text text-neutral-900 dark:text-white grow self-center overflow-hidden break-words">Comparison with Paper (Table 1)</div></div><div class="myst-admonition-body px-4 py-1"><p><strong>Paper Results (PBE-DFT, Tran et al.):</strong></p><ul><li><p>Ni(111): 1.92 J/m²</p></li><li><p>Ni(100): 2.21 J/m²</p></li><li><p>Ni(110): 2.29 J/m²</p></li><li><p>Ni(211): 2.24 J/m²</p></li></ul><p><strong>Key Observations:</strong></p><ol start="1"><li><p><strong>Energy ordering preserved</strong>: (111) &lt; (100) &lt; (110) ≈ (211), matching DFT</p></li><li><p><strong>Absolute errors</strong>: Typically 10-20%, within expected range for ML potentials</p></li><li><p><strong>(111) most stable</strong>: Both methods agree this is the lowest energy surface</p></li><li><p><strong>Physical trend correct</strong>: Close-packed surfaces have lower energy</p></li></ol><p><strong>Why differences exist:</strong></p><ul><li><p>Training data biases in ML model, which has seen mostly periodic bulk structures, not surfaces.</p></li><li><p>Slab thickness effects (even with extrapolation)</p></li><li><p>Lack of explicit spin polarization in ML model. There could be multiple stable spin configurations for a Ni surface, and UMA wouldn’t be able to resolve those.</p></li></ul><p><strong>Caveat</strong>
Both methods here use PBE as the underlying functional in DFT. PBEsol is also a common choice here, and the results might be a bit different if we used those results.</p><p><strong>Bottom line</strong>: Surface energy <em>ordering</em> is more reliable than absolute values. Use ML for screening, validate critical cases with DFT.</p></div></aside><aside class="myst-admonition myst-admonition-note my-5 shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-gray-50/10 dark:bg-stone-800 overflow-hidden myst-admonition-default rounded border-l-4 border-blue-500 note"><div class="myst-admonition-header m-0 font-medium py-1 flex min-w-0 text-lg text-blue-600 bg-blue-50 dark:bg-slate-900"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="myst-admonition-header-icon inline-block pl-2 mr-2 self-center flex-none text-blue-600"><path stroke-linecap="round" stroke-linejoin="round" d="m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"></path></svg><div class="myst-admonition-header-text text-neutral-900 dark:text-white grow self-center overflow-hidden break-words">Why Linear Extrapolation?</div></div><div class="myst-admonition-body px-4 py-1"><p>Single-thickness slabs suffer from:</p><ul><li><p><strong>Quantum confinement</strong>: Electronic structure depends on slab thickness</p></li><li><p><strong>Surface-surface interactions</strong>: Bottom and top surfaces couple at small thicknesses</p></li><li><p><strong>Relaxation artifacts</strong>: Atoms at center may not reach bulk-like coordination</p></li></ul><p>Linear extrapolation eliminates these by fitting <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>E</mi><mtext>slab</mtext></msub><mo stretchy="false">(</mo><mi>N</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">E_{\text{slab}}(N)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">slab</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mclose">)</span></span></span></span></span> and extracting the asymptotic surface energy.</p></div></aside><h3 id="explore-on-your-own" class="relative group"><span class="heading-text">Explore on Your Own</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#explore-on-your-own" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><ol start="1"><li><p><strong>Thickness convergence</strong>: Add 10 and 12 layer calculations. Is the linear fit still valid?</p></li><li><p><strong>Constraint effects</strong>: Fix the bottom 2 layers during relaxation. How does this affect γ?</p></li><li><p><strong>Vacuum size</strong>: Vary <code>min_vacuum_size</code> from 8 to 15 Å. When does γ converge?</p></li><li><p><strong>High-index facets</strong>: Try (311) or (331) surfaces. Are they more or less stable?</p></li><li><p><strong>Alternative fitting</strong>: Use polynomial (degree 2) instead of linear fit. Does the intercept change?</p></li></ol><hr class="py-2 my-5 translate-y-2"/><h2 id="part-3-wulff-construction" class="relative group"><span class="heading-text">Part 3: Wulff Construction</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#part-3-wulff-construction" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><h3 id="introduction-2" class="relative group"><span class="heading-text">Introduction</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#introduction-2" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>The <strong>Wulff construction</strong> predicts the equilibrium shape of a crystalline particle by minimizing total surface energy. This determines the morphology of supported catalyst nanoparticles.</p><h3 id="theory-2" class="relative group"><span class="heading-text">Theory</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#theory-2" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>The Wulff theorem states that at equilibrium, the distance from the particle center to a facet is proportional to its surface energy:</p><div id="Prra3w7pbr" class="flex my-5 group"><div class="flex-grow overflow-x-auto overflow-y-hidden"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mfrac><msub><mi>h</mi><mi>i</mi></msub><msub><mi>γ</mi><mi>i</mi></msub></mfrac><mo>=</mo><mtext>constant</mtext></mrow><annotation encoding="application/x-tex">\frac{h_i}{\gamma_i} = \text{constant}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.2519em;vertical-align:-0.8804em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0556em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord text"><span class="mord">constant</span></span></span></span></span></span></div><div class="relative self-center flex-none pl-2 m-0 text-right select-none"><a class="no-underline text-inherit hover:text-inherit text-inherit hover:text-inherit select-none hover:underline" href="#Prra3w7pbr" title="Link to this Equation" aria-label="Link to this Equation">(<!-- -->2<!-- -->)</a></div></div><p>Facets with lower surface energy have larger areas in the equilibrium shape.</p><h3 id="step-1-prepare-surface-energies" class="relative group"><span class="heading-text">Step 1: Prepare Surface Energies</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#step-1-prepare-surface-energies" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>We’ll use the surface energies calculated in Part 2 to construct the Wulff shape:</p><div id="CVFcysOlAm" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">print(&quot;\nConstructing Wulff Shape&quot;)
print(&quot;=&quot; * 50)

# Use optimized bulk structure
adaptor = AseAtomsAdaptor()
ni_structure = adaptor.get_structure(ni_bulk)

miller_list = list(surface_energies_SI.keys())
energy_list = [surface_energies_SI[m] for m in miller_list]

print(f&quot;Using {len(miller_list)} facets:&quot;)
for miller, energy in zip(miller_list, energy_list):
    print(f&quot;  {miller}: {energy:.2f} J/m²&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="fQQRKxQb_Uf_-l8q0Nqzf" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>
Constructing Wulff Shape
==================================================
Using 4 facets:
  (1, 1, 1): 1.92 J/m²
  (1, 0, 0): 2.30 J/m²
  (1, 1, 0): 2.36 J/m²
  (2, 1, 1): 2.23 J/m²
</span></code></pre></div></div></div></div><h3 id="step-2-generate-wulff-construction" class="relative group"><span class="heading-text">Step 2: Generate Wulff Construction</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#step-2-generate-wulff-construction" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Now we create the Wulff shape and analyze its properties:</p><div id="UUrxtAPc4y" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Create Wulff shape
wulff = WulffShape(ni_structure.lattice, miller_list, energy_list)

# Print properties
print(f&quot;\nWulff Shape Properties:&quot;)
print(f&quot;  Volume:          {wulff.volume:.2f} Å³&quot;)
print(f&quot;  Surface area:    {wulff.surface_area:.2f} Å²&quot;)
print(f&quot;  Effective radius: {wulff.effective_radius:.2f} Å&quot;)
print(f&quot;  Weighted γ:      {wulff.weighted_surface_energy:.2f} J/m²&quot;)

# Area fractions
print(f&quot;\nFacet Area Fractions:&quot;)
area_frac = wulff.area_fraction_dict
for hkl, frac in sorted(area_frac.items(), key=lambda x: x[1], reverse=True):
    print(f&quot;  {hkl}: {frac*100:.1f}%&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="C-c_rc9IhonCKGnBMWbYS" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>
Wulff Shape Properties:
  Volume:          44.54 Å³
  Surface area:    66.03 Å²
  Effective radius: 2.20 Å
  Weighted γ:      2.02 J/m²

Facet Area Fractions:
  (1, 1, 1): 70.1%
  (2, 1, 1): 16.9%
  (1, 0, 0): 13.0%
  (1, 1, 0): 0.0%
</span></code></pre></div></div></div></div><h3 id="step-3-visualize-and-compare" class="relative group"><span class="heading-text">Step 3: Visualize and Compare</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#step-3-visualize-and-compare" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Let’s visualize the Wulff shape and compare with literature:</p><div id="m97gKqJOIJ" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Visualize
fig = wulff.get_plot()
plt.title(&quot;Wulff Construction: Ni Nanoparticle&quot;, fontsize=14)
plt.tight_layout()
plt.savefig(
    str(output_dir / part_dirs[&quot;part3&quot;] / &quot;wulff_shape.png&quot;),
    dpi=300,
    bbox_inches=&quot;tight&quot;,
)
plt.show()

# Compare with paper
print(f&quot;\nComparison with Paper (Table 2):&quot;)
paper_fractions = {(1, 1, 1): 69.23, (1, 0, 0): 21.10, (1, 1, 0): 5.28, (2, 1, 1): 4.39}
for hkl in miller_list:
    calc_frac = area_frac.get(hkl, 0) * 100
    paper_frac = paper_fractions.get(hkl, 0)
    print(f&quot;  {hkl}: {calc_frac:&gt;6.1f}% (Paper: {paper_frac:.1f}%)&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="pm3EF7CSj4onWbSjIU4a-" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-image"><img src="/build/ee7a7c0dd7528ee6c7de9da7b361b474.png" alt="&lt;Figure size 800x800 with 1 Axes&gt;"/></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>
Comparison with Paper (Table 2):
  (1, 1, 1):   70.1% (Paper: 69.2%)
  (1, 0, 0):   13.0% (Paper: 21.1%)
  (1, 1, 0):    0.0% (Paper: 5.3%)
  (2, 1, 1):   16.9% (Paper: 4.4%)
</span></code></pre></div></div></div></div><aside class="myst-admonition myst-admonition-note my-5 shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-gray-50/10 dark:bg-stone-800 overflow-hidden myst-admonition-default rounded border-l-4 border-blue-500 note"><div class="myst-admonition-header m-0 font-medium py-1 flex min-w-0 text-lg text-blue-600 bg-blue-50 dark:bg-slate-900"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="myst-admonition-header-icon inline-block pl-2 mr-2 self-center flex-none text-blue-600"><path stroke-linecap="round" stroke-linejoin="round" d="m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"></path></svg><div class="myst-admonition-header-text text-neutral-900 dark:text-white grow self-center overflow-hidden break-words">Comparison with Paper (Table 2)</div></div><div class="myst-admonition-body px-4 py-1"><p><strong>Paper Results (Wulff Construction):</strong></p><ul><li><p>Ni(111): 69.23% of surface area</p></li><li><p>Ni(100): 21.10%</p></li><li><p>Ni(110): 5.28%</p></li><li><p>Ni(211): 4.39%</p></li></ul><p><strong>Key Findings:</strong></p><ol start="1"><li><p><strong>(111) dominance</strong>: Both ML and DFT show &gt;65% of surface is (111) facets</p></li><li><p><strong>Shape prediction</strong>: Truncated octahedron with primarily {111} and {100} faces</p></li><li><p><strong>Minor facets</strong>: (110) and (211) have small contributions (&lt;10%)</p></li><li><p><strong>Agreement</strong>: Area fraction ordering matches perfectly with paper</p></li></ol><p><strong>Physical interpretation:</strong></p><ul><li><p>Real Ni nanoparticles are (111)-terminated octahedra</p></li><li><p>(100) facets appear at corners/edges as truncations</p></li><li><p>This morphology is confirmed experimentally by TEM</p></li><li><p>Explains why (111) surface chemistry dominates catalysis</p></li></ul><p><strong>Impact on catalysis:</strong></p><ul><li><p>Must study (111) surface for representative results</p></li><li><p>(100) sites may be important for minority reaction pathways</p></li><li><p>Edge/corner sites (not captured here) can be highly active</p></li></ul></div></aside><aside class="myst-admonition myst-admonition-note my-5 shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-gray-50/10 dark:bg-stone-800 overflow-hidden myst-admonition-default rounded border-l-4 border-blue-500 note"><div class="myst-admonition-header m-0 font-medium py-1 flex min-w-0 text-lg text-blue-600 bg-blue-50 dark:bg-slate-900"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="myst-admonition-header-icon inline-block pl-2 mr-2 self-center flex-none text-blue-600"><path stroke-linecap="round" stroke-linejoin="round" d="m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"></path></svg><div class="myst-admonition-header-text text-neutral-900 dark:text-white grow self-center overflow-hidden break-words">Physical Interpretation</div></div><div class="myst-admonition-body px-4 py-1"><p>The Wulff shape shows:</p><ul><li><p><strong>(111) dominance</strong>: Close-packed surface has lowest energy → largest area</p></li><li><p><strong>(100) presence</strong>: Moderate energy → significant area fraction</p></li><li><p><strong>(110), (211) minor</strong>: Higher energy → small or absent</p></li></ul><p>This predicts that Ni nanoparticles will be predominantly {111}-faceted octahedra with {100} truncations, matching experimental observations.</p></div></aside><h3 id="explore-on-your-own-1" class="relative group"><span class="heading-text">Explore on Your Own</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#explore-on-your-own-1" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><ol start="1"><li><p><strong>Particle size effects</strong>: How would including edge/corner energies modify the shape?</p></li><li><p><strong>Anisotropic strain</strong>: Apply 2% compressive strain to the lattice. How does the shape change?</p></li><li><p><strong>Temperature effects</strong>: Surface energies decrease with T. Estimate γ(T) and recompute Wulff shape.</p></li><li><p><strong>Alloy nanoparticles</strong>: Replace some Ni with Cu or Au. How would segregation affect the shape?</p></li><li><p><strong>Support effects</strong>: Some facets interact more strongly with supports. Model this by reducing their γ.</p></li></ol><hr class="py-2 my-5 translate-y-2"/><h2 id="part-4-h-adsorption-energy-with-zpe-correction" class="relative group"><span class="heading-text">Part 4: H Adsorption Energy with ZPE Correction</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#part-4-h-adsorption-energy-with-zpe-correction" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><h3 id="introduction-3" class="relative group"><span class="heading-text">Introduction</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#introduction-3" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Hydrogen adsorption is a fundamental step in many catalytic reactions (hydrogenation, dehydrogenation, etc.). We’ll calculate the binding energy with vibrational zero-point energy (ZPE) corrections.</p><h3 id="theory-3" class="relative group"><span class="heading-text">Theory</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#theory-3" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>The adsorption energy is:</p><div id="CAirYNkUXa" class="flex my-5 group"><div class="flex-grow overflow-x-auto overflow-y-hidden"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>E</mi><mtext>ads</mtext></msub><mo>=</mo><mi>E</mi><mo stretchy="false">(</mo><mtext>slab+H</mtext><mo stretchy="false">)</mo><mo>−</mo><mi>E</mi><mo stretchy="false">(</mo><mtext>slab</mtext><mo stretchy="false">)</mo><mo>−</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mi>E</mi><mo stretchy="false">(</mo><msub><mtext>H</mtext><mn>2</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">E_{\text{ads}} = E(\text{slab+H}) - E(\text{slab}) - \frac{1}{2}E(\text{H}_2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">ads</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mopen">(</span><span class="mord text"><span class="mord">slab+H</span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mopen">(</span><span class="mord text"><span class="mord">slab</span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.0074em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mopen">(</span><span class="mord"><span class="mord text"><span class="mord">H</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></div><div class="relative self-center flex-none pl-2 m-0 text-right select-none"><a class="no-underline text-inherit hover:text-inherit text-inherit hover:text-inherit select-none hover:underline" href="#CAirYNkUXa" title="Link to this Equation" aria-label="Link to this Equation">(<!-- -->3<!-- -->)</a></div></div><p>ZPE correction accounts for quantum vibrational effects:</p><div id="YQLGBMut4A" class="flex my-5 group"><div class="flex-grow overflow-x-auto overflow-y-hidden"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msubsup><mi>E</mi><mtext>ads</mtext><mtext>ZPE</mtext></msubsup><mo>=</mo><msub><mi>E</mi><mtext>ads</mtext></msub><mo>+</mo><mtext>ZPE</mtext><mo stretchy="false">(</mo><msup><mtext>H</mtext><mo>∗</mo></msup><mo stretchy="false">)</mo><mo>−</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mtext>ZPE</mtext><mo stretchy="false">(</mo><msub><mtext>H</mtext><mn>2</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">E_{\text{ads}}^{\text{ZPE}} = E_{\text{ads}} + \text{ZPE}(\text{H}^*) - \frac{1}{2}\text{ZPE}(\text{H}_2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1383em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-2.453em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">ads</span></span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">ZPE</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">ads</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0119em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">ZPE</span></span><span class="mopen">(</span><span class="mord"><span class="mord text"><span class="mord">H</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7619em;"><span style="top:-3.1362em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.0074em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord text"><span class="mord">ZPE</span></span><span class="mopen">(</span><span class="mord"><span class="mord text"><span class="mord">H</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></div><div class="relative self-center flex-none pl-2 m-0 text-right select-none"><a class="no-underline text-inherit hover:text-inherit text-inherit hover:text-inherit select-none hover:underline" href="#YQLGBMut4A" title="Link to this Equation" aria-label="Link to this Equation">(<!-- -->4<!-- -->)</a></div></div><p>The ZPE correction is calculated by analyzing the vibrational modes of the molecule/adsorbate.</p><h3 id="step-1-setup-and-relax-clean-slab" class="relative group"><span class="heading-text">Step 1: Setup and Relax Clean Slab</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#step-1-setup-and-relax-clean-slab" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>First, we create the Ni(111) surface and relax it:</p><div id="x0Enl9tVx4" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Create Ni(111) slab
ni_bulk_atoms = bulk(&quot;Ni&quot;, &quot;fcc&quot;, a=a_opt, cubic=True)
ni_bulk_obj = Bulk(bulk_atoms=ni_bulk_atoms)
ni_slabs = Slab.from_bulk_get_specific_millers(
    bulk=ni_bulk_obj, specific_millers=(1, 1, 1)
)
ni_slab = ni_slabs[0].atoms

print(f&quot;   Created {len(ni_slab)} atom slab&quot;)

# Set up calculators
calc = FAIRChemCalculator(predictor, task_name=&quot;oc20&quot;)
d3_calc = TorchDFTD3Calculator(device=&quot;cpu&quot;, damping=&quot;bj&quot;)
print(&quot;   Calculators initialized (ML + D3)&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="djyVM0eVzomWuNVRUdOLf" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>   Created 96 atom slab
   Calculators initialized (ML + D3)
</span></code></pre></div></div></div></div><h3 id="step-2-relax-clean-slab" class="relative group"><span class="heading-text">Step 2: Relax Clean Slab</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#step-2-relax-clean-slab" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Relax the bare Ni(111) surface as our reference:</p><div id="x00VxXA1nl" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">print(&quot;\n1. Relaxing clean Ni(111) slab...&quot;)
clean_slab = ni_slab.copy()
clean_slab.set_pbc([True, True, True])
clean_slab.calc = calc

opt = LBFGS(
    clean_slab,
    trajectory=str(output_dir / part_dirs[&quot;part4&quot;] / &quot;ni111_clean.traj&quot;),
    logfile=str(output_dir / part_dirs[&quot;part4&quot;] / &quot;ni111_clean.log&quot;),
)
opt.run(fmax=0.05, steps=relaxation_steps)

E_clean_ml = clean_slab.get_potential_energy()
clean_slab.calc = d3_calc
E_clean_d3 = clean_slab.get_potential_energy()
E_clean = E_clean_ml + E_clean_d3
print(f&quot;   E(clean): {E_clean:.2f} eV (ML: {E_clean_ml:.2f}, D3: {E_clean_d3:.2f})&quot;)

# Save clean slab
ase.io.write(str(output_dir / part_dirs[&quot;part4&quot;] / &quot;ni111_clean.xyz&quot;), clean_slab)
print(&quot;   ✓ Clean slab relaxed and saved&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="lwbr5E-nz2m5U9W7Y8TCF" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>
1. Relaxing clean Ni(111) slab...
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/home/runner/work/_tool/Python/3.12.12/x64/lib/python3.12/site-packages/torch_dftd/torch_dftd3_calculator.py:98: UserWarning: Creating a tensor from a list of numpy.ndarrays is extremely slow. Please consider converting the list to a single numpy.ndarray with numpy.array() before converting to a tensor. (Triggered internally at /pytorch/torch/csrc/utils/tensor_new.cpp:253.)
  cell: Optional[Tensor] = torch.tensor(
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>   E(clean): -487.46 eV (ML: -450.89, D3: -36.57)
   ✓ Clean slab relaxed and saved
</span></code></pre></div></div></div></div><h3 id="step-3-generate-h-adsorption-sites" class="relative group"><span class="heading-text">Step 3: Generate H Adsorption Sites</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#step-3-generate-h-adsorption-sites" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Use heuristic placement to generate multiple candidate H adsorption sites:</p><div id="uMrNZ1n6Fc" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">print(&quot;\n2. Generating 5 H adsorption sites...&quot;)
ni_slab_for_ads = ni_slabs[0]
ni_slab_for_ads.atoms = clean_slab.copy()

adsorbate_h = Adsorbate(adsorbate_smiles_from_db=&quot;*H&quot;)
ads_slab_config = AdsorbateSlabConfig(
    ni_slab_for_ads,
    adsorbate_h,
    mode=&quot;random_site_heuristic_placement&quot;,
    num_sites=num_sites,
)

print(f&quot;   Generated {len(ads_slab_config.atoms_list)} initial configurations&quot;)
print(&quot;   These include fcc, hcp, bridge, and top sites&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="bQo1Jh-yzCp6lMl91C9SN" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>
2. Generating 5 H adsorption sites...
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>   Generated 2 initial configurations
   These include fcc, hcp, bridge, and top sites
</span></code></pre></div></div></div></div><h3 id="step-4-relax-all-h-configurations" class="relative group"><span class="heading-text">Step 4: Relax All H Configurations</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#step-4-relax-all-h-configurations" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Relax each configuration and identify the most stable site:</p><div id="ec5c5JjL92" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">print(&quot;\n3. Relaxing all H adsorption configurations...&quot;)
h_energies = []
h_configs = []
h_d3_energies = []

for idx, config in enumerate(ads_slab_config.atoms_list):
    config_relaxed = config.copy()
    config_relaxed.set_pbc([True, True, True])
    config_relaxed.calc = calc

    opt = LBFGS(
        config_relaxed,
        trajectory=str(output_dir / part_dirs[&quot;part4&quot;] / f&quot;h_site_{idx+1}.traj&quot;),
        logfile=str(output_dir / part_dirs[&quot;part4&quot;] / f&quot;h_site_{idx+1}.log&quot;),
    )
    opt.run(fmax=0.05, steps=relaxation_steps)

    E_ml = config_relaxed.get_potential_energy()
    config_relaxed.calc = d3_calc
    E_d3 = config_relaxed.get_potential_energy()
    E_total = E_ml + E_d3

    h_energies.append(E_total)
    h_configs.append(config_relaxed)
    h_d3_energies.append(E_d3)
    print(f&quot;   Config {idx+1}: {E_total:.2f} eV (ML: {E_ml:.2f}, D3: {E_d3:.2f})&quot;)

    # Save structure
    ase.io.write(
        str(output_dir / part_dirs[&quot;part4&quot;] / f&quot;h_site_{idx+1}.xyz&quot;), config_relaxed
    )

# Select best configuration
best_idx = np.argmin(h_energies)
slab_with_h = h_configs[best_idx]
E_with_h = h_energies[best_idx]
E_with_h_d3 = h_d3_energies[best_idx]

print(f&quot;\n   ✓ Best site: Config {best_idx+1}, E = {E_with_h:.2f} eV&quot;)
print(f&quot;   Energy spread: {max(h_energies) - min(h_energies):.2f} eV&quot;)
print(f&quot;   This spread indicates the importance of testing multiple sites!&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="XFdSIuhqdh4DD0GoOxz73" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>
3. Relaxing all H adsorption configurations...
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>   Config 1: -491.53 eV (ML: -454.87, D3: -36.65)
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>   Config 2: -491.48 eV (ML: -454.82, D3: -36.66)

   ✓ Best site: Config 1, E = -491.53 eV
   Energy spread: 0.05 eV
   This spread indicates the importance of testing multiple sites!
</span></code></pre></div></div></div></div><h3 id="step-5-calculate-h-reference-energy" class="relative group"><span class="heading-text">Step 5: Calculate H₂ Reference Energy</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#step-5-calculate-h-reference-energy" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>We need the H₂ molecule energy as a reference:</p><div id="euRXGlu9p7" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">print(&quot;\n4. Calculating H₂ reference energy...&quot;)
h2 = Atoms(&quot;H2&quot;, positions=[[0, 0, 0], [0, 0, 0.74]])
h2.center(vacuum=10.0)
h2.set_pbc([True, True, True])
h2.calc = calc

opt = LBFGS(
    h2,
    trajectory=str(output_dir / part_dirs[&quot;part4&quot;] / &quot;h2.traj&quot;),
    logfile=str(output_dir / part_dirs[&quot;part4&quot;] / &quot;h2.log&quot;),
)
opt.run(fmax=0.05, steps=relaxation_steps)

E_h2_ml = h2.get_potential_energy()
h2.calc = d3_calc
E_h2_d3 = h2.get_potential_energy()
E_h2 = E_h2_ml + E_h2_d3
print(f&quot;   E(H₂): {E_h2:.2f} eV (ML: {E_h2_ml:.2f}, D3: {E_h2_d3:.2f})&quot;)

# Save H2 structure
ase.io.write(str(output_dir / part_dirs[&quot;part4&quot;] / &quot;h2_optimized.xyz&quot;), h2)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="Dmobw7YK2K8Xp16KpDdpo" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>
4. Calculating H₂ reference energy...
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>   E(H₂): -6.97 eV (ML: -6.97, D3: -0.00)
</span></code></pre></div></div></div></div><h3 id="step-6-compute-adsorption-energy" class="relative group"><span class="heading-text">Step 6: Compute Adsorption Energy</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#step-6-compute-adsorption-energy" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Calculate the adsorption energy using the formula: E_ads = E(slab+H) - E(slab) - 0.5×E(H₂)</p><div id="coXRzz8QNY" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">print(f&quot;\n4. Computing Adsorption Energy:&quot;)
print(&quot;   E_ads = E(slab+H) - E(slab) - 0.5×E(H₂)&quot;)

E_ads = E_with_h - E_clean - 0.5 * E_h2
E_ads_no_d3 = (E_with_h - E_with_h_d3) - (E_clean - E_clean_d3) - 0.5 * (E_h2 - E_h2_d3)

print(f&quot;\n   Without D3: {E_ads_no_d3:.2f} eV&quot;)
print(f&quot;   With D3:    {E_ads:.2f} eV&quot;)
print(f&quot;   D3 effect:  {E_ads - E_ads_no_d3:.2f} eV&quot;)
print(f&quot;\n   → D3 corrections are negligible for H* (small, covalent bonding)&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="YMb3dy1Osyehle8k3ztn8" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>
4. Computing Adsorption Energy:
   E_ads = E(slab+H) - E(slab) - 0.5×E(H₂)

   Without D3: -0.50 eV
   With D3:    -0.58 eV
   D3 effect:  -0.08 eV

   → D3 corrections are negligible for H* (small, covalent bonding)
</span></code></pre></div></div></div></div><h3 id="step-7-zero-point-energy-zpe-corrections" class="relative group"><span class="heading-text">Step 7: Zero-Point Energy (ZPE) Corrections</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#step-7-zero-point-energy-zpe-corrections" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Calculate vibrational frequencies to get ZPE corrections:</p><div id="Kd4Se9YdZ5" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">print(&quot;\n6. Computing ZPE corrections...&quot;)
print(&quot;   This accounts for quantum vibrational effects&quot;)
h_index = len(slab_with_h) - 1
slab_with_h.calc = calc
vib = Vibrations(slab_with_h, indices=[h_index], delta=0.02)
vib.run()
vib_energies = vib.get_energies()
zpe_ads = np.sum(vib_energies) / 2.0

h2.calc = calc
vib_h2 = Vibrations(h2, indices=[0, 1], delta=0.02)
vib_h2.run()
vib_energies_h2 = vib_h2.get_energies()
zpe_h2 = np.sum(vib_energies_h2) / 2.0

E_ads_zpe = E_ads + zpe_ads - 0.5 * zpe_h2

print(f&quot;   ZPE(H*):  {zpe_ads:.2f} eV&quot;)
print(f&quot;   ZPE(H₂):  {zpe_h2:.2f} eV&quot;)
print(f&quot;   E_ads(ZPE): {E_ads_zpe:.2f} eV&quot;)

# Visualize vibrational modes
print(&quot;\n   Creating animations of vibrational modes...&quot;)
vib.write_mode(n=0)
ase.io.write(&quot;vib.0.gif&quot;, ase.io.read(&quot;vib.0.traj@:&quot;), rotation=(&quot;-45x,0y,0z&quot;))

vib.clean()
vib_h2.clean()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="eqb4oKmjh-3U4I0Lqoq_-" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>
6. Computing ZPE corrections...
   This accounts for quantum vibrational effects
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>   ZPE(H*):  0.18+0.00j eV
   ZPE(H₂):  0.41+0.00j eV
   E_ads(ZPE): -0.61-0.00j eV

   Creating animations of vibrational modes...
</span></code></pre></div></div><div data-name="safe-output-text" class="font-mono text-sm whitespace-pre-wrap myst-jp-safe-output-text"><code><span>0</span></code></div><div data-name="safe-output-image"><img src="/build/aa68cff275eb0848410ea1eb3c9eb9c0.png" alt="&lt;Figure size 640x480 with 1 Axes&gt;"/></div></div></div><img id="hKIZaPLH0i" style="width:750px;margin-left:auto;margin-right:auto" src="/build/vib.0-3108e0682b2bf05fbb952db933022aed.gif" data-canonical-url="vib.0.gif" class=""/><h3 id="step-8-visualize-and-compare-results" class="relative group"><span class="heading-text">Step 8: Visualize and Compare Results</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#step-8-visualize-and-compare-results" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Visualize the best configuration and compare with literature:</p><div id="QqU2Dj8CYd" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">print(&quot;\n7. Visualizing best H* configuration...&quot;)
view(slab_with_h, viewer=&#x27;x3d&#x27;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="t10vEmj9aj396KHHq2Yab" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>
7. Visualizing best H* configuration...
</span></code></pre></div></div><div><div class="p-2.5">Loading...</div></div></div></div><aside class="myst-admonition myst-admonition-tip my-5 shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-gray-50/10 dark:bg-stone-800 overflow-hidden myst-admonition-default rounded border-l-4 border-green-600 dropdown, tip"><div class="myst-admonition-header m-0 font-medium py-1 flex min-w-0 text-lg text-green-600 bg-green-50 dark:bg-slate-900"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="myst-admonition-header-icon inline-block pl-2 mr-2 self-center flex-none text-green-600"><path stroke-linecap="round" stroke-linejoin="round" d="m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"></path></svg><div class="myst-admonition-header-text text-neutral-900 dark:text-white grow self-center overflow-hidden break-words">Missing UMA access?</div></div><div class="myst-admonition-body px-4 py-1"><p>Don’t have access to UMA yet? You can still explore this calculation!</p><p><a class="link" href="/example_configs/h_on_ni111.xyz">Download example H on Ni(111) structure</a> and test it in the <a target="_blank" rel="noreferrer" href="https://facebook-fairchem-uma-demo.hf.space/" class="link whitespace-nowrap"><span class="link-text whitespace-normal">UMA demo (no login required)</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="link-icon"><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"></path></svg></a> to see how the model predicts adsorption properties.</p></div></aside><div id="YjnJsQFBob" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># 6. Compare with literature
print(f&quot;\n{&#x27;=&#x27;*60}&quot;)
print(&quot;Comparison with Literature:&quot;)
print(f&quot;{&#x27;=&#x27;*60}&quot;)
print(&quot;Table 4 (DFT): -0.60 eV (Ni(111), ref H₂)&quot;)
print(f&quot;This work:     {E_ads_zpe:.2f} eV&quot;)
print(f&quot;Difference:    {abs(E_ads_zpe - (-0.60)):.2f} eV&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="Ir0eng549xoRc5AqDCvLv" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>
============================================================
Comparison with Literature:
============================================================
Table 4 (DFT): -0.60 eV (Ni(111), ref H₂)
This work:     -0.61-0.00j eV
Difference:    0.01 eV
</span></code></pre></div></div></div></div><aside class="myst-admonition myst-admonition-tip my-5 shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-gray-50/10 dark:bg-stone-800 overflow-hidden myst-admonition-default rounded border-l-4 border-green-600 tip"><div class="myst-admonition-header m-0 font-medium py-1 flex min-w-0 text-lg text-green-600 bg-green-50 dark:bg-slate-900"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="myst-admonition-header-icon inline-block pl-2 mr-2 self-center flex-none text-green-600"><path stroke-linecap="round" stroke-linejoin="round" d="m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"></path></svg><div class="myst-admonition-header-text text-neutral-900 dark:text-white grow self-center overflow-hidden break-words">D3 Dispersion Corrections</div></div><div class="myst-admonition-body px-4 py-1"><p>Dispersion (van der Waals) interactions are important for:</p><ul><li><p>Large molecules (CO, CO₂)</p></li><li><p>Physisorption</p></li><li><p>Metal-support interfaces</p></li></ul><p>For H adsorption, D3 corrections are typically small (&lt;0.1 eV) because H forms strong covalent bonds with the surface. However, always check the magnitude!</p></div></aside><h3 id="explore-on-your-own-2" class="relative group"><span class="heading-text">Explore on Your Own</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#explore-on-your-own-2" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><ol start="1"><li><p><strong>Site preference</strong>: Identify which site (fcc, hcp, bridge, top) the H prefers. Visualize with <code>view(atoms, viewer=&#x27;x3d&#x27;)</code>.</p></li><li><p><strong>Coverage effects</strong>: Place 2 H atoms on the slab. How does binding change with separation?</p></li><li><p><strong>Different facets</strong>: Compare H adsorption on (100) and (110) surfaces. Which is strongest?</p></li><li><p><strong>Subsurface H</strong>: Place H below the surface layer. Is it stable?</p></li><li><p><strong>ZPE uncertainty</strong>: How sensitive is E_ads to the vibrational delta parameter (try 0.01, 0.03 Å)?</p></li></ol><hr class="py-2 my-5 translate-y-2"/><h2 id="part-5-coverage-dependent-h-adsorption" class="relative group"><span class="heading-text">Part 5: Coverage-Dependent H Adsorption</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#part-5-coverage-dependent-h-adsorption" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><h3 id="introduction-4" class="relative group"><span class="heading-text">Introduction</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#introduction-4" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>At higher coverages, adsorbate-adsorbate interactions become significant. We’ll study how H binding energy changes from dilute (1 atom) to saturated (full monolayer) coverage.</p><h3 id="theory-4" class="relative group"><span class="heading-text">Theory</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#theory-4" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>The differential adsorption energy at coverage θ is:</p><div id="a77d2yyMS5" class="flex my-5 group"><div class="flex-grow overflow-x-auto overflow-y-hidden"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>E</mi><mtext>ads</mtext></msub><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><mi>E</mi><mo stretchy="false">(</mo><mi>n</mi><msup><mtext>H</mtext><mo>∗</mo></msup><mo stretchy="false">)</mo><mo>−</mo><mi>E</mi><mo stretchy="false">(</mo><mo>∗</mo><mo stretchy="false">)</mo><mo>−</mo><mi>n</mi><mo>⋅</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mi>E</mi><mo stretchy="false">(</mo><msub><mtext>H</mtext><mn>2</mn></msub><mo stretchy="false">)</mo></mrow><mi>n</mi></mfrac></mrow><annotation encoding="application/x-tex">E_{\text{ads}}(\theta) = \frac{E(n\text{H}^*) - E(*) - n \cdot \frac{1}{2}E(\text{H}_2)}{n}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">ads</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.2661em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5801em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">n</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.735em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mord"><span class="mord text"><span class="mord">H</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7619em;"><span style="top:-3.1362em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mopen">(</span><span class="mord">∗</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mopen">(</span><span class="mord"><span class="mord text"><span class="mord">H</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></div><div class="relative self-center flex-none pl-2 m-0 text-right select-none"><a class="no-underline text-inherit hover:text-inherit text-inherit hover:text-inherit select-none hover:underline" href="#a77d2yyMS5" title="Link to this Equation" aria-label="Link to this Equation">(<!-- -->5<!-- -->)</a></div></div><p>For many systems, this varies linearly:</p><div id="b6PR2eZJG6" class="flex my-5 group"><div class="flex-grow overflow-x-auto overflow-y-hidden"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>E</mi><mtext>ads</mtext></msub><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi>E</mi><mtext>ads</mtext></msub><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo><mo>+</mo><mi>β</mi><mi>θ</mi></mrow><annotation encoding="application/x-tex">E_{\text{ads}}(\theta) = E_{\text{ads}}(0) + \beta \theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">ads</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">ads</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">0</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">βθ</span></span></span></span></span></div><div class="relative self-center flex-none pl-2 m-0 text-right select-none"><a class="no-underline text-inherit hover:text-inherit text-inherit hover:text-inherit select-none hover:underline" href="#b6PR2eZJG6" title="Link to this Equation" aria-label="Link to this Equation">(<!-- -->6<!-- -->)</a></div></div><p>where β quantifies lateral interactions (repulsive if β &gt; 0).</p><h3 id="step-1-setup-slab-and-calculators" class="relative group"><span class="heading-text">Step 1: Setup Slab and Calculators</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#step-1-setup-slab-and-calculators" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Create a larger Ni(111) slab to accommodate multiple adsorbates:</p><div id="GYKcNMHcTs" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Create large Ni(111) slab
ni_bulk_atoms = bulk(&quot;Ni&quot;, &quot;fcc&quot;, a=a_opt, cubic=True)
ni_bulk_obj = Bulk(bulk_atoms=ni_bulk_atoms)
ni_slabs = Slab.from_bulk_get_specific_millers(
    bulk=ni_bulk_obj, specific_millers=(1, 1, 1)
)
slab = ni_slabs[0].atoms.copy()

print(f&quot;   Created {len(slab)} atom slab&quot;)

# Set up calculators
base_calc = FAIRChemCalculator(predictor, task_name=&quot;oc20&quot;)
d3_calc = TorchDFTD3Calculator(device=&quot;cpu&quot;, damping=&quot;bj&quot;)
print(&quot;   ✓ Calculators initialized&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="NX5MsDqmCRNEl_fZoyw8k" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>   Created 96 atom slab
   ✓ Calculators initialized
</span></code></pre></div></div></div></div><h3 id="step-2-calculate-reference-energies" class="relative group"><span class="heading-text">Step 2: Calculate Reference Energies</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#step-2-calculate-reference-energies" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Get reference energies for clean surface and H₂:</p><div id="lw1jpGEAUV" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">print(&quot;\n1. Relaxing clean slab...&quot;)
clean_slab = slab.copy()
clean_slab.pbc = True
clean_slab.calc = base_calc

opt = LBFGS(
    clean_slab,
    trajectory=str(output_dir / part_dirs[&quot;part5&quot;] / &quot;ni111_clean.traj&quot;),
    logfile=str(output_dir / part_dirs[&quot;part5&quot;] / &quot;ni111_clean.log&quot;),
)
opt.run(fmax=0.05, steps=relaxation_steps)

E_clean_ml = clean_slab.get_potential_energy()
clean_slab.calc = d3_calc
E_clean_d3 = clean_slab.get_potential_energy()
E_clean = E_clean_ml + E_clean_d3
print(f&quot;   E(clean): {E_clean:.2f} eV&quot;)

print(&quot;\n2. Calculating H₂ reference...&quot;)
h2 = Atoms(&quot;H2&quot;, positions=[[0, 0, 0], [0, 0, 0.74]])
h2.center(vacuum=10.0)
h2.set_pbc([True, True, True])
h2.calc = base_calc

opt = LBFGS(
    h2,
    trajectory=str(output_dir / part_dirs[&quot;part5&quot;] / &quot;h2.traj&quot;),
    logfile=str(output_dir / part_dirs[&quot;part5&quot;] / &quot;h2.log&quot;),
)
opt.run(fmax=0.05, steps=relaxation_steps)

E_h2_ml = h2.get_potential_energy()
h2.calc = d3_calc
E_h2_d3 = h2.get_potential_energy()
E_h2 = E_h2_ml + E_h2_d3
print(f&quot;   E(H₂): {E_h2:.2f} eV&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="79x1YZ8BcfXwZXxkeXcbn" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>
1. Relaxing clean slab...
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>   E(clean): -487.46 eV

2. Calculating H₂ reference...
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>   E(H₂): -6.97 eV
</span></code></pre></div></div></div></div><h3 id="step-3-set-up-coverage-study" class="relative group"><span class="heading-text">Step 3: Set Up Coverage Study</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#step-3-set-up-coverage-study" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Define the coverages we’ll test (from dilute to nearly 1 ML):</p><div id="RAYD98p9MT" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Count surface sites
tags = slab.get_tags()
n_sites = np.sum(tags == 1)
print(f&quot;\n3. Surface sites: {n_sites} (4×4 Ni(111))&quot;)

# Test coverages: 1 H, 0.25 ML, 0.5 ML, 0.75 ML, 1.0 ML
coverages_to_test = [1, 4, 8, 12, 16]
print(f&quot;\n   Will test coverages: {[f&#x27;{n/n_sites:.2f} ML&#x27; for n in coverages_to_test]}&quot;)
print(&quot;   This spans from dilute to nearly full monolayer&quot;)

coverages = []
adsorption_energies = []</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="zXP-DGrKuUZ4j04YtDWr3" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>
3. Surface sites: 16 (4×4 Ni(111))

   Will test coverages: [&#x27;0.06 ML&#x27;, &#x27;0.25 ML&#x27;, &#x27;0.50 ML&#x27;, &#x27;0.75 ML&#x27;, &#x27;1.00 ML&#x27;]
   This spans from dilute to nearly full monolayer
</span></code></pre></div></div></div></div><h3 id="step-4-generate-and-relax-configurations-at-each-coverage" class="relative group"><span class="heading-text">Step 4: Generate and Relax Configurations at Each Coverage</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#step-4-generate-and-relax-configurations-at-each-coverage" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>For each coverage, generate multiple configurations and find the lowest energy:</p><div id="sbznMghFAK" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">for n_h in coverages_to_test:
    print(f&quot;\n3. Coverage: {n_h} H ({n_h/n_sites:.2f} ML)&quot;)

    # Generate configurations
    ni_bulk_obj_h = Bulk(bulk_atoms=ni_bulk_atoms)
    ni_slabs_h = Slab.from_bulk_get_specific_millers(
        bulk=ni_bulk_obj_h, specific_millers=(1, 1, 1)
    )
    slab_for_ads = ni_slabs_h[0]
    slab_for_ads.atoms = clean_slab.copy()

    adsorbates_list = [Adsorbate(adsorbate_smiles_from_db=&quot;*H&quot;) for _ in range(n_h)]

    try:
        multi_ads_config = MultipleAdsorbateSlabConfig(
            slab_for_ads, adsorbates_list, num_configurations=num_sites
        )
    except ValueError as e:
        print(f&quot;   ⚠ Configuration generation failed: {e}&quot;)
        continue

    if len(multi_ads_config.atoms_list) == 0:
        print(f&quot;   ⚠ No configurations generated&quot;)
        continue

    print(f&quot;   Generated {len(multi_ads_config.atoms_list)} configurations&quot;)

    # Relax each and find best
    config_energies = []

    for idx, config in enumerate(multi_ads_config.atoms_list):
        config_relaxed = config.copy()
        config_relaxed.set_pbc([True, True, True])
        config_relaxed.calc = base_calc

        opt = LBFGS(config_relaxed, logfile=None)
        opt.run(fmax=0.05, steps=relaxation_steps)

        E_ml = config_relaxed.get_potential_energy()
        config_relaxed.calc = d3_calc
        E_d3 = config_relaxed.get_potential_energy()
        E_total = E_ml + E_d3

        config_energies.append(E_total)
        print(f&quot;     Config {idx+1}: {E_total:.2f} eV&quot;)

    best_idx = np.argmin(config_energies)
    best_energy = config_energies[best_idx]
    best_config = multi_ads_config.atoms_list[best_idx]
    E_ads_per_h = (best_energy - E_clean - n_h * 0.5 * E_h2) / n_h

    coverage = n_h / n_sites
    coverages.append(coverage)
    adsorption_energies.append(E_ads_per_h)

    print(f&quot;   → E_ads/H: {E_ads_per_h:.2f} eV&quot;)

    # Visualize best configuration at this coverage
    print(f&quot;   Visualizing configuration with {n_h} H atoms...&quot;)
    view(best_config, viewer=&#x27;x3d&#x27;)

print(f&quot;\n✓ Completed coverage study: {len(coverages)} data points&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="QnrP9Ss_DMx846Xmeq54x" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>
3. Coverage: 1 H (0.06 ML)
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>   Generated 2 configurations
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>     Config 1: -491.47 eV
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>     Config 2: -491.53 eV
   → E_ads/H: -0.58 eV
   Visualizing configuration with 1 H atoms...

3. Coverage: 4 H (0.25 ML)
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>   Generated 2 configurations
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>     Config 1: -502.65 eV
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>     Config 2: -503.39 eV
   → E_ads/H: -0.50 eV
   Visualizing configuration with 4 H atoms...

3. Coverage: 8 H (0.50 ML)
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>   Generated 2 configurations
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>     Config 1: -519.34 eV
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>     Config 2: -518.23 eV
   → E_ads/H: -0.50 eV
   Visualizing configuration with 8 H atoms...

3. Coverage: 12 H (0.75 ML)
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>   Generated 2 configurations
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>     Config 1: -532.43 eV
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>     Config 2: -533.04 eV
   → E_ads/H: -0.31 eV
   Visualizing configuration with 12 H atoms...

3. Coverage: 16 H (1.00 ML)
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>   Generated 2 configurations
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>     Config 1: -546.63 eV
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>     Config 2: -547.70 eV
   → E_ads/H: -0.28 eV
   Visualizing configuration with 16 H atoms...

✓ Completed coverage study: 5 data points
</span></code></pre></div></div></div></div><h3 id="step-5-perform-linear-fit" class="relative group"><span class="heading-text">Step 5: Perform Linear Fit</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#step-5-perform-linear-fit" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Fit E_ads vs coverage to extract the slope (lateral interaction strength):</p><div id="KMatEygH2M" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">print(&quot;\n4. Performing linear fit to coverage dependence...&quot;)

# Linear fit
from numpy.polynomial import Polynomial

p = Polynomial.fit(coverages, adsorption_energies, 1)
slope = p.coef[1]
intercept = p.coef[0]

print(f&quot;\n{&#x27;=&#x27;*60}&quot;)
print(f&quot;Linear Fit: E_ads = {intercept:.2f} + {slope:.2f}θ (eV)&quot;)
print(f&quot;Slope: {slope * 96.485:.1f} kJ/mol per ML&quot;)
print(f&quot;Paper: 8.7 kJ/mol per ML&quot;)
print(f&quot;{&#x27;=&#x27;*60}&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="lTJkoJQ9eAwYXNsIVFUbi" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>
4. Performing linear fit to coverage dependence...

============================================================
Linear Fit: E_ads = -0.43 + 0.16θ (eV)
Slope: 15.2 kJ/mol per ML
Paper: 8.7 kJ/mol per ML
============================================================
</span></code></pre></div></div></div></div><h3 id="step-6-visualize-coverage-dependence" class="relative group"><span class="heading-text">Step 6: Visualize Coverage Dependence</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#step-6-visualize-coverage-dependence" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Create a plot showing how adsorption energy changes with coverage:</p><div id="M7TUwaJzXt" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">print(&quot;\n5. Plotting coverage dependence...&quot;)

# Plot
fig, ax = plt.subplots(figsize=(8, 6))
ax.scatter(
    coverages,
    adsorption_energies,
    s=100,
    marker=&quot;o&quot;,
    label=&quot;Calculated&quot;,
    zorder=3,
    color=&quot;steelblue&quot;,
)

cov_fit = np.linspace(0, max(coverages), 100)
ads_fit = p(cov_fit)
ax.plot(
    cov_fit, ads_fit, &quot;r--&quot;, label=f&quot;Fit: {intercept:.2f} + {slope:.2f}θ&quot;, linewidth=2
)

ax.set_xlabel(&quot;H Coverage (ML)&quot;, fontsize=12)
ax.set_ylabel(&quot;Adsorption Energy (eV/H)&quot;, fontsize=12)
ax.set_title(&quot;Coverage-Dependent H Adsorption on Ni(111)&quot;, fontsize=14)
ax.legend(fontsize=11)
ax.grid(True, alpha=0.3)
plt.tight_layout()
plt.savefig(str(output_dir / part_dirs[&quot;part5&quot;] / &quot;coverage_dependence.png&quot;), dpi=300)
plt.show()

print(&quot;\n✓ Coverage dependence analysis complete!&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="67P3P0kx8_lECA-wArxOT" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>
5. Plotting coverage dependence...
</span></code></pre></div></div><div data-name="safe-output-image"><img src="/build/f0d4e3288431ea0b1ec4b7b13832ea97.png" alt="&lt;Figure size 800x600 with 1 Axes&gt;"/></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>
✓ Coverage dependence analysis complete!
</span></code></pre></div></div></div></div><aside class="myst-admonition myst-admonition-tip my-5 shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-gray-50/10 dark:bg-stone-800 overflow-hidden myst-admonition-default rounded border-l-4 border-green-600 dropdown, tip"><div class="myst-admonition-header m-0 font-medium py-1 flex min-w-0 text-lg text-green-600 bg-green-50 dark:bg-slate-900"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="myst-admonition-header-icon inline-block pl-2 mr-2 self-center flex-none text-green-600"><path stroke-linecap="round" stroke-linejoin="round" d="m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"></path></svg><div class="myst-admonition-header-text text-neutral-900 dark:text-white grow self-center overflow-hidden break-words">Missing UMA access?</div></div><div class="myst-admonition-body px-4 py-1"><p>Don’t have access to UMA yet? You can still explore this calculation!</p><p><a class="link" href="/example_configs/4h_on_ni111.xyz">Download example multiple H on Ni(111) structure</a> and test it in the <a target="_blank" rel="noreferrer" href="https://facebook-fairchem-uma-demo.hf.space/" class="link whitespace-nowrap"><span class="link-text whitespace-normal">UMA demo (no login required)</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="link-icon"><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"></path></svg></a> to see how the model handles coverage-dependent binding.</p></div></aside><aside class="myst-admonition myst-admonition-note my-5 shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-gray-50/10 dark:bg-stone-800 overflow-hidden myst-admonition-default rounded border-l-4 border-blue-500 note"><div class="myst-admonition-header m-0 font-medium py-1 flex min-w-0 text-lg text-blue-600 bg-blue-50 dark:bg-slate-900"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="myst-admonition-header-icon inline-block pl-2 mr-2 self-center flex-none text-blue-600"><path stroke-linecap="round" stroke-linejoin="round" d="m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"></path></svg><div class="myst-admonition-header-text text-neutral-900 dark:text-white grow self-center overflow-hidden break-words">Comparison with Paper</div></div><div class="myst-admonition-body px-4 py-1"><p><strong>Expected Results from Paper:</strong></p><ul><li><p><strong>Slope</strong>: 8.7 kJ/mol per ML (indicating repulsive lateral H-H interactions)</p></li><li><p><strong>Physical interpretation</strong>: H atoms repel weakly due to electrostatic and Pauli effects</p></li></ul><p><strong>What to Check:</strong></p><ul><li><p>Your fitted slope should be close to 8.7 kJ/mol per ML</p></li><li><p>The relationship should be approximately linear for θ &lt; 1 ML</p></li><li><p>Intercept (E_ads at θ → 0) should match the single-H result from Part 4 (~-0.60 eV)</p></li></ul><p><strong>Typical Variations:</strong></p><ul><li><p>Slope can vary by ±2-3 kJ/mol depending on slab size and configuration sampling</p></li><li><p>Non-linearity may appear at very high coverage (θ &gt; 0.75 ML)</p></li><li><p>Model differences can affect lateral interactions more than adsorption energies</p></li></ul></div></aside><aside class="myst-admonition myst-admonition-note my-5 shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-gray-50/10 dark:bg-stone-800 overflow-hidden myst-admonition-default rounded border-l-4 border-blue-500 note"><div class="myst-admonition-header m-0 font-medium py-1 flex min-w-0 text-lg text-blue-600 bg-blue-50 dark:bg-slate-900"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="myst-admonition-header-icon inline-block pl-2 mr-2 self-center flex-none text-blue-600"><path stroke-linecap="round" stroke-linejoin="round" d="m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"></path></svg><div class="myst-admonition-header-text text-neutral-900 dark:text-white grow self-center overflow-hidden break-words">Physical Insights</div></div><div class="myst-admonition-body px-4 py-1"><p><strong>Positive slope</strong> (repulsive interactions):</p><ul><li><p>Electrostatic: H atoms accumulate negative charge from Ni</p></li><li><p>Pauli repulsion: Overlapping electron clouds</p></li><li><p>Strain: Lattice distortions propagate</p></li></ul><p><strong>Magnitude</strong>:</p><ul><li><p>Weak (~10 kJ/mol/ML) → isolated adsorbates</p></li><li><p>Strong (&gt;50 kJ/mol/ML) → clustering or phase separation likely</p></li></ul><p>The paper reports 8.7 kJ/mol/ML, indicating relatively weak lateral interactions for H on Ni(111).</p></div></aside><h3 id="explore-on-your-own-3" class="relative group"><span class="heading-text">Explore on Your Own</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#explore-on-your-own-3" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><ol start="1"><li><p><strong>Non-linear behavior</strong>: Use polynomial (degree 2) fit. Is there curvature at high coverage?</p></li><li><p><strong>Temperature effects</strong>: Estimate configurational entropy at each coverage. How does this affect free energy?</p></li><li><p><strong>Pattern formation</strong>: Visualize the lowest-energy configuration at 0.5 ML. Are H atoms ordered?</p></li><li><p><strong>Other adsorbates</strong>: Repeat for O or N. How do lateral interactions compare?</p></li><li><p><strong>Phase diagrams</strong>: At what coverage do you expect phase separation (islands vs uniform)?</p></li></ol><hr class="py-2 my-5 translate-y-2"/><h2 id="part-6-co-formation-dissociation-thermochemistry-and-barrier" class="relative group"><span class="heading-text">Part 6: CO Formation/Dissociation Thermochemistry and Barrier</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#part-6-co-formation-dissociation-thermochemistry-and-barrier" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><h3 id="introduction-5" class="relative group"><span class="heading-text">Introduction</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#introduction-5" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>CO dissociation (CO* → C* + O*) is the rate-limiting step in many catalytic processes (Fischer-Tropsch, CO oxidation, etc.). We’ll calculate the reaction energy for C* + O* → CO* and the activation barriers in both directions using the nudged elastic band (NEB) method.</p><h3 id="theory-5" class="relative group"><span class="heading-text">Theory</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#theory-5" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><ul><li><p><strong>Forward Reaction</strong>: C* + O* → CO* + * (recombination)</p></li><li><p><strong>Reverse Reaction</strong>: CO* + <em>→ C</em> + O* (dissociation)</p></li><li><p><strong>Thermochemistry</strong>: <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Δ</mi><msub><mi>E</mi><mtext>rxn</mtext></msub><mo>=</mo><mi>E</mi><mo stretchy="false">(</mo><msup><mtext>C</mtext><mo>∗</mo></msup><mo>+</mo><msup><mtext>O</mtext><mo>∗</mo></msup><mo stretchy="false">)</mo><mo>−</mo><mi>E</mi><mo stretchy="false">(</mo><msup><mtext>CO</mtext><mo>∗</mo></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\Delta E_{\text{rxn}} = E(\text{C}^* + \text{O}^*) - E(\text{CO}^*)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord">Δ</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">rxn</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0119em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mopen">(</span><span class="mord"><span class="mord text"><span class="mord">C</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7619em;"><span style="top:-3.1362em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0119em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord text"><span class="mord">O</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7619em;"><span style="top:-3.1362em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0119em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mopen">(</span><span class="mord"><span class="mord text"><span class="mord">CO</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7619em;"><span style="top:-3.1362em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p></li><li><p><strong>Barrier</strong>: NEB finds the minimum energy path (MEP) and transition state: <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>E</mi><mi>a</mi></msub><mo>=</mo><msup><mi>E</mi><mo lspace="0em" rspace="0em">‡</mo></msup><mo>−</mo><msub><mi>E</mi><mtext>initial</mtext></msub></mrow><annotation encoding="application/x-tex">E_a = E^{\ddagger} - E_{\text{initial}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">a</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9324em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">‡</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">initial</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p></li></ul><h3 id="step-1-setup-slab-and-calculators-1" class="relative group"><span class="heading-text">Step 1: Setup Slab and Calculators</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#step-1-setup-slab-and-calculators-1" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Initialize the Ni(111) surface and calculators:</p><div id="xqnhC9WSg7" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Create slab
ni_bulk_atoms = bulk(&quot;Ni&quot;, &quot;fcc&quot;, a=a_opt, cubic=True)
ni_bulk_obj = Bulk(bulk_atoms=ni_bulk_atoms)
ni_slabs = Slab.from_bulk_get_specific_millers(
    bulk=ni_bulk_obj, specific_millers=(1, 1, 1)
)
slab = ni_slabs[0].atoms

print(f&quot;   Created {len(slab)} atom slab&quot;)

base_calc = FAIRChemCalculator(predictor, task_name=&quot;oc20&quot;)
d3_calc = TorchDFTD3Calculator(device=&quot;cpu&quot;, damping=&quot;bj&quot;)
print(&quot;   \u2713 Calculators initialized&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="L02XW2fw3h2cdDVDiOnyJ" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>   Created 96 atom slab
   ✓ Calculators initialized
</span></code></pre></div></div></div></div><h3 id="step-2-generate-and-relax-final-state-co" class="relative group"><span class="heading-text">Step 2: Generate and Relax Final State (CO*)</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#step-2-generate-and-relax-final-state-co" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Find the most stable CO adsorption configuration (this is the product of C+O recombination):</p><div id="MVICjBMRLf" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">print(&quot;\n1. Final State: CO* on Ni(111)&quot;)
print(&quot;   Generating CO adsorption configurations...&quot;)

ni_bulk_obj_co = Bulk(bulk_atoms=ni_bulk_atoms)
ni_slab_co = Slab.from_bulk_get_specific_millers(
    bulk=ni_bulk_obj_co, specific_millers=(1, 1, 1)
)[0]
ni_slab_co.atoms = slab.copy()

adsorbate_co = Adsorbate(adsorbate_smiles_from_db=&quot;*CO&quot;)
multi_ads_config_co = MultipleAdsorbateSlabConfig(
    ni_slab_co, [adsorbate_co], num_configurations=num_sites
)

print(f&quot;   Generated {len(multi_ads_config_co.atoms_list)} configurations&quot;)

# Relax and find best
co_energies = []
co_energies_ml = []
co_energies_d3 = []
co_configs = []

for idx, config in enumerate(multi_ads_config_co.atoms_list):
    config_relaxed = config.copy()
    config_relaxed.set_pbc([True, True, True])
    config_relaxed.calc = base_calc
    opt = LBFGS(config_relaxed, logfile=None)
    opt.run(fmax=0.05, steps=relaxation_steps)

    E_ml = config_relaxed.get_potential_energy()
    config_relaxed.calc = d3_calc
    E_d3 = config_relaxed.get_potential_energy()
    E_total = E_ml + E_d3

    co_energies.append(E_total)
    co_energies_ml.append(E_ml)
    co_energies_d3.append(E_d3)
    co_configs.append(config_relaxed)
    print(
        f&quot;     Config {idx+1}: E_total = {E_total:.2f} eV (RPBE: {E_ml:.2f}, D3: {E_d3:.2f})&quot;
    )

best_co_idx = np.argmin(co_energies)
final_co = co_configs[best_co_idx]
E_final_co = co_energies[best_co_idx]
E_final_co_ml = co_energies_ml[best_co_idx]
E_final_co_d3 = co_energies_d3[best_co_idx]

print(f&quot;\n   → Best CO* (Config {best_co_idx+1}):&quot;)
print(f&quot;      RPBE:  {E_final_co_ml:.2f} eV&quot;)
print(f&quot;      D3:    {E_final_co_d3:.2f} eV&quot;)
print(f&quot;      Total: {E_final_co:.2f} eV&quot;)

# Save best CO state
ase.io.write(str(output_dir / part_dirs[&quot;part6&quot;] / &quot;co_final_best.traj&quot;), final_co)
print(&quot;   ✓ Best CO* structure saved&quot;)

# Visualize best CO* structure
print(&quot;\n   Visualizing best CO* structure...&quot;)
view(final_co, viewer=&#x27;x3d&#x27;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="rTJlqKLkLuhCj3JMuMktL" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>
1. Final State: CO* on Ni(111)
   Generating CO adsorption configurations...
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>   Generated 2 configurations
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>     Config 1: E_total = -503.58 eV (RPBE: -466.73, D3: -36.85)
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>     Config 2: E_total = -503.78 eV (RPBE: -466.90, D3: -36.88)

   → Best CO* (Config 2):
      RPBE:  -466.90 eV
      D3:    -36.88 eV
      Total: -503.78 eV
   ✓ Best CO* structure saved

   Visualizing best CO* structure...
</span></code></pre></div></div><div><div class="p-2.5">Loading...</div></div></div></div><h3 id="step-3-generate-and-relax-initial-state-c-o" class="relative group"><span class="heading-text">Step 3: Generate and Relax Initial State (C* + O*)</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#step-3-generate-and-relax-initial-state-c-o" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Find the most stable configuration for dissociated C and O (reactants):</p><div id="QBQLOHc0T5" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">print(&quot;\n2. Initial State: C* + O* on Ni(111)&quot;)
print(&quot;   Generating C+O configurations...&quot;)

ni_bulk_obj_c_o = Bulk(bulk_atoms=ni_bulk_atoms)
ni_slab_c_o = Slab.from_bulk_get_specific_millers(
    bulk=ni_bulk_obj_c_o, specific_millers=(1, 1, 1)
)[0]

adsorbate_c = Adsorbate(adsorbate_smiles_from_db=&quot;*C&quot;)
adsorbate_o = Adsorbate(adsorbate_smiles_from_db=&quot;*O&quot;)

multi_ads_config_c_o = MultipleAdsorbateSlabConfig(
    ni_slab_c_o, [adsorbate_c, adsorbate_o], num_configurations=num_sites
)

print(f&quot;   Generated {len(multi_ads_config_c_o.atoms_list)} configurations&quot;)

c_o_energies = []
c_o_energies_ml = []
c_o_energies_d3 = []
c_o_configs = []

for idx, config in enumerate(multi_ads_config_c_o.atoms_list):
    config_relaxed = config.copy()
    config_relaxed.set_pbc([True, True, True])
    config_relaxed.calc = base_calc
    opt = LBFGS(config_relaxed, logfile=None)
    opt.run(fmax=0.05, steps=relaxation_steps)

    # Check C-O bond distance to ensure they haven&#x27;t formed CO molecule
    c_o_dist = config_relaxed[config_relaxed.get_tags() == 2].get_distance(
        0, 1, mic=True
    )

    # CO bond length is ~1.15 Å, so if distance &lt; 1.5 Å, they&#x27;ve formed a molecule
    if c_o_dist &lt; 1.5:
        print(
            f&quot;     Config {idx+1}: ⚠ REJECTED - C and O formed CO molecule (d = {c_o_dist:.2f} Å)&quot;
        )
        continue

    E_ml = config_relaxed.get_potential_energy()
    config_relaxed.calc = d3_calc
    E_d3 = config_relaxed.get_potential_energy()
    E_total = E_ml + E_d3

    c_o_energies.append(E_total)
    c_o_energies_ml.append(E_ml)
    c_o_energies_d3.append(E_d3)
    c_o_configs.append(config_relaxed)
    print(
        f&quot;     Config {idx+1}: E_total = {E_total:.2f} eV (RPBE: {E_ml:.2f}, D3: {E_d3:.2f}, C-O dist: {c_o_dist:.2f} Å)&quot;
    )

best_c_o_idx = np.argmin(c_o_energies)
initial_c_o = c_o_configs[best_c_o_idx]
E_initial_c_o = c_o_energies[best_c_o_idx]
E_initial_c_o_ml = c_o_energies_ml[best_c_o_idx]
E_initial_c_o_d3 = c_o_energies_d3[best_c_o_idx]

print(f&quot;\n   → Best C*+O* (Config {best_c_o_idx+1}):&quot;)
print(f&quot;      RPBE:  {E_initial_c_o_ml:.2f} eV&quot;)
print(f&quot;      D3:    {E_initial_c_o_d3:.2f} eV&quot;)
print(f&quot;      Total: {E_initial_c_o:.2f} eV&quot;)

# Save best C+O state
ase.io.write(str(output_dir / part_dirs[&quot;part6&quot;] / &quot;co_initial_best.traj&quot;), initial_c_o)
print(&quot;   ✓ Best C*+O* structure saved&quot;)

# Visualize best C*+O* structure
print(&quot;\n   Visualizing best C*+O* structure...&quot;)
view(initial_c_o, viewer=&#x27;x3d&#x27;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="Q_6jRoMWvL4vz6fpe_GQb" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>
2. Initial State: C* + O* on Ni(111)
   Generating C+O configurations...
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>   Generated 2 configurations
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>     Config 1: E_total = -502.66 eV (RPBE: -465.77, D3: -36.89, C-O dist: 3.28 Å)
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>     Config 2: E_total = -500.64 eV (RPBE: -463.69, D3: -36.96, C-O dist: 3.53 Å)

   → Best C*+O* (Config 1):
      RPBE:  -465.77 eV
      D3:    -36.89 eV
      Total: -502.66 eV
   ✓ Best C*+O* structure saved

   Visualizing best C*+O* structure...
</span></code></pre></div></div><div><div class="p-2.5">Loading...</div></div></div></div><h3 id="step-3b-calculate-c-and-o-energies-separately" class="relative group"><span class="heading-text">Step 3b: Calculate C* and O* Energies Separately</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#step-3b-calculate-c-and-o-energies-separately" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Another strategy to calculate the initial energies for *C and *O at very low coverage (without interactions between the two reactants) is to do two separate relaxations.</p><div id="JisNxVeXu3" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Clean slab
ni_bulk_obj = Bulk(bulk_atoms=ni_bulk_atoms)
clean_slab = Slab.from_bulk_get_specific_millers(
    bulk=ni_bulk_obj_c_o, specific_millers=(1, 1, 1)
)[0].atoms
clean_slab.set_pbc([True, True, True])
clean_slab.calc = base_calc
opt = LBFGS(clean_slab, logfile=None)
opt.run(fmax=0.05, steps=relaxation_steps)

E_clean_ml = clean_slab.get_potential_energy()
clean_slab.calc = d3_calc
E_clean_d3 = clean_slab.get_potential_energy()
E_clean = E_clean_ml + E_clean_d3

print(
    f&quot;\n   Clean slab: E_total = {E_clean:.2f} eV (RPBE: {E_clean_ml:.2f}, D3: {E_clean_d3:.2f})&quot;
)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="HjtYb9fULXo0pP3guZqzw" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>
   Clean slab: E_total = -487.46 eV (RPBE: -450.89, D3: -36.57)
</span></code></pre></div></div></div></div><div id="tAM679LI12" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">print(f&quot;\n2b. Separate C* and O* Energies:&quot;)
print(&quot;    Calculating energies in separate unit cells to avoid interactions&quot;)

ni_bulk_obj_c_o = Bulk(bulk_atoms=ni_bulk_atoms)
ni_slab_c_o = Slab.from_bulk_get_specific_millers(
    bulk=ni_bulk_obj_c_o, specific_millers=(1, 1, 1)
)[0]

print(&quot;\n   Generating C* configurations...&quot;)
multi_ads_config_c = MultipleAdsorbateSlabConfig(
    ni_slab_c_o,
    adsorbates=[Adsorbate(adsorbate_smiles_from_db=&quot;*C&quot;)],
    num_configurations=num_sites,
)

c_energies = []
c_energies_ml = []
c_energies_d3 = []
c_configs = []

for idx, config in enumerate(multi_ads_config_c.atoms_list):
    config_relaxed = config.copy()
    config_relaxed.set_pbc([True, True, True])
    config_relaxed.calc = base_calc
    opt = LBFGS(config_relaxed, logfile=None)
    opt.run(fmax=0.05, steps=relaxation_steps)

    E_ml = config_relaxed.get_potential_energy()
    config_relaxed.calc = d3_calc
    E_d3 = config_relaxed.get_potential_energy()
    E_total = E_ml + E_d3

    c_energies.append(E_total)
    c_energies_ml.append(E_ml)
    c_energies_d3.append(E_d3)
    c_configs.append(config_relaxed)
    print(
        f&quot;     Config {idx+1}: E_total = {E_total:.2f} eV (RPBE: {E_ml:.2f}, D3: {E_d3:.2f})&quot;
    )

best_c_idx = np.argmin(c_energies)
c_ads = c_configs[best_c_idx]
E_c = c_energies[best_c_idx]
E_c_ml = c_energies_ml[best_c_idx]
E_c_d3 = c_energies_d3[best_c_idx]

print(f&quot;\n   → Best C* (Config {best_c_idx+1}):&quot;)
print(f&quot;      RPBE:  {E_c_ml:.2f} eV&quot;)
print(f&quot;      D3:    {E_c_d3:.2f} eV&quot;)
print(f&quot;      Total: {E_c:.2f} eV&quot;)

# Save best C state
ase.io.write(str(output_dir / part_dirs[&quot;part6&quot;] / &quot;c_best.traj&quot;), c_ads)

# Visualize best C* structure
print(&quot;\n   Visualizing best C* structure...&quot;)
view(c_ads, viewer=&#x27;x3d&#x27;)

# Generate O* configuration
print(&quot;\n   Generating O* configurations...&quot;)
multi_ads_config_o = MultipleAdsorbateSlabConfig(
    ni_slab_c_o,
    adsorbates=[Adsorbate(adsorbate_smiles_from_db=&quot;*O&quot;)],
    num_configurations=num_sites,
)
o_energies = []
o_energies_ml = []
o_energies_d3 = []
o_configs = []

for idx, config in enumerate(multi_ads_config_o.atoms_list):
    config_relaxed = config.copy()
    config_relaxed.set_pbc([True, True, True])
    config_relaxed.calc = base_calc
    opt = LBFGS(config_relaxed, logfile=None)
    opt.run(fmax=0.05, steps=relaxation_steps)

    E_ml = config_relaxed.get_potential_energy()
    config_relaxed.calc = d3_calc
    E_d3 = config_relaxed.get_potential_energy()
    E_total = E_ml + E_d3

    o_energies.append(E_total)
    o_energies_ml.append(E_ml)
    o_energies_d3.append(E_d3)
    o_configs.append(config_relaxed)
    print(
        f&quot;     Config {idx+1}: E_total = {E_total:.2f} eV (RPBE: {E_ml:.2f}, D3: {E_d3:.2f})&quot;
    )

best_o_idx = np.argmin(o_energies)
o_ads = o_configs[best_o_idx]
E_o = o_energies[best_o_idx]
E_o_ml = o_energies_ml[best_o_idx]
E_o_d3 = o_energies_d3[best_o_idx]

print(f&quot;\n   → Best O* (Config {best_o_idx+1}):&quot;)
print(f&quot;      RPBE:  {E_o_ml:.2f} eV&quot;)
print(f&quot;      D3:    {E_o_d3:.2f} eV&quot;)
print(f&quot;      Total: {E_o:.2f} eV&quot;)

# Save best O state
ase.io.write(str(output_dir / part_dirs[&quot;part6&quot;] / &quot;o_best.traj&quot;), o_ads)

# Visualize best O* structure
print(&quot;\n   Visualizing best O* structure...&quot;)
view(o_ads, viewer=&#x27;x3d&#x27;)

# Calculate combined energy for separate C* and O*
E_initial_c_o_separate = E_c + E_o
E_initial_c_o_separate_ml = E_c_ml + E_o_ml
E_initial_c_o_separate_d3 = E_c_d3 + E_o_d3</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="GYVukmLkrynOhlkwSM6VB" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>
2b. Separate C* and O* Energies:
    Calculating energies in separate unit cells to avoid interactions
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>
   Generating C* configurations...
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>     Config 1: E_total = -493.02 eV (RPBE: -456.21, D3: -36.81)
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>     Config 2: E_total = -495.67 eV (RPBE: -458.89, D3: -36.78)

   → Best C* (Config 2):
      RPBE:  -458.89 eV
      D3:    -36.78 eV
      Total: -495.67 eV

   Visualizing best C* structure...

   Generating O* configurations...
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>     Config 1: E_total = -494.66 eV (RPBE: -457.97, D3: -36.69)
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>     Config 2: E_total = -494.46 eV (RPBE: -457.77, D3: -36.69)

   → Best O* (Config 1):
      RPBE:  -457.97 eV
      D3:    -36.69 eV
      Total: -494.66 eV

   Visualizing best O* structure...
</span></code></pre></div></div></div></div><div id="nEPCrK9UJX" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">print(f&quot;\n   Combined C* + O* (separate calculations):&quot;)
print(f&quot;      RPBE:  {E_initial_c_o_separate_ml:.2f} eV&quot;)
print(f&quot;      D3:    {E_initial_c_o_separate_d3:.2f} eV&quot;)
print(f&quot;      Total: {E_initial_c_o_separate:.2f} eV&quot;)

print(f&quot;\n   Comparison:&quot;)
print(f&quot;      C*+O* (same cell):  {E_initial_c_o - E_clean:.2f} eV&quot;)
print(f&quot;      C* + O* (separate): {E_initial_c_o_separate - 2*E_clean:.2f} eV&quot;)
print(
    f&quot;      Difference:         {(E_initial_c_o - E_clean) - (E_initial_c_o_separate - 2*E_clean):.2f} eV&quot;
)
print(&quot;   ✓ Separate C* and O* energies calculated&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="ILyrfRHgCLS9r5crXKY-o" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>
   Combined C* + O* (separate calculations):
      RPBE:  -916.86 eV
      D3:    -73.46 eV
      Total: -990.32 eV

   Comparison:
      C*+O* (same cell):  -15.20 eV
      C* + O* (separate): -15.40 eV
      Difference:         0.20 eV
   ✓ Separate C* and O* energies calculated
</span></code></pre></div></div></div></div><h3 id="step-4-calculate-reaction-energy-with-zpe" class="relative group"><span class="heading-text">Step 4: Calculate Reaction Energy with ZPE</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#step-4-calculate-reaction-energy-with-zpe" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Compute the thermochemistry for C* + O* → CO* with ZPE corrections:</p><div id="aSKq3CmQlz" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">print(f&quot;\n3. Reaction Energy (C* + O* → CO*):&quot;)
print(f&quot;   &quot; + &quot;=&quot; * 60)

# Electronic energies
print(f&quot;\n   Electronic Energies:&quot;)
print(
    f&quot;   Initial (C*+O*): RPBE = {E_initial_c_o_ml:.2f} eV, D3 = {E_initial_c_o_d3:.2f} eV, Total = {E_initial_c_o:.2f} eV&quot;
)
print(
    f&quot;   Final (CO*):     RPBE = {E_final_co_ml:.2f} eV, D3 = {E_final_co_d3:.2f} eV, Total = {E_final_co:.2f} eV&quot;
)

# Reaction energies without ZPE
delta_E_rpbe = E_final_co_ml - E_initial_c_o_ml
delta_E_d3_contrib = E_final_co_d3 - E_initial_c_o_d3
delta_E_elec = E_final_co - E_initial_c_o

print(f&quot;\n   Reaction Energies (without ZPE):&quot;)
print(f&quot;   ΔE(RPBE only):     {delta_E_rpbe:.2f} eV = {delta_E_rpbe*96.485:.1f} kJ/mol&quot;)
print(
    f&quot;   ΔE(D3 contrib):    {delta_E_d3_contrib:.2f} eV = {delta_E_d3_contrib*96.485:.1f} kJ/mol&quot;
)
print(f&quot;   ΔE(RPBE+D3):       {delta_E_elec:.2f} eV = {delta_E_elec*96.485:.1f} kJ/mol&quot;)

# Calculate ZPE for CO* (final state)
print(f&quot;\n   Computing ZPE for CO*...&quot;)
final_co.calc = base_calc

co_indices = np.where(final_co.get_tags() == 2)[0]
vib_co = Vibrations(final_co, indices=co_indices, delta=0.02, name=&quot;vib_co&quot;)
vib_co.run()
vib_energies_co = vib_co.get_energies()
zpe_co = np.sum(vib_energies_co[vib_energies_co &gt; 0]) / 2.0
vib_co.clean()
print(f&quot;   ZPE(CO*): {zpe_co:.2f} eV ({zpe_co*1000:.1f} meV)&quot;)


# Calculate ZPE for C* and O* (initial state)
print(f&quot;\n   Computing ZPE for C* and O*...&quot;)
initial_c_o.calc = base_calc
c_o_indices = np.where(initial_c_o.get_tags() == 2)[0]
vib_c_o = Vibrations(initial_c_o, indices=c_o_indices, delta=0.02, name=&quot;vib_c_o&quot;)
vib_c_o.run()
vib_energies_c_o = vib_c_o.get_energies()
zpe_c_o = np.sum(vib_energies_c_o[vib_energies_c_o &gt; 0]) / 2.0
vib_c_o.clean()
print(f&quot;   ZPE(C*+O*): {zpe_c_o:.2f} eV ({zpe_c_o*1000:.1f} meV)&quot;)


# Total reaction energy with ZPE
delta_zpe = zpe_co - zpe_c_o
delta_E_zpe = delta_E_elec + delta_zpe

print(f&quot;\n   Reaction Energy (with ZPE):&quot;)
print(f&quot;   ΔE(electronic):    {delta_E_elec:.2f} eV = {delta_E_elec*96.485:.1f} kJ/mol&quot;)
print(
    f&quot;   ΔZPE:              {delta_zpe:.2f} eV = {delta_zpe*96.485:.1f} kJ/mol ({delta_zpe*1000:.1f} meV)&quot;
)
print(f&quot;   ΔE(total):         {delta_E_zpe:.2f} eV = {delta_E_zpe*96.485:.1f} kJ/mol&quot;)

print(f&quot;\n   Summary:&quot;)
print(
    f&quot;   Without D3, without ZPE: {delta_E_rpbe:.2f} eV = {delta_E_rpbe*96.485:.1f} kJ/mol&quot;
)
print(
    f&quot;   With D3, without ZPE:    {delta_E_elec:.2f} eV = {delta_E_elec*96.485:.1f} kJ/mol&quot;
)
print(
    f&quot;   With D3, with ZPE:       {delta_E_zpe:.2f} eV = {delta_E_zpe*96.485:.1f} kJ/mol&quot;
)

print(f&quot;\n   &quot; + &quot;=&quot; * 60)
print(f&quot;\n   Comparison with Paper (Table 5):&quot;)
print(f&quot;   Paper (DFT-D3): -142.7 kJ/mol = -1.48 eV&quot;)
print(f&quot;   This work:      {delta_E_zpe*96.485:.1f} kJ/mol = {delta_E_zpe:.2f} eV&quot;)
print(f&quot;   Difference:     {abs(delta_E_zpe - (-1.48)):.2f} eV&quot;)

if delta_E_zpe &lt; 0:
    print(f&quot;\n   ✓ Reaction is exothermic (C+O recombination favorable)&quot;)
else:
    print(f&quot;\n   ⚠ Reaction is endothermic (dissociation favorable)&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="WAgFle1iQA1MTTlwspRN5" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>
3. Reaction Energy (C* + O* → CO*):
   ============================================================

   Electronic Energies:
   Initial (C*+O*): RPBE = -465.77 eV, D3 = -36.89 eV, Total = -502.66 eV
   Final (CO*):     RPBE = -466.90 eV, D3 = -36.88 eV, Total = -503.78 eV

   Reaction Energies (without ZPE):
   ΔE(RPBE only):     -1.13 eV = -108.6 kJ/mol
   ΔE(D3 contrib):    0.01 eV = 0.7 kJ/mol
   ΔE(RPBE+D3):       -1.12 eV = -107.9 kJ/mol

   Computing ZPE for CO*...
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>   ZPE(CO*): 0.18+0.01j eV (183.5+5.1j meV)

   Computing ZPE for C* and O*...
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>   ZPE(C*+O*): 0.18+0.00j eV (177.8+0.0j meV)

   Reaction Energy (with ZPE):
   ΔE(electronic):    -1.12 eV = -107.9 kJ/mol
   ΔZPE:              0.01+0.01j eV = 0.5+0.5j kJ/mol (5.7+5.1j meV)
   ΔE(total):         -1.11+0.01j eV = -107.4+0.5j kJ/mol

   Summary:
   Without D3, without ZPE: -1.13 eV = -108.6 kJ/mol
   With D3, without ZPE:    -1.12 eV = -107.9 kJ/mol
   With D3, with ZPE:       -1.11+0.01j eV = -107.4+0.5j kJ/mol

   ============================================================

   Comparison with Paper (Table 5):
   Paper (DFT-D3): -142.7 kJ/mol = -1.48 eV
   This work:      -107.4+0.5j kJ/mol = -1.11+0.01j eV
   Difference:     0.37 eV

   ✓ Reaction is exothermic (C+O recombination favorable)
</span></code></pre></div></div></div></div><h3 id="step-5-calculate-co-adsorption-energy-bonus" class="relative group"><span class="heading-text">Step 5: Calculate CO Adsorption Energy (Bonus)</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#step-5-calculate-co-adsorption-energy-bonus" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Calculate how strongly CO binds to the surface:</p><div id="o8vwWxvCUc" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">print(f&quot;\n4. CO Adsorption Energy ( CO(g) + * → CO*):&quot;)
print(&quot;   This helps us understand CO binding strength&quot;)

# CO(g)
co_gas = Atoms(&quot;CO&quot;, positions=[[0, 0, 0], [0, 0, 1.15]])
co_gas.center(vacuum=10.0)
co_gas.set_pbc([True, True, True])
co_gas.calc = base_calc
opt = LBFGS(co_gas, logfile=None)
opt.run(fmax=0.05, steps=relaxation_steps)

E_co_gas_ml = co_gas.get_potential_energy()
co_gas.calc = d3_calc
E_co_gas_d3 = co_gas.get_potential_energy()
E_co_gas = E_co_gas_ml + E_co_gas_d3

print(
    f&quot;   CO(g):       E_total = {E_co_gas:.2f} eV (RPBE: {E_co_gas_ml:.2f}, D3: {E_co_gas_d3:.2f})&quot;
)

# Calculate ZPE for CO(g)
co_gas.calc = base_calc
vib_co_gas = Vibrations(co_gas, indices=[0, 1], delta=0.01, nfree=2)
vib_co_gas.clean()
vib_co_gas.run()
vib_energies_co_gas = vib_co_gas.get_energies()
zpe_co_gas = 0.5 * np.sum(vib_energies_co_gas[vib_energies_co_gas &gt; 0])
vib_co_gas.clean()

print(f&quot;   ZPE(CO(g)):  {zpe_co_gas:.2f} eV&quot;)
print(f&quot;   ZPE(CO*):    {zpe_co:.2f} eV (from Step 4 calculation)&quot;)

# Electronic adsorption energy
E_ads_co_elec = E_final_co - E_clean - E_co_gas

# ZPE contribution to adsorption energy
delta_zpe_ads = zpe_co - zpe_co_gas

# Total adsorption energy with ZPE
E_ads_co_total = E_ads_co_elec + delta_zpe_ads

print(f&quot;\n   Electronic Energy Breakdown:&quot;)
print(f&quot;   ΔE(RPBE only) = {(E_final_co_ml - E_clean_ml - E_co_gas_ml):.2f} eV&quot;)
print(f&quot;   ΔE(D3 contrib) = {((E_final_co_d3 - E_clean_d3 - E_co_gas_d3)):.2f} eV&quot;)
print(f&quot;   ΔE(RPBE+D3) = {E_ads_co_elec:.2f} eV&quot;)
print(f&quot;\n   ZPE Contribution:&quot;)
print(f&quot;   ΔZPE = {delta_zpe_ads:.2f} eV&quot;)
print(f&quot;\n   Total Adsorption Energy:&quot;)
print(f&quot;   ΔE(total) = {E_ads_co_total:.2f} eV = {E_ads_co_total*96.485:.1f} kJ/mol&quot;)
print(f&quot;\n   Summary:&quot;)
print(
    f&quot;   E_ads(CO) without ZPE = {-E_ads_co_elec:.2f} eV = {-E_ads_co_elec*96.485:.1f} kJ/mol&quot;
)
print(
    f&quot;   E_ads(CO) with ZPE    = {-E_ads_co_total:.2f} eV = {-E_ads_co_total*96.485:.1f} kJ/mol&quot;
)
print(
    f&quot;   → CO binds {abs(E_ads_co_total):.2f} eV stronger than H ({abs(E_ads_co_total)/0.60:.1f}x)&quot;
)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="LqRY2Qu9PycsBdfp27M-_" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>
4. CO Adsorption Energy ( CO(g) + * → CO*):
   This helps us understand CO binding strength
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>   CO(g):       E_total = -14.43 eV (RPBE: -14.42, D3: -0.01)
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>   ZPE(CO(g)):  0.13+0.00j eV
   ZPE(CO*):    0.18+0.01j eV (from Step 4 calculation)

   Electronic Energy Breakdown:
   ΔE(RPBE only) = -1.59 eV
   ΔE(D3 contrib) = -0.30 eV
   ΔE(RPBE+D3) = -1.89 eV

   ZPE Contribution:
   ΔZPE = 0.05+0.01j eV

   Total Adsorption Energy:
   ΔE(total) = -1.84+0.01j eV = -177.2+0.5j kJ/mol

   Summary:
   E_ads(CO) without ZPE = 1.89 eV = 182.2 kJ/mol
   E_ads(CO) with ZPE    = 1.84-0.01j eV = 177.2-0.5j kJ/mol
   → CO binds 1.84 eV stronger than H (3.1x)
</span></code></pre></div></div></div></div><aside class="myst-admonition myst-admonition-tip my-5 shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-gray-50/10 dark:bg-stone-800 overflow-hidden myst-admonition-default rounded border-l-4 border-green-600 tip"><div class="myst-admonition-header m-0 font-medium py-1 flex min-w-0 text-lg text-green-600 bg-green-50 dark:bg-slate-900"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="myst-admonition-header-icon inline-block pl-2 mr-2 self-center flex-none text-green-600"><path stroke-linecap="round" stroke-linejoin="round" d="m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"></path></svg><div class="myst-admonition-header-text text-neutral-900 dark:text-white grow self-center overflow-hidden break-words">Comparison with Paper Results</div></div><div class="myst-admonition-body px-4 py-1"><p>The paper reports a CO adsorption energy of <strong>1.82 eV (175.6 kJ/mol)</strong> in Table 4, calculated using DFT (RPBE functional).</p><p>These results show:</p><ul><li><p><strong>Without ZPE</strong>: The electronic binding energy matches well with DFT predictions</p></li><li><p><strong>With ZPE</strong>: The zero-point energy correction reduces the binding strength slightly</p></li><li><p><strong>D3 Dispersion</strong>: Contributes to stronger binding due to van der Waals interactions</p></li></ul></div></aside><h3 id="step-6-find-guesses-for-nearby-initial-and-final-states-for-the-reaction" class="relative group"><span class="heading-text">Step 6: Find guesses for nearby initial and final states for the reaction</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#step-6-find-guesses-for-nearby-initial-and-final-states-for-the-reaction" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Now that we have an estimate on the reaction energy from the best possible initial and final states, we want to find a transition state (barrier) for this reaction. There are MANY possible ways that we could do this. In this case, we’ll start with the *CO final state and then try and find a nearby local minimal of *C and *O, by fixing the C-O bond distance and finding a nearby local minima. Note that this approach required some insight into what the transition state might look like, and could be considerably more complicated for a reaction that did not involve breaking a single bond.</p><div id="v2351MdIRm" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">print(f&quot;\nFinding Transition State Initial and Final States&quot;)
print(&quot;   Creating initial guess with stretched C-O bond...&quot;)
print(&quot;   Starting from CO* and stretching the C-O bond...&quot;)

# Create a guess structure with stretched CO bond (start from CO*)
initial_guess = final_co.copy()

# Set up a constraint to fix the bond length to ~2 Angstroms, which should be far enough that we&#x27;ll be closer to *C+*O than *CO
co_indices = np.where(initial_guess.get_tags() == 2)[0]

# Rotate the atoms a bit just to break the symmetry and prevent the O from going straight up to satisfy the constraint
initial_slab = initial_guess[initial_guess.get_tags() != 2]
initial_co = initial_guess[initial_guess.get_tags() == 2]
initial_co.rotate(30, &quot;x&quot;, center=initial_co.positions[0])
initial_guess = initial_slab + initial_co

initial_guess.calc = FAIRChemCalculator(predictor, task_name=&quot;oc20&quot;)

# Add constraints to keep the CO bond length extended
initial_guess.constraints += [
    FixBondLengths([co_indices], tolerance=1e-2, iterations=5000, bondlengths=[2.0])
]


try:
    opt = LBFGS(
        initial_guess,
        trajectory=output_dir / part_dirs[&quot;part6&quot;] / &quot;initial_guess_with_constraint.traj&quot;,
    )
    opt.run(fmax=0.01)
except RuntimeError:
    # The FixBondLength constraint is sometimes a little finicky,
    # but it&#x27;s ok if it doesn&#x27;t finish as it&#x27;s just an initial guess
    # for the next step
    pass

# Now that we have a guess, re-relax without the constraints
initial_guess.constraints = initial_guess.constraints[:-1]
opt = LBFGS(
    initial_guess,
    trajectory=output_dir
    / part_dirs[&quot;part6&quot;]
    / &quot;initial_guess_without_constraint.traj&quot;,
)
opt.run(fmax=0.01)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="N3mpPVeL_HTdBoVBJWhsc" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>
Finding Transition State Initial and Final States
   Creating initial guess with stretched C-O bond...
   Starting from CO* and stretching the C-O bond...
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>       Step     Time          Energy          fmax
LBFGS:    0 21:14:50     -466.586819        1.126528
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>LBFGS:    1 21:14:51     -466.631456        1.024523
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>LBFGS:    2 21:14:51     -466.833472        3.051798
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>LBFGS:    3 21:14:52     -466.884462        0.871574
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>LBFGS:    4 21:14:52     -466.911698        0.549930
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>LBFGS:    5 21:14:53     -466.951743        0.590103
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>LBFGS:    6 21:14:53     -466.969523        0.397013
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>LBFGS:    7 21:14:54     -466.981476        0.392852
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>LBFGS:    8 21:14:54     -466.986590        0.298904
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>LBFGS:    9 21:14:54     -466.993401        0.259323
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>LBFGS:   10 21:14:55     -466.997520        0.277442
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>LBFGS:   11 21:14:55     -466.999979        0.249170
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>LBFGS:   12 21:14:56     -467.002311        0.145081
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>LBFGS:   13 21:14:56     -467.004330        0.117686
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>LBFGS:   14 21:14:56     -467.005186        0.111491
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>LBFGS:   15 21:14:57     -467.006000        0.084512
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>LBFGS:   16 21:14:57     -467.006792        0.082439
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>LBFGS:   17 21:14:57     -467.007572        0.058191
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>LBFGS:   18 21:14:58     -467.008152        0.073206
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>LBFGS:   19 21:14:58     -467.008587        0.071630
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>LBFGS:   20 21:14:59     -467.009067        0.060635
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>LBFGS:   21 21:14:59     -467.009663        0.066588
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>LBFGS:   22 21:14:59     -467.010343        0.118594
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>LBFGS:   23 21:15:00     -467.011054        0.144746
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>LBFGS:   24 21:15:00     -467.011764        0.116407
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>LBFGS:   25 21:15:00     -467.012494        0.065354
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>LBFGS:   26 21:15:01     -467.013410        0.121565
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>LBFGS:   27 21:15:01     -467.014890        0.243838
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>LBFGS:   28 21:15:02     -467.017752        0.384512
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>LBFGS:   29 21:15:02     -467.023440        0.537903
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>LBFGS:   30 21:15:02     -467.030595        0.628289
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>LBFGS:   31 21:15:03     -467.043212        0.373476
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>LBFGS:   32 21:15:03     -467.074735        0.582289
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>LBFGS:   33 21:15:03     -467.066960        0.877857
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>LBFGS:   34 21:15:04     -467.098999        0.780995
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>LBFGS:   35 21:15:04     -467.105918        0.501631
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>LBFGS:   36 21:15:04     -467.116751        0.204056
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>LBFGS:   37 21:15:05     -467.120241        0.182302
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>LBFGS:   38 21:15:05     -467.123177        0.200803
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>LBFGS:   39 21:15:05     -467.125401        0.164320
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>LBFGS:   40 21:15:06     -467.127870        0.136161
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>LBFGS:   41 21:15:06     -467.130722        0.127583
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>LBFGS:   42 21:15:06     -467.132516        0.126120
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>LBFGS:   43 21:15:07     -467.133611        0.119503
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>LBFGS:   44 21:15:07     -467.134573        0.092507
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>LBFGS:   45 21:15:08     -467.135881        0.111032
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>LBFGS:   46 21:15:08     -467.137585        0.108930
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>LBFGS:   47 21:15:08     -467.139015        0.074102
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>LBFGS:   48 21:15:09     -467.139748        0.051515
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>LBFGS:   49 21:15:09     -467.140103        0.042414
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>LBFGS:   50 21:15:09     -467.140421        0.039418
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>LBFGS:   51 21:15:10     -467.140764        0.028931
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>LBFGS:   52 21:15:10     -467.140954        0.019574
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>LBFGS:   53 21:15:10     -467.141028        0.016651
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>LBFGS:   54 21:15:11     -467.141072        0.017189
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>LBFGS:   55 21:15:11     -467.141149        0.018255
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>LBFGS:   56 21:15:12     -467.141232        0.016314
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>LBFGS:   57 21:15:12     -467.141301        0.015502
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>LBFGS:   58 21:15:13     -467.141335        0.013035
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>LBFGS:   59 21:15:13     -467.141359        0.011771
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>LBFGS:   60 21:15:14     -467.141387        0.013656
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>LBFGS:   61 21:15:14     -467.141425        0.013902
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>LBFGS:   62 21:15:15     -467.141451        0.009736
</span></code></pre></div></div><div data-name="safe-output-text" class="font-mono text-sm whitespace-pre-wrap myst-jp-safe-output-text"><code><span>np.True_</span></code></div></div></div><h3 id="step-7-run-neb-to-find-activation-barrier" class="relative group"><span class="heading-text">Step 7: Run NEB to Find Activation Barrier</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#step-7-run-neb-to-find-activation-barrier" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Use the nudged elastic band method to find the minimum energy path:</p><div id="z8uKldtvsN" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">print(f&quot;\n7. NEB Barrier Calculation (C* + O* → CO*)&quot;)
print(&quot;   Setting up 7-image NEB chain with TS guess in middle...&quot;)
print(&quot;   Reaction: C* + O* (initial) → TS → CO* (final)&quot;)

initial = initial_guess.copy()
initial.calc = FAIRChemCalculator(predictor, task_name=&quot;oc20&quot;)
images = [initial]  # Start with C* + O*

n_images = 10
for i in range(n_images):
    image = initial.copy()
    image.calc = FAIRChemCalculator(predictor, task_name=&quot;oc20&quot;)
    images.append(image)

final = final_co.copy()
final.calc = FAIRChemCalculator(predictor, task_name=&quot;oc20&quot;)
images.append(final)  # End with CO*

# Interpolate with better initial guess
dyneb = DyNEB(images, climb=True, fmax=0.05)

# Interpolate first half (C*+O* → TS)
print(&quot;\n   Interpolating images...&quot;)
dyneb.interpolate(&quot;idpp&quot;, mic=True)

# Optimize
print(&quot;   Optimizing NEB path (this may take a while)...&quot;)
opt = FIRE(
    dyneb,
    trajectory=str(output_dir / part_dirs[&quot;part6&quot;] / &quot;neb.traj&quot;),
    logfile=str(output_dir / part_dirs[&quot;part6&quot;] / &quot;neb.log&quot;),
)
opt.run(fmax=0.1, steps=relaxation_steps)

# Extract barrier (from C*+O* to TS)
energies = [img.get_potential_energy() for img in images]
energies_rel = np.array(energies) - energies[0]
E_barrier = np.max(energies_rel)

print(f&quot;\n   ✓ NEB converged!&quot;)
print(
    f&quot;\n   Forward barrier (C*+O* → CO*): {E_barrier:.2f} eV = {E_barrier*96.485:.1f} kJ/mol&quot;
)
print(
    f&quot;   Reverse barrier (CO* → C*+O*): {E_barrier - energies_rel[-1]:.2f} eV = {(E_barrier- energies_rel[-1])*96.485:.1f} kJ/mol&quot;
)
print(f&quot;\n   Paper (Table 5): 153 kJ/mol = 1.59 eV &quot;)
print(f&quot;   Difference: {abs(E_barrier - 1.59):.2f} eV&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="fYgRwMfypUS9PuSrt8lB_" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>
7. NEB Barrier Calculation (C* + O* → CO*)
   Setting up 7-image NEB chain with TS guess in middle...
   Reaction: C* + O* (initial) → TS → CO* (final)

   Interpolating images...
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>   Optimizing NEB path (this may take a while)...
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>
   ✓ NEB converged!

   Forward barrier (C*+O* → CO*): 0.25 eV = 23.7 kJ/mol
   Reverse barrier (CO* → C*+O*): 0.00 eV = 0.0 kJ/mol

   Paper (Table 5): 153 kJ/mol = 1.59 eV 
   Difference: 1.34 eV
</span></code></pre></div></div></div></div><h3 id="step-8-visualize-neb-path-and-key-structures" class="relative group"><span class="heading-text">Step 8: Visualize NEB Path and Key Structures</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#step-8-visualize-neb-path-and-key-structures" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Create plots showing the reaction pathway:</p><div id="MJENSF5Jzn" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">print(&quot;\n   Creating NEB visualization...&quot;)

# Plot NEB path
fig, ax = plt.subplots(figsize=(10, 6))
ax.plot(
    range(len(energies_rel)),
    energies_rel,
    &quot;o-&quot;,
    linewidth=2,
    markersize=10,
    color=&quot;steelblue&quot;,
    label=&quot;NEB Path&quot;,
)
ax.axhline(0, color=&quot;green&quot;, linestyle=&quot;--&quot;, alpha=0.5, label=&quot;Initial: C*+O*&quot;)
ax.axhline(delta_E_zpe, color=&quot;red&quot;, linestyle=&quot;--&quot;, alpha=0.5, label=&quot;Final: CO*&quot;)
ax.axhline(
    E_barrier,
    color=&quot;orange&quot;,
    linestyle=&quot;:&quot;,
    alpha=0.7,
    linewidth=2,
    label=f&quot;Forward Barrier = {E_barrier:.2f} eV&quot;,
)

# Annotate transition state
ts_idx = np.argmax(energies_rel)
ax.annotate(
    f&quot;TS\n{energies_rel[ts_idx]:.2f} eV&quot;,
    xy=(ts_idx, energies_rel[ts_idx]),
    xytext=(ts_idx, energies_rel[ts_idx] + 0.3),
    ha=&quot;center&quot;,
    fontsize=11,
    fontweight=&quot;bold&quot;,
    arrowprops=dict(arrowstyle=&quot;-&gt;&quot;, lw=1.5, color=&quot;red&quot;),
)

ax.set_xlabel(&quot;Image Number&quot;, fontsize=13)
ax.set_ylabel(&quot;Relative Energy (eV)&quot;, fontsize=13)
ax.set_title(
    &quot;CO Formation on Ni(111): C* + O* → CO* - NEB Path&quot;, fontsize=15, fontweight=&quot;bold&quot;
)
ax.legend(fontsize=11, loc=&quot;upper left&quot;)
ax.grid(True, alpha=0.3)

plt.tight_layout()
plt.savefig(
    str(output_dir / part_dirs[&quot;part6&quot;] / &quot;neb_path.png&quot;), dpi=300, bbox_inches=&quot;tight&quot;
)
plt.show()

# Create animation of NEB path
print(&quot;\n   Creating NEB path animation...&quot;)
from ase.io import write as ase_write

ase.io.write(
    str(output_dir / part_dirs[&quot;part6&quot;] / &quot;neb_path.gif&quot;), images, format=&quot;gif&quot;
)
print(&quot;   → Saved as neb_path.gif&quot;)

# Visualize key structures
print(&quot;\n   Visualizing initial state (C* + O*)...&quot;)
view(initial_c_o, viewer=&#x27;x3d&#x27;)

print(&quot;\n   Visualizing transition state...&quot;)
view(images[ts_idx], viewer=&#x27;x3d&#x27;)

print(&quot;\n   Visualizing final state (CO*)...&quot;)
view(final_co, viewer=&#x27;x3d&#x27;)

print(&quot;\n✓ NEB analysis complete!&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="GlV_u4S3YEYvZmFC3q2O8" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>
   Creating NEB visualization...
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>/home/runner/work/_tool/Python/3.12.12/x64/lib/python3.12/site-packages/matplotlib/cbook.py:1355: ComplexWarning: Casting complex values to real discards the imaginary part
  return np.asarray(x, float)
</span></code></pre></div></div><div data-name="safe-output-image"><img src="/build/16817b250821510773f9765309ea7671.png" alt="&lt;Figure size 1000x600 with 1 Axes&gt;"/></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>
   Creating NEB path animation...
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>   → Saved as neb_path.gif

   Visualizing initial state (C* + O*)...

   Visualizing transition state...

   Visualizing final state (CO*)...

✓ NEB analysis complete!
</span></code></pre></div></div><div data-name="safe-output-image"><img src="/build/8258dbc471c4ccc769a50effdf53c191.png" alt="&lt;Figure size 640x480 with 1 Axes&gt;"/></div></div></div><aside class="myst-admonition myst-admonition-tip my-5 shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-gray-50/10 dark:bg-stone-800 overflow-hidden myst-admonition-default rounded border-l-4 border-green-600 dropdown, tip"><div class="myst-admonition-header m-0 font-medium py-1 flex min-w-0 text-lg text-green-600 bg-green-50 dark:bg-slate-900"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="myst-admonition-header-icon inline-block pl-2 mr-2 self-center flex-none text-green-600"><path stroke-linecap="round" stroke-linejoin="round" d="m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"></path></svg><div class="myst-admonition-header-text text-neutral-900 dark:text-white grow self-center overflow-hidden break-words">Missing UMA access?</div></div><div class="myst-admonition-body px-4 py-1"><p>Don’t have access to UMA yet? You can still explore this calculation!</p><p><a class="link" href="/example_configs/co_on_ni111.xyz">Download example CO on Ni(111) structure</a> and <a class="link" href="/example_configs/c_o_on_ni111.xyz">Download C+O on Ni(111) structure</a> to test in the <a target="_blank" rel="noreferrer" href="https://facebook-fairchem-uma-demo.hf.space/" class="link whitespace-nowrap"><span class="link-text whitespace-normal">UMA demo (no login required)</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="link-icon"><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"></path></svg></a> and explore the reaction pathway.</p></div></aside><aside class="myst-admonition myst-admonition-note my-5 shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-gray-50/10 dark:bg-stone-800 overflow-hidden myst-admonition-default rounded border-l-4 border-blue-500 note"><div class="myst-admonition-header m-0 font-medium py-1 flex min-w-0 text-lg text-blue-600 bg-blue-50 dark:bg-slate-900"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="myst-admonition-header-icon inline-block pl-2 mr-2 self-center flex-none text-blue-600"><path stroke-linecap="round" stroke-linejoin="round" d="m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"></path></svg><div class="myst-admonition-header-text text-neutral-900 dark:text-white grow self-center overflow-hidden break-words">Comparison with Paper (Tables 4 &amp; 5)</div></div><div class="myst-admonition-body px-4 py-1"><p><strong>Expected Results from Paper:</strong></p><ul><li><p><em><em>Reaction Energy (C</em> + O</em> → CO*)**: <strong>-142.7 kJ/mol = -1.48 eV</strong> (exothermic, DFT-D3)</p></li><li><p><em><em>Activation Barrier (C</em> + O</em> → CO*)**: <strong>153 kJ/mol = 1.59 eV</strong> (reverse/dissociation, DFT-D3)</p></li><li><p><strong>CO Adsorption Energy</strong>: <strong>1.82 eV = 175.6 kJ/mol</strong> (DFT-D3)</p></li></ul><p><strong>Reaction Direction:</strong></p><ul><li><p>Paper reports CO dissociation barrier (CO* → C* + O*), which is the <strong>reverse</strong> of the recombination we calculate</p></li><li><p>Forward (C* + O* → CO*): barrier = reverse_barrier - |ΔE| ≈ 1.59 - 1.48 ≈ 0.11 eV (very fast)</p></li><li><p>Reverse (CO* → C* + O*): barrier = 1.59 eV (very slow, kinetic bottleneck)</p></li></ul><p><strong>What to Check:</strong></p><ul><li><p>Reaction energy (C*+O* → CO*) should be strongly exothermic (~-1.5 eV)</p></li><li><p>Reverse barrier (CO dissociation) should be substantial (~1.6 eV)</p></li><li><p>Forward barrier (recombination) should be very small (~0.1 eV)</p></li><li><p>CO binds much more strongly than H (1.82 eV vs 0.60 eV)</p></li></ul><p><strong>Typical Variations:</strong></p><ul><li><p>Reaction energies typically accurate within 0.1-0.2 eV</p></li><li><p>Barriers more sensitive: expect ±0.2-0.3 eV variation</p></li><li><p>ZPE corrections typically add 0.05-0.15 eV to reaction energies</p></li><li><p>NEB convergence affects barrier more than reaction energy</p></li></ul><p><strong>Physical Insight:</strong></p><ul><li><p>Large reverse barrier (1.59 eV) makes CO dissociation very slow at low T</p></li><li><p>Small forward barrier (0.11 eV) means C+O rapidly recombine to CO</p></li><li><p>This explains why Ni produces CO in Fischer-Tropsch rather than keeping C and O separate</p></li><li><p>High temperatures needed to overcome the dissociation barrier for further C-C coupling</p></li></ul></div></aside><aside class="myst-admonition myst-admonition-note my-5 shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-gray-50/10 dark:bg-stone-800 overflow-hidden myst-admonition-default rounded border-l-4 border-blue-500 note"><div class="myst-admonition-header m-0 font-medium py-1 flex min-w-0 text-lg text-blue-600 bg-blue-50 dark:bg-slate-900"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="myst-admonition-header-icon inline-block pl-2 mr-2 self-center flex-none text-blue-600"><path stroke-linecap="round" stroke-linejoin="round" d="m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"></path></svg><div class="myst-admonition-header-text text-neutral-900 dark:text-white grow self-center overflow-hidden break-words">NEB Method Explained</div></div><div class="myst-admonition-body px-4 py-1"><p>The <strong>Nudged Elastic Band (NEB)</strong> method finds the minimum energy path between reactants and products:</p><ol start="1"><li><p><strong>Interpolate</strong> between initial and final states (5-9 images typical)</p></li><li><p><strong>Add spring forces</strong> along the chain to maintain spacing</p></li><li><p><strong>Project out</strong> spring components perpendicular to the path</p></li><li><p><strong>Climbing image</strong> variant: highest energy image climbs to saddle point</p></li></ol><p>Advantages:</p><ul><li><p>No prior knowledge of transition state needed</p></li><li><p>Finds entire reaction coordinate</p></li><li><p>Robust for complex reactions</p></li></ul><p>Limitations:</p><ul><li><p>Computationally expensive (optimize N images)</p></li><li><p>May find wrong path if initial interpolation is poor</p></li></ul></div></aside><h3 id="explore-on-your-own-4" class="relative group"><span class="heading-text">Explore on Your Own</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#explore-on-your-own-4" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><ol start="1"><li><p><strong>Image convergence</strong>: Run with 7 or 9 images. Does the barrier change?</p></li><li><p><strong>Spring constant</strong>: Modify the NEB spring constant. How does this affect convergence?</p></li><li><p><strong>Alternative paths</strong>: Try different initial CO/final C+O configurations. Are there multiple pathways?</p></li><li><p><strong>Reverse barrier</strong>: Calculate E_a(reverse) = E_a(forward) - ΔE. Check Brønsted-Evans-Polanyi relationship.</p></li><li><p><strong>Diffusion barriers</strong>: Compute NEB for C or O diffusion on the surface. How do they compare?</p></li></ol><hr class="py-2 my-5 translate-y-2"/><h2 id="summary-and-best-practices" class="relative group"><span class="heading-text">Summary and Best Practices</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#summary-and-best-practices" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><h3 id="key-takeaways" class="relative group"><span class="heading-text">Key Takeaways</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#key-takeaways" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><ol start="1"><li><p><strong>ML Potentials</strong>: UMa-S-1P1 provides ~1000× speedup over DFT with reasonable accuracy</p></li><li><p><strong>Bulk optimization</strong>: Always use the ML-optimized lattice constant for consistency</p></li><li><p><strong>Surface energies</strong>: Linear extrapolation eliminates finite-size effects</p></li><li><p><strong>Adsorption</strong>: Test multiple sites; lowest energy may not be intuitive</p></li><li><p><strong>Coverage</strong>: Lateral interactions become significant above ~0.3 ML</p></li><li><p><strong>Barriers</strong>: NEB requires careful setup but yields full reaction pathway</p></li></ol><h3 id="recommended-workflow-for-new-systems" class="relative group"><span class="heading-text">Recommended Workflow for New Systems</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#recommended-workflow-for-new-systems" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><ol start="1"><li><p><strong>Optimize Bulk</strong> - Determine equilibrium lattice constant</p></li><li><p><strong>Calculate Surface Energies</strong> - Identify stable facets</p></li><li><p><strong>Wulff Construction</strong> - Predict nanoparticle morphology</p></li><li><p><strong>Low-Coverage Adsorption</strong> - Find binding sites and energies</p></li><li><p><strong>Coverage Study</strong> (if coverage-dependent effects are important) - Determine lateral interactions</p></li><li><p><strong>Reaction Barriers</strong> - Calculate activation energies using NEB</p></li><li><p><strong>Microkinetic Modeling</strong> - Predict overall catalytic performance</p></li></ol><h3 id="accuracy-considerations" class="relative group"><span class="heading-text">Accuracy Considerations</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#accuracy-considerations" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><table class=""><tbody><tr class=""><th class="">Property</th><th class="">Typical Error</th><th class="">When Critical</th></tr><tr class=""><td class="">Lattice constants</td><td class="">1-2%</td><td class="">Strain effects, alloys</td></tr><tr class=""><td class="">Surface energies</td><td class="">10-20%</td><td class="">Nanoparticle shapes</td></tr><tr class=""><td class="">Adsorption energies</td><td class="">0.1-0.3 eV</td><td class="">Thermochemistry</td></tr><tr class=""><td class="">Barriers</td><td class="">0.2-0.5 eV</td><td class="">Kinetics, selectivity</td></tr></tbody></table><p><strong>Rule of thumb</strong>: Use ML for screening → DFT for validation → Experiment for verification</p><h3 id="further-reading" class="relative group"><span class="heading-text">Further Reading</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#further-reading" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><ul><li><p><strong>UMA Paper</strong>: <a target="_blank" rel="noreferrer" href="https://arxiv.org/abs/2506.23971" class="link whitespace-nowrap"><span class="link-text whitespace-normal">Wood et al. 2025</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="link-icon"><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"></path></svg></a></p></li><li><p><strong>OMat24 Paper</strong>: <a target="_blank" rel="noreferrer" href="https://arxiv.org/abs/2410.12771" class="link whitespace-nowrap"><span class="link-text whitespace-normal">Barroso-Luque et al., 2024</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="link-icon"><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"></path></svg></a></p></li><li><p><strong>OC20 Dataset</strong>: <cite class="" data-state="closed"><a href="https://doi.org/10.1021/acscatal.0c04525" target="_blank" rel="noreferrer" class="hover-link">Chanussot et al., ACS Catalysis, 2021</a></cite></p></li><li><p><strong>ASE Tutorial</strong>: <a target="_blank" rel="noreferrer" href="https://wiki.fysik.dtu.dk/ase/" class="link whitespace-nowrap"><span class="link-text whitespace-normal">https://<wbr/>wiki<wbr/>.fysik<wbr/>.dtu<wbr/>.dk<wbr/>/ase/</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="link-icon"><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"></path></svg></a></p></li></ul><hr class="py-2 my-5 translate-y-2"/><h2 id="appendix-troubleshooting" class="relative group"><span class="heading-text">Appendix: Troubleshooting</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#appendix-troubleshooting" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><h3 id="common-issues" class="relative group"><span class="heading-text">Common Issues</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#common-issues" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p><strong>Problem</strong>: Convergence failures</p><ul><li><p><strong>Solution</strong>: Reduce <code>fmax</code> to 0.1 initially, tighten later</p></li><li><p>Check if system is metastable (try different starting geometry)</p></li></ul><p><strong>Problem</strong>: NEB fails to find transition state</p><ul><li><p><strong>Solution</strong>: Use more images (9-11) or better initial guess</p></li><li><p>Try fixed-end NEB first, then climbing image</p></li></ul><p><strong>Problem</strong>: Unexpected adsorption energies</p><ul><li><p><strong>Solution</strong>: Visualize structures - check for distortions</p></li><li><p>Compare with multiple sites</p></li><li><p>Add D3 corrections</p></li></ul><p><strong>Problem</strong>: Out of memory</p><ul><li><p><strong>Solution</strong>: Reduce system size (smaller supercells)</p></li><li><p>Use fewer NEB images</p></li><li><p>Run on HPC with more RAM</p></li></ul><h3 id="performance-tips" class="relative group"><span class="heading-text">Performance Tips</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#performance-tips" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><ol start="1"><li><p><strong>Use batching</strong>: Relax multiple configurations in parallel</p></li><li><p><strong>Start with DEBUG_MAX_STEPS=50</strong>: Get quick results, refine later</p></li><li><p><strong>Cache bulk energies</strong>: Don’t recalculate reference systems</p></li><li><p><strong>Trajectory analysis</strong>: Monitor optimization progress with ASE GUI</p></li></ol><hr class="py-2 my-5 translate-y-2"/><h2 id="caveats-and-pitfalls" class="relative group"><span class="heading-text">Caveats and Pitfalls</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#caveats-and-pitfalls" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><aside class="myst-admonition myst-admonition-warning my-5 shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-gray-50/10 dark:bg-stone-800 overflow-hidden myst-admonition-default rounded border-l-4 border-amber-600 warning"><div class="myst-admonition-header m-0 font-medium py-1 flex min-w-0 text-lg text-amber-600 bg-amber-50 dark:bg-slate-900"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="myst-admonition-header-icon inline-block pl-2 mr-2 self-center flex-none text-amber-600"><path fill-rule="evenodd" d="M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003ZM12 8.25a.75.75 0 0 1 .75.75v3.75a.75.75 0 0 1-1.5 0V9a.75.75 0 0 1 .75-.75Zm0 8.25a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5Z" clip-rule="evenodd"></path></svg><div class="myst-admonition-header-text text-neutral-900 dark:text-white grow self-center overflow-hidden break-words">Important Considerations</div></div><div class="myst-admonition-body px-4 py-1"><p>When using ML potentials for surface catalysis, be aware of these critical issues!</p></div></aside><h3 id="id-1-task-selection-omat-vs-oc20" class="relative group"><span class="heading-text">1. Task Selection: OMAT vs OC20</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-1-task-selection-omat-vs-oc20" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p><strong>Critical choice</strong>: Which task_name to use?</p><ul><li><p><strong><code>task_name=&quot;omat&quot;</code></strong>: Optimized for bulk and clean surface calculations</p><ul><li><p>Use for: Part 1 (bulk), Part 2 (surface energies), Part 3 (Wulff)</p></li><li><p>Better for structural relaxations without adsorbates</p></li></ul></li><li><p><strong><code>task_name=&quot;oc20&quot;</code></strong>: Optimized for surface chemistry with adsorbates</p><ul><li><p>Use for: Part 4-6 (all adsorbate calculations)</p></li><li><p>Trained on Open Catalyst data with adsorbate-surface interactions</p></li></ul></li></ul><p><strong>Impact</strong>: Using wrong task can lead to 0.1-0.3 eV errors in adsorption energies!</p><h3 id="id-2-d3-dispersion-corrections" class="relative group"><span class="heading-text">2. D3 Dispersion Corrections</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-2-d3-dispersion-corrections" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p><strong>Multiple decisions required</strong>:</p><ol start="1"><li><p><strong>Whether to use D3 at all?</strong></p><ul><li><p>Small adsorbates (H, O, N): D3 effect ~0.01-0.05 eV (often negligible)</p></li><li><p>Large molecules (CO, CO₂, aromatics): D3 effect ~0.1-0.3 eV (important!)</p></li><li><p>Physisorption: D3 critical (can change binding from repulsive to attractive)</p></li><li><p>RPBE was originally fit for chemisorption energies without D3 corrections, so adding D3 corrections may actually cause small adsorbates to overbind. However, it probably would be important for larger molecules. It’s relatively uncommon to see RPBE+D3 as a choice in the catalysis literature (compared to PBE+D3, or RPBE, or BEEF-vdW).</p></li></ul></li><li><p><strong>Which DFT functional for D3?</strong></p><ul><li><p>This tutorial uses <code>method=&quot;PBE&quot;</code> consistently for the D3 correction. This is often implied when papers say they use a D3 correction, but the results can be different if use the RPBE parameterizations.</p></li><li><p>Original paper used PBE for bulk/surfaces, RPBE for adsorption. It’s not specified what D3 parameterization they used, but it’s likely PBE.</p></li></ul></li><li><p><strong>When to apply D3?</strong></p><ul><li><p><strong>End-point correction</strong> (used here): Fast, run ML optimization then add D3 energy</p></li><li><p><strong>During optimization</strong>: Slower but more accurate geometries</p></li><li><p><strong>Impact</strong>: Usually &lt;0.05 eV difference, but can be larger for weak interactions</p></li></ul></li></ol><h3 id="id-3-coverage-dependence-challenges" class="relative group"><span class="heading-text">3. Coverage Dependence Challenges</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-3-coverage-dependence-challenges" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p><strong>Non-linearity at high coverage</strong>:</p><ul><li><p>This tutorial assumes linear E_ads(θ) = E₀ + βθ</p></li><li><p>Reality: Often non-linear, especially near θ = 1 ML. See the plots generated - there is a linear regime for relatively high coverage, and relatively low coverage, but it’s not uniformly linear everywhere. As long as you consistently in one regime or the other a linear assumption is probably ok, but you could get into problems if solving microkinetic models where the coverage of the species in question changes significantly from very low to high.</p></li><li><p><strong>Why</strong>: Phase transitions, adsorbate ordering, surface reconstruction</p></li><li><p><strong>Solution</strong>: Test polynomial fits, look for ordering in visualizations</p></li></ul><p><strong>Low coverage limit</strong>:</p><ul><li><p>At θ &lt; 0.1 ML, coverage effects are tiny (&lt;0.01 eV)</p></li><li><p>Hard to distinguish from numerical noise</p></li><li><p><strong>Best practice</strong>: Focus on 0.25-1.0 ML range for fitting</p></li></ul><h3 id="id-4-periodic-boundary-conditions" class="relative group"><span class="heading-text">4. Periodic Boundary Conditions</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-4-periodic-boundary-conditions" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p><strong>UMa requires PBC=True in all directions!</strong></p><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-stone-200/10"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">atoms.set_pbc([True, True, True])  # Always required</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><ul><li><p>Forgetting this causes crashes or wrong energies</p></li><li><p>Even for “gas phase” molecules in vacuum</p></li></ul><h3 id="id-5-gas-phase-reference-energies" class="relative group"><span class="heading-text">5. Gas Phase Reference Energies</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-5-gas-phase-reference-energies" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p><strong>Tricky cases</strong>:</p><ul><li><p><strong>H₂(g)</strong>: UMa handles well (used in this tutorial)</p></li><li><p><strong>H(g)</strong>: May not be reliable (use H₂/2 instead)</p></li><li><p><strong>CO(g)</strong>, <strong>O₂(g)</strong>: Usually okay, but check against DFT</p></li><li><p><strong>Radicals</strong>: Often problematic</p></li></ul><p><strong>Best practice</strong>: Always use stable molecules as references (H₂, not H; H₂O, not OH)</p><h3 id="id-6-spin-polarization" class="relative group"><span class="heading-text">6. Spin Polarization</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-6-spin-polarization" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p><strong>Key limitation</strong>: OC20/UMa does not include spin!</p><ul><li><p>Paper used spin-polarized DFT</p></li><li><p><strong>Impact</strong>: Usually small (0.05-0.1 eV)</p></li><li><p><strong>Larger</strong> for:</p><ul><li><p>Magnetic metals (Fe, Co, Ni)</p></li><li><p>Open-shell adsorbates (O*, OH*)</p></li><li><p>Reaction barriers with radicals</p></li></ul></li></ul><h3 id="id-7-constraint-philosophy" class="relative group"><span class="heading-text">7. Constraint Philosophy</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-7-constraint-philosophy" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p><strong>Clean slabs</strong> (Part 2): No constraints (both surfaces relax)</p><ul><li><p>Best for surface energy calculations</p></li><li><p>More physical for symmetric slabs</p></li></ul><p><strong>Adsorbate slabs</strong> (Part 4-6): Bottom layers fixed</p><ul><li><p>Faster convergence</p></li><li><p>Prevents adsorbate-induced reconstruction</p></li><li><p>Standard practice in surface chemistry</p></li></ul><p><strong>Fairchem helper functions</strong>: Automatically apply sensible constraints</p><ul><li><p>Trust their heuristics unless you have good reason not to</p></li><li><p>Check <code>atoms.constraints</code> to see what was applied</p></li></ul><h3 id="id-8-complex-surface-structures" class="relative group"><span class="heading-text">8. Complex Surface Structures</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-8-complex-surface-structures" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p><strong>This tutorial uses low-index facets</strong> (111, 100, 110, 211)</p><ul><li><p>Well-defined, symmetric</p></li><li><p>Easy to generate and analyze</p></li></ul><p><strong>Real catalysts</strong> have:</p><ul><li><p>Steps, kinks, grain boundaries</p></li><li><p>Support interfaces</p></li><li><p>Defects and vacancies</p></li><li><p><strong>Challenge</strong>: Harder to generate, more configurations to test</p></li></ul><h3 id="id-9-slab-thickness-and-vacuum" class="relative group"><span class="heading-text">9. Slab Thickness and Vacuum</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-9-slab-thickness-and-vacuum" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p><strong>Convergence tests critical</strong> but expensive:</p><ul><li><p>This tutorial uses “reasonable” values (4-8 layers, 10 Å vacuum)</p></li><li><p><strong>Always check</strong> convergence for new systems</p></li><li><p><strong>Especially important</strong> for:</p><ul><li><p>Metals with long electron screening (Au, Ag)</p></li><li><p>Charged adsorbates</p></li><li><p>Strong adsorbate-induced reconstruction</p></li></ul></li></ul><h3 id="id-10-neb-convergence" class="relative group"><span class="heading-text">10. NEB Convergence</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-10-neb-convergence" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p><strong>Most computationally expensive part</strong>:</p><ul><li><p>May need 7-11 images (not just 5)</p></li><li><p>Initial guess matters a lot</p></li><li><p>Can get stuck in local minima</p></li></ul><p><strong>Tricks</strong>:</p><ol start="1"><li><p>Use dimer method to find better TS guess (as shown in Part 6)</p></li><li><p>Start with coarse convergence (fmax=0.2), refine later</p></li><li><p>Visualize the path - does it make chemical sense?</p></li><li><p>Try different spring constants (0.1-1.0 eV/Å)</p></li></ol><h3 id="id-11-lattice-constant-source" class="relative group"><span class="heading-text">11. Lattice Constant Source</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-11-lattice-constant-source" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p><strong>Consistency is key</strong>:</p><ul><li><p>Use ML-optimized lattice constant throughout (as done here)</p></li><li><p><strong>Don’t mix</strong>: ML lattice + DFT surface energies = inconsistent</p></li><li><p>Alternative: Use experimental lattice constant for everything</p></li></ul><h3 id="id-12-adsorbate-placement" class="relative group"><span class="heading-text">12. Adsorbate Placement</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-12-adsorbate-placement" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p><strong>Multiple local minima</strong>:</p><ul><li><p>Surface chemistry is <strong>not</strong> convex!</p></li><li><p>Always test multiple adsorption sites</p></li><li><p>Fairchem helpers generate ~5 configurations in this tutorial, but you may need more to search many modes. You can already try methods like minima hopping or other global optimization methods to sample more configurations.</p></li></ul><p><strong>For complex adsorbates</strong>:</p><ul><li><p>Test different orientations</p></li><li><p>May need 10-20 configurations</p></li><li><p>Consider genetic algorithms or basin hopping</p></li></ul><hr class="py-2 my-5 translate-y-2"/><aside class="myst-admonition myst-admonition-tip my-5 shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-gray-50/10 dark:bg-stone-800 overflow-hidden myst-admonition-default rounded border-l-4 border-green-600 tip"><div class="myst-admonition-header m-0 font-medium py-1 flex min-w-0 text-lg text-green-600 bg-green-50 dark:bg-slate-900"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="myst-admonition-header-icon inline-block pl-2 mr-2 self-center flex-none text-green-600"><path stroke-linecap="round" stroke-linejoin="round" d="m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"></path></svg><div class="myst-admonition-header-text text-neutral-900 dark:text-white grow self-center overflow-hidden break-words">Congratulations! 🎉</div></div><div class="myst-admonition-body px-4 py-1"><p>You’ve completed a comprehensive computational catalysis workflow using state-of-the-art ML potentials. You can now:</p><ul><li><p>Characterize catalyst surfaces computationally</p></li><li><p>Predict nanoparticle shapes</p></li><li><p>Calculate reaction thermodynamics and kinetics</p></li><li><p>Apply these methods to your own research questions</p></li></ul><p><strong>Next steps</strong>:</p><ul><li><p>Apply to your catalyst system of interest</p></li><li><p>Validate key results with DFT</p></li><li><p>Develop microkinetic models</p></li><li><p>Publish your findings!</p></li></ul></div></aside><div class="myst-backmatter-parts"></div><section id="references" class="myst-bibliography article-grid subgrid-gap col-screen"><div><header class="myst-bibliography-header text-lg font-semibold text-stone-900 dark:text-white group">References<a class="no-underline text-inherit hover:text-inherit ml-2 select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#references" title="Link to References" aria-label="Link to References">¶</a></header></div><div class="myst-bibliography-list pl-3 mb-8 text-xs text-stone-500 dark:text-stone-300"><ol><li class="myst-bibliography-item break-words" id="cite-Kreitz_2021">Kreitz, B., Wehinger, G. D., Goldsmith, C. F., & Turek, T. (2021). Microkinetic Modeling of the CO2 Desorption from Supported Multifaceted Ni Catalysts. <i>The Journal of Physical Chemistry C</i>, <i>125</i>(5), 2984–3000. <a target="_blank" rel="noreferrer" href="https://doi.org/10.1021/acs.jpcc.0c09985">10.1021/acs.jpcc.0c09985</a></li><li class="myst-bibliography-item break-words" id="cite-chanussot-2021-open-catal">Chanussot, L., Das, A., Goyal, S., Lavril, T., Shuaibi, M., Riviere, M., Tran, K., Heras-Domingo, J., Ho, C., Hu, W., Palizhati, A., Sriram, A., Wood, B., Yoon, J., Parikh, D., Zitnick, C. L., & Ulissi, Z. (2021). Open Catalyst 2020 (OC20) Dataset and Community Challenges. <i>ACS Catalysis</i>, <i>11</i>(10), 6059–6072. <a target="_blank" rel="noreferrer" href="https://doi.org/10.1021/acscatal.0c04525">10.1021/acscatal.0c04525</a></li></ol></div></section><div class="myst-footer-links flex pt-10 mb-10 space-x-4"><a class="myst-footer-link flex-1 block p-4 font-normal text-gray-600 no-underline border border-gray-200 rounded shadow-sm group hover:border-blue-600 dark:hover:border-blue-400 hover:text-blue-600 dark:hover:text-blue-400 dark:text-gray-100 dark:border-gray-500 hover:shadow-lg dark:shadow-neutral-700 myst-footer-link-prev" href="/uma-tutorial"><div class="flex h-full align-middle"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="myst-footer-link-icon self-center transition-transform group-hover:-translate-x-1 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"></path></svg><div class="flex-grow text-right"><div class="myst-footer-link-group text-xs text-gray-500 dark:text-gray-400">AI/ML Models &amp; Usage</div>UMA Intro Tutorial</div></div></a><a class="myst-footer-link flex-1 block p-4 font-normal text-gray-600 no-underline border border-gray-200 rounded shadow-sm group hover:border-blue-600 dark:hover:border-blue-400 hover:text-blue-600 dark:hover:text-blue-400 dark:text-gray-100 dark:border-gray-500 hover:shadow-lg dark:shadow-neutral-700 myst-footer-link-next" href="/generative-models"><div class="flex h-full align-middle"><div class="flex-grow"><div class="myst-footer-link-group text-xs text-gray-500 dark:text-gray-400">AI/ML Models &amp; Usage</div>Generative Models</div><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="myst-footer-link-icon self-center transition-transform group-hover:translate-x-1 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3"></path></svg></div></a></div></article></main><script>((a,l)=>{if(!window.history.state||!window.history.state.key){let u=Math.random().toString(32).slice(2);window.history.replaceState({key:u},"")}try{let d=JSON.parse(sessionStorage.getItem(a)||"{}")[l||window.history.state.key];typeof d=="number"&&window.scrollTo(0,d)}catch(u){console.error(u),sessionStorage.removeItem(a)}})("positions", null)</script><link rel="modulepreload" href="/build/entry.client-PCJPW7TK.js"/><link rel="modulepreload" href="/build/_shared/chunk-AQ2CODAG.js"/><link rel="modulepreload" href="/build/_shared/chunk-JJXTQVMA.js"/><link rel="modulepreload" href="/build/_shared/chunk-OZE3FFNP.js"/><link rel="modulepreload" href="/build/_shared/chunk-G62B6HZR.js"/><link rel="modulepreload" href="/build/_shared/chunk-C4DFGG5C.js"/><link rel="modulepreload" href="/build/_shared/chunk-J7TUH54J.js"/><link rel="modulepreload" href="/build/_shared/chunk-FZ2S7OYD.js"/><link rel="modulepreload" href="/build/_shared/chunk-JEM6JXYA.js"/><link rel="modulepreload" href="/build/_shared/chunk-34XIY2DH.js"/><link rel="modulepreload" href="/build/_shared/chunk-KQM5FBHR.js"/><link rel="modulepreload" href="/build/_shared/chunk-OCWQY3HK.js"/><link rel="modulepreload" href="/build/_shared/chunk-7HNKBP4B.js"/><link rel="modulepreload" href="/build/_shared/chunk-CUKUDK3R.js"/><link rel="modulepreload" href="/build/_shared/chunk-3EBOCCHJ.js"/><link rel="modulepreload" href="/build/_shared/chunk-O4VQNZ62.js"/><link rel="modulepreload" href="/build/_shared/chunk-4OEDG4JQ.js"/><link rel="modulepreload" href="/build/_shared/chunk-GUCIBHGO.js"/><link rel="modulepreload" href="/build/root-PMP5BIHC.js"/><link rel="modulepreload" href="/build/_shared/chunk-IX5KPAHP.js"/><link rel="modulepreload" href="/build/routes/$-5ZLZ2O3Y.js"/><script>window.__remixContext = {"url":"/uma-catalysis-tutorial","state":{"loaderData":{"root":{"config":{"version":3,"myst":"1.8.0","title":"FAIR Chemistry Documentation","options":{"logo":"/build/fair_chem_logo_v2-8db274e987822faff08820502b8c23f7.png","folders":false},"nav":[{"title":"Quickstart","url":"/quickstart"},{"title":"Docs","url":"/install"},{"title":"Tutorial","url":"/uma-tutorial"},{"title":"Demo","url":"https://facebook-fairchem-uma-demo.hf.space/"},{"title":"Github","url":"https://github.com/facebookresearch/fairchem"},{"title":"Help","children":[{"title":"Ask a question ❓","url":"https://github.com/facebookresearch/fairchem/discussions"},{"title":"Report a bug 🐛","url":"https://github.com/facebookresearch/fairchem/issues"}]}],"actions":[],"projects":[{"bibliography":["/home/runner/work/fairchem/fairchem/docs/references.bib"],"exports":[],"title":"fairchem","authors":[{"nameParsed":{"literal":"FAIR Chemistry \u0026 Collaborators","given":"FAIR Chemistry \u0026","family":"Collaborators"},"name":"FAIR Chemistry \u0026 Collaborators","id":"contributors-myst-generated-uid-0"}],"github":"https://github.com/facebookresearch/fairchem","copyright":"Meta Platforms, Inc","thebe":{"binder":{"url":"https://mybinder.org/","provider":"github","repo":"https://github.com/facebookresearch/fairchem","ref":"HEAD"}},"toc":[{"file":"index.md"},{"children":[{"file":"core/install.md"},{"file":"core/quickstart.md"},{"file":"core/fairchemv1_v2.md"},{"url":"https://facebook-fairchem-uma-demo.hf.space/","title":"UMA Demo"}],"title":"Quickstart"},{"children":[{"file":"core/uma.md"},{"file":"core/intro.md"},{"children":[{"file":"core/common_tasks/ase_calculator.md"},{"file":"core/common_tasks/lammps.md"},{"file":"core/common_tasks/batch_inference.md"},{"file":"core/common_tasks/inference_batcher.md"},{"file":"core/common_tasks/ase_dataset_creation.md"},{"file":"core/common_tasks/training.md"},{"file":"core/common_tasks/evaluation.md"},{"file":"core/common_tasks/fine_tuning.md"},{"file":"core/common_tasks/workflows.md"},{"file":"core/uma_faq.md"}],"file":"core/common_tasks/summary.md"},{"children":[{"file":"uma_tutorials/uma_tutorial.md"},{"file":"uma_tutorials/uma_catalysis_tutorial.md"}],"file":"uma_tutorials/summary.md"},{"file":"core/generative_models.md"}],"title":"AI/ML Models \u0026 Usage"},{"file":"core/fair_chemistry_papers.md"},{"children":[{"children":[{"file":"molecules/datasets/omol25.md"},{"file":"molecules/datasets/omol25_elec.md"},{"file":"molecules/datasets/omc25.md"}],"file":"molecules/datasets/summary.md"},{"file":"molecules/models.md"},{"file":"molecules/leaderboard.md"},{"file":"molecules/FAQ.md"}],"title":"Organic Molecules"},{"children":[{"children":[{"file":"catalysts/datasets/oc20.md"},{"file":"catalysts/datasets/oc20_mads.md"},{"file":"catalysts/datasets/oc22.md"},{"file":"catalysts/datasets/oc20dense.md"},{"file":"catalysts/datasets/oc20neb.md"},{"file":"catalysts/datasets/ocx24.md"},{"file":"catalysts/datasets/oc25.md"}],"file":"catalysts/datasets/summary.md"},{"file":"catalysts/models.md"},{"children":[{"file":"catalysts/examples_tutorials/OCP-introduction.md"},{"file":"catalysts/examples_tutorials/adsorption_energies/adsorption_energies.md"},{"file":"catalysts/examples_tutorials/adsorbml_walkthrough.md"},{"file":"catalysts/examples_tutorials/cattsunami_tutorial.md"},{"file":"catalysts/examples_tutorials/ocpapi.md"}],"file":"catalysts/examples_tutorials/summary.md"},{"file":"catalysts/FAQ.md"},{"url":"https://opencatalystproject.org","title":"OCP Leaderboard"},{"url":"https://open-catalyst.metademolab.com/","title":"OCP Demo (no install required!)"}],"title":"Heterogeneous Catalysis"},{"children":[{"children":[{"file":"inorganic_materials/datasets/omat24.md"}],"file":"inorganic_materials/datasets/summary.md"},{"file":"inorganic_materials/models.md"},{"children":[{"file":"inorganic_materials/examples_tutorials/formation_energy.md"},{"file":"inorganic_materials/examples_tutorials/phonons.md"},{"file":"inorganic_materials/examples_tutorials/elastic.md"}],"file":"inorganic_materials/examples_tutorials/summary.md"},{"file":"inorganic_materials/FAQ.md"}],"title":"Inorganic Materials"},{"children":[{"children":[{"file":"dac/datasets/odac25.md"},{"file":"dac/datasets/odac23.md"}],"file":"dac/datasets/summary.md"},{"file":"dac/models.md"},{"children":[{"file":"dac/examples_tutorials/adsorption_energy.md"}],"file":"dac/examples_tutorials/summary.md"}],"title":"MOFs for Direct Air Capture"},{"children":[{"file":"core/intro_series.md"},{"file":"videos/technical_talks.md"}],"title":"Learn More"}],"thumbnail":"/build/fair_chem_logo_v2-8db274e987822faff08820502b8c23f7.png","index":"index","pages":[{"level":1,"title":"Quickstart"},{"slug":"install","title":"Installation \u0026 License","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"quickstart","title":"UMA Quick Start w/ ASE","description":"","date":"","thumbnail":"/build/catalysis-46d81ff52ef6683423606a40c88cf856.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fairchemv1-v2","title":"fairchem\u003e=2.0","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"title":"UMA Demo","url":"https://facebook-fairchem-uma-demo.hf.space/","level":2},{"level":1,"title":"AI/ML Models \u0026 Usage"},{"slug":"uma","title":"UMA Models","description":"","date":"","thumbnail":"/build/uma-bdcbdfbd6337128d63e4cb5f70d43863.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"intro","title":"GNNs for Chemistry","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"summary","title":"Common Tasks","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"ase-calculator","title":"Inference using ASE and Predictor Interface","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"lammps","title":"LAMMPS Integration","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"batch-inference","title":"Batch Inference with UMA Models","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"inference-batcher","title":"Batched Atomic Simulations with InferenceBatcher","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"ase-dataset-creation","title":"FAIRChem and Custom Datasets","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"training","title":"Training Models from Scratch","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"evaluation","title":"Evaluating Pretrained Models","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"fine-tuning","title":"Fine-tuning","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"workflows","title":"Calculation Workflows with FAIRChem Models","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"uma-faq","title":"UMA FAQ","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"summary-1","title":"UMA Tutorials","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"uma-tutorial","title":"UMA Intro Tutorial","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"uma-catalysis-tutorial","title":"UMA Catalysis Tutorial","description":"","date":"","thumbnail":"/build/vib.0-3108e0682b2bf05fbb952db933022aed.gif","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"generative-models","title":"Generative Models","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fair-chemistry-papers","title":"FAIR Chemistry Papers","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"level":1,"title":"Organic Molecules"},{"slug":"summary-2","title":"Datasets","description":"","date":"","thumbnail":"/build/molecules-0c3863e2a7881b28ef685d7bab791a4b.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"omol25","title":"OMol25","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"omol25-elec","title":"OMol25 Electronic Structures","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"omc25","title":"OMC25","description":"","date":"","thumbnail":"/build/molecular-crystals-c1b430e11ac0b275e001102948aa37b4.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"models","title":"Pretrained models","description":"","date":"","thumbnail":"/build/molecules-0c3863e2a7881b28ef685d7bab791a4b.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"leaderboard","title":"OMol25 Leaderboard","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"faq","title":"FAQ","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Heterogeneous Catalysis"},{"slug":"summary-3","title":"Datasets","description":"","date":"","thumbnail":"/build/catalysis-46d81ff52ef6683423606a40c88cf856.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"oc20","title":"Open Catalyst 2020 (OC20)","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"oc20-mads","title":"Open Catalyst 2020 Multi-Adsorbate (mAds) Dataset","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"oc22","title":"Open Catalyst 2022 (OC22)","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"oc20dense","title":"Open Catalyst 2020 Dense (OC20Dense)","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"oc20neb","title":"Open Catalyst 2020 Nudged Elastic Band (OC20NEB)","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"ocx24","title":"Open Catalyst Experiments 2024 (OCx24): Bridging Experiments and Computational Models","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"oc25","title":"OC25","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"models-1","title":"Pretrained Models","description":"","date":"","thumbnail":"/build/catalysis-46d81ff52ef6683423606a40c88cf856.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"summary-4","title":"Examples \u0026 Tutorials","description":"","date":"","thumbnail":"/build/catalysis-46d81ff52ef6683423606a40c88cf856.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"ocp-introduction","title":"Intro to Adsorption Energies","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"adsorption-energies","title":"Expert Adsorption Energies","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"adsorbml-walkthrough","title":"AdsorbML Tutorial","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"cattsunami-tutorial","title":"Transition State Search (NEBs)","description":"","date":"","thumbnail":"/build/dissociation_scheme-47cce37d377d250edbdf6ecb162d70d1.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"ocpapi","title":"ocpapi","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"faq-1","title":"FAQ","description":"","date":"","thumbnail":"/build/catalysis-46d81ff52ef6683423606a40c88cf856.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"title":"OCP Leaderboard","url":"https://opencatalystproject.org","level":2},{"title":"OCP Demo (no install required!)","url":"https://open-catalyst.metademolab.com/","level":2},{"level":1,"title":"Inorganic Materials"},{"slug":"summary-5","title":"Datasets","description":"","date":"","thumbnail":"/build/inorganic-18a9d87f97ae5338c855175a2b943bdf.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"omat24","title":"OMat24","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"models-2","title":"Pretrained models","description":"","date":"","thumbnail":"/build/inorganic-18a9d87f97ae5338c855175a2b943bdf.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"summary-6","title":"Examples \u0026 Tutorials","description":"","date":"","thumbnail":"/build/inorganic-18a9d87f97ae5338c855175a2b943bdf.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"formation-energy","title":"Formation Energy","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"phonons","title":"Phonon Calculations","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"elastic","title":"Elastic Tensors","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"faq-2","title":"FAQ","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"MOFs for Direct Air Capture"},{"slug":"summary-7","title":"Datasets","description":"","date":"","thumbnail":"/build/mofs-dac-83d34cd34c6bcd547d2dff49ac93510c.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"odac25","title":"ODAC25","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"odac23","title":"Open Direct Air Capture 2023 (ODAC23)","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"models-3","title":"Pretrained models","description":"","date":"","thumbnail":"/build/mofs-dac-83d34cd34c6bcd547d2dff49ac93510c.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"summary-8","title":"Examples \u0026 Tutorials","description":"","date":"","thumbnail":"/build/mofs-dac-83d34cd34c6bcd547d2dff49ac93510c.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"adsorption-energy","title":"Adsorption Energies in MOFs","description":"","date":"","thumbnail":"/build/WOBHEB_flexible-39c59a36534a0b0af95c2a688f1e2b26.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":1,"title":"Learn More"},{"slug":"intro-series","title":"Why model atoms for climate?","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"technical-talks","title":"Technical Presentations","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2}]}]},"CONTENT_CDN_PORT":"3100","MODE":"static"},"routes/$":{"config":{"version":3,"myst":"1.8.0","title":"FAIR Chemistry Documentation","options":{"logo":"/build/fair_chem_logo_v2-8db274e987822faff08820502b8c23f7.png","folders":false},"nav":[{"title":"Quickstart","url":"/quickstart"},{"title":"Docs","url":"/install"},{"title":"Tutorial","url":"/uma-tutorial"},{"title":"Demo","url":"https://facebook-fairchem-uma-demo.hf.space/"},{"title":"Github","url":"https://github.com/facebookresearch/fairchem"},{"title":"Help","children":[{"title":"Ask a question ❓","url":"https://github.com/facebookresearch/fairchem/discussions"},{"title":"Report a bug 🐛","url":"https://github.com/facebookresearch/fairchem/issues"}]}],"actions":[],"projects":[{"bibliography":["/home/runner/work/fairchem/fairchem/docs/references.bib"],"exports":[],"title":"fairchem","authors":[{"nameParsed":{"literal":"FAIR Chemistry \u0026 Collaborators","given":"FAIR Chemistry \u0026","family":"Collaborators"},"name":"FAIR Chemistry \u0026 Collaborators","id":"contributors-myst-generated-uid-0"}],"github":"https://github.com/facebookresearch/fairchem","copyright":"Meta Platforms, Inc","thebe":{"binder":{"url":"https://mybinder.org/","provider":"github","repo":"https://github.com/facebookresearch/fairchem","ref":"HEAD"}},"toc":[{"file":"index.md"},{"children":[{"file":"core/install.md"},{"file":"core/quickstart.md"},{"file":"core/fairchemv1_v2.md"},{"url":"https://facebook-fairchem-uma-demo.hf.space/","title":"UMA Demo"}],"title":"Quickstart"},{"children":[{"file":"core/uma.md"},{"file":"core/intro.md"},{"children":[{"file":"core/common_tasks/ase_calculator.md"},{"file":"core/common_tasks/lammps.md"},{"file":"core/common_tasks/batch_inference.md"},{"file":"core/common_tasks/inference_batcher.md"},{"file":"core/common_tasks/ase_dataset_creation.md"},{"file":"core/common_tasks/training.md"},{"file":"core/common_tasks/evaluation.md"},{"file":"core/common_tasks/fine_tuning.md"},{"file":"core/common_tasks/workflows.md"},{"file":"core/uma_faq.md"}],"file":"core/common_tasks/summary.md"},{"children":[{"file":"uma_tutorials/uma_tutorial.md"},{"file":"uma_tutorials/uma_catalysis_tutorial.md"}],"file":"uma_tutorials/summary.md"},{"file":"core/generative_models.md"}],"title":"AI/ML Models \u0026 Usage"},{"file":"core/fair_chemistry_papers.md"},{"children":[{"children":[{"file":"molecules/datasets/omol25.md"},{"file":"molecules/datasets/omol25_elec.md"},{"file":"molecules/datasets/omc25.md"}],"file":"molecules/datasets/summary.md"},{"file":"molecules/models.md"},{"file":"molecules/leaderboard.md"},{"file":"molecules/FAQ.md"}],"title":"Organic Molecules"},{"children":[{"children":[{"file":"catalysts/datasets/oc20.md"},{"file":"catalysts/datasets/oc20_mads.md"},{"file":"catalysts/datasets/oc22.md"},{"file":"catalysts/datasets/oc20dense.md"},{"file":"catalysts/datasets/oc20neb.md"},{"file":"catalysts/datasets/ocx24.md"},{"file":"catalysts/datasets/oc25.md"}],"file":"catalysts/datasets/summary.md"},{"file":"catalysts/models.md"},{"children":[{"file":"catalysts/examples_tutorials/OCP-introduction.md"},{"file":"catalysts/examples_tutorials/adsorption_energies/adsorption_energies.md"},{"file":"catalysts/examples_tutorials/adsorbml_walkthrough.md"},{"file":"catalysts/examples_tutorials/cattsunami_tutorial.md"},{"file":"catalysts/examples_tutorials/ocpapi.md"}],"file":"catalysts/examples_tutorials/summary.md"},{"file":"catalysts/FAQ.md"},{"url":"https://opencatalystproject.org","title":"OCP Leaderboard"},{"url":"https://open-catalyst.metademolab.com/","title":"OCP Demo (no install required!)"}],"title":"Heterogeneous Catalysis"},{"children":[{"children":[{"file":"inorganic_materials/datasets/omat24.md"}],"file":"inorganic_materials/datasets/summary.md"},{"file":"inorganic_materials/models.md"},{"children":[{"file":"inorganic_materials/examples_tutorials/formation_energy.md"},{"file":"inorganic_materials/examples_tutorials/phonons.md"},{"file":"inorganic_materials/examples_tutorials/elastic.md"}],"file":"inorganic_materials/examples_tutorials/summary.md"},{"file":"inorganic_materials/FAQ.md"}],"title":"Inorganic Materials"},{"children":[{"children":[{"file":"dac/datasets/odac25.md"},{"file":"dac/datasets/odac23.md"}],"file":"dac/datasets/summary.md"},{"file":"dac/models.md"},{"children":[{"file":"dac/examples_tutorials/adsorption_energy.md"}],"file":"dac/examples_tutorials/summary.md"}],"title":"MOFs for Direct Air Capture"},{"children":[{"file":"core/intro_series.md"},{"file":"videos/technical_talks.md"}],"title":"Learn More"}],"thumbnail":"/build/fair_chem_logo_v2-8db274e987822faff08820502b8c23f7.png","index":"index","pages":[{"level":1,"title":"Quickstart"},{"slug":"install","title":"Installation \u0026 License","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"quickstart","title":"UMA Quick Start w/ ASE","description":"","date":"","thumbnail":"/build/catalysis-46d81ff52ef6683423606a40c88cf856.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fairchemv1-v2","title":"fairchem\u003e=2.0","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"title":"UMA Demo","url":"https://facebook-fairchem-uma-demo.hf.space/","level":2},{"level":1,"title":"AI/ML Models \u0026 Usage"},{"slug":"uma","title":"UMA Models","description":"","date":"","thumbnail":"/build/uma-bdcbdfbd6337128d63e4cb5f70d43863.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"intro","title":"GNNs for Chemistry","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"summary","title":"Common Tasks","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"ase-calculator","title":"Inference using ASE and Predictor Interface","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"lammps","title":"LAMMPS Integration","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"batch-inference","title":"Batch Inference with UMA Models","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"inference-batcher","title":"Batched Atomic Simulations with InferenceBatcher","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"ase-dataset-creation","title":"FAIRChem and Custom Datasets","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"training","title":"Training Models from Scratch","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"evaluation","title":"Evaluating Pretrained Models","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"fine-tuning","title":"Fine-tuning","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"workflows","title":"Calculation Workflows with FAIRChem Models","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"uma-faq","title":"UMA FAQ","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"summary-1","title":"UMA Tutorials","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"uma-tutorial","title":"UMA Intro Tutorial","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"uma-catalysis-tutorial","title":"UMA Catalysis Tutorial","description":"","date":"","thumbnail":"/build/vib.0-3108e0682b2bf05fbb952db933022aed.gif","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"generative-models","title":"Generative Models","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fair-chemistry-papers","title":"FAIR Chemistry Papers","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"level":1,"title":"Organic Molecules"},{"slug":"summary-2","title":"Datasets","description":"","date":"","thumbnail":"/build/molecules-0c3863e2a7881b28ef685d7bab791a4b.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"omol25","title":"OMol25","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"omol25-elec","title":"OMol25 Electronic Structures","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"omc25","title":"OMC25","description":"","date":"","thumbnail":"/build/molecular-crystals-c1b430e11ac0b275e001102948aa37b4.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"models","title":"Pretrained models","description":"","date":"","thumbnail":"/build/molecules-0c3863e2a7881b28ef685d7bab791a4b.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"leaderboard","title":"OMol25 Leaderboard","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"faq","title":"FAQ","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Heterogeneous Catalysis"},{"slug":"summary-3","title":"Datasets","description":"","date":"","thumbnail":"/build/catalysis-46d81ff52ef6683423606a40c88cf856.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"oc20","title":"Open Catalyst 2020 (OC20)","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"oc20-mads","title":"Open Catalyst 2020 Multi-Adsorbate (mAds) Dataset","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"oc22","title":"Open Catalyst 2022 (OC22)","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"oc20dense","title":"Open Catalyst 2020 Dense (OC20Dense)","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"oc20neb","title":"Open Catalyst 2020 Nudged Elastic Band (OC20NEB)","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"ocx24","title":"Open Catalyst Experiments 2024 (OCx24): Bridging Experiments and Computational Models","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"oc25","title":"OC25","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"models-1","title":"Pretrained Models","description":"","date":"","thumbnail":"/build/catalysis-46d81ff52ef6683423606a40c88cf856.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"summary-4","title":"Examples \u0026 Tutorials","description":"","date":"","thumbnail":"/build/catalysis-46d81ff52ef6683423606a40c88cf856.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"ocp-introduction","title":"Intro to Adsorption Energies","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"adsorption-energies","title":"Expert Adsorption Energies","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"adsorbml-walkthrough","title":"AdsorbML Tutorial","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"cattsunami-tutorial","title":"Transition State Search (NEBs)","description":"","date":"","thumbnail":"/build/dissociation_scheme-47cce37d377d250edbdf6ecb162d70d1.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"ocpapi","title":"ocpapi","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"faq-1","title":"FAQ","description":"","date":"","thumbnail":"/build/catalysis-46d81ff52ef6683423606a40c88cf856.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"title":"OCP Leaderboard","url":"https://opencatalystproject.org","level":2},{"title":"OCP Demo (no install required!)","url":"https://open-catalyst.metademolab.com/","level":2},{"level":1,"title":"Inorganic Materials"},{"slug":"summary-5","title":"Datasets","description":"","date":"","thumbnail":"/build/inorganic-18a9d87f97ae5338c855175a2b943bdf.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"omat24","title":"OMat24","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"models-2","title":"Pretrained models","description":"","date":"","thumbnail":"/build/inorganic-18a9d87f97ae5338c855175a2b943bdf.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"summary-6","title":"Examples \u0026 Tutorials","description":"","date":"","thumbnail":"/build/inorganic-18a9d87f97ae5338c855175a2b943bdf.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"formation-energy","title":"Formation Energy","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"phonons","title":"Phonon Calculations","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"elastic","title":"Elastic Tensors","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"faq-2","title":"FAQ","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"MOFs for Direct Air Capture"},{"slug":"summary-7","title":"Datasets","description":"","date":"","thumbnail":"/build/mofs-dac-83d34cd34c6bcd547d2dff49ac93510c.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"odac25","title":"ODAC25","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"odac23","title":"Open Direct Air Capture 2023 (ODAC23)","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"models-3","title":"Pretrained models","description":"","date":"","thumbnail":"/build/mofs-dac-83d34cd34c6bcd547d2dff49ac93510c.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"summary-8","title":"Examples \u0026 Tutorials","description":"","date":"","thumbnail":"/build/mofs-dac-83d34cd34c6bcd547d2dff49ac93510c.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"adsorption-energy","title":"Adsorption Energies in MOFs","description":"","date":"","thumbnail":"/build/WOBHEB_flexible-39c59a36534a0b0af95c2a688f1e2b26.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":1,"title":"Learn More"},{"slug":"intro-series","title":"Why model atoms for climate?","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"technical-talks","title":"Technical Presentations","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2}]}]},"page":{"version":3,"kind":"Notebook","sha256":"afed20e7b8fa90486102f8501b9e2aa28ca1c44c81314b39cc9d421e9f1cb844","slug":"uma-catalysis-tutorial","location":"/uma_tutorials/uma_catalysis_tutorial.md","dependencies":[],"frontmatter":{"title":"UMA Catalysis Tutorial","kernelspec":{"name":"python3","display_name":"Python 3 (ipykernel)","language":"python"},"jupytext":{"formats":"ipynb,md:myst","text_representation":{"extension":".md","format_name":"myst","format_version":"0.13","jupytext_version":"1.18.1"}},"content_includes_title":false,"authors":[{"nameParsed":{"literal":"FAIR Chemistry \u0026 Collaborators","given":"FAIR Chemistry \u0026","family":"Collaborators"},"name":"FAIR Chemistry \u0026 Collaborators","id":"contributors-myst-generated-uid-0"}],"github":"https://github.com/facebookresearch/fairchem","copyright":"Meta Platforms, Inc","numbering":{"title":{"offset":2}},"source_url":"https://github.com/facebookresearch/fairchem/blob/main/docs/uma_tutorials/uma_catalysis_tutorial.md","edit_url":"https://github.com/facebookresearch/fairchem/edit/main/docs/uma_tutorials/uma_catalysis_tutorial.md","thumbnail":"/build/vib.0-3108e0682b2bf05fbb952db933022aed.gif","exports":[{"format":"md","filename":"uma_catalysis_tutorial.md","url":"/build/uma_catalysis_tutori-d7bbb03a65fbb24ecadfb45df5064cf0.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"Author: Zack Ulissi (Meta, CMU), with help from AI coding agents / LLMs","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"XnjDarZ4uo"}],"key":"ojDjEqtDeR"},{"type":"paragraph","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"Original paper: Bjarne Kreitz et al. JPCC (2021)","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"v8VpPVMx6P"}],"key":"Pznt58O3AM"},{"type":"heading","depth":2,"position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"Overview","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"BmtP5IB4OS"}],"identifier":"overview","label":"Overview","html_id":"overview","implicit":true,"key":"pDBrUCGffL"},{"type":"paragraph","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"This tutorial demonstrates how to use the Universal Model for Atoms (UMA) machine learning potential to perform comprehensive catalyst surface analysis. We replicate key computational workflows from ","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"BjP7Kx7GF6"},{"type":"cite","url":"https://pubs.acs.org/doi/10.1021/acs.jpcc.0c09985","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"“Microkinetic Modeling of CO₂ Desorption from Supported Multifaceted Ni Catalysts”","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"vutfF4FNZ9"}],"kind":"narrative","label":"Kreitz_2021","identifier":"https://pubs.acs.org/doi/10.1021/acs.jpcc.0c09985","enumerator":"1","key":"Ck5yMd79Uy"},{"type":"text","value":" by Bjarne Kreitz (now faculty at Georgia Tech!), showing how ML potentials can accelerate computational catalysis research.","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"CaRXSPZZZx"}],"key":"Mhlcy91Nd4"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Learning Objectives","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"UsGfHK7QeJ"}],"key":"FWz7wUFDw7"},{"type":"paragraph","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"text","value":"By the end of this tutorial, you will be able to:","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"mS3vjpAX74"}],"key":"IgXRncFSSR"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":30,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Optimize bulk crystal structures and extract lattice constants","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"RcUABf6EYp"}],"key":"hpNeIdkWRd"}],"key":"agKeEB3Sdx"},{"type":"listItem","spread":true,"position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Calculate surface energies using linear extrapolation methods","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"RdSubwrwV5"}],"key":"kFN3taKuuW"}],"key":"Vd9j5Hqlsu"},{"type":"listItem","spread":true,"position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Construct Wulff shapes to predict nanoparticle morphologies","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"L1bWzspP4h"}],"key":"vqNOSAuiJN"}],"key":"DjpeEqYPl3"},{"type":"listItem","spread":true,"position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Compute adsorption energies with zero-point energy corrections","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"B9nWRBrBPv"}],"key":"tHHrsY6MGe"}],"key":"Pfs9GrhqO7"},{"type":"listItem","spread":true,"position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Study coverage-dependent binding phenomena","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"qA0gsHyPGD"}],"key":"FfFnHIjWGq"}],"key":"cAamP2cSEp"},{"type":"listItem","spread":true,"position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Calculate reaction barriers using the nudged elastic band (NEB) method","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"MehcEclo1x"}],"key":"iBN1VvYh5v"}],"key":"j4zydkywMh"},{"type":"listItem","spread":true,"position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Apply D3 dispersion corrections to improve accuracy","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"wxwdPuNbG1"}],"key":"Fxh8uvO3aX"}],"key":"mph9pRdOLP"}],"key":"Uuw1nMwcAL"}],"class":"note","key":"kRuMpNR9Ux"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"About UMA-S-1P1","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"key":"I3v0Qc7nDU"}],"key":"m4nEUC1Mik"},{"type":"paragraph","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"key":"qcK5obvNRc"},{"type":"strong","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"children":[{"type":"text","value":"UMA-S-1P1","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"key":"eW94jU3Lev"}],"key":"zEgfpdJ6co"},{"type":"text","value":" model is a state-of-the-art universal machine learning potential trained on the OMat24, OC20, OMol25, ODAC23, and OMC25 datasets, covering diverse materials and surface chemistries. It provides ~1000× speedup over DFT while maintaining reasonable accuracy for screening studies. Here we’ll use the UMA-s-1p1 checkpoint which is the small (=faster) 1.1 version released in June. The UMA-s-1p1 checkpoint is open science with a lightweight license that users have to agree to through Huggingface.","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"key":"nwpelC2DgJ"}],"key":"vt2ygourZv"},{"type":"paragraph","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"children":[{"type":"text","value":"You can read more about the UMA models here: ","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"key":"w5XPpx6kjd"},{"type":"link","url":"https://arxiv.org/abs/2506.23971","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"children":[{"type":"text","value":"https://​arxiv​.org​/abs​/2506​.23971","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"key":"VNLHXgE0Nu"}],"urlSource":"https://arxiv.org/abs/2506.23971","key":"i2zUeUSQZp"}],"key":"oTBS7fddHA"}],"class":"tip","key":"uSEySyj6ao"},{"type":"heading","depth":2,"position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"children":[{"type":"text","value":"Installation and Setup","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"key":"m3AelnzMd8"}],"identifier":"installation-and-setup","label":"Installation and Setup","html_id":"installation-and-setup","implicit":true,"key":"Z2CUFHNBci"},{"type":"paragraph","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"children":[{"type":"text","value":"This tutorial uses a number of helpful open source packages:","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"key":"zBniCDrBrd"}],"key":"hMTTZXfX6o"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":50,"column":1},"end":{"line":57,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"ase","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"e9nLkzGlS7"},{"type":"text","value":" - Atomic Simulation Environment","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"J3AFDzRssV"}],"key":"kaCRKyy23D"}],"key":"IOIfLctCir"},{"type":"listItem","spread":true,"position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"fairchem","position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"key":"RwoNd077lz"},{"type":"text","value":" - FAIR Chemistry ML potentials (formerly OCP)","position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"key":"jFX1VXB7CI"}],"key":"xh76oNw3xz"}],"key":"CBbftFS5Eg"},{"type":"listItem","spread":true,"position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"pymatgen","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"key":"yi25xMh7Aw"},{"type":"text","value":" - Materials analysis","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"key":"IWrq0d6h6b"}],"key":"ErB1d2lY0I"}],"key":"lfNcRSFk2I"},{"type":"listItem","spread":true,"position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"matplotlib","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"KLpKf60U9z"},{"type":"text","value":" - Visualization","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"TqsPUKBe8v"}],"key":"MqaLOOBdJU"}],"key":"Hi4kbK5nzJ"},{"type":"listItem","spread":true,"position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"numpy","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"key":"O9eZMwnYu4"},{"type":"text","value":" - Numerical computing","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"key":"wb92cxtH2j"}],"key":"Eo0CxduPqW"}],"key":"rxGvYn4N5l"},{"type":"listItem","spread":true,"position":{"start":{"line":55,"column":1},"end":{"line":57,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"torch-dftd","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"key":"Qtq3eDzR21"},{"type":"text","value":" - Dispersion corrections\namong many others!","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"key":"mL46OUeim2"}],"key":"LktfAPUK5A"}],"key":"fk9qxxekou"}],"key":"IXMO7sbS3F"},{"type":"heading","depth":3,"position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"children":[{"type":"text","value":"Huggingface setups","position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"key":"xjVrMTEDSQ"}],"identifier":"huggingface-setups","label":"Huggingface setups","html_id":"huggingface-setups","implicit":true,"key":"mWfkifOptU"},{"type":"paragraph","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"children":[{"type":"text","value":"You need to get a HuggingFace account and request access to the UMA models.","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"key":"JLtwfbZ3Dp"}],"key":"cLts4mYO5v"},{"type":"paragraph","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"children":[{"type":"text","value":"You need a Huggingface account, request access to ","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"key":"ELLW9ypm9Q"},{"type":"link","url":"https://huggingface.co/facebook/UMA","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"children":[{"type":"text","value":"https://​huggingface​.co​/facebook​/UMA","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"key":"rIHlFUVrzM"}],"urlSource":"https://huggingface.co/facebook/UMA","key":"g1jPDbweYx"},{"type":"text","value":", and to create a Huggingface token at ","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"key":"CcfX2b0AzS"},{"type":"link","url":"https://huggingface.co/settings/tokens/","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"children":[{"type":"text","value":"https://​huggingface​.co​/settings​/tokens/","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"key":"fNWvlQIGPn"}],"urlSource":"https://huggingface.co/settings/tokens/","key":"nk4vxRDhWu"},{"type":"text","value":" with these permission:","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"key":"r5PASzLFHs"}],"key":"si93MKMnNN"},{"type":"paragraph","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"children":[{"type":"text","value":"Permissions: Read access to contents of all public gated repos you can access","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"key":"MVhb89QLLJ"}],"key":"JKTnTEVsu0"},{"type":"paragraph","position":{"start":{"line":66,"column":1},"end":{"line":66,"column":1}},"children":[{"type":"text","value":"Then, add the token as an environment variable using ","position":{"start":{"line":66,"column":1},"end":{"line":66,"column":1}},"key":"LlFK7fIyyS"},{"type":"inlineCode","value":"huggingface-cli login","position":{"start":{"line":66,"column":1},"end":{"line":66,"column":1}},"key":"UJmspuiWcb"},{"type":"text","value":":","position":{"start":{"line":66,"column":1},"end":{"line":66,"column":1}},"key":"BtIq69AhnD"}],"key":"sxkG37llxy"}],"key":"Z0Ee1bpOD8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Enter token via huggingface-cli\n! huggingface-cli login","visibility":"show","key":"FJX2D1Gt5k"},{"type":"outputs","id":"0oqr4OZurOYp2N8Wj5ffW","children":[],"visibility":"show","key":"nsQIQSYDpd"}],"data":{"tags":["skip-execution"]},"visibility":"show","key":"Op44Pg6p0A"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"children":[{"type":"text","value":"or you can set the token via HF_TOKEN variable:","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"Xn6zddBXpn"}],"key":"CC7SyDzW0t"}],"key":"fcEL4EbiNR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Set token via env variable\nimport os\n\nos.environ[\"HF_TOKEN\"] = \"MYTOKEN\"","visibility":"show","key":"zFYHIKGevt"},{"type":"outputs","id":"GgkOx2yIrYFJkKN9fnKfm","children":[],"visibility":"show","key":"ZntYyrcaeb"}],"data":{"tags":["skip-execution"]},"visibility":"show","key":"SKdsqXtCn3"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":86,"column":1},"end":{"line":86,"column":1}},"children":[{"type":"text","value":"FAIR Chemistry (UMA) installation","position":{"start":{"line":86,"column":1},"end":{"line":86,"column":1}},"key":"tegIilllSE"}],"identifier":"fair-chemistry-uma-installation","label":"FAIR Chemistry (UMA) installation","html_id":"fair-chemistry-uma-installation","implicit":true,"key":"Henjo2l2z7"},{"type":"paragraph","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"children":[{"type":"text","value":"It may be enough to use ","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"key":"d1Uc0nXddU"},{"type":"inlineCode","value":"pip install fairchem-core","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"key":"hhGX8cbjig"},{"type":"text","value":". This gets you the latest version on PyPi (","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"key":"BhOYSd6wU9"},{"type":"link","url":"https://pypi.org/project/fairchem-core/","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"children":[{"type":"text","value":"https://​pypi​.org​/project​/fairchem​-core/","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"key":"nOxz0pNX4v"}],"urlSource":"https://pypi.org/project/fairchem-core/","key":"CmfqAowU1w"},{"type":"text","value":")","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"key":"sjJC4Aifel"}],"key":"V4mUQzxmtz"},{"type":"paragraph","position":{"start":{"line":90,"column":1},"end":{"line":90,"column":1}},"children":[{"type":"text","value":"Here we install some sub-packages. This can take 2-5 minutes to run.","position":{"start":{"line":90,"column":1},"end":{"line":90,"column":1}},"key":"hkirT37QQA"}],"key":"g7fUyBQbfg"}],"key":"tT0xwsiNEM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"! pip install fairchem-core[docs] fairchem-data-oc fairchem-applications-cattsunami x3dase","visibility":"show","key":"jMJQnYdJdh"},{"type":"outputs","id":"IkW-O-4gFyfh5EgFWNyhX","children":[],"visibility":"show","key":"I9bGemwbzD"}],"data":{"tags":["skip-execution"]},"visibility":"show","key":"J7G9RVlqkj"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Check that packages are installed\n!pip list | grep fairchem","key":"X9asC95eeG"},{"type":"outputs","id":"4RLHTNUOqYbeAwXZrGg_Y","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"fairchem-applications-cattsunami   1.1.2.dev169+g4ae8d4a0\r\nfairchem-core                      2.14.0\r\nfairchem-data-oc                   1.0.3.dev169+g4ae8d4a0\r\nfairchem-data-omat                 0.2.1.dev74+g4ae8d4a0\r\n"},"key":"gw9NNjsrCf"}],"key":"rVCykDWF0G"}],"key":"Nre8gT3gGb"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import fairchem.core\n\nfairchem.core.__version__","key":"WVaOPh0dLE"},{"type":"outputs","id":"ELv91ma6oFh3K_7bHr8DA","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"execute_result","execution_count":2,"metadata":{},"data":{"text/plain":{"content":"'2.14.0'","content_type":"text/plain"}}},"key":"hOMLgOfTp3"}],"key":"detK8h1Udj"}],"key":"elDRUWyA37"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"children":[{"type":"text","value":"Package imports","position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"key":"MJugw9eJzm"}],"identifier":"package-imports","label":"Package imports","html_id":"package-imports","implicit":true,"key":"X867H2Zi6p"},{"type":"paragraph","position":{"start":{"line":111,"column":1},"end":{"line":111,"column":1}},"children":[{"type":"text","value":"First, let’s import all necessary libraries and initialize the UMA-S-1P1 predictor:","position":{"start":{"line":111,"column":1},"end":{"line":111,"column":1}},"key":"UpIDp01Y7x"}],"key":"FKs4IYQa0Z"}],"key":"Usrpfq3AcW"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from pathlib import Path\n\nimport ase.io\nimport matplotlib.pyplot as plt\nimport numpy as np\nfrom ase import Atoms\nfrom ase.build import bulk\nfrom ase.constraints import FixBondLengths\nfrom ase.io import write\nfrom ase.mep import interpolate\nfrom ase.mep.dyneb import DyNEB\nfrom ase.optimize import FIRE, LBFGS\nfrom ase.vibrations import Vibrations\nfrom ase.visualize import view\nfrom fairchem.core import FAIRChemCalculator, pretrained_mlip\nfrom fairchem.data.oc.core import (\n    Adsorbate,\n    AdsorbateSlabConfig,\n    Bulk,\n    MultipleAdsorbateSlabConfig,\n    Slab,\n)\nfrom pymatgen.analysis.wulff import WulffShape\nfrom pymatgen.core import Lattice, Structure\nfrom pymatgen.core.surface import SlabGenerator\nfrom pymatgen.io.ase import AseAtomsAdaptor\nfrom torch_dftd.torch_dftd3_calculator import TorchDFTD3Calculator\n\n# Set up output directory structure\noutput_dir = Path(\"ni_tutorial_results\")\noutput_dir.mkdir(exist_ok=True)\n\n# Create subdirectories for each part\npart_dirs = {\n    \"part1\": \"part1-bulk-optimization\",\n    \"part2\": \"part2-surface-energies\",\n    \"part3\": \"part3-wulff-construction\",\n    \"part4\": \"part4-h-adsorption\",\n    \"part5\": \"part5-coverage-dependence\",\n    \"part6\": \"part6-co-dissociation\",\n}\n\nfor key, dirname in part_dirs.items():\n    (output_dir / dirname).mkdir(exist_ok=True)\n\n# Create subdirectories for different facets in part2\nfor facet in [\"111\", \"100\", \"110\", \"211\"]:\n    (output_dir / part_dirs[\"part2\"] / f\"ni{facet}\").mkdir(exist_ok=True)\n\n# Initialize the UMA-S-1P1 predictor\nprint(\"\\nLoading UMA-S-1P1 model...\")\npredictor = pretrained_mlip.get_predict_unit(\"uma-s-1p1\")\nprint(\"✓ Model loaded successfully!\")","key":"WCFRMjiGva"},{"type":"outputs","id":"a1mIlzDH721yLUU2WS7jd","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"\nLoading UMA-S-1P1 model...\n"},"key":"eG2peD6oBW"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"WARNING:root:device was not explicitly set, using device='cuda'.\n"},"key":"JgtFXb7X5d"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"✓ Model loaded successfully!\n"},"key":"mCaoVCd9eS"}],"key":"kU4wiJCvSa"}],"key":"LEzv0AXVHZ"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":169,"column":1},"end":{"line":169,"column":1}},"children":[{"type":"text","value":"It is somewhat time consuming to run this. We’re going to use a small number of bulks for the testing of this documentation, but otherwise run all of the results for the actual documentation.","position":{"start":{"line":169,"column":1},"end":{"line":169,"column":1}},"key":"XpEeQ8qo1h"}],"key":"uGh9Expr4h"}],"key":"V0AxADIWJk"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import os\n\nfast_docs = os.environ.get(\"FAST_DOCS\", \"false\").lower() == \"true\"\nif fast_docs:\n    num_sites = 2\n    relaxation_steps = 20\nelse:\n    num_sites = 5\n    relaxation_steps = 300","key":"VreFvG2caa"},{"type":"outputs","id":"vEEgBnR92s5HyH4X3QAw5","children":[],"key":"x7WAatWfJI"}],"key":"eaxh4bAMAB"},{"type":"block","children":[{"type":"thematicBreak","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"key":"wAXxhyaXMH"},{"type":"heading","depth":2,"position":{"start":{"line":185,"column":1},"end":{"line":185,"column":1}},"children":[{"type":"text","value":"Part 1: Bulk Crystal Optimization","position":{"start":{"line":185,"column":1},"end":{"line":185,"column":1}},"key":"vXMUmmGv2s"}],"identifier":"part-1-bulk-crystal-optimization","label":"Part 1: Bulk Crystal Optimization","html_id":"part-1-bulk-crystal-optimization","implicit":true,"key":"yrektkLkl2"},{"type":"heading","depth":3,"position":{"start":{"line":187,"column":1},"end":{"line":187,"column":1}},"children":[{"type":"text","value":"Introduction","position":{"start":{"line":187,"column":1},"end":{"line":187,"column":1}},"key":"TCNePnbria"}],"identifier":"introduction","label":"Introduction","html_id":"introduction","implicit":true,"key":"tpOKSsrlc1"},{"type":"paragraph","position":{"start":{"line":189,"column":1},"end":{"line":189,"column":1}},"children":[{"type":"text","value":"Before studying surfaces, we need to determine the equilibrium lattice constant of bulk Ni. This is crucial because surface energies and adsorbate binding depend strongly on the underlying lattice parameter.","position":{"start":{"line":189,"column":1},"end":{"line":189,"column":1}},"key":"LHVHocYpoV"}],"key":"l2GQFOAEQs"},{"type":"heading","depth":3,"position":{"start":{"line":191,"column":1},"end":{"line":191,"column":1}},"children":[{"type":"text","value":"Theory","position":{"start":{"line":191,"column":1},"end":{"line":191,"column":1}},"key":"wfJ1DIs2wZ"}],"identifier":"theory","label":"Theory","html_id":"theory","implicit":true,"key":"bQLbNLJUL5"},{"type":"paragraph","position":{"start":{"line":193,"column":1},"end":{"line":193,"column":1}},"children":[{"type":"text","value":"For FCC metals like Ni, the lattice constant ","position":{"start":{"line":193,"column":1},"end":{"line":193,"column":1}},"key":"HOHNYp0vqN"},{"type":"strong","position":{"start":{"line":193,"column":1},"end":{"line":193,"column":1}},"children":[{"type":"text","value":"a","position":{"start":{"line":193,"column":1},"end":{"line":193,"column":1}},"key":"loK7XVzFsm"}],"key":"og3OSpxgYR"},{"type":"text","value":" defines the unit cell size. The experimental value for Ni is ","position":{"start":{"line":193,"column":1},"end":{"line":193,"column":1}},"key":"KS6kdA9iNp"},{"type":"strong","position":{"start":{"line":193,"column":1},"end":{"line":193,"column":1}},"children":[{"type":"text","value":"a = 3.524 Å","position":{"start":{"line":193,"column":1},"end":{"line":193,"column":1}},"key":"joY5HCDkCc"}],"key":"QkNlslueue"},{"type":"text","value":" at room temperature. We’ll optimize both atomic positions and the cell volume to find the ML potential’s equilibrium structure.","position":{"start":{"line":193,"column":1},"end":{"line":193,"column":1}},"key":"Pc9D3HpqMZ"}],"key":"ZbhyxFtIwL"}],"key":"XAsl79CPsn"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Create initial FCC Ni structure\na_initial = 3.52  # Å, close to experimental\nni_bulk = bulk(\"Ni\", \"fcc\", a=a_initial, cubic=True)\n\nprint(f\"Initial lattice constant: {a_initial:.2f} Å\")\nprint(f\"Number of atoms: {len(ni_bulk)}\")\n\n# Set up calculator for bulk optimization\ncalc = FAIRChemCalculator(predictor, task_name=\"omat\")\nni_bulk.calc = calc\n\n# Use ExpCellFilter to allow cell relaxation\nfrom ase.filters import ExpCellFilter\n\necf = ExpCellFilter(ni_bulk)\n\n# Optimize with LBFGS\nopt = LBFGS(\n    ecf,\n    trajectory=str(output_dir / part_dirs[\"part1\"] / \"ni_bulk_opt.traj\"),\n    logfile=str(output_dir / part_dirs[\"part1\"] / \"ni_bulk_opt.log\"),\n)\nopt.run(fmax=0.05, steps=relaxation_steps)\n\n# Extract results\ncell = ni_bulk.get_cell()\na_optimized = cell[0, 0]\na_exp = 3.524  # Experimental value\nerror = abs(a_optimized - a_exp) / a_exp * 100\n\nprint(f\"\\n{'='*50}\")\nprint(f\"Experimental lattice constant: {a_exp:.2f} Å\")\nprint(f\"Optimized lattice constant:    {a_optimized:.2f} Å\")\nprint(f\"Relative error:                {error:.2f}%\")\nprint(f\"{'='*50}\")\n\nase.io.write(str(output_dir / part_dirs[\"part1\"] / \"ni_bulk_relaxed.cif\"), ni_bulk)\n\n# Store results for later use\na_opt = a_optimized","key":"D255sbjxwc"},{"type":"outputs","id":"c5MXmFtv7qllcyb8BCZ6p","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Initial lattice constant: 3.52 Å\nNumber of atoms: 4\n"},"key":"ZsKXvWpdHo"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"/tmp/ipykernel_9713/3959847705.py:15: DeprecationWarning: Use FrechetCellFilter for better convergence w.r.t. cell variables.\n  ecf = ExpCellFilter(ni_bulk)\n"},"key":"UmsHThEh30"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"\n==================================================\nExperimental lattice constant: 3.52 Å\nOptimized lattice constant:    3.52 Å\nRelative error:                0.25%\n==================================================\n"},"key":"tIf7d1tYv8"}],"key":"Q5XHKUH2J8"}],"key":"SkWO6ci3A3"},{"type":"block","children":[{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Missing UMA access?","position":{"start":{"line":238,"column":1},"end":{"line":238,"column":1}},"key":"l8xa4VvTXY"}],"key":"eTRkiriNwp"},{"type":"paragraph","position":{"start":{"line":241,"column":1},"end":{"line":241,"column":1}},"children":[{"type":"text","value":"Don’t have access to UMA yet? You can still explore this calculation!","position":{"start":{"line":241,"column":1},"end":{"line":241,"column":1}},"key":"oZbRdwiyh4"}],"key":"x91ex33zwt"},{"type":"paragraph","position":{"start":{"line":243,"column":1},"end":{"line":243,"column":1}},"children":[{"type":"link","url":"example_configs/ni_bulk.xyz","position":{"start":{"line":243,"column":1},"end":{"line":243,"column":1}},"children":[{"type":"text","value":"Download example Ni bulk structure","position":{"start":{"line":243,"column":1},"end":{"line":243,"column":1}},"key":"E9Y3iFXkRg"}],"urlSource":"example_configs/ni_bulk.xyz","key":"NixYHjLxQF"},{"type":"text","value":" and test it in the ","position":{"start":{"line":243,"column":1},"end":{"line":243,"column":1}},"key":"G1YSAzXKSq"},{"type":"link","url":"https://facebook-fairchem-uma-demo.hf.space/","position":{"start":{"line":243,"column":1},"end":{"line":243,"column":1}},"children":[{"type":"text","value":"UMA demo (no login required)","position":{"start":{"line":243,"column":1},"end":{"line":243,"column":1}},"key":"vKONcqPYIc"}],"urlSource":"https://facebook-fairchem-uma-demo.hf.space/","key":"WAhPXyHGVN"},{"type":"text","value":" to see how the model predicts properties for bulk Ni.","position":{"start":{"line":243,"column":1},"end":{"line":243,"column":1}},"key":"jdxGnhgsZB"}],"key":"jq5EV5WAFQ"}],"class":"dropdown, tip","key":"FxznzT0P2V"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Understanding the Results","position":{"start":{"line":246,"column":1},"end":{"line":246,"column":1}},"key":"QE1dEBOJtU"}],"key":"NJ7oeJHAni"},{"type":"paragraph","position":{"start":{"line":249,"column":1},"end":{"line":249,"column":1}},"children":[{"type":"text","value":"UMA-s-1p1 using the ","position":{"start":{"line":249,"column":1},"end":{"line":249,"column":1}},"key":"kiMTebZte6"},{"type":"inlineCode","value":"omat","position":{"start":{"line":249,"column":1},"end":{"line":249,"column":1}},"key":"UDqjgi7B1u"},{"type":"text","value":" task name will predict lattice constants at the PBE level of DFT. For metals, PBE typically predicts lattice constants within 1-2% of experimental values.","position":{"start":{"line":249,"column":1},"end":{"line":249,"column":1}},"key":"dkrd34AV4k"}],"key":"XvJ1p72Jha"},{"type":"paragraph","position":{"start":{"line":251,"column":1},"end":{"line":251,"column":1}},"children":[{"type":"text","value":"Small discrepancies arise from:","position":{"start":{"line":251,"column":1},"end":{"line":251,"column":1}},"key":"Ab0EpqU8C5"}],"key":"idV0GHPi8v"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":252,"column":1},"end":{"line":255,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":252,"column":1},"end":{"line":252,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Training data biases (if your structure is far from OMAT24)","position":{"start":{"line":252,"column":1},"end":{"line":252,"column":1}},"key":"oLzSPTzcgx"}],"key":"PPpMqSqEGe"}],"key":"K9CJUgRcSf"},{"type":"listItem","spread":true,"position":{"start":{"line":253,"column":1},"end":{"line":253,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Temperature effects (0 K vs room temperature). You can do a quasi-harmonic analysis to include finite temperature effects if desired.","position":{"start":{"line":253,"column":1},"end":{"line":253,"column":1}},"key":"oeZqngkK47"}],"key":"ym5P7DIXbc"}],"key":"CUsRL46DJG"},{"type":"listItem","spread":true,"position":{"start":{"line":254,"column":1},"end":{"line":255,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Quantum effects not captured by the underlying DFT/PBE simulations","position":{"start":{"line":254,"column":1},"end":{"line":254,"column":1}},"key":"jcL2D595j4"}],"key":"cJKVqnrZGc"}],"key":"sR859Bvab1"}],"key":"Jh06D78leT"},{"type":"paragraph","position":{"start":{"line":256,"column":1},"end":{"line":256,"column":1}},"children":[{"type":"text","value":"For surface calculations, using the ML-optimized lattice constant maintains internal consistency.","position":{"start":{"line":256,"column":1},"end":{"line":256,"column":1}},"key":"nl1WbiN1Vx"}],"key":"wBGtsm1Crd"}],"class":"tip","key":"p02XHZmLhI"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Comparison with Paper","position":{"start":{"line":259,"column":1},"end":{"line":259,"column":1}},"key":"bWmrTijwGE"}],"key":"R4whSPplzA"},{"type":"paragraph","position":{"start":{"line":262,"column":1},"end":{"line":262,"column":1}},"children":[{"type":"strong","position":{"start":{"line":262,"column":1},"end":{"line":262,"column":1}},"children":[{"type":"text","value":"Paper (Table 1):","position":{"start":{"line":262,"column":1},"end":{"line":262,"column":1}},"key":"c6TkZM0eTA"}],"key":"qPKaNU2HMF"},{"type":"text","value":" Ni lattice constant = 3.524 Å (experimental reference)","position":{"start":{"line":262,"column":1},"end":{"line":262,"column":1}},"key":"R35CijCnaz"}],"key":"q5Fl56xIJP"},{"type":"paragraph","position":{"start":{"line":264,"column":1},"end":{"line":264,"column":1}},"children":[{"type":"text","value":"The UMA-S-1P1 model with OMAT provides excellent agreement with experiment, as would be expected for the PBE functional for simple BCC Ni. The underlying calculations for OMat24 and the original results cited in the paper should be very similar (both PBE), so the fact that the results are a little closer to experiment than the original results is within the numerical noise of the ML model.","position":{"start":{"line":264,"column":1},"end":{"line":264,"column":1}},"key":"cB7Bzo2wUC"}],"key":"mK8oH3j3mb"}],"class":"note","key":"EPRjKFlGaF"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Further exploration","position":{"start":{"line":267,"column":1},"end":{"line":267,"column":1}},"key":"PCaXkSmosJ"}],"key":"iALYNKAri7"},{"type":"paragraph","position":{"start":{"line":270,"column":1},"end":{"line":270,"column":1}},"children":[{"type":"text","value":"Try modifying the following parameters and observe the effects:","position":{"start":{"line":270,"column":1},"end":{"line":270,"column":1}},"key":"XGx52dV5xA"}],"key":"kscVBiNRYv"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":272,"column":1},"end":{"line":276,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":272,"column":1},"end":{"line":272,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":272,"column":1},"end":{"line":272,"column":1}},"children":[{"type":"text","value":"Task name","position":{"start":{"line":272,"column":1},"end":{"line":272,"column":1}},"key":"EdPSuLGxiD"}],"key":"qdFJabKeKJ"},{"type":"text","value":": The original paper re-relaxed the structures at the RPBE level of theory before continuing. Try that with the UMA-s-1p1 model (using the oc20 task name) and see if it matters here.","position":{"start":{"line":272,"column":1},"end":{"line":272,"column":1}},"key":"wrcfYr7Thq"}],"key":"CUAOCOk5XW"}],"key":"YwHbDRic1i"},{"type":"listItem","spread":true,"position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"children":[{"type":"text","value":"Initial guess","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"key":"hPjb7X0oz3"}],"key":"zMqGJz8PKl"},{"type":"text","value":": Change ","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"key":"gG3caO0Dh6"},{"type":"inlineCode","value":"a_initial","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"key":"IXcGlRkQMX"},{"type":"text","value":" to 3.0 or 4.0 Å. Does the optimizer still converge to the same value?","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"key":"pnRuZdyV4K"}],"key":"HZV4LPuSpX"}],"key":"ohtjvMzKET"},{"type":"listItem","spread":true,"position":{"start":{"line":274,"column":1},"end":{"line":274,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":274,"column":1},"end":{"line":274,"column":1}},"children":[{"type":"text","value":"Convergence criterion","position":{"start":{"line":274,"column":1},"end":{"line":274,"column":1}},"key":"FbePMkyJV1"}],"key":"RKGvmrBhVP"},{"type":"text","value":": Tighten ","position":{"start":{"line":274,"column":1},"end":{"line":274,"column":1}},"key":"rp2PNSRqzo"},{"type":"inlineCode","value":"fmax","position":{"start":{"line":274,"column":1},"end":{"line":274,"column":1}},"key":"uiyzPBjDCl"},{"type":"text","value":" to 0.01 eV/Å. How many more steps are required?","position":{"start":{"line":274,"column":1},"end":{"line":274,"column":1}},"key":"dAh5d3dzQe"}],"key":"X5BpzBOMn2"}],"key":"IOmUCZnfqU"},{"type":"listItem","spread":true,"position":{"start":{"line":275,"column":1},"end":{"line":275,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":275,"column":1},"end":{"line":275,"column":1}},"children":[{"type":"text","value":"Different metals","position":{"start":{"line":275,"column":1},"end":{"line":275,"column":1}},"key":"we5oqaDcmz"}],"key":"vyHu1nOP4I"},{"type":"text","value":": Replace ","position":{"start":{"line":275,"column":1},"end":{"line":275,"column":1}},"key":"SmYcnTpAH0"},{"type":"inlineCode","value":"\"Ni\"","position":{"start":{"line":275,"column":1},"end":{"line":275,"column":1}},"key":"kPOY5VyVBN"},{"type":"text","value":" with ","position":{"start":{"line":275,"column":1},"end":{"line":275,"column":1}},"key":"zVEh3hVmT7"},{"type":"inlineCode","value":"\"Cu\"","position":{"start":{"line":275,"column":1},"end":{"line":275,"column":1}},"key":"MS3Dqt7xsC"},{"type":"text","value":", ","position":{"start":{"line":275,"column":1},"end":{"line":275,"column":1}},"key":"Eags2Am4iy"},{"type":"inlineCode","value":"\"Pd\"","position":{"start":{"line":275,"column":1},"end":{"line":275,"column":1}},"key":"a7LIdfS31t"},{"type":"text","value":", or ","position":{"start":{"line":275,"column":1},"end":{"line":275,"column":1}},"key":"uocXHQuFL3"},{"type":"inlineCode","value":"\"Pt\"","position":{"start":{"line":275,"column":1},"end":{"line":275,"column":1}},"key":"Yye8seIxA1"},{"type":"text","value":". Compare predicted vs experimental lattice constants.","position":{"start":{"line":275,"column":1},"end":{"line":275,"column":1}},"key":"E65VTuJ7sU"}],"key":"Kn7AgXtcgH"}],"key":"iZdfPACwfg"},{"type":"listItem","spread":true,"position":{"start":{"line":276,"column":1},"end":{"line":276,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":276,"column":1},"end":{"line":276,"column":1}},"children":[{"type":"text","value":"Cell shape","position":{"start":{"line":276,"column":1},"end":{"line":276,"column":1}},"key":"S3Q60Hf4DR"}],"key":"TD77TZ4NxT"},{"type":"text","value":": Remove ","position":{"start":{"line":276,"column":1},"end":{"line":276,"column":1}},"key":"owcBq3iaXW"},{"type":"inlineCode","value":"cubic=True","position":{"start":{"line":276,"column":1},"end":{"line":276,"column":1}},"key":"ZQU6bPB1pA"},{"type":"text","value":" and allow the cell to distort. Does FCC remain stable?","position":{"start":{"line":276,"column":1},"end":{"line":276,"column":1}},"key":"BN974D9Vze"}],"key":"PxrC3xWm1x"}],"key":"E0FPL3WrkF"}],"key":"hKWppdnPH7"}],"class":"seealso","key":"cf66aHR2gp"},{"type":"thematicBreak","position":{"start":{"line":280,"column":1},"end":{"line":280,"column":1}},"key":"J3owkh2mDm"},{"type":"heading","depth":2,"position":{"start":{"line":282,"column":1},"end":{"line":282,"column":1}},"children":[{"type":"text","value":"Part 2: Surface Energy Calculations","position":{"start":{"line":282,"column":1},"end":{"line":282,"column":1}},"key":"NyvkyvCFGc"}],"identifier":"part-2-surface-energy-calculations","label":"Part 2: Surface Energy Calculations","html_id":"part-2-surface-energy-calculations","implicit":true,"key":"zPAavbw1o5"},{"type":"heading","depth":3,"position":{"start":{"line":284,"column":1},"end":{"line":284,"column":1}},"children":[{"type":"text","value":"Introduction","position":{"start":{"line":284,"column":1},"end":{"line":284,"column":1}},"key":"zEg5Qpeq9a"}],"identifier":"introduction","label":"Introduction","html_id":"introduction-1","implicit":true,"key":"ccQVYBsdg3"},{"type":"paragraph","position":{"start":{"line":286,"column":1},"end":{"line":286,"column":1}},"children":[{"type":"text","value":"Surface energy (γ) quantifies the thermodynamic cost of creating a surface. It determines surface stability, morphology, and catalytic activity. We’ll calculate γ for four low-index Ni facets: (111), (100), (110), and (211).","position":{"start":{"line":286,"column":1},"end":{"line":286,"column":1}},"key":"NOAksI2Ixg"}],"key":"TjMwwZZW7F"},{"type":"heading","depth":3,"position":{"start":{"line":288,"column":1},"end":{"line":288,"column":1}},"children":[{"type":"text","value":"Theory","position":{"start":{"line":288,"column":1},"end":{"line":288,"column":1}},"key":"drb3q1pitP"}],"identifier":"theory","label":"Theory","html_id":"theory-1","implicit":true,"key":"Cv8ExJM3vU"},{"type":"paragraph","position":{"start":{"line":290,"column":1},"end":{"line":290,"column":1}},"children":[{"type":"text","value":"The surface energy is defined as:","position":{"start":{"line":290,"column":1},"end":{"line":290,"column":1}},"key":"kFmwvoe52A"}],"key":"wyhj44yHlZ"},{"type":"math","value":"\\gamma = \\frac{E_{\\text{slab}} - N \\cdot E_{\\text{bulk}}}{2A}","position":{"start":{"line":292,"column":1},"end":{"line":294,"column":1}},"html":"\u003cspan class=\"katex-display\"\u003e\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003eγ\u003c/mi\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmfrac\u003e\u003cmrow\u003e\u003cmsub\u003e\u003cmi\u003eE\u003c/mi\u003e\u003cmtext\u003eslab\u003c/mtext\u003e\u003c/msub\u003e\u003cmo\u003e−\u003c/mo\u003e\u003cmi\u003eN\u003c/mi\u003e\u003cmo\u003e⋅\u003c/mo\u003e\u003cmsub\u003e\u003cmi\u003eE\u003c/mi\u003e\u003cmtext\u003ebulk\u003c/mtext\u003e\u003c/msub\u003e\u003c/mrow\u003e\u003cmrow\u003e\u003cmn\u003e2\u003c/mn\u003e\u003cmi\u003eA\u003c/mi\u003e\u003c/mrow\u003e\u003c/mfrac\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\gamma = \\frac{E_{\\text{slab}} - N \\cdot E_{\\text{bulk}}}{2A}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.05556em;\"\u003eγ\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:2.0463em;vertical-align:-0.686em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mopen nulldelimiter\"\u003e\u003c/span\u003e\u003cspan class=\"mfrac\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.3603em;\"\u003e\u003cspan style=\"top:-2.314em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e2\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003eA\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.23em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"frac-line\" style=\"border-bottom-width:0.04em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.677em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.05764em;\"\u003eE\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3361em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord text mtight\"\u003e\u003cspan class=\"mord mtight\"\u003eslab\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e−\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.10903em;\"\u003eN\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e⋅\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.05764em;\"\u003eE\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3361em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord text mtight\"\u003e\u003cspan class=\"mord mtight\"\u003ebulk\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.686em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose nulldelimiter\"\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","enumerator":"1","key":"hlm9gV9BdU"},{"type":"paragraph","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"children":[{"type":"text","value":"where:","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"key":"kDAD5BsFYj"}],"key":"r1pgnxbQ0X"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":297,"column":1},"end":{"line":302,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":297,"column":1},"end":{"line":297,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineMath","value":"E_{\\text{slab}}","position":{"start":{"line":297,"column":1},"end":{"line":297,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsub\u003e\u003cmi\u003eE\u003c/mi\u003e\u003cmtext\u003eslab\u003c/mtext\u003e\u003c/msub\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003eE_{\\text{slab}}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.05764em;\"\u003eE\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3361em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord text mtight\"\u003e\u003cspan class=\"mord mtight\"\u003eslab\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"CW9z6KN1yW"},{"type":"text","value":" = total energy of the slab","position":{"start":{"line":297,"column":1},"end":{"line":297,"column":1}},"key":"mk6o6tPI1B"}],"key":"bf8lo9ZsEU"}],"key":"XDHq9RDmLT"},{"type":"listItem","spread":true,"position":{"start":{"line":298,"column":1},"end":{"line":298,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineMath","value":"N","position":{"start":{"line":298,"column":1},"end":{"line":298,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003eN\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003eN\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6833em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.10903em;\"\u003eN\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"IheUtrWYY2"},{"type":"text","value":" = number of atoms in the slab","position":{"start":{"line":298,"column":1},"end":{"line":298,"column":1}},"key":"svHaEUUjVZ"}],"key":"Yhpk2uMAEG"}],"key":"wg2Dh04C8t"},{"type":"listItem","spread":true,"position":{"start":{"line":299,"column":1},"end":{"line":299,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineMath","value":"E_{\\text{bulk}}","position":{"start":{"line":299,"column":1},"end":{"line":299,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsub\u003e\u003cmi\u003eE\u003c/mi\u003e\u003cmtext\u003ebulk\u003c/mtext\u003e\u003c/msub\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003eE_{\\text{bulk}}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.05764em;\"\u003eE\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3361em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord text mtight\"\u003e\u003cspan class=\"mord mtight\"\u003ebulk\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"u8T7G2LiAd"},{"type":"text","value":" = bulk energy per atom","position":{"start":{"line":299,"column":1},"end":{"line":299,"column":1}},"key":"ecewOW8UWV"}],"key":"ZFVippDbUQ"}],"key":"cIG7OHq0Xu"},{"type":"listItem","spread":true,"position":{"start":{"line":300,"column":1},"end":{"line":300,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineMath","value":"A","position":{"start":{"line":300,"column":1},"end":{"line":300,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003eA\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003eA\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6833em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003eA\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"vM9IfHebpZ"},{"type":"text","value":" = surface area","position":{"start":{"line":300,"column":1},"end":{"line":300,"column":1}},"key":"xoUNBVaNWR"}],"key":"P4FDZbOzDq"}],"key":"a9iYOiiltU"},{"type":"listItem","spread":true,"position":{"start":{"line":301,"column":1},"end":{"line":302,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Factor of 2 accounts for two surfaces (top and bottom)","position":{"start":{"line":301,"column":1},"end":{"line":301,"column":1}},"key":"oivJiRukfI"}],"key":"loXzBxnqcC"}],"key":"BXaVoACERp"}],"key":"B29DKNNsiN"},{"type":"paragraph","position":{"start":{"line":303,"column":1},"end":{"line":303,"column":1}},"children":[{"type":"strong","position":{"start":{"line":303,"column":1},"end":{"line":303,"column":1}},"children":[{"type":"text","value":"Challenge","position":{"start":{"line":303,"column":1},"end":{"line":303,"column":1}},"key":"S1ya7oyOEr"}],"key":"rujHUFNkaY"},{"type":"text","value":": Direct calculation suffers from quantum size effects, and if you were doing DFT calculations small numerical errors in the simulation or from the K-point grid sampling can lead to small (but significant) errors in the bulk lattice energy.","position":{"start":{"line":303,"column":1},"end":{"line":303,"column":1}},"key":"T7BPdOr39y"}],"key":"TmRItimB9s"},{"type":"paragraph","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"children":[{"type":"strong","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"children":[{"type":"text","value":"Solution","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"key":"mziPlsHKyI"}],"key":"ymr91W2CjN"},{"type":"text","value":": It is fairly common when calculating surface energies to use the bulk energy from a bulk relaxation in the above equation. However, because DFT often has some small numerical noise in the predictions from k-point convergence, this might lead to the wrong surface energy. Instead, two more careful schemes are either:","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"key":"AtASlvZKOZ"}],"key":"YOCe8f8pEY"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":306,"column":1},"end":{"line":308,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":306,"column":1},"end":{"line":306,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Calculate the energy of a bulk structure oriented to each slab to maximize cancellation of small numerical errors or","position":{"start":{"line":306,"column":1},"end":{"line":306,"column":1}},"key":"wdLhOKmmuH"}],"key":"A3syvFP6MR"}],"key":"L9yZbrJRhe"},{"type":"listItem","spread":true,"position":{"start":{"line":307,"column":1},"end":{"line":308,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Calculate the energy of multiple slabs at multiple thicknesses and extrapolate to zero thickness. The intercept will be the surface energy, and the slope will be a fitted bulk energy. A benefit of this approach is that it also forces us to check that we have a sufficiently thick slab for a well defined surface energy; if the fit is non-linear we need thicker slabs.","position":{"start":{"line":307,"column":1},"end":{"line":307,"column":1}},"key":"SrqRXB9sNX"}],"key":"VGj5VH62zL"}],"key":"Z7UFtQIZvn"}],"key":"EVIyeUH6vd"},{"type":"paragraph","position":{"start":{"line":309,"column":1},"end":{"line":309,"column":1}},"children":[{"type":"text","value":"We’ll use the linear extrapolation method here as it’s more likely to work in future DFT studies if you use this code!","position":{"start":{"line":309,"column":1},"end":{"line":309,"column":1}},"key":"rg2kTaIkOe"}],"key":"fYpyP628n2"},{"type":"heading","depth":3,"position":{"start":{"line":311,"column":1},"end":{"line":311,"column":1}},"children":[{"type":"text","value":"Step 1: Setup and Bulk Energy Reference","position":{"start":{"line":311,"column":1},"end":{"line":311,"column":1}},"key":"wNUWZ9hb5Z"}],"identifier":"step-1-setup-and-bulk-energy-reference","label":"Step 1: Setup and Bulk Energy Reference","html_id":"step-1-setup-and-bulk-energy-reference","implicit":true,"key":"xL8BFHjhI9"},{"type":"paragraph","position":{"start":{"line":313,"column":1},"end":{"line":313,"column":1}},"children":[{"type":"text","value":"First, we’ll set up the calculation parameters and get the bulk energy reference:","position":{"start":{"line":313,"column":1},"end":{"line":313,"column":1}},"key":"HgcVnU0WG1"}],"key":"cQ9kkKXS05"}],"key":"GziQJqXhUh"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Calculate surface energies for all facets\nfacets = [(1, 1, 1), (1, 0, 0), (1, 1, 0), (2, 1, 1)]\nsurface_energies = {}\nsurface_energies_SI = {}\nall_fit_data = {}\n\n# Get bulk energy reference (only need to do this once)\nE_bulk_total = ni_bulk.get_potential_energy()\nN_bulk = len(ni_bulk)\nE_bulk_per_atom = E_bulk_total / N_bulk\n\nprint(f\"Bulk energy reference:\")\nprint(f\"  Total energy: {E_bulk_total:.2f} eV\")\nprint(f\"  Number of atoms: {N_bulk}\")\nprint(f\"  Energy per atom: {E_bulk_per_atom:.6f} eV/atom\")","key":"BfkeLcCDtF"},{"type":"outputs","id":"OOnxuxVfXrJBc19HX_Alu","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Bulk energy reference:\n  Total energy: -21.97 eV\n  Number of atoms: 4\n  Energy per atom: -5.491441 eV/atom\n"},"key":"sI9edi4hiF"}],"key":"xIDrlwLTYV"}],"key":"BlNjQNo2Dh"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":333,"column":1},"end":{"line":333,"column":1}},"children":[{"type":"text","value":"Step 2: Generate and Relax Slabs","position":{"start":{"line":333,"column":1},"end":{"line":333,"column":1}},"key":"tAlKTombLr"}],"identifier":"step-2-generate-and-relax-slabs","label":"Step 2: Generate and Relax Slabs","html_id":"step-2-generate-and-relax-slabs","implicit":true,"key":"kwonLbacfk"},{"type":"paragraph","position":{"start":{"line":335,"column":1},"end":{"line":335,"column":1}},"children":[{"type":"text","value":"Now we’ll loop through each facet, generating slabs at three different thicknesses:","position":{"start":{"line":335,"column":1},"end":{"line":335,"column":1}},"key":"g3usEqsFbF"}],"key":"ZjjqTvN4wT"}],"key":"hpt3a4mmb2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Convert bulk to pymatgen structure for slab generation\nadaptor = AseAtomsAdaptor()\nni_structure = adaptor.get_structure(ni_bulk)\n\nfor facet in facets:\n    facet_str = \"\".join(map(str, facet))\n    print(f\"\\n{'='*60}\")\n    print(f\"Calculating Ni({facet_str}) surface energy\")\n    print(f\"{'='*60}\")\n\n    # Calculate for three thicknesses\n    thicknesses = [4, 6, 8]  # layers\n    n_atoms_list = []\n    energies_list = []\n\n    for n_layers in thicknesses:\n        print(f\"\\n  Thickness: {n_layers} layers\")\n\n        # Generate slab\n        slabgen = SlabGenerator(\n            ni_structure,\n            facet,\n            min_slab_size=n_layers * a_opt / np.sqrt(sum([h**2 for h in facet])),\n            min_vacuum_size=10.0,\n            center_slab=True,\n        )\n        pmg_slab = slabgen.get_slabs()[0]\n        slab = adaptor.get_atoms(pmg_slab)\n        slab.center(vacuum=10.0, axis=2)\n\n        print(f\"    Atoms: {len(slab)}\")\n\n        # Relax slab (no constraints - both surfaces free)\n        calc = FAIRChemCalculator(predictor, task_name=\"omat\")\n        slab.calc = calc\n        opt = LBFGS(slab, logfile=None)\n        opt.run(fmax=0.05, steps=relaxation_steps)\n\n        E_slab = slab.get_potential_energy()\n        n_atoms_list.append(len(slab))\n        energies_list.append(E_slab)\n        print(f\"    Energy: {E_slab:.2f} eV\")\n\n    # Linear regression: E_slab = slope * N + intercept\n    coeffs = np.polyfit(n_atoms_list, energies_list, 1)\n    slope = coeffs[0]\n    intercept = coeffs[1]\n\n    # Extract surface energy from intercept\n    cell = slab.get_cell()\n    area = np.linalg.norm(np.cross(cell[0], cell[1]))\n    gamma = intercept / (2 * area)  # eV/Å²\n    gamma_SI = gamma * 16.0218  # J/m²\n\n    print(f\"\\n  Linear fit:\")\n    print(f\"    Slope:     {slope:.6f} eV/atom (cf. bulk {E_bulk_per_atom:.6f})\")\n    print(f\"    Intercept: {intercept:.2f} eV\")\n    print(f\"\\n  Surface energy:\")\n    print(f\"    γ = {gamma:.6f} eV/Å² = {gamma_SI:.2f} J/m²\")\n\n    # Store results and fit data\n    surface_energies[facet] = gamma\n    surface_energies_SI[facet] = gamma_SI\n    all_fit_data[facet] = {\n        \"n_atoms\": n_atoms_list,\n        \"energies\": energies_list,\n        \"slope\": slope,\n        \"intercept\": intercept,\n    }","key":"VNZtNzrsRK"},{"type":"outputs","id":"EeZtiZFisx8gPK2SiqqsE","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"\n============================================================\nCalculating Ni(111) surface energy\n============================================================\n\n  Thickness: 4 layers\n    Atoms: 4\n"},"key":"UbewMTpci5"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"    Energy: -20.69 eV\n\n  Thickness: 6 layers\n    Atoms: 6\n"},"key":"kRSx9u8uPk"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"    Energy: -31.67 eV\n\n  Thickness: 8 layers\n    Atoms: 8\n"},"key":"YgOb7zihSq"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"    Energy: -42.66 eV\n\n  Linear fit:\n    Slope:     -5.492960 eV/atom (cf. bulk -5.491441)\n    Intercept: 1.28 eV\n\n  Surface energy:\n    γ = 0.120067 eV/Å² = 1.92 J/m²\n\n============================================================\nCalculating Ni(100) surface energy\n============================================================\n\n  Thickness: 4 layers\n    Atoms: 8\n"},"key":"dNASOgorNi"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"    Energy: -42.16 eV\n\n  Thickness: 6 layers\n    Atoms: 12\n"},"key":"Kbryo2D1Ba"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"    Energy: -64.12 eV\n\n  Thickness: 8 layers\n    Atoms: 16\n"},"key":"hmTdJQceAF"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"    Energy: -86.09 eV\n\n  Linear fit:\n    Slope:     -5.491521 eV/atom (cf. bulk -5.491441)\n    Intercept: 1.78 eV\n\n  Surface energy:\n    γ = 0.143731 eV/Å² = 2.30 J/m²\n\n============================================================\nCalculating Ni(110) surface energy\n============================================================\n\n  Thickness: 4 layers\n    Atoms: 8\n"},"key":"FQGPi89lx1"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"    Energy: -41.36 eV\n\n  Thickness: 6 layers\n    Atoms: 12\n"},"key":"veBscFSeYV"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"    Energy: -63.34 eV\n\n  Thickness: 8 layers\n    Atoms: 16\n"},"key":"SAy9f2xq2b"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"    Energy: -85.30 eV\n\n  Linear fit:\n    Slope:     -5.492427 eV/atom (cf. bulk -5.491441)\n    Intercept: 2.57 eV\n\n  Surface energy:\n    γ = 0.147336 eV/Å² = 2.36 J/m²\n\n============================================================\nCalculating Ni(211) surface energy\n============================================================\n\n  Thickness: 4 layers\n"},"key":"N30elYqeAI"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"    Atoms: 8\n"},"key":"UNvTcGD8rd"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"    Energy: -39.69 eV\n\n  Thickness: 6 layers\n"},"key":"btkrXZTZ02"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"    Atoms: 12\n"},"key":"QZsc2kRS9E"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"    Energy: -61.61 eV\n\n  Thickness: 8 layers\n"},"key":"COnuXVhgVN"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"    Atoms: 16\n"},"key":"MOxV1lvTL8"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"    Energy: -83.58 eV\n\n  Linear fit:\n    Slope:     -5.485733 eV/atom (cf. bulk -5.491441)\n    Intercept: 4.20 eV\n\n  Surface energy:\n    γ = 0.138877 eV/Å² = 2.23 J/m²\n"},"key":"AHLeSuFUBJ"}],"key":"gfr5woDN8Y"}],"key":"Q4L8M04gb9"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":409,"column":1},"end":{"line":409,"column":1}},"children":[{"type":"text","value":"Step 3: Visualize Linear Fits","position":{"start":{"line":409,"column":1},"end":{"line":409,"column":1}},"key":"delRzcw9gD"}],"identifier":"step-3-visualize-linear-fits","label":"Step 3: Visualize Linear Fits","html_id":"step-3-visualize-linear-fits","implicit":true,"key":"bXmq1uOvtL"},{"type":"paragraph","position":{"start":{"line":411,"column":1},"end":{"line":411,"column":1}},"children":[{"type":"text","value":"Let’s visualize the linear extrapolation for all four facets:","position":{"start":{"line":411,"column":1},"end":{"line":411,"column":1}},"key":"z4mu6yVehv"}],"key":"NbTu7fgyPB"}],"key":"xVpT1RHJKc"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Visualize linear fits for all facets\nfig, axes = plt.subplots(2, 2, figsize=(12, 10))\naxes = axes.flatten()\n\nfor idx, facet in enumerate(facets):\n    ax = axes[idx]\n    data = all_fit_data[facet]\n\n    # Plot data points\n    ax.scatter(\n        data[\"n_atoms\"],\n        data[\"energies\"],\n        s=100,\n        color=\"steelblue\",\n        marker=\"o\",\n        zorder=3,\n        label=\"Calculated\",\n    )\n\n    # Plot fit line\n    n_range = np.linspace(min(data[\"n_atoms\"]) - 5, max(data[\"n_atoms\"]) + 5, 100)\n    E_fit = data[\"slope\"] * n_range + data[\"intercept\"]\n    ax.plot(\n        n_range,\n        E_fit,\n        \"r--\",\n        linewidth=2,\n        label=f'Fit: {data[\"slope\"]:.2f}N + {data[\"intercept\"]:.2f}',\n    )\n\n    # Formatting\n    facet_str = f\"Ni({facet[0]}{facet[1]}{facet[2]})\"\n    ax.set_xlabel(\"Number of Atoms\", fontsize=11)\n    ax.set_ylabel(\"Slab Energy (eV)\", fontsize=11)\n    ax.set_title(\n        f\"{facet_str}: γ = {surface_energies_SI[facet]:.2f} J/m²\",\n        fontsize=12,\n        fontweight=\"bold\",\n    )\n    ax.legend(fontsize=9)\n    ax.grid(True, alpha=0.3)\n\nplt.tight_layout()\nplt.savefig(\n    str(output_dir / part_dirs[\"part2\"] / \"surface_energy_fits.png\"),\n    dpi=300,\n    bbox_inches=\"tight\",\n)\nplt.show()","key":"LZz06kgPsj"},{"type":"outputs","id":"iWQcNxsuW1ap1nf2uX3sL","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"\u003cFigure size 1200x1000 with 4 Axes\u003e","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"34ef9df633346ff7882cd91ef8afd315","path":"/build/34ef9df633346ff7882cd91ef8afd315.png"}}},"key":"uf2CRTDNRf"}],"key":"krGp1ZLvRr"}],"key":"ZKC0dyyWJi"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":465,"column":1},"end":{"line":465,"column":1}},"children":[{"type":"text","value":"Step 4: Compare with Literature","position":{"start":{"line":465,"column":1},"end":{"line":465,"column":1}},"key":"Qo054SQoDf"}],"identifier":"step-4-compare-with-literature","label":"Step 4: Compare with Literature","html_id":"step-4-compare-with-literature","implicit":true,"key":"z7cMS3ezS3"},{"type":"paragraph","position":{"start":{"line":467,"column":1},"end":{"line":467,"column":1}},"children":[{"type":"text","value":"Finally, let’s compare our calculated surface energies with DFT literature values:","position":{"start":{"line":467,"column":1},"end":{"line":467,"column":1}},"key":"DdjgFww5pl"}],"key":"i7VF4UmtOf"}],"key":"hYYt68oFJ8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(f\"\\n{'='*70}\")\nprint(\"Comparison with DFT Literature (Tran et al., 2016)\")\nprint(f\"{'='*70}\")\nlit_values = {\n    (1, 1, 1): 1.92,\n    (1, 0, 0): 2.21,\n    (1, 1, 0): 2.29,\n    (2, 1, 1): 2.24,\n}  # J/m²\n\nfor facet in facets:\n    facet_str = f\"Ni({facet[0]}{facet[1]}{facet[2]})\"\n    calc = surface_energies_SI[facet]\n    lit = lit_values[facet]\n    diff = abs(calc - lit) / lit * 100\n    print(f\"{facet_str:\u003c10} {calc:\u003e8.2f} J/m²  (Lit: {lit:.2f}, Δ={diff:.1f}%)\")","key":"u7T0kx484Z"},{"type":"outputs","id":"9Y4C7S62sBYjab5YbNxaP","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"\n======================================================================\nComparison with DFT Literature (Tran et al., 2016)\n======================================================================\nNi(111)        1.92 J/m²  (Lit: 1.92, Δ=0.2%)\nNi(100)        2.30 J/m²  (Lit: 2.21, Δ=4.2%)\nNi(110)        2.36 J/m²  (Lit: 2.29, Δ=3.1%)\nNi(211)        2.23 J/m²  (Lit: 2.24, Δ=0.7%)\n"},"key":"I7kYuU6gU9"}],"key":"sFk1y85B5r"}],"key":"OfhfAlMCp7"},{"type":"block","children":[{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Missing UMA access?","position":{"start":{"line":488,"column":1},"end":{"line":488,"column":1}},"key":"KS9Qk7HHWC"}],"key":"hBqL7lycsv"},{"type":"paragraph","position":{"start":{"line":491,"column":1},"end":{"line":491,"column":1}},"children":[{"type":"text","value":"Don’t have access to UMA yet? You can still explore this calculation!","position":{"start":{"line":491,"column":1},"end":{"line":491,"column":1}},"key":"JL2mInGNfA"}],"key":"o3dVcOX92E"},{"type":"paragraph","position":{"start":{"line":493,"column":1},"end":{"line":493,"column":1}},"children":[{"type":"link","url":"example_configs/ni111_slab.xyz","position":{"start":{"line":493,"column":1},"end":{"line":493,"column":1}},"children":[{"type":"text","value":"Download example Ni(111) slab structure","position":{"start":{"line":493,"column":1},"end":{"line":493,"column":1}},"key":"iVcG8MpC7T"}],"urlSource":"example_configs/ni111_slab.xyz","key":"JWCwCWZl4k"},{"type":"text","value":" and test it in the ","position":{"start":{"line":493,"column":1},"end":{"line":493,"column":1}},"key":"YEBkNkQDAo"},{"type":"link","url":"https://facebook-fairchem-uma-demo.hf.space/","position":{"start":{"line":493,"column":1},"end":{"line":493,"column":1}},"children":[{"type":"text","value":"UMA demo (no login required)","position":{"start":{"line":493,"column":1},"end":{"line":493,"column":1}},"key":"xwZcLNLJE5"}],"urlSource":"https://facebook-fairchem-uma-demo.hf.space/","key":"VTUgjAYTeX"},{"type":"text","value":" to see how the model predicts energies for Ni surfaces.","position":{"start":{"line":493,"column":1},"end":{"line":493,"column":1}},"key":"f5taa8zvpb"}],"key":"a1IkzyRy3d"}],"class":"dropdown, tip","key":"bUjvxFzRow"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Comparison with Paper (Table 1)","position":{"start":{"line":496,"column":1},"end":{"line":496,"column":1}},"key":"cLMDc6iIzz"}],"key":"bYyVnYJirt"},{"type":"paragraph","position":{"start":{"line":499,"column":1},"end":{"line":499,"column":1}},"children":[{"type":"strong","position":{"start":{"line":499,"column":1},"end":{"line":499,"column":1}},"children":[{"type":"text","value":"Paper Results (PBE-DFT, Tran et al.):","position":{"start":{"line":499,"column":1},"end":{"line":499,"column":1}},"key":"uJjAMPIw9F"}],"key":"BleuaRSz76"}],"key":"PU8em26Ysk"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":500,"column":1},"end":{"line":504,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":500,"column":1},"end":{"line":500,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Ni(111): 1.92 J/m²","position":{"start":{"line":500,"column":1},"end":{"line":500,"column":1}},"key":"LbC8SuqXhO"}],"key":"iqe20PduR0"}],"key":"Gy4TIiytjR"},{"type":"listItem","spread":true,"position":{"start":{"line":501,"column":1},"end":{"line":501,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Ni(100): 2.21 J/m²","position":{"start":{"line":501,"column":1},"end":{"line":501,"column":1}},"key":"X4Iz8RcJQ7"}],"key":"OlpNrGBruR"}],"key":"XeB7PEtuja"},{"type":"listItem","spread":true,"position":{"start":{"line":502,"column":1},"end":{"line":502,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Ni(110): 2.29 J/m²","position":{"start":{"line":502,"column":1},"end":{"line":502,"column":1}},"key":"yGYazVcTDR"}],"key":"W30Wv0O2Lc"}],"key":"dV203tcaLg"},{"type":"listItem","spread":true,"position":{"start":{"line":503,"column":1},"end":{"line":504,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Ni(211): 2.24 J/m²","position":{"start":{"line":503,"column":1},"end":{"line":503,"column":1}},"key":"hxdpmUUDkA"}],"key":"yjtD92IRmd"}],"key":"dMzncC67NV"}],"key":"hdxcBlgykD"},{"type":"paragraph","position":{"start":{"line":505,"column":1},"end":{"line":505,"column":1}},"children":[{"type":"strong","position":{"start":{"line":505,"column":1},"end":{"line":505,"column":1}},"children":[{"type":"text","value":"Key Observations:","position":{"start":{"line":505,"column":1},"end":{"line":505,"column":1}},"key":"QkFQF5yvho"}],"key":"HW54Nok0vg"}],"key":"WLKJkTvHm9"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":506,"column":1},"end":{"line":510,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":506,"column":1},"end":{"line":506,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":506,"column":1},"end":{"line":506,"column":1}},"children":[{"type":"text","value":"Energy ordering preserved","position":{"start":{"line":506,"column":1},"end":{"line":506,"column":1}},"key":"KoxFFePdCf"}],"key":"qkUlJch6j1"},{"type":"text","value":": (111) \u003c (100) \u003c (110) ≈ (211), matching DFT","position":{"start":{"line":506,"column":1},"end":{"line":506,"column":1}},"key":"ZAwj3Y13QF"}],"key":"hDjI3tayaA"}],"key":"KWQbNMWeY6"},{"type":"listItem","spread":true,"position":{"start":{"line":507,"column":1},"end":{"line":507,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":507,"column":1},"end":{"line":507,"column":1}},"children":[{"type":"text","value":"Absolute errors","position":{"start":{"line":507,"column":1},"end":{"line":507,"column":1}},"key":"qRnamtz72a"}],"key":"vDm7HCTgYg"},{"type":"text","value":": Typically 10-20%, within expected range for ML potentials","position":{"start":{"line":507,"column":1},"end":{"line":507,"column":1}},"key":"adVUoPkdME"}],"key":"i3Q0hnxRE5"}],"key":"jgNNRJLc2L"},{"type":"listItem","spread":true,"position":{"start":{"line":508,"column":1},"end":{"line":508,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":508,"column":1},"end":{"line":508,"column":1}},"children":[{"type":"text","value":"(111) most stable","position":{"start":{"line":508,"column":1},"end":{"line":508,"column":1}},"key":"q7e5oLPLkg"}],"key":"WNNDuCFTmi"},{"type":"text","value":": Both methods agree this is the lowest energy surface","position":{"start":{"line":508,"column":1},"end":{"line":508,"column":1}},"key":"WHjAcqmpdQ"}],"key":"tFR6b4g4I3"}],"key":"EE6fSsszwr"},{"type":"listItem","spread":true,"position":{"start":{"line":509,"column":1},"end":{"line":510,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":509,"column":1},"end":{"line":509,"column":1}},"children":[{"type":"text","value":"Physical trend correct","position":{"start":{"line":509,"column":1},"end":{"line":509,"column":1}},"key":"MvbGP888Pt"}],"key":"VevFCE0L30"},{"type":"text","value":": Close-packed surfaces have lower energy","position":{"start":{"line":509,"column":1},"end":{"line":509,"column":1}},"key":"TAlleysvlq"}],"key":"DnUHWixeGW"}],"key":"Qjwnu3jgF1"}],"key":"U6wcTZgyoN"},{"type":"paragraph","position":{"start":{"line":511,"column":1},"end":{"line":511,"column":1}},"children":[{"type":"strong","position":{"start":{"line":511,"column":1},"end":{"line":511,"column":1}},"children":[{"type":"text","value":"Why differences exist:","position":{"start":{"line":511,"column":1},"end":{"line":511,"column":1}},"key":"viwzkzG5GP"}],"key":"eD5XZ1obK8"}],"key":"fSoWjYC6bV"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":512,"column":1},"end":{"line":515,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":512,"column":1},"end":{"line":512,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Training data biases in ML model, which has seen mostly periodic bulk structures, not surfaces.","position":{"start":{"line":512,"column":1},"end":{"line":512,"column":1}},"key":"cnUwtCjWPA"}],"key":"iRlKZn0hX8"}],"key":"WX8aiv6TkC"},{"type":"listItem","spread":true,"position":{"start":{"line":513,"column":1},"end":{"line":513,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Slab thickness effects (even with extrapolation)","position":{"start":{"line":513,"column":1},"end":{"line":513,"column":1}},"key":"hGrdcdy7rj"}],"key":"r7zZahLw4R"}],"key":"o7wcekvvQu"},{"type":"listItem","spread":true,"position":{"start":{"line":514,"column":1},"end":{"line":515,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Lack of explicit spin polarization in ML model. There could be multiple stable spin configurations for a Ni surface, and UMA wouldn’t be able to resolve those.","position":{"start":{"line":514,"column":1},"end":{"line":514,"column":1}},"key":"ADfif2rF1u"}],"key":"KKHGCBg4g1"}],"key":"M7WE5wOM70"}],"key":"zoT3eZx5fe"},{"type":"paragraph","position":{"start":{"line":516,"column":1},"end":{"line":517,"column":1}},"children":[{"type":"strong","position":{"start":{"line":516,"column":1},"end":{"line":516,"column":1}},"children":[{"type":"text","value":"Caveat","position":{"start":{"line":516,"column":1},"end":{"line":516,"column":1}},"key":"K9B6q2zqy7"}],"key":"sV2rnatbYy"},{"type":"text","value":"\nBoth methods here use PBE as the underlying functional in DFT. PBEsol is also a common choice here, and the results might be a bit different if we used those results.","position":{"start":{"line":516,"column":1},"end":{"line":516,"column":1}},"key":"ilgjiAaDXs"}],"key":"aRqQijtdTe"},{"type":"paragraph","position":{"start":{"line":519,"column":1},"end":{"line":519,"column":1}},"children":[{"type":"strong","position":{"start":{"line":519,"column":1},"end":{"line":519,"column":1}},"children":[{"type":"text","value":"Bottom line","position":{"start":{"line":519,"column":1},"end":{"line":519,"column":1}},"key":"BJoAxMm1VB"}],"key":"Uxpcisyz6F"},{"type":"text","value":": Surface energy ","position":{"start":{"line":519,"column":1},"end":{"line":519,"column":1}},"key":"CKueiqyMbz"},{"type":"emphasis","position":{"start":{"line":519,"column":1},"end":{"line":519,"column":1}},"children":[{"type":"text","value":"ordering","position":{"start":{"line":519,"column":1},"end":{"line":519,"column":1}},"key":"HtADfTs13S"}],"key":"L4BLwMxGsS"},{"type":"text","value":" is more reliable than absolute values. Use ML for screening, validate critical cases with DFT.","position":{"start":{"line":519,"column":1},"end":{"line":519,"column":1}},"key":"aFL6IkOjVk"}],"key":"uUEhNTYael"}],"class":"note","key":"jkYWifwASn"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Why Linear Extrapolation?","position":{"start":{"line":522,"column":1},"end":{"line":522,"column":1}},"key":"SbqGRoTYb2"}],"key":"m5r6hcu18Q"},{"type":"paragraph","position":{"start":{"line":525,"column":1},"end":{"line":525,"column":1}},"children":[{"type":"text","value":"Single-thickness slabs suffer from:","position":{"start":{"line":525,"column":1},"end":{"line":525,"column":1}},"key":"rfShiDEr0z"}],"key":"KQm6PYu1QR"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":526,"column":1},"end":{"line":529,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":526,"column":1},"end":{"line":526,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":526,"column":1},"end":{"line":526,"column":1}},"children":[{"type":"text","value":"Quantum confinement","position":{"start":{"line":526,"column":1},"end":{"line":526,"column":1}},"key":"SOKgl5FAn6"}],"key":"F6WVO7xEPT"},{"type":"text","value":": Electronic structure depends on slab thickness","position":{"start":{"line":526,"column":1},"end":{"line":526,"column":1}},"key":"MC75J8Uf0o"}],"key":"ojDRQ0ubW1"}],"key":"WdcfHgWyNS"},{"type":"listItem","spread":true,"position":{"start":{"line":527,"column":1},"end":{"line":527,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":527,"column":1},"end":{"line":527,"column":1}},"children":[{"type":"text","value":"Surface-surface interactions","position":{"start":{"line":527,"column":1},"end":{"line":527,"column":1}},"key":"U9tldxnewj"}],"key":"T6aysDpoLE"},{"type":"text","value":": Bottom and top surfaces couple at small thicknesses","position":{"start":{"line":527,"column":1},"end":{"line":527,"column":1}},"key":"WkWanmfjRt"}],"key":"i0sdnV2wfj"}],"key":"wf916KxkNs"},{"type":"listItem","spread":true,"position":{"start":{"line":528,"column":1},"end":{"line":529,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":528,"column":1},"end":{"line":528,"column":1}},"children":[{"type":"text","value":"Relaxation artifacts","position":{"start":{"line":528,"column":1},"end":{"line":528,"column":1}},"key":"dEJFYROijA"}],"key":"xj6q0fUvP3"},{"type":"text","value":": Atoms at center may not reach bulk-like coordination","position":{"start":{"line":528,"column":1},"end":{"line":528,"column":1}},"key":"F1VdydWp7r"}],"key":"NK3hwOzXvx"}],"key":"FjBoo8WPt2"}],"key":"FWrI6QMhu1"},{"type":"paragraph","position":{"start":{"line":530,"column":1},"end":{"line":530,"column":1}},"children":[{"type":"text","value":"Linear extrapolation eliminates these by fitting ","position":{"start":{"line":530,"column":1},"end":{"line":530,"column":1}},"key":"tQiXAwndVu"},{"type":"inlineMath","value":"E_{\\text{slab}}(N)","position":{"start":{"line":530,"column":1},"end":{"line":530,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsub\u003e\u003cmi\u003eE\u003c/mi\u003e\u003cmtext\u003eslab\u003c/mtext\u003e\u003c/msub\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmi\u003eN\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003eE_{\\text{slab}}(N)\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.05764em;\"\u003eE\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3361em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord text mtight\"\u003e\u003cspan class=\"mord mtight\"\u003eslab\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.10903em;\"\u003eN\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"fUcRFpeqf2"},{"type":"text","value":" and extracting the asymptotic surface energy.","position":{"start":{"line":530,"column":1},"end":{"line":530,"column":1}},"key":"CfCsIG4AmS"}],"key":"pympZ9clbr"}],"class":"note","key":"e2gkqJ86Ii"},{"type":"heading","depth":3,"position":{"start":{"line":533,"column":1},"end":{"line":533,"column":1}},"children":[{"type":"text","value":"Explore on Your Own","position":{"start":{"line":533,"column":1},"end":{"line":533,"column":1}},"key":"sa7MJqTP03"}],"identifier":"explore-on-your-own","label":"Explore on Your Own","html_id":"explore-on-your-own","implicit":true,"key":"zzN2wKv5b9"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":535,"column":1},"end":{"line":540,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":535,"column":1},"end":{"line":535,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":535,"column":1},"end":{"line":535,"column":1}},"children":[{"type":"text","value":"Thickness convergence","position":{"start":{"line":535,"column":1},"end":{"line":535,"column":1}},"key":"KP6Ad6EG8S"}],"key":"wRlc2p5de7"},{"type":"text","value":": Add 10 and 12 layer calculations. Is the linear fit still valid?","position":{"start":{"line":535,"column":1},"end":{"line":535,"column":1}},"key":"GX0gwhhfuD"}],"key":"asP6kg06ll"}],"key":"TP6aE63zIP"},{"type":"listItem","spread":true,"position":{"start":{"line":536,"column":1},"end":{"line":536,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":536,"column":1},"end":{"line":536,"column":1}},"children":[{"type":"text","value":"Constraint effects","position":{"start":{"line":536,"column":1},"end":{"line":536,"column":1}},"key":"qDqfaLebV1"}],"key":"pgVfBzDT7m"},{"type":"text","value":": Fix the bottom 2 layers during relaxation. How does this affect γ?","position":{"start":{"line":536,"column":1},"end":{"line":536,"column":1}},"key":"LtvG8xpNp7"}],"key":"MsOeBX72pp"}],"key":"Ss4RWm6uNQ"},{"type":"listItem","spread":true,"position":{"start":{"line":537,"column":1},"end":{"line":537,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":537,"column":1},"end":{"line":537,"column":1}},"children":[{"type":"text","value":"Vacuum size","position":{"start":{"line":537,"column":1},"end":{"line":537,"column":1}},"key":"DbLXekADQO"}],"key":"uQVBXkcfqo"},{"type":"text","value":": Vary ","position":{"start":{"line":537,"column":1},"end":{"line":537,"column":1}},"key":"MlULkYWfAo"},{"type":"inlineCode","value":"min_vacuum_size","position":{"start":{"line":537,"column":1},"end":{"line":537,"column":1}},"key":"sqjDTi5MJo"},{"type":"text","value":" from 8 to 15 Å. When does γ converge?","position":{"start":{"line":537,"column":1},"end":{"line":537,"column":1}},"key":"ScIOjJqvRf"}],"key":"rIOE6DsfyF"}],"key":"tGPFenGhyu"},{"type":"listItem","spread":true,"position":{"start":{"line":538,"column":1},"end":{"line":538,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":538,"column":1},"end":{"line":538,"column":1}},"children":[{"type":"text","value":"High-index facets","position":{"start":{"line":538,"column":1},"end":{"line":538,"column":1}},"key":"FX8v2g3K8E"}],"key":"v2qRdgESwi"},{"type":"text","value":": Try (311) or (331) surfaces. Are they more or less stable?","position":{"start":{"line":538,"column":1},"end":{"line":538,"column":1}},"key":"Ni78fF93sX"}],"key":"Cx4y5yo9g2"}],"key":"P4WwkXh9ua"},{"type":"listItem","spread":true,"position":{"start":{"line":539,"column":1},"end":{"line":540,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":539,"column":1},"end":{"line":539,"column":1}},"children":[{"type":"text","value":"Alternative fitting","position":{"start":{"line":539,"column":1},"end":{"line":539,"column":1}},"key":"YMhxMllKbN"}],"key":"OMYEVVVq8e"},{"type":"text","value":": Use polynomial (degree 2) instead of linear fit. Does the intercept change?","position":{"start":{"line":539,"column":1},"end":{"line":539,"column":1}},"key":"fCT5feXOKL"}],"key":"c8f6dbVJg8"}],"key":"gpFdKe1Htc"}],"key":"C3a3hKYKjA"},{"type":"thematicBreak","position":{"start":{"line":541,"column":1},"end":{"line":541,"column":1}},"key":"tnJinDRRDR"},{"type":"heading","depth":2,"position":{"start":{"line":543,"column":1},"end":{"line":543,"column":1}},"children":[{"type":"text","value":"Part 3: Wulff Construction","position":{"start":{"line":543,"column":1},"end":{"line":543,"column":1}},"key":"mwYJ1PKVso"}],"identifier":"part-3-wulff-construction","label":"Part 3: Wulff Construction","html_id":"part-3-wulff-construction","implicit":true,"key":"cEA8kjV0di"},{"type":"heading","depth":3,"position":{"start":{"line":545,"column":1},"end":{"line":545,"column":1}},"children":[{"type":"text","value":"Introduction","position":{"start":{"line":545,"column":1},"end":{"line":545,"column":1}},"key":"JvJZToqDPt"}],"identifier":"introduction","label":"Introduction","html_id":"introduction-2","implicit":true,"key":"hLQDBMBDEd"},{"type":"paragraph","position":{"start":{"line":547,"column":1},"end":{"line":547,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":547,"column":1},"end":{"line":547,"column":1}},"key":"Bvkzb4bis0"},{"type":"strong","position":{"start":{"line":547,"column":1},"end":{"line":547,"column":1}},"children":[{"type":"text","value":"Wulff construction","position":{"start":{"line":547,"column":1},"end":{"line":547,"column":1}},"key":"VjxeWPmvxh"}],"key":"NohcnXnFmH"},{"type":"text","value":" predicts the equilibrium shape of a crystalline particle by minimizing total surface energy. This determines the morphology of supported catalyst nanoparticles.","position":{"start":{"line":547,"column":1},"end":{"line":547,"column":1}},"key":"ZVzcQ2hako"}],"key":"Eub2tXdp2s"},{"type":"heading","depth":3,"position":{"start":{"line":549,"column":1},"end":{"line":549,"column":1}},"children":[{"type":"text","value":"Theory","position":{"start":{"line":549,"column":1},"end":{"line":549,"column":1}},"key":"sv3G3XDTpB"}],"identifier":"theory","label":"Theory","html_id":"theory-2","implicit":true,"key":"o0GZaT723m"},{"type":"paragraph","position":{"start":{"line":551,"column":1},"end":{"line":551,"column":1}},"children":[{"type":"text","value":"The Wulff theorem states that at equilibrium, the distance from the particle center to a facet is proportional to its surface energy:","position":{"start":{"line":551,"column":1},"end":{"line":551,"column":1}},"key":"NbFfDMmNqU"}],"key":"TSno1HDpdP"},{"type":"math","value":"\\frac{h_i}{\\gamma_i} = \\text{constant}","position":{"start":{"line":553,"column":1},"end":{"line":555,"column":1}},"html":"\u003cspan class=\"katex-display\"\u003e\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmfrac\u003e\u003cmsub\u003e\u003cmi\u003eh\u003c/mi\u003e\u003cmi\u003ei\u003c/mi\u003e\u003c/msub\u003e\u003cmsub\u003e\u003cmi\u003eγ\u003c/mi\u003e\u003cmi\u003ei\u003c/mi\u003e\u003c/msub\u003e\u003c/mfrac\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmtext\u003econstant\u003c/mtext\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\frac{h_i}{\\gamma_i} = \\text{constant}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:2.2519em;vertical-align:-0.8804em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mopen nulldelimiter\"\u003e\u003c/span\u003e\u003cspan class=\"mfrac\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.3714em;\"\u003e\u003cspan style=\"top:-2.314em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.05556em;\"\u003eγ\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3117em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.0556em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003ei\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.23em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"frac-line\" style=\"border-bottom-width:0.04em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.677em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003eh\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3117em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003ei\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8804em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose nulldelimiter\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6151em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord text\"\u003e\u003cspan class=\"mord\"\u003econstant\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","enumerator":"2","key":"Prra3w7pbr"},{"type":"paragraph","position":{"start":{"line":557,"column":1},"end":{"line":557,"column":1}},"children":[{"type":"text","value":"Facets with lower surface energy have larger areas in the equilibrium shape.","position":{"start":{"line":557,"column":1},"end":{"line":557,"column":1}},"key":"lGPjf77J1m"}],"key":"KG7dZiYm35"},{"type":"heading","depth":3,"position":{"start":{"line":559,"column":1},"end":{"line":559,"column":1}},"children":[{"type":"text","value":"Step 1: Prepare Surface Energies","position":{"start":{"line":559,"column":1},"end":{"line":559,"column":1}},"key":"BH60Ul8PFm"}],"identifier":"step-1-prepare-surface-energies","label":"Step 1: Prepare Surface Energies","html_id":"step-1-prepare-surface-energies","implicit":true,"key":"nwMV4INTKt"},{"type":"paragraph","position":{"start":{"line":561,"column":1},"end":{"line":561,"column":1}},"children":[{"type":"text","value":"We’ll use the surface energies calculated in Part 2 to construct the Wulff shape:","position":{"start":{"line":561,"column":1},"end":{"line":561,"column":1}},"key":"YloAp0f91S"}],"key":"vaNber0TWq"}],"key":"oWF6XmfrKc"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(\"\\nConstructing Wulff Shape\")\nprint(\"=\" * 50)\n\n# Use optimized bulk structure\nadaptor = AseAtomsAdaptor()\nni_structure = adaptor.get_structure(ni_bulk)\n\nmiller_list = list(surface_energies_SI.keys())\nenergy_list = [surface_energies_SI[m] for m in miller_list]\n\nprint(f\"Using {len(miller_list)} facets:\")\nfor miller, energy in zip(miller_list, energy_list):\n    print(f\"  {miller}: {energy:.2f} J/m²\")","key":"L5T5SAdUEQ"},{"type":"outputs","id":"fQQRKxQb_Uf_-l8q0Nqzf","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"\nConstructing Wulff Shape\n==================================================\nUsing 4 facets:\n  (1, 1, 1): 1.92 J/m²\n  (1, 0, 0): 2.30 J/m²\n  (1, 1, 0): 2.36 J/m²\n  (2, 1, 1): 2.23 J/m²\n"},"key":"fI1gSxVISn"}],"key":"nb7Z40gTIM"}],"key":"CVFcysOlAm"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":579,"column":1},"end":{"line":579,"column":1}},"children":[{"type":"text","value":"Step 2: Generate Wulff Construction","position":{"start":{"line":579,"column":1},"end":{"line":579,"column":1}},"key":"Y7LNV3sTlb"}],"identifier":"step-2-generate-wulff-construction","label":"Step 2: Generate Wulff Construction","html_id":"step-2-generate-wulff-construction","implicit":true,"key":"ttRbJReQal"},{"type":"paragraph","position":{"start":{"line":581,"column":1},"end":{"line":581,"column":1}},"children":[{"type":"text","value":"Now we create the Wulff shape and analyze its properties:","position":{"start":{"line":581,"column":1},"end":{"line":581,"column":1}},"key":"wq2XpfpFe0"}],"key":"o6yhd8uMJV"}],"key":"J8eigsVPQm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Create Wulff shape\nwulff = WulffShape(ni_structure.lattice, miller_list, energy_list)\n\n# Print properties\nprint(f\"\\nWulff Shape Properties:\")\nprint(f\"  Volume:          {wulff.volume:.2f} Å³\")\nprint(f\"  Surface area:    {wulff.surface_area:.2f} Å²\")\nprint(f\"  Effective radius: {wulff.effective_radius:.2f} Å\")\nprint(f\"  Weighted γ:      {wulff.weighted_surface_energy:.2f} J/m²\")\n\n# Area fractions\nprint(f\"\\nFacet Area Fractions:\")\narea_frac = wulff.area_fraction_dict\nfor hkl, frac in sorted(area_frac.items(), key=lambda x: x[1], reverse=True):\n    print(f\"  {hkl}: {frac*100:.1f}%\")","key":"gjYlZJpvej"},{"type":"outputs","id":"C-c_rc9IhonCKGnBMWbYS","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"\nWulff Shape Properties:\n  Volume:          44.54 Å³\n  Surface area:    66.03 Å²\n  Effective radius: 2.20 Å\n  Weighted γ:      2.02 J/m²\n\nFacet Area Fractions:\n  (1, 1, 1): 70.1%\n  (2, 1, 1): 16.9%\n  (1, 0, 0): 13.0%\n  (1, 1, 0): 0.0%\n"},"key":"NJRpFORBpR"}],"key":"ANt7NjYRHW"}],"key":"UUrxtAPc4y"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":601,"column":1},"end":{"line":601,"column":1}},"children":[{"type":"text","value":"Step 3: Visualize and Compare","position":{"start":{"line":601,"column":1},"end":{"line":601,"column":1}},"key":"JhCDIfF3vJ"}],"identifier":"step-3-visualize-and-compare","label":"Step 3: Visualize and Compare","html_id":"step-3-visualize-and-compare","implicit":true,"key":"nKtapF7VJ8"},{"type":"paragraph","position":{"start":{"line":603,"column":1},"end":{"line":603,"column":1}},"children":[{"type":"text","value":"Let’s visualize the Wulff shape and compare with literature:","position":{"start":{"line":603,"column":1},"end":{"line":603,"column":1}},"key":"gGfFD7GrPu"}],"key":"A3qMx9YsYd"}],"key":"F1kQHzfG2u"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Visualize\nfig = wulff.get_plot()\nplt.title(\"Wulff Construction: Ni Nanoparticle\", fontsize=14)\nplt.tight_layout()\nplt.savefig(\n    str(output_dir / part_dirs[\"part3\"] / \"wulff_shape.png\"),\n    dpi=300,\n    bbox_inches=\"tight\",\n)\nplt.show()\n\n# Compare with paper\nprint(f\"\\nComparison with Paper (Table 2):\")\npaper_fractions = {(1, 1, 1): 69.23, (1, 0, 0): 21.10, (1, 1, 0): 5.28, (2, 1, 1): 4.39}\nfor hkl in miller_list:\n    calc_frac = area_frac.get(hkl, 0) * 100\n    paper_frac = paper_fractions.get(hkl, 0)\n    print(f\"  {hkl}: {calc_frac:\u003e6.1f}% (Paper: {paper_frac:.1f}%)\")","key":"RKlj1Fc317"},{"type":"outputs","id":"pm3EF7CSj4onWbSjIU4a-","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"\u003cFigure size 800x800 with 1 Axes\u003e","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"ee7a7c0dd7528ee6c7de9da7b361b474","path":"/build/ee7a7c0dd7528ee6c7de9da7b361b474.png"}}},"key":"SYvpjKYabd"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"\nComparison with Paper (Table 2):\n  (1, 1, 1):   70.1% (Paper: 69.2%)\n  (1, 0, 0):   13.0% (Paper: 21.1%)\n  (1, 1, 0):    0.0% (Paper: 5.3%)\n  (2, 1, 1):   16.9% (Paper: 4.4%)\n"},"key":"RW1Bek2x3D"}],"key":"l8hb1MJ0VV"}],"key":"m97gKqJOIJ"},{"type":"block","children":[{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Comparison with Paper (Table 2)","position":{"start":{"line":626,"column":1},"end":{"line":626,"column":1}},"key":"A1Akur6SOL"}],"key":"LPmEqLU346"},{"type":"paragraph","position":{"start":{"line":629,"column":1},"end":{"line":629,"column":1}},"children":[{"type":"strong","position":{"start":{"line":629,"column":1},"end":{"line":629,"column":1}},"children":[{"type":"text","value":"Paper Results (Wulff Construction):","position":{"start":{"line":629,"column":1},"end":{"line":629,"column":1}},"key":"GsGO8a7WbV"}],"key":"I9pXf0rYPf"}],"key":"uqHjutUccI"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":630,"column":1},"end":{"line":634,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":630,"column":1},"end":{"line":630,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Ni(111): 69.23% of surface area","position":{"start":{"line":630,"column":1},"end":{"line":630,"column":1}},"key":"tGuiJDpq3y"}],"key":"KmW4CbMc0E"}],"key":"VIsvOp38VW"},{"type":"listItem","spread":true,"position":{"start":{"line":631,"column":1},"end":{"line":631,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Ni(100): 21.10%","position":{"start":{"line":631,"column":1},"end":{"line":631,"column":1}},"key":"IviHAvxXbU"}],"key":"EHnm0fqStF"}],"key":"u6iY6P3nb7"},{"type":"listItem","spread":true,"position":{"start":{"line":632,"column":1},"end":{"line":632,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Ni(110): 5.28%","position":{"start":{"line":632,"column":1},"end":{"line":632,"column":1}},"key":"mDNbibLd6M"}],"key":"BpLaaGS7RW"}],"key":"tA6TH1PI2x"},{"type":"listItem","spread":true,"position":{"start":{"line":633,"column":1},"end":{"line":634,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Ni(211): 4.39%","position":{"start":{"line":633,"column":1},"end":{"line":633,"column":1}},"key":"teTWwpoALy"}],"key":"e52JgtEsoW"}],"key":"tRnFZvB2H3"}],"key":"VbxLz3WbXH"},{"type":"paragraph","position":{"start":{"line":635,"column":1},"end":{"line":635,"column":1}},"children":[{"type":"strong","position":{"start":{"line":635,"column":1},"end":{"line":635,"column":1}},"children":[{"type":"text","value":"Key Findings:","position":{"start":{"line":635,"column":1},"end":{"line":635,"column":1}},"key":"mW7hCd9GR4"}],"key":"IOemweCSTx"}],"key":"EeNLfW1XAL"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":636,"column":1},"end":{"line":640,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":636,"column":1},"end":{"line":636,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":636,"column":1},"end":{"line":636,"column":1}},"children":[{"type":"text","value":"(111) dominance","position":{"start":{"line":636,"column":1},"end":{"line":636,"column":1}},"key":"BrhijZxWZj"}],"key":"sAhJF3svur"},{"type":"text","value":": Both ML and DFT show \u003e65% of surface is (111) facets","position":{"start":{"line":636,"column":1},"end":{"line":636,"column":1}},"key":"BZgPW2252C"}],"key":"xMgQpnPEBt"}],"key":"sXqVy7WhMC"},{"type":"listItem","spread":true,"position":{"start":{"line":637,"column":1},"end":{"line":637,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":637,"column":1},"end":{"line":637,"column":1}},"children":[{"type":"text","value":"Shape prediction","position":{"start":{"line":637,"column":1},"end":{"line":637,"column":1}},"key":"PAIuyK08Fo"}],"key":"FmfKHEl5NK"},{"type":"text","value":": Truncated octahedron with primarily {111} and {100} faces","position":{"start":{"line":637,"column":1},"end":{"line":637,"column":1}},"key":"eae34S8A0Y"}],"key":"Ok5xSxQP4Z"}],"key":"oVYoG82dTS"},{"type":"listItem","spread":true,"position":{"start":{"line":638,"column":1},"end":{"line":638,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":638,"column":1},"end":{"line":638,"column":1}},"children":[{"type":"text","value":"Minor facets","position":{"start":{"line":638,"column":1},"end":{"line":638,"column":1}},"key":"ytDAAY52jY"}],"key":"d2SsXIbKOV"},{"type":"text","value":": (110) and (211) have small contributions (\u003c10%)","position":{"start":{"line":638,"column":1},"end":{"line":638,"column":1}},"key":"Slk3L63u7y"}],"key":"FJ3mY6llT2"}],"key":"L0mVCsRGk1"},{"type":"listItem","spread":true,"position":{"start":{"line":639,"column":1},"end":{"line":640,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":639,"column":1},"end":{"line":639,"column":1}},"children":[{"type":"text","value":"Agreement","position":{"start":{"line":639,"column":1},"end":{"line":639,"column":1}},"key":"ESFF9lSsDW"}],"key":"GBIofOAstq"},{"type":"text","value":": Area fraction ordering matches perfectly with paper","position":{"start":{"line":639,"column":1},"end":{"line":639,"column":1}},"key":"O7BvmCsZ5v"}],"key":"DkWNv7Zku1"}],"key":"g7UhpY3gVh"}],"key":"tVHPqWoVbB"},{"type":"paragraph","position":{"start":{"line":641,"column":1},"end":{"line":641,"column":1}},"children":[{"type":"strong","position":{"start":{"line":641,"column":1},"end":{"line":641,"column":1}},"children":[{"type":"text","value":"Physical interpretation:","position":{"start":{"line":641,"column":1},"end":{"line":641,"column":1}},"key":"W7Pfddy5Rv"}],"key":"qLDutwiXwk"}],"key":"K174qHbx5a"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":642,"column":1},"end":{"line":646,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":642,"column":1},"end":{"line":642,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Real Ni nanoparticles are (111)-terminated octahedra","position":{"start":{"line":642,"column":1},"end":{"line":642,"column":1}},"key":"fizFIguq8e"}],"key":"ADnfcmpSEb"}],"key":"PEkB6NiEii"},{"type":"listItem","spread":true,"position":{"start":{"line":643,"column":1},"end":{"line":643,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"(100) facets appear at corners/edges as truncations","position":{"start":{"line":643,"column":1},"end":{"line":643,"column":1}},"key":"wxAUhQUwoG"}],"key":"b7Ws3TmMoS"}],"key":"r8hk2VUM3m"},{"type":"listItem","spread":true,"position":{"start":{"line":644,"column":1},"end":{"line":644,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"This morphology is confirmed experimentally by TEM","position":{"start":{"line":644,"column":1},"end":{"line":644,"column":1}},"key":"lYRa2KR5JE"}],"key":"SMQPggIGsB"}],"key":"DVKhamdWFv"},{"type":"listItem","spread":true,"position":{"start":{"line":645,"column":1},"end":{"line":646,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Explains why (111) surface chemistry dominates catalysis","position":{"start":{"line":645,"column":1},"end":{"line":645,"column":1}},"key":"m6PQvOD2Zt"}],"key":"LxswVRw9rR"}],"key":"BZm8xPnc9R"}],"key":"V1DG2ZVomB"},{"type":"paragraph","position":{"start":{"line":647,"column":1},"end":{"line":647,"column":1}},"children":[{"type":"strong","position":{"start":{"line":647,"column":1},"end":{"line":647,"column":1}},"children":[{"type":"text","value":"Impact on catalysis:","position":{"start":{"line":647,"column":1},"end":{"line":647,"column":1}},"key":"ZqgtHSBarC"}],"key":"Wnc75eevdW"}],"key":"SbBOZDgh1B"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":648,"column":1},"end":{"line":650,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":648,"column":1},"end":{"line":648,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Must study (111) surface for representative results","position":{"start":{"line":648,"column":1},"end":{"line":648,"column":1}},"key":"unJuBReLab"}],"key":"cIvXNTvpWB"}],"key":"kO5SdB5fZN"},{"type":"listItem","spread":true,"position":{"start":{"line":649,"column":1},"end":{"line":649,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"(100) sites may be important for minority reaction pathways","position":{"start":{"line":649,"column":1},"end":{"line":649,"column":1}},"key":"USlZ1CJLFo"}],"key":"CqGYNDAKEM"}],"key":"rGPTE3xW5d"},{"type":"listItem","spread":true,"position":{"start":{"line":650,"column":1},"end":{"line":650,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Edge/corner sites (not captured here) can be highly active","position":{"start":{"line":650,"column":1},"end":{"line":650,"column":1}},"key":"JvAuXtHQKq"}],"key":"Lju9Hf6eKH"}],"key":"yZlYMRqwVw"}],"key":"H7pIPyucrx"}],"class":"note","key":"J7BF30vH4u"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Physical Interpretation","position":{"start":{"line":654,"column":1},"end":{"line":654,"column":1}},"key":"k69hZiuqoV"}],"key":"KyarEXoSNE"},{"type":"paragraph","position":{"start":{"line":657,"column":1},"end":{"line":657,"column":1}},"children":[{"type":"text","value":"The Wulff shape shows:","position":{"start":{"line":657,"column":1},"end":{"line":657,"column":1}},"key":"NMUdHyZ6pU"}],"key":"GTokTGqyix"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":658,"column":1},"end":{"line":661,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":658,"column":1},"end":{"line":658,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":658,"column":1},"end":{"line":658,"column":1}},"children":[{"type":"text","value":"(111) dominance","position":{"start":{"line":658,"column":1},"end":{"line":658,"column":1}},"key":"CBiwfxcm1o"}],"key":"CVkoKNglXk"},{"type":"text","value":": Close-packed surface has lowest energy → largest area","position":{"start":{"line":658,"column":1},"end":{"line":658,"column":1}},"key":"GkXSYBS7AD"}],"key":"GTimnr8v5X"}],"key":"rBeUlcjkwT"},{"type":"listItem","spread":true,"position":{"start":{"line":659,"column":1},"end":{"line":659,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":659,"column":1},"end":{"line":659,"column":1}},"children":[{"type":"text","value":"(100) presence","position":{"start":{"line":659,"column":1},"end":{"line":659,"column":1}},"key":"Q8vzMp8GeG"}],"key":"dmLKIUy69I"},{"type":"text","value":": Moderate energy → significant area fraction","position":{"start":{"line":659,"column":1},"end":{"line":659,"column":1}},"key":"sh8AywY5uu"}],"key":"qi4oTRB0UX"}],"key":"yM59E79y3H"},{"type":"listItem","spread":true,"position":{"start":{"line":660,"column":1},"end":{"line":661,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":660,"column":1},"end":{"line":660,"column":1}},"children":[{"type":"text","value":"(110), (211) minor","position":{"start":{"line":660,"column":1},"end":{"line":660,"column":1}},"key":"X6diNGJq9n"}],"key":"Ury4VxiJGs"},{"type":"text","value":": Higher energy → small or absent","position":{"start":{"line":660,"column":1},"end":{"line":660,"column":1}},"key":"a2iPgHHQCl"}],"key":"Johycn0Zg3"}],"key":"W5Wx4PmAV4"}],"key":"L19CTWlxw4"},{"type":"paragraph","position":{"start":{"line":662,"column":1},"end":{"line":662,"column":1}},"children":[{"type":"text","value":"This predicts that Ni nanoparticles will be predominantly {111}-faceted octahedra with {100} truncations, matching experimental observations.","position":{"start":{"line":662,"column":1},"end":{"line":662,"column":1}},"key":"CpFlAs3rO3"}],"key":"E6uNASkKYa"}],"class":"note","key":"YH6wlKmNjM"},{"type":"heading","depth":3,"position":{"start":{"line":665,"column":1},"end":{"line":665,"column":1}},"children":[{"type":"text","value":"Explore on Your Own","position":{"start":{"line":665,"column":1},"end":{"line":665,"column":1}},"key":"Zu8sY882RJ"}],"identifier":"explore-on-your-own","label":"Explore on Your Own","html_id":"explore-on-your-own-1","implicit":true,"key":"AaZm9WASTB"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":667,"column":1},"end":{"line":672,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":667,"column":1},"end":{"line":667,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":667,"column":1},"end":{"line":667,"column":1}},"children":[{"type":"text","value":"Particle size effects","position":{"start":{"line":667,"column":1},"end":{"line":667,"column":1}},"key":"Uv5gXr6iI1"}],"key":"hSMueYFQZh"},{"type":"text","value":": How would including edge/corner energies modify the shape?","position":{"start":{"line":667,"column":1},"end":{"line":667,"column":1}},"key":"h3tVC51Vas"}],"key":"jrZKzcocte"}],"key":"kqrIaJBq99"},{"type":"listItem","spread":true,"position":{"start":{"line":668,"column":1},"end":{"line":668,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":668,"column":1},"end":{"line":668,"column":1}},"children":[{"type":"text","value":"Anisotropic strain","position":{"start":{"line":668,"column":1},"end":{"line":668,"column":1}},"key":"EIouM3fcdA"}],"key":"KihoIwTDfb"},{"type":"text","value":": Apply 2% compressive strain to the lattice. How does the shape change?","position":{"start":{"line":668,"column":1},"end":{"line":668,"column":1}},"key":"XTBfAT463U"}],"key":"VEzutlgj4H"}],"key":"V9j5W0SHhh"},{"type":"listItem","spread":true,"position":{"start":{"line":669,"column":1},"end":{"line":669,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":669,"column":1},"end":{"line":669,"column":1}},"children":[{"type":"text","value":"Temperature effects","position":{"start":{"line":669,"column":1},"end":{"line":669,"column":1}},"key":"XhlQe1XP3h"}],"key":"QPqrblPTiR"},{"type":"text","value":": Surface energies decrease with T. Estimate γ(T) and recompute Wulff shape.","position":{"start":{"line":669,"column":1},"end":{"line":669,"column":1}},"key":"oKBzUWGAqB"}],"key":"B12eqnEmXc"}],"key":"CgeCf2b1c1"},{"type":"listItem","spread":true,"position":{"start":{"line":670,"column":1},"end":{"line":670,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":670,"column":1},"end":{"line":670,"column":1}},"children":[{"type":"text","value":"Alloy nanoparticles","position":{"start":{"line":670,"column":1},"end":{"line":670,"column":1}},"key":"D5wZHVpZ0M"}],"key":"peOeZHGUCH"},{"type":"text","value":": Replace some Ni with Cu or Au. How would segregation affect the shape?","position":{"start":{"line":670,"column":1},"end":{"line":670,"column":1}},"key":"t9IjG2y8FG"}],"key":"jM8HfjIVgY"}],"key":"t7C665xDC4"},{"type":"listItem","spread":true,"position":{"start":{"line":671,"column":1},"end":{"line":672,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":671,"column":1},"end":{"line":671,"column":1}},"children":[{"type":"text","value":"Support effects","position":{"start":{"line":671,"column":1},"end":{"line":671,"column":1}},"key":"k3RZRlRSsB"}],"key":"OFR0HS8P9G"},{"type":"text","value":": Some facets interact more strongly with supports. Model this by reducing their γ.","position":{"start":{"line":671,"column":1},"end":{"line":671,"column":1}},"key":"f8pAvUfenA"}],"key":"D1cjueHpql"}],"key":"Ouh1osBly2"}],"key":"LooGAjCIsX"},{"type":"thematicBreak","position":{"start":{"line":673,"column":1},"end":{"line":673,"column":1}},"key":"EXWDHmRhaG"},{"type":"heading","depth":2,"position":{"start":{"line":675,"column":1},"end":{"line":675,"column":1}},"children":[{"type":"text","value":"Part 4: H Adsorption Energy with ZPE Correction","position":{"start":{"line":675,"column":1},"end":{"line":675,"column":1}},"key":"pX4Yu0pBmI"}],"identifier":"part-4-h-adsorption-energy-with-zpe-correction","label":"Part 4: H Adsorption Energy with ZPE Correction","html_id":"part-4-h-adsorption-energy-with-zpe-correction","implicit":true,"key":"I6POTyQc5n"},{"type":"heading","depth":3,"position":{"start":{"line":677,"column":1},"end":{"line":677,"column":1}},"children":[{"type":"text","value":"Introduction","position":{"start":{"line":677,"column":1},"end":{"line":677,"column":1}},"key":"L4Qry5Fp36"}],"identifier":"introduction","label":"Introduction","html_id":"introduction-3","implicit":true,"key":"AR00qQr7Is"},{"type":"paragraph","position":{"start":{"line":679,"column":1},"end":{"line":679,"column":1}},"children":[{"type":"text","value":"Hydrogen adsorption is a fundamental step in many catalytic reactions (hydrogenation, dehydrogenation, etc.). We’ll calculate the binding energy with vibrational zero-point energy (ZPE) corrections.","position":{"start":{"line":679,"column":1},"end":{"line":679,"column":1}},"key":"VsyDHMNRXa"}],"key":"VTUxLZHLf9"},{"type":"heading","depth":3,"position":{"start":{"line":681,"column":1},"end":{"line":681,"column":1}},"children":[{"type":"text","value":"Theory","position":{"start":{"line":681,"column":1},"end":{"line":681,"column":1}},"key":"Yn1jogk6yo"}],"identifier":"theory","label":"Theory","html_id":"theory-3","implicit":true,"key":"Do3h2tULHQ"},{"type":"paragraph","position":{"start":{"line":683,"column":1},"end":{"line":683,"column":1}},"children":[{"type":"text","value":"The adsorption energy is:","position":{"start":{"line":683,"column":1},"end":{"line":683,"column":1}},"key":"iczCS5yvZc"}],"key":"QLbjjfroHE"},{"type":"math","value":"E_{\\text{ads}} = E(\\text{slab+H}) - E(\\text{slab}) - \\frac{1}{2}E(\\text{H}_2)","position":{"start":{"line":685,"column":1},"end":{"line":687,"column":1}},"html":"\u003cspan class=\"katex-display\"\u003e\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsub\u003e\u003cmi\u003eE\u003c/mi\u003e\u003cmtext\u003eads\u003c/mtext\u003e\u003c/msub\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmi\u003eE\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmtext\u003eslab+H\u003c/mtext\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003cmo\u003e−\u003c/mo\u003e\u003cmi\u003eE\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmtext\u003eslab\u003c/mtext\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003cmo\u003e−\u003c/mo\u003e\u003cmfrac\u003e\u003cmn\u003e1\u003c/mn\u003e\u003cmn\u003e2\u003c/mn\u003e\u003c/mfrac\u003e\u003cmi\u003eE\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmsub\u003e\u003cmtext\u003eH\u003c/mtext\u003e\u003cmn\u003e2\u003c/mn\u003e\u003c/msub\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003eE_{\\text{ads}} = E(\\text{slab+H}) - E(\\text{slab}) - \\frac{1}{2}E(\\text{H}_2)\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.05764em;\"\u003eE\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3361em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord text mtight\"\u003e\u003cspan class=\"mord mtight\"\u003eads\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.05764em;\"\u003eE\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord text\"\u003e\u003cspan class=\"mord\"\u003eslab+H\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e−\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.05764em;\"\u003eE\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord text\"\u003e\u003cspan class=\"mord\"\u003eslab\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e−\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:2.0074em;vertical-align:-0.686em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mopen nulldelimiter\"\u003e\u003c/span\u003e\u003cspan class=\"mfrac\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.3214em;\"\u003e\u003cspan style=\"top:-2.314em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e2\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.23em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"frac-line\" style=\"border-bottom-width:0.04em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.677em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.686em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose nulldelimiter\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.05764em;\"\u003eE\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord text\"\u003e\u003cspan class=\"mord\"\u003eH\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3011em;\"\u003e\u003cspan style=\"top:-2.55em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e2\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","enumerator":"3","key":"CAirYNkUXa"},{"type":"paragraph","position":{"start":{"line":689,"column":1},"end":{"line":689,"column":1}},"children":[{"type":"text","value":"ZPE correction accounts for quantum vibrational effects:","position":{"start":{"line":689,"column":1},"end":{"line":689,"column":1}},"key":"NupvRtIWa7"}],"key":"qGW1DzQdl6"},{"type":"math","value":"E_{\\text{ads}}^{\\text{ZPE}} = E_{\\text{ads}} + \\text{ZPE}(\\text{H}^*) - \\frac{1}{2}\\text{ZPE}(\\text{H}_2)","position":{"start":{"line":691,"column":1},"end":{"line":693,"column":1}},"html":"\u003cspan class=\"katex-display\"\u003e\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsubsup\u003e\u003cmi\u003eE\u003c/mi\u003e\u003cmtext\u003eads\u003c/mtext\u003e\u003cmtext\u003eZPE\u003c/mtext\u003e\u003c/msubsup\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmsub\u003e\u003cmi\u003eE\u003c/mi\u003e\u003cmtext\u003eads\u003c/mtext\u003e\u003c/msub\u003e\u003cmo\u003e+\u003c/mo\u003e\u003cmtext\u003eZPE\u003c/mtext\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmsup\u003e\u003cmtext\u003eH\u003c/mtext\u003e\u003cmo\u003e∗\u003c/mo\u003e\u003c/msup\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003cmo\u003e−\u003c/mo\u003e\u003cmfrac\u003e\u003cmn\u003e1\u003c/mn\u003e\u003cmn\u003e2\u003c/mn\u003e\u003c/mfrac\u003e\u003cmtext\u003eZPE\u003c/mtext\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmsub\u003e\u003cmtext\u003eH\u003c/mtext\u003e\u003cmn\u003e2\u003c/mn\u003e\u003c/msub\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003eE_{\\text{ads}}^{\\text{ZPE}} = E_{\\text{ads}} + \\text{ZPE}(\\text{H}^*) - \\frac{1}{2}\\text{ZPE}(\\text{H}_2)\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1.1383em;vertical-align:-0.247em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.05764em;\"\u003eE\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8913em;\"\u003e\u003cspan style=\"top:-2.453em;margin-left:-0.0576em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord text mtight\"\u003e\u003cspan class=\"mord mtight\"\u003eads\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.113em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord text mtight\"\u003e\u003cspan class=\"mord mtight\"\u003eZPE\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.247em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.05764em;\"\u003eE\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3361em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord text mtight\"\u003e\u003cspan class=\"mord mtight\"\u003eads\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e+\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1.0119em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord text\"\u003e\u003cspan class=\"mord\"\u003eZPE\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord text\"\u003e\u003cspan class=\"mord\"\u003eH\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.7619em;\"\u003e\u003cspan style=\"top:-3.1362em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mbin mtight\"\u003e∗\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e−\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:2.0074em;vertical-align:-0.686em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mopen nulldelimiter\"\u003e\u003c/span\u003e\u003cspan class=\"mfrac\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.3214em;\"\u003e\u003cspan style=\"top:-2.314em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e2\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.23em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"frac-line\" style=\"border-bottom-width:0.04em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.677em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.686em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose nulldelimiter\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mord text\"\u003e\u003cspan class=\"mord\"\u003eZPE\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord text\"\u003e\u003cspan class=\"mord\"\u003eH\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3011em;\"\u003e\u003cspan style=\"top:-2.55em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e2\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","enumerator":"4","key":"YQLGBMut4A"},{"type":"paragraph","position":{"start":{"line":695,"column":1},"end":{"line":695,"column":1}},"children":[{"type":"text","value":"The ZPE correction is calculated by analyzing the vibrational modes of the molecule/adsorbate.","position":{"start":{"line":695,"column":1},"end":{"line":695,"column":1}},"key":"IqktRCDKQc"}],"key":"xEMBJGf5iT"},{"type":"heading","depth":3,"position":{"start":{"line":697,"column":1},"end":{"line":697,"column":1}},"children":[{"type":"text","value":"Step 1: Setup and Relax Clean Slab","position":{"start":{"line":697,"column":1},"end":{"line":697,"column":1}},"key":"HF98DjnUFB"}],"identifier":"step-1-setup-and-relax-clean-slab","label":"Step 1: Setup and Relax Clean Slab","html_id":"step-1-setup-and-relax-clean-slab","implicit":true,"key":"N26Vp4D8XF"},{"type":"paragraph","position":{"start":{"line":699,"column":1},"end":{"line":699,"column":1}},"children":[{"type":"text","value":"First, we create the Ni(111) surface and relax it:","position":{"start":{"line":699,"column":1},"end":{"line":699,"column":1}},"key":"ISbsCBHriN"}],"key":"mUaiXkbTBR"}],"key":"mRusre50lJ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Create Ni(111) slab\nni_bulk_atoms = bulk(\"Ni\", \"fcc\", a=a_opt, cubic=True)\nni_bulk_obj = Bulk(bulk_atoms=ni_bulk_atoms)\nni_slabs = Slab.from_bulk_get_specific_millers(\n    bulk=ni_bulk_obj, specific_millers=(1, 1, 1)\n)\nni_slab = ni_slabs[0].atoms\n\nprint(f\"   Created {len(ni_slab)} atom slab\")\n\n# Set up calculators\ncalc = FAIRChemCalculator(predictor, task_name=\"oc20\")\nd3_calc = TorchDFTD3Calculator(device=\"cpu\", damping=\"bj\")\nprint(\"   Calculators initialized (ML + D3)\")","key":"tUd68fVrUY"},{"type":"outputs","id":"djyVM0eVzomWuNVRUdOLf","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"   Created 96 atom slab\n   Calculators initialized (ML + D3)\n"},"key":"XtRXoAiO9h"}],"key":"h6ScrCq1MO"}],"key":"x0Enl9tVx4"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":718,"column":1},"end":{"line":718,"column":1}},"children":[{"type":"text","value":"Step 2: Relax Clean Slab","position":{"start":{"line":718,"column":1},"end":{"line":718,"column":1}},"key":"Nw5ml5rz8C"}],"identifier":"step-2-relax-clean-slab","label":"Step 2: Relax Clean Slab","html_id":"step-2-relax-clean-slab","implicit":true,"key":"gJdyRR72kX"},{"type":"paragraph","position":{"start":{"line":720,"column":1},"end":{"line":720,"column":1}},"children":[{"type":"text","value":"Relax the bare Ni(111) surface as our reference:","position":{"start":{"line":720,"column":1},"end":{"line":720,"column":1}},"key":"f1xkZNi9MC"}],"key":"U4rLrLZRg4"}],"key":"YAH8a58tyT"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(\"\\n1. Relaxing clean Ni(111) slab...\")\nclean_slab = ni_slab.copy()\nclean_slab.set_pbc([True, True, True])\nclean_slab.calc = calc\n\nopt = LBFGS(\n    clean_slab,\n    trajectory=str(output_dir / part_dirs[\"part4\"] / \"ni111_clean.traj\"),\n    logfile=str(output_dir / part_dirs[\"part4\"] / \"ni111_clean.log\"),\n)\nopt.run(fmax=0.05, steps=relaxation_steps)\n\nE_clean_ml = clean_slab.get_potential_energy()\nclean_slab.calc = d3_calc\nE_clean_d3 = clean_slab.get_potential_energy()\nE_clean = E_clean_ml + E_clean_d3\nprint(f\"   E(clean): {E_clean:.2f} eV (ML: {E_clean_ml:.2f}, D3: {E_clean_d3:.2f})\")\n\n# Save clean slab\nase.io.write(str(output_dir / part_dirs[\"part4\"] / \"ni111_clean.xyz\"), clean_slab)\nprint(\"   ✓ Clean slab relaxed and saved\")","key":"dnFtILHiUF"},{"type":"outputs","id":"lwbr5E-nz2m5U9W7Y8TCF","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"\n1. Relaxing clean Ni(111) slab...\n"},"key":"ULof6elkh3"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"/home/runner/work/_tool/Python/3.12.12/x64/lib/python3.12/site-packages/torch_dftd/torch_dftd3_calculator.py:98: UserWarning: Creating a tensor from a list of numpy.ndarrays is extremely slow. Please consider converting the list to a single numpy.ndarray with numpy.array() before converting to a tensor. (Triggered internally at /pytorch/torch/csrc/utils/tensor_new.cpp:253.)\n  cell: Optional[Tensor] = torch.tensor(\n"},"key":"nW59bG7R7t"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"   E(clean): -487.46 eV (ML: -450.89, D3: -36.57)\n   ✓ Clean slab relaxed and saved\n"},"key":"KONtvO4ZtV"}],"key":"roxB1fRcGq"}],"key":"x00VxXA1nl"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":746,"column":1},"end":{"line":746,"column":1}},"children":[{"type":"text","value":"Step 3: Generate H Adsorption Sites","position":{"start":{"line":746,"column":1},"end":{"line":746,"column":1}},"key":"RYBHH5Tt87"}],"identifier":"step-3-generate-h-adsorption-sites","label":"Step 3: Generate H Adsorption Sites","html_id":"step-3-generate-h-adsorption-sites","implicit":true,"key":"zkt0KCajTq"},{"type":"paragraph","position":{"start":{"line":748,"column":1},"end":{"line":748,"column":1}},"children":[{"type":"text","value":"Use heuristic placement to generate multiple candidate H adsorption sites:","position":{"start":{"line":748,"column":1},"end":{"line":748,"column":1}},"key":"Ux1IJ9XvtA"}],"key":"oNY2qPbNrd"}],"key":"RvOZjKH52l"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(\"\\n2. Generating 5 H adsorption sites...\")\nni_slab_for_ads = ni_slabs[0]\nni_slab_for_ads.atoms = clean_slab.copy()\n\nadsorbate_h = Adsorbate(adsorbate_smiles_from_db=\"*H\")\nads_slab_config = AdsorbateSlabConfig(\n    ni_slab_for_ads,\n    adsorbate_h,\n    mode=\"random_site_heuristic_placement\",\n    num_sites=num_sites,\n)\n\nprint(f\"   Generated {len(ads_slab_config.atoms_list)} initial configurations\")\nprint(\"   These include fcc, hcp, bridge, and top sites\")","key":"BzVFdz3L06"},{"type":"outputs","id":"bQo1Jh-yzCp6lMl91C9SN","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"\n2. Generating 5 H adsorption sites...\n"},"key":"KiRCeIBX3J"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"   Generated 2 initial configurations\n   These include fcc, hcp, bridge, and top sites\n"},"key":"kph1zvROsg"}],"key":"KFNQo0evq9"}],"key":"uMrNZ1n6Fc"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":767,"column":1},"end":{"line":767,"column":1}},"children":[{"type":"text","value":"Step 4: Relax All H Configurations","position":{"start":{"line":767,"column":1},"end":{"line":767,"column":1}},"key":"P10BQr4SBp"}],"identifier":"step-4-relax-all-h-configurations","label":"Step 4: Relax All H Configurations","html_id":"step-4-relax-all-h-configurations","implicit":true,"key":"FdMd8Tu0Dx"},{"type":"paragraph","position":{"start":{"line":769,"column":1},"end":{"line":769,"column":1}},"children":[{"type":"text","value":"Relax each configuration and identify the most stable site:","position":{"start":{"line":769,"column":1},"end":{"line":769,"column":1}},"key":"jMcIcsyGyc"}],"key":"Oqot0UnosJ"}],"key":"vWuuy0n4HU"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(\"\\n3. Relaxing all H adsorption configurations...\")\nh_energies = []\nh_configs = []\nh_d3_energies = []\n\nfor idx, config in enumerate(ads_slab_config.atoms_list):\n    config_relaxed = config.copy()\n    config_relaxed.set_pbc([True, True, True])\n    config_relaxed.calc = calc\n\n    opt = LBFGS(\n        config_relaxed,\n        trajectory=str(output_dir / part_dirs[\"part4\"] / f\"h_site_{idx+1}.traj\"),\n        logfile=str(output_dir / part_dirs[\"part4\"] / f\"h_site_{idx+1}.log\"),\n    )\n    opt.run(fmax=0.05, steps=relaxation_steps)\n\n    E_ml = config_relaxed.get_potential_energy()\n    config_relaxed.calc = d3_calc\n    E_d3 = config_relaxed.get_potential_energy()\n    E_total = E_ml + E_d3\n\n    h_energies.append(E_total)\n    h_configs.append(config_relaxed)\n    h_d3_energies.append(E_d3)\n    print(f\"   Config {idx+1}: {E_total:.2f} eV (ML: {E_ml:.2f}, D3: {E_d3:.2f})\")\n\n    # Save structure\n    ase.io.write(\n        str(output_dir / part_dirs[\"part4\"] / f\"h_site_{idx+1}.xyz\"), config_relaxed\n    )\n\n# Select best configuration\nbest_idx = np.argmin(h_energies)\nslab_with_h = h_configs[best_idx]\nE_with_h = h_energies[best_idx]\nE_with_h_d3 = h_d3_energies[best_idx]\n\nprint(f\"\\n   ✓ Best site: Config {best_idx+1}, E = {E_with_h:.2f} eV\")\nprint(f\"   Energy spread: {max(h_energies) - min(h_energies):.2f} eV\")\nprint(f\"   This spread indicates the importance of testing multiple sites!\")","key":"pJFShgZPOQ"},{"type":"outputs","id":"XFdSIuhqdh4DD0GoOxz73","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"\n3. Relaxing all H adsorption configurations...\n"},"key":"nv7JRjPXMI"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"   Config 1: -491.53 eV (ML: -454.87, D3: -36.65)\n"},"key":"w4QHgnEz23"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"   Config 2: -491.48 eV (ML: -454.82, D3: -36.66)\n\n   ✓ Best site: Config 1, E = -491.53 eV\n   Energy spread: 0.05 eV\n   This spread indicates the importance of testing multiple sites!\n"},"key":"bUyRsUbwse"}],"key":"uRifPjQsQ3"}],"key":"ec5c5JjL92"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":815,"column":1},"end":{"line":815,"column":1}},"children":[{"type":"text","value":"Step 5: Calculate H₂ Reference Energy","position":{"start":{"line":815,"column":1},"end":{"line":815,"column":1}},"key":"AGTQQv6eXJ"}],"identifier":"step-5-calculate-h-reference-energy","label":"Step 5: Calculate H₂ Reference Energy","html_id":"step-5-calculate-h-reference-energy","implicit":true,"key":"qkAHjIso2I"},{"type":"paragraph","position":{"start":{"line":817,"column":1},"end":{"line":817,"column":1}},"children":[{"type":"text","value":"We need the H₂ molecule energy as a reference:","position":{"start":{"line":817,"column":1},"end":{"line":817,"column":1}},"key":"PZQkoz0NON"}],"key":"mkF1RRz2P7"}],"key":"Zwli03I1gk"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(\"\\n4. Calculating H₂ reference energy...\")\nh2 = Atoms(\"H2\", positions=[[0, 0, 0], [0, 0, 0.74]])\nh2.center(vacuum=10.0)\nh2.set_pbc([True, True, True])\nh2.calc = calc\n\nopt = LBFGS(\n    h2,\n    trajectory=str(output_dir / part_dirs[\"part4\"] / \"h2.traj\"),\n    logfile=str(output_dir / part_dirs[\"part4\"] / \"h2.log\"),\n)\nopt.run(fmax=0.05, steps=relaxation_steps)\n\nE_h2_ml = h2.get_potential_energy()\nh2.calc = d3_calc\nE_h2_d3 = h2.get_potential_energy()\nE_h2 = E_h2_ml + E_h2_d3\nprint(f\"   E(H₂): {E_h2:.2f} eV (ML: {E_h2_ml:.2f}, D3: {E_h2_d3:.2f})\")\n\n# Save H2 structure\nase.io.write(str(output_dir / part_dirs[\"part4\"] / \"h2_optimized.xyz\"), h2)","key":"Uv2UNTYuSH"},{"type":"outputs","id":"Dmobw7YK2K8Xp16KpDdpo","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"\n4. Calculating H₂ reference energy...\n"},"key":"CAqttKVvbM"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"   E(H₂): -6.97 eV (ML: -6.97, D3: -0.00)\n"},"key":"G644ueFpom"}],"key":"FXDdkpt15M"}],"key":"euRXGlu9p7"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":843,"column":1},"end":{"line":843,"column":1}},"children":[{"type":"text","value":"Step 6: Compute Adsorption Energy","position":{"start":{"line":843,"column":1},"end":{"line":843,"column":1}},"key":"pkwuvX69Je"}],"identifier":"step-6-compute-adsorption-energy","label":"Step 6: Compute Adsorption Energy","html_id":"step-6-compute-adsorption-energy","implicit":true,"key":"Nd1cYGCkgt"},{"type":"paragraph","position":{"start":{"line":845,"column":1},"end":{"line":845,"column":1}},"children":[{"type":"text","value":"Calculate the adsorption energy using the formula: E_ads = E(slab+H) - E(slab) - 0.5×E(H₂)","position":{"start":{"line":845,"column":1},"end":{"line":845,"column":1}},"key":"P9jtg7UfLL"}],"key":"XQKstpYvL3"}],"key":"jqOHZfBFoQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(f\"\\n4. Computing Adsorption Energy:\")\nprint(\"   E_ads = E(slab+H) - E(slab) - 0.5×E(H₂)\")\n\nE_ads = E_with_h - E_clean - 0.5 * E_h2\nE_ads_no_d3 = (E_with_h - E_with_h_d3) - (E_clean - E_clean_d3) - 0.5 * (E_h2 - E_h2_d3)\n\nprint(f\"\\n   Without D3: {E_ads_no_d3:.2f} eV\")\nprint(f\"   With D3:    {E_ads:.2f} eV\")\nprint(f\"   D3 effect:  {E_ads - E_ads_no_d3:.2f} eV\")\nprint(f\"\\n   → D3 corrections are negligible for H* (small, covalent bonding)\")","key":"m7h4LsOQKQ"},{"type":"outputs","id":"YMb3dy1Osyehle8k3ztn8","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"\n4. Computing Adsorption Energy:\n   E_ads = E(slab+H) - E(slab) - 0.5×E(H₂)\n\n   Without D3: -0.50 eV\n   With D3:    -0.58 eV\n   D3 effect:  -0.08 eV\n\n   → D3 corrections are negligible for H* (small, covalent bonding)\n"},"key":"gAybx6BDrx"}],"key":"v2psFkVjxP"}],"key":"coXRzz8QNY"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":860,"column":1},"end":{"line":860,"column":1}},"children":[{"type":"text","value":"Step 7: Zero-Point Energy (ZPE) Corrections","position":{"start":{"line":860,"column":1},"end":{"line":860,"column":1}},"key":"aksq50IacI"}],"identifier":"step-7-zero-point-energy-zpe-corrections","label":"Step 7: Zero-Point Energy (ZPE) Corrections","html_id":"step-7-zero-point-energy-zpe-corrections","implicit":true,"key":"YgysO6W90g"},{"type":"paragraph","position":{"start":{"line":862,"column":1},"end":{"line":862,"column":1}},"children":[{"type":"text","value":"Calculate vibrational frequencies to get ZPE corrections:","position":{"start":{"line":862,"column":1},"end":{"line":862,"column":1}},"key":"nViufBYGYV"}],"key":"YdUjcrbrRc"}],"key":"ccz1lhNFkg"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(\"\\n6. Computing ZPE corrections...\")\nprint(\"   This accounts for quantum vibrational effects\")\nh_index = len(slab_with_h) - 1\nslab_with_h.calc = calc\nvib = Vibrations(slab_with_h, indices=[h_index], delta=0.02)\nvib.run()\nvib_energies = vib.get_energies()\nzpe_ads = np.sum(vib_energies) / 2.0\n\nh2.calc = calc\nvib_h2 = Vibrations(h2, indices=[0, 1], delta=0.02)\nvib_h2.run()\nvib_energies_h2 = vib_h2.get_energies()\nzpe_h2 = np.sum(vib_energies_h2) / 2.0\n\nE_ads_zpe = E_ads + zpe_ads - 0.5 * zpe_h2\n\nprint(f\"   ZPE(H*):  {zpe_ads:.2f} eV\")\nprint(f\"   ZPE(H₂):  {zpe_h2:.2f} eV\")\nprint(f\"   E_ads(ZPE): {E_ads_zpe:.2f} eV\")\n\n# Visualize vibrational modes\nprint(\"\\n   Creating animations of vibrational modes...\")\nvib.write_mode(n=0)\nase.io.write(\"vib.0.gif\", ase.io.read(\"vib.0.traj@:\"), rotation=(\"-45x,0y,0z\"))\n\nvib.clean()\nvib_h2.clean()","key":"azs8lWsney"},{"type":"outputs","id":"eqb4oKmjh-3U4I0Lqoq_-","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"\n6. Computing ZPE corrections...\n   This accounts for quantum vibrational effects\n"},"key":"vRa83H6bj1"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"   ZPE(H*):  0.18+0.00j eV\n   ZPE(H₂):  0.41+0.00j eV\n   E_ads(ZPE): -0.61-0.00j eV\n\n   Creating animations of vibrational modes...\n"},"key":"Njcf7HBgsb"},{"type":"output","children":[],"jupyter_data":{"output_type":"execute_result","execution_count":19,"metadata":{},"data":{"text/plain":{"content":"0","content_type":"text/plain"}}},"key":"hM83X9QEkY"},{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"\u003cFigure size 640x480 with 1 Axes\u003e","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"aa68cff275eb0848410ea1eb3c9eb9c0","path":"/build/aa68cff275eb0848410ea1eb3c9eb9c0.png"}}},"key":"Ws57D9ZvO9"}],"key":"OKIDk1ImP7"}],"key":"Kd4Se9YdZ5"},{"type":"block","children":[{"type":"image","url":"/build/vib.0-3108e0682b2bf05fbb952db933022aed.gif","width":750,"key":"hKIZaPLH0i","urlSource":"vib.0.gif"}],"key":"Bu0nz2rVyw"},{"type":"block","position":{"start":{"line":897,"column":1},"end":{"line":897,"column":1}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":899,"column":1},"end":{"line":899,"column":1}},"children":[{"type":"text","value":"Step 8: Visualize and Compare Results","position":{"start":{"line":899,"column":1},"end":{"line":899,"column":1}},"key":"jjNwYz4TrA"}],"identifier":"step-8-visualize-and-compare-results","label":"Step 8: Visualize and Compare Results","html_id":"step-8-visualize-and-compare-results","implicit":true,"key":"cUgOtGINIw"},{"type":"paragraph","position":{"start":{"line":901,"column":1},"end":{"line":901,"column":1}},"children":[{"type":"text","value":"Visualize the best configuration and compare with literature:","position":{"start":{"line":901,"column":1},"end":{"line":901,"column":1}},"key":"tiT2imp2Iy"}],"key":"ZDd4coaGwC"}],"key":"pjxbSDLuuh"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(\"\\n7. Visualizing best H* configuration...\")\nview(slab_with_h, viewer='x3d')","key":"o5QWWDSq73"},{"type":"outputs","id":"t10vEmj9aj396KHHq2Yab","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"\n7. Visualizing best H* configuration...\n"},"key":"I1AXj7EtZX"},{"type":"output","children":[],"jupyter_data":{"output_type":"execute_result","execution_count":20,"metadata":{},"data":{"text/plain":{"content":"\u003cIPython.core.display.HTML object\u003e","content_type":"text/plain"},"text/html":{"content_type":"text/html","hash":"8a044c5db562a5fe17df40e6b0a2164c","path":"/build/8a044c5db562a5fe17df40e6b0a2164c.html"}}},"key":"BJ689gvIxb"}],"key":"PCBpqSwVZk"}],"key":"QqU2Dj8CYd"},{"type":"block","children":[{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Missing UMA access?","position":{"start":{"line":908,"column":1},"end":{"line":908,"column":1}},"key":"BD5sC7VUeJ"}],"key":"bnxuRR4qZo"},{"type":"paragraph","position":{"start":{"line":911,"column":1},"end":{"line":911,"column":1}},"children":[{"type":"text","value":"Don’t have access to UMA yet? You can still explore this calculation!","position":{"start":{"line":911,"column":1},"end":{"line":911,"column":1}},"key":"IkJJunCqWx"}],"key":"IbgrgnEjgo"},{"type":"paragraph","position":{"start":{"line":913,"column":1},"end":{"line":913,"column":1}},"children":[{"type":"link","url":"example_configs/h_on_ni111.xyz","position":{"start":{"line":913,"column":1},"end":{"line":913,"column":1}},"children":[{"type":"text","value":"Download example H on Ni(111) structure","position":{"start":{"line":913,"column":1},"end":{"line":913,"column":1}},"key":"Q7z6bKl1zA"}],"urlSource":"example_configs/h_on_ni111.xyz","key":"mxLjdCgQEi"},{"type":"text","value":" and test it in the ","position":{"start":{"line":913,"column":1},"end":{"line":913,"column":1}},"key":"Gbqrqi2hlL"},{"type":"link","url":"https://facebook-fairchem-uma-demo.hf.space/","position":{"start":{"line":913,"column":1},"end":{"line":913,"column":1}},"children":[{"type":"text","value":"UMA demo (no login required)","position":{"start":{"line":913,"column":1},"end":{"line":913,"column":1}},"key":"WNoahA5rsC"}],"urlSource":"https://facebook-fairchem-uma-demo.hf.space/","key":"gzScW2U7Yx"},{"type":"text","value":" to see how the model predicts adsorption properties.","position":{"start":{"line":913,"column":1},"end":{"line":913,"column":1}},"key":"SqHLDvmjVE"}],"key":"lEtRDxhxKm"}],"class":"dropdown, tip","key":"RHAOm5BtDR"}],"key":"bRvxYyDz1M"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# 6. Compare with literature\nprint(f\"\\n{'='*60}\")\nprint(\"Comparison with Literature:\")\nprint(f\"{'='*60}\")\nprint(\"Table 4 (DFT): -0.60 eV (Ni(111), ref H₂)\")\nprint(f\"This work:     {E_ads_zpe:.2f} eV\")\nprint(f\"Difference:    {abs(E_ads_zpe - (-0.60)):.2f} eV\")","key":"aScgQIfQae"},{"type":"outputs","id":"Ir0eng549xoRc5AqDCvLv","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"\n============================================================\nComparison with Literature:\n============================================================\nTable 4 (DFT): -0.60 eV (Ni(111), ref H₂)\nThis work:     -0.61-0.00j eV\nDifference:    0.01 eV\n"},"key":"gIaelVXstc"}],"key":"cIA7wL7EPO"}],"key":"YjnJsQFBob"},{"type":"block","children":[{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"D3 Dispersion Corrections","position":{"start":{"line":926,"column":1},"end":{"line":926,"column":1}},"key":"B4cu8cXJJS"}],"key":"pCTqGFZZKU"},{"type":"paragraph","position":{"start":{"line":929,"column":1},"end":{"line":929,"column":1}},"children":[{"type":"text","value":"Dispersion (van der Waals) interactions are important for:","position":{"start":{"line":929,"column":1},"end":{"line":929,"column":1}},"key":"kmkhP3K8pp"}],"key":"c08uaagdN1"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":930,"column":1},"end":{"line":933,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":930,"column":1},"end":{"line":930,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Large molecules (CO, CO₂)","position":{"start":{"line":930,"column":1},"end":{"line":930,"column":1}},"key":"ggdhN6yH1u"}],"key":"Ymu0yUQcLl"}],"key":"vzchDdeIE0"},{"type":"listItem","spread":true,"position":{"start":{"line":931,"column":1},"end":{"line":931,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Physisorption","position":{"start":{"line":931,"column":1},"end":{"line":931,"column":1}},"key":"Gqrmf6GyQl"}],"key":"BG4YwjhkYM"}],"key":"uYjYjr9CEn"},{"type":"listItem","spread":true,"position":{"start":{"line":932,"column":1},"end":{"line":933,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Metal-support interfaces","position":{"start":{"line":932,"column":1},"end":{"line":932,"column":1}},"key":"GhiSYGo8Pw"}],"key":"lqokNJUabX"}],"key":"y9wONHeJB8"}],"key":"L0SpB6eFer"},{"type":"paragraph","position":{"start":{"line":934,"column":1},"end":{"line":934,"column":1}},"children":[{"type":"text","value":"For H adsorption, D3 corrections are typically small (\u003c0.1 eV) because H forms strong covalent bonds with the surface. However, always check the magnitude!","position":{"start":{"line":934,"column":1},"end":{"line":934,"column":1}},"key":"Objm97NCNp"}],"key":"yYEzCV6PCy"}],"class":"tip","key":"JZEdosalix"},{"type":"heading","depth":3,"position":{"start":{"line":937,"column":1},"end":{"line":937,"column":1}},"children":[{"type":"text","value":"Explore on Your Own","position":{"start":{"line":937,"column":1},"end":{"line":937,"column":1}},"key":"hZ0jETj0hK"}],"identifier":"explore-on-your-own","label":"Explore on Your Own","html_id":"explore-on-your-own-2","implicit":true,"key":"mshoRLd77D"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":939,"column":1},"end":{"line":944,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":939,"column":1},"end":{"line":939,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":939,"column":1},"end":{"line":939,"column":1}},"children":[{"type":"text","value":"Site preference","position":{"start":{"line":939,"column":1},"end":{"line":939,"column":1}},"key":"NJCsdB4AwH"}],"key":"VJClDioHYz"},{"type":"text","value":": Identify which site (fcc, hcp, bridge, top) the H prefers. Visualize with ","position":{"start":{"line":939,"column":1},"end":{"line":939,"column":1}},"key":"EWZfswemaQ"},{"type":"inlineCode","value":"view(atoms, viewer='x3d')","position":{"start":{"line":939,"column":1},"end":{"line":939,"column":1}},"key":"N8aR3lYDHG"},{"type":"text","value":".","position":{"start":{"line":939,"column":1},"end":{"line":939,"column":1}},"key":"QWCnsVtl9J"}],"key":"KXLcX4Vt12"}],"key":"H7lgOvTSB1"},{"type":"listItem","spread":true,"position":{"start":{"line":940,"column":1},"end":{"line":940,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":940,"column":1},"end":{"line":940,"column":1}},"children":[{"type":"text","value":"Coverage effects","position":{"start":{"line":940,"column":1},"end":{"line":940,"column":1}},"key":"lVyphYkRL9"}],"key":"Jz4EOaRcgP"},{"type":"text","value":": Place 2 H atoms on the slab. How does binding change with separation?","position":{"start":{"line":940,"column":1},"end":{"line":940,"column":1}},"key":"CNXBc8k3WY"}],"key":"dBI0zAKm5s"}],"key":"bE5I55N3DG"},{"type":"listItem","spread":true,"position":{"start":{"line":941,"column":1},"end":{"line":941,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":941,"column":1},"end":{"line":941,"column":1}},"children":[{"type":"text","value":"Different facets","position":{"start":{"line":941,"column":1},"end":{"line":941,"column":1}},"key":"klvIhrTi6L"}],"key":"qeoOJwNrXQ"},{"type":"text","value":": Compare H adsorption on (100) and (110) surfaces. Which is strongest?","position":{"start":{"line":941,"column":1},"end":{"line":941,"column":1}},"key":"nckuhgnuwn"}],"key":"FYG9lmCh9m"}],"key":"NEKYaCwWFM"},{"type":"listItem","spread":true,"position":{"start":{"line":942,"column":1},"end":{"line":942,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":942,"column":1},"end":{"line":942,"column":1}},"children":[{"type":"text","value":"Subsurface H","position":{"start":{"line":942,"column":1},"end":{"line":942,"column":1}},"key":"WEI3Jn4bWf"}],"key":"AlDtr9Jf0e"},{"type":"text","value":": Place H below the surface layer. Is it stable?","position":{"start":{"line":942,"column":1},"end":{"line":942,"column":1}},"key":"Su5ASfhIVw"}],"key":"h9VuF84fRE"}],"key":"j0Ejv7cPjd"},{"type":"listItem","spread":true,"position":{"start":{"line":943,"column":1},"end":{"line":944,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":943,"column":1},"end":{"line":943,"column":1}},"children":[{"type":"text","value":"ZPE uncertainty","position":{"start":{"line":943,"column":1},"end":{"line":943,"column":1}},"key":"RPNtg3oSgC"}],"key":"T9TXu6zFt0"},{"type":"text","value":": How sensitive is E_ads to the vibrational delta parameter (try 0.01, 0.03 Å)?","position":{"start":{"line":943,"column":1},"end":{"line":943,"column":1}},"key":"puScatlnlf"}],"key":"GlLwMOsyg8"}],"key":"d58RnrBqhA"}],"key":"VcXp9YU1fT"},{"type":"thematicBreak","position":{"start":{"line":945,"column":1},"end":{"line":945,"column":1}},"key":"EWWvW4sIX3"},{"type":"heading","depth":2,"position":{"start":{"line":947,"column":1},"end":{"line":947,"column":1}},"children":[{"type":"text","value":"Part 5: Coverage-Dependent H Adsorption","position":{"start":{"line":947,"column":1},"end":{"line":947,"column":1}},"key":"F0P1cKlDNY"}],"identifier":"part-5-coverage-dependent-h-adsorption","label":"Part 5: Coverage-Dependent H Adsorption","html_id":"part-5-coverage-dependent-h-adsorption","implicit":true,"key":"HRbiGF59Yv"},{"type":"heading","depth":3,"position":{"start":{"line":949,"column":1},"end":{"line":949,"column":1}},"children":[{"type":"text","value":"Introduction","position":{"start":{"line":949,"column":1},"end":{"line":949,"column":1}},"key":"guiV2ndLNm"}],"identifier":"introduction","label":"Introduction","html_id":"introduction-4","implicit":true,"key":"ZTKuJSPCc9"},{"type":"paragraph","position":{"start":{"line":951,"column":1},"end":{"line":951,"column":1}},"children":[{"type":"text","value":"At higher coverages, adsorbate-adsorbate interactions become significant. We’ll study how H binding energy changes from dilute (1 atom) to saturated (full monolayer) coverage.","position":{"start":{"line":951,"column":1},"end":{"line":951,"column":1}},"key":"v36ZmfojCP"}],"key":"ioKs9XPq4v"},{"type":"heading","depth":3,"position":{"start":{"line":953,"column":1},"end":{"line":953,"column":1}},"children":[{"type":"text","value":"Theory","position":{"start":{"line":953,"column":1},"end":{"line":953,"column":1}},"key":"xw8W2ZtE4K"}],"identifier":"theory","label":"Theory","html_id":"theory-4","implicit":true,"key":"tswnk1fJXz"},{"type":"paragraph","position":{"start":{"line":955,"column":1},"end":{"line":955,"column":1}},"children":[{"type":"text","value":"The differential adsorption energy at coverage θ is:","position":{"start":{"line":955,"column":1},"end":{"line":955,"column":1}},"key":"QVbYgbZ2Se"}],"key":"Mi9J6ddKMw"},{"type":"math","value":"E_{\\text{ads}}(\\theta) = \\frac{E(n\\text{H}^*) - E(*) - n \\cdot \\frac{1}{2}E(\\text{H}_2)}{n}","position":{"start":{"line":957,"column":1},"end":{"line":959,"column":1}},"html":"\u003cspan class=\"katex-display\"\u003e\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsub\u003e\u003cmi\u003eE\u003c/mi\u003e\u003cmtext\u003eads\u003c/mtext\u003e\u003c/msub\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmi\u003eθ\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmfrac\u003e\u003cmrow\u003e\u003cmi\u003eE\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmi\u003en\u003c/mi\u003e\u003cmsup\u003e\u003cmtext\u003eH\u003c/mtext\u003e\u003cmo\u003e∗\u003c/mo\u003e\u003c/msup\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003cmo\u003e−\u003c/mo\u003e\u003cmi\u003eE\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmo\u003e∗\u003c/mo\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003cmo\u003e−\u003c/mo\u003e\u003cmi\u003en\u003c/mi\u003e\u003cmo\u003e⋅\u003c/mo\u003e\u003cmfrac\u003e\u003cmn\u003e1\u003c/mn\u003e\u003cmn\u003e2\u003c/mn\u003e\u003c/mfrac\u003e\u003cmi\u003eE\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmsub\u003e\u003cmtext\u003eH\u003c/mtext\u003e\u003cmn\u003e2\u003c/mn\u003e\u003c/msub\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003c/mrow\u003e\u003cmi\u003en\u003c/mi\u003e\u003c/mfrac\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003eE_{\\text{ads}}(\\theta) = \\frac{E(n\\text{H}^*) - E(*) - n \\cdot \\frac{1}{2}E(\\text{H}_2)}{n}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.05764em;\"\u003eE\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3361em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord text mtight\"\u003e\u003cspan class=\"mord mtight\"\u003eads\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\"\u003eθ\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:2.2661em;vertical-align:-0.686em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mopen nulldelimiter\"\u003e\u003c/span\u003e\u003cspan class=\"mfrac\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.5801em;\"\u003e\u003cspan style=\"top:-2.314em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003en\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.23em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"frac-line\" style=\"border-bottom-width:0.04em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.735em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.05764em;\"\u003eE\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003en\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord text\"\u003e\u003cspan class=\"mord\"\u003eH\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.7619em;\"\u003e\u003cspan style=\"top:-3.1362em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mbin mtight\"\u003e∗\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e−\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.05764em;\"\u003eE\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord\"\u003e∗\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e−\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003en\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e⋅\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mopen nulldelimiter\"\u003e\u003c/span\u003e\u003cspan class=\"mfrac\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8451em;\"\u003e\u003cspan style=\"top:-2.655em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e2\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.23em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"frac-line\" style=\"border-bottom-width:0.04em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.394em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.345em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose nulldelimiter\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.05764em;\"\u003eE\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord text\"\u003e\u003cspan class=\"mord\"\u003eH\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3011em;\"\u003e\u003cspan style=\"top:-2.55em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e2\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.686em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose nulldelimiter\"\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","enumerator":"5","key":"a77d2yyMS5"},{"type":"paragraph","position":{"start":{"line":961,"column":1},"end":{"line":961,"column":1}},"children":[{"type":"text","value":"For many systems, this varies linearly:","position":{"start":{"line":961,"column":1},"end":{"line":961,"column":1}},"key":"bOd2xhNWag"}],"key":"xWCcxhPxP8"},{"type":"math","value":"E_{\\text{ads}}(\\theta) = E_{\\text{ads}}(0) + \\beta \\theta","position":{"start":{"line":963,"column":1},"end":{"line":965,"column":1}},"html":"\u003cspan class=\"katex-display\"\u003e\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsub\u003e\u003cmi\u003eE\u003c/mi\u003e\u003cmtext\u003eads\u003c/mtext\u003e\u003c/msub\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmi\u003eθ\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmsub\u003e\u003cmi\u003eE\u003c/mi\u003e\u003cmtext\u003eads\u003c/mtext\u003e\u003c/msub\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmn\u003e0\u003c/mn\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003cmo\u003e+\u003c/mo\u003e\u003cmi\u003eβ\u003c/mi\u003e\u003cmi\u003eθ\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003eE_{\\text{ads}}(\\theta) = E_{\\text{ads}}(0) + \\beta \\theta\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.05764em;\"\u003eE\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3361em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord text mtight\"\u003e\u003cspan class=\"mord mtight\"\u003eads\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\"\u003eθ\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.05764em;\"\u003eE\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3361em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord text mtight\"\u003e\u003cspan class=\"mord mtight\"\u003eads\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord\"\u003e0\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e+\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\"\u003eβθ\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","enumerator":"6","key":"b6PR2eZJG6"},{"type":"paragraph","position":{"start":{"line":967,"column":1},"end":{"line":967,"column":1}},"children":[{"type":"text","value":"where β quantifies lateral interactions (repulsive if β \u003e 0).","position":{"start":{"line":967,"column":1},"end":{"line":967,"column":1}},"key":"RrSQUBZJO4"}],"key":"psepm5nGOa"},{"type":"heading","depth":3,"position":{"start":{"line":969,"column":1},"end":{"line":969,"column":1}},"children":[{"type":"text","value":"Step 1: Setup Slab and Calculators","position":{"start":{"line":969,"column":1},"end":{"line":969,"column":1}},"key":"jLs9lowVLV"}],"identifier":"step-1-setup-slab-and-calculators","label":"Step 1: Setup Slab and Calculators","html_id":"step-1-setup-slab-and-calculators","implicit":true,"key":"kWEHUckgc8"},{"type":"paragraph","position":{"start":{"line":971,"column":1},"end":{"line":971,"column":1}},"children":[{"type":"text","value":"Create a larger Ni(111) slab to accommodate multiple adsorbates:","position":{"start":{"line":971,"column":1},"end":{"line":971,"column":1}},"key":"Xq0NqRV0lk"}],"key":"tlUQmk8nAW"}],"key":"ddjS8kk0kQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Create large Ni(111) slab\nni_bulk_atoms = bulk(\"Ni\", \"fcc\", a=a_opt, cubic=True)\nni_bulk_obj = Bulk(bulk_atoms=ni_bulk_atoms)\nni_slabs = Slab.from_bulk_get_specific_millers(\n    bulk=ni_bulk_obj, specific_millers=(1, 1, 1)\n)\nslab = ni_slabs[0].atoms.copy()\n\nprint(f\"   Created {len(slab)} atom slab\")\n\n# Set up calculators\nbase_calc = FAIRChemCalculator(predictor, task_name=\"oc20\")\nd3_calc = TorchDFTD3Calculator(device=\"cpu\", damping=\"bj\")\nprint(\"   ✓ Calculators initialized\")","key":"Nl3m87DzBR"},{"type":"outputs","id":"NX5MsDqmCRNEl_fZoyw8k","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"   Created 96 atom slab\n   ✓ Calculators initialized\n"},"key":"lZwZDQpWAR"}],"key":"OT6cnInB2n"}],"key":"GYKcNMHcTs"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":990,"column":1},"end":{"line":990,"column":1}},"children":[{"type":"text","value":"Step 2: Calculate Reference Energies","position":{"start":{"line":990,"column":1},"end":{"line":990,"column":1}},"key":"tChbg0xNjg"}],"identifier":"step-2-calculate-reference-energies","label":"Step 2: Calculate Reference Energies","html_id":"step-2-calculate-reference-energies","implicit":true,"key":"DhPqGroa8s"},{"type":"paragraph","position":{"start":{"line":992,"column":1},"end":{"line":992,"column":1}},"children":[{"type":"text","value":"Get reference energies for clean surface and H₂:","position":{"start":{"line":992,"column":1},"end":{"line":992,"column":1}},"key":"gOzb8M05qE"}],"key":"WKH5ptGbNo"}],"key":"Pu17V9OQHS"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(\"\\n1. Relaxing clean slab...\")\nclean_slab = slab.copy()\nclean_slab.pbc = True\nclean_slab.calc = base_calc\n\nopt = LBFGS(\n    clean_slab,\n    trajectory=str(output_dir / part_dirs[\"part5\"] / \"ni111_clean.traj\"),\n    logfile=str(output_dir / part_dirs[\"part5\"] / \"ni111_clean.log\"),\n)\nopt.run(fmax=0.05, steps=relaxation_steps)\n\nE_clean_ml = clean_slab.get_potential_energy()\nclean_slab.calc = d3_calc\nE_clean_d3 = clean_slab.get_potential_energy()\nE_clean = E_clean_ml + E_clean_d3\nprint(f\"   E(clean): {E_clean:.2f} eV\")\n\nprint(\"\\n2. Calculating H₂ reference...\")\nh2 = Atoms(\"H2\", positions=[[0, 0, 0], [0, 0, 0.74]])\nh2.center(vacuum=10.0)\nh2.set_pbc([True, True, True])\nh2.calc = base_calc\n\nopt = LBFGS(\n    h2,\n    trajectory=str(output_dir / part_dirs[\"part5\"] / \"h2.traj\"),\n    logfile=str(output_dir / part_dirs[\"part5\"] / \"h2.log\"),\n)\nopt.run(fmax=0.05, steps=relaxation_steps)\n\nE_h2_ml = h2.get_potential_energy()\nh2.calc = d3_calc\nE_h2_d3 = h2.get_potential_energy()\nE_h2 = E_h2_ml + E_h2_d3\nprint(f\"   E(H₂): {E_h2:.2f} eV\")","key":"VAae8vETfo"},{"type":"outputs","id":"79x1YZ8BcfXwZXxkeXcbn","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"\n1. Relaxing clean slab...\n"},"key":"eoN4eNidii"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"   E(clean): -487.46 eV\n\n2. Calculating H₂ reference...\n"},"key":"O9PJkBeQMG"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"   E(H₂): -6.97 eV\n"},"key":"uCJopChy3e"}],"key":"oTY0K86DOy"}],"key":"lw1jpGEAUV"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":1033,"column":1},"end":{"line":1033,"column":1}},"children":[{"type":"text","value":"Step 3: Set Up Coverage Study","position":{"start":{"line":1033,"column":1},"end":{"line":1033,"column":1}},"key":"RCrAmbZvwc"}],"identifier":"step-3-set-up-coverage-study","label":"Step 3: Set Up Coverage Study","html_id":"step-3-set-up-coverage-study","implicit":true,"key":"pnBhz0wQZL"},{"type":"paragraph","position":{"start":{"line":1035,"column":1},"end":{"line":1035,"column":1}},"children":[{"type":"text","value":"Define the coverages we’ll test (from dilute to nearly 1 ML):","position":{"start":{"line":1035,"column":1},"end":{"line":1035,"column":1}},"key":"gFLKtndGpF"}],"key":"Pm6GQlOkZu"}],"key":"HSi1zTuoQZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Count surface sites\ntags = slab.get_tags()\nn_sites = np.sum(tags == 1)\nprint(f\"\\n3. Surface sites: {n_sites} (4×4 Ni(111))\")\n\n# Test coverages: 1 H, 0.25 ML, 0.5 ML, 0.75 ML, 1.0 ML\ncoverages_to_test = [1, 4, 8, 12, 16]\nprint(f\"\\n   Will test coverages: {[f'{n/n_sites:.2f} ML' for n in coverages_to_test]}\")\nprint(\"   This spans from dilute to nearly full monolayer\")\n\ncoverages = []\nadsorption_energies = []","key":"waeXXcjBuR"},{"type":"outputs","id":"zXP-DGrKuUZ4j04YtDWr3","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"\n3. Surface sites: 16 (4×4 Ni(111))\n\n   Will test coverages: ['0.06 ML', '0.25 ML', '0.50 ML', '0.75 ML', '1.00 ML']\n   This spans from dilute to nearly full monolayer\n"},"key":"JU5gHp04vW"}],"key":"i0s9MrlBT5"}],"key":"RAYD98p9MT"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":1052,"column":1},"end":{"line":1052,"column":1}},"children":[{"type":"text","value":"Step 4: Generate and Relax Configurations at Each Coverage","position":{"start":{"line":1052,"column":1},"end":{"line":1052,"column":1}},"key":"StCktaZVi5"}],"identifier":"step-4-generate-and-relax-configurations-at-each-coverage","label":"Step 4: Generate and Relax Configurations at Each Coverage","html_id":"step-4-generate-and-relax-configurations-at-each-coverage","implicit":true,"key":"XYaVu0vkIN"},{"type":"paragraph","position":{"start":{"line":1054,"column":1},"end":{"line":1054,"column":1}},"children":[{"type":"text","value":"For each coverage, generate multiple configurations and find the lowest energy:","position":{"start":{"line":1054,"column":1},"end":{"line":1054,"column":1}},"key":"LcRkLcU6bp"}],"key":"Pzl34taJLi"}],"key":"aU0Frij0I0"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"for n_h in coverages_to_test:\n    print(f\"\\n3. Coverage: {n_h} H ({n_h/n_sites:.2f} ML)\")\n\n    # Generate configurations\n    ni_bulk_obj_h = Bulk(bulk_atoms=ni_bulk_atoms)\n    ni_slabs_h = Slab.from_bulk_get_specific_millers(\n        bulk=ni_bulk_obj_h, specific_millers=(1, 1, 1)\n    )\n    slab_for_ads = ni_slabs_h[0]\n    slab_for_ads.atoms = clean_slab.copy()\n\n    adsorbates_list = [Adsorbate(adsorbate_smiles_from_db=\"*H\") for _ in range(n_h)]\n\n    try:\n        multi_ads_config = MultipleAdsorbateSlabConfig(\n            slab_for_ads, adsorbates_list, num_configurations=num_sites\n        )\n    except ValueError as e:\n        print(f\"   ⚠ Configuration generation failed: {e}\")\n        continue\n\n    if len(multi_ads_config.atoms_list) == 0:\n        print(f\"   ⚠ No configurations generated\")\n        continue\n\n    print(f\"   Generated {len(multi_ads_config.atoms_list)} configurations\")\n\n    # Relax each and find best\n    config_energies = []\n\n    for idx, config in enumerate(multi_ads_config.atoms_list):\n        config_relaxed = config.copy()\n        config_relaxed.set_pbc([True, True, True])\n        config_relaxed.calc = base_calc\n\n        opt = LBFGS(config_relaxed, logfile=None)\n        opt.run(fmax=0.05, steps=relaxation_steps)\n\n        E_ml = config_relaxed.get_potential_energy()\n        config_relaxed.calc = d3_calc\n        E_d3 = config_relaxed.get_potential_energy()\n        E_total = E_ml + E_d3\n\n        config_energies.append(E_total)\n        print(f\"     Config {idx+1}: {E_total:.2f} eV\")\n\n    best_idx = np.argmin(config_energies)\n    best_energy = config_energies[best_idx]\n    best_config = multi_ads_config.atoms_list[best_idx]\n    E_ads_per_h = (best_energy - E_clean - n_h * 0.5 * E_h2) / n_h\n\n    coverage = n_h / n_sites\n    coverages.append(coverage)\n    adsorption_energies.append(E_ads_per_h)\n\n    print(f\"   → E_ads/H: {E_ads_per_h:.2f} eV\")\n\n    # Visualize best configuration at this coverage\n    print(f\"   Visualizing configuration with {n_h} H atoms...\")\n    view(best_config, viewer='x3d')\n\nprint(f\"\\n✓ Completed coverage study: {len(coverages)} data points\")","key":"g1bGiqJwdC"},{"type":"outputs","id":"QnrP9Ss_DMx846Xmeq54x","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"\n3. Coverage: 1 H (0.06 ML)\n"},"key":"J8gQCn4x9y"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"   Generated 2 configurations\n"},"key":"nlf9lXVhCi"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"     Config 1: -491.47 eV\n"},"key":"nuzH3F1NHI"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"     Config 2: -491.53 eV\n   → E_ads/H: -0.58 eV\n   Visualizing configuration with 1 H atoms...\n\n3. Coverage: 4 H (0.25 ML)\n"},"key":"hrO9mvOVxO"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"   Generated 2 configurations\n"},"key":"IOONcFPFlN"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"     Config 1: -502.65 eV\n"},"key":"QKj6zPP5by"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"     Config 2: -503.39 eV\n   → E_ads/H: -0.50 eV\n   Visualizing configuration with 4 H atoms...\n\n3. Coverage: 8 H (0.50 ML)\n"},"key":"CD4NUZ2BRt"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"   Generated 2 configurations\n"},"key":"gtsdF0C6gQ"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"     Config 1: -519.34 eV\n"},"key":"AwqsHCYVSR"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"     Config 2: -518.23 eV\n   → E_ads/H: -0.50 eV\n   Visualizing configuration with 8 H atoms...\n\n3. Coverage: 12 H (0.75 ML)\n"},"key":"FiiIQtJZ6V"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"   Generated 2 configurations\n"},"key":"bhf45zJu3H"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"     Config 1: -532.43 eV\n"},"key":"z9xr11taYk"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"     Config 2: -533.04 eV\n   → E_ads/H: -0.31 eV\n   Visualizing configuration with 12 H atoms...\n\n3. Coverage: 16 H (1.00 ML)\n"},"key":"sEdiDKgfyX"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"   Generated 2 configurations\n"},"key":"aijLgf17Cc"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"     Config 1: -546.63 eV\n"},"key":"jAHcbgU5xs"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"     Config 2: -547.70 eV\n   → E_ads/H: -0.28 eV\n   Visualizing configuration with 16 H atoms...\n\n✓ Completed coverage study: 5 data points\n"},"key":"xSShAa2q2z"}],"key":"Oeev9Mpnx1"}],"key":"sbznMghFAK"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":1121,"column":1},"end":{"line":1121,"column":1}},"children":[{"type":"text","value":"Step 5: Perform Linear Fit","position":{"start":{"line":1121,"column":1},"end":{"line":1121,"column":1}},"key":"v7gchUcZoP"}],"identifier":"step-5-perform-linear-fit","label":"Step 5: Perform Linear Fit","html_id":"step-5-perform-linear-fit","implicit":true,"key":"lDxwEcCMtD"},{"type":"paragraph","position":{"start":{"line":1123,"column":1},"end":{"line":1123,"column":1}},"children":[{"type":"text","value":"Fit E_ads vs coverage to extract the slope (lateral interaction strength):","position":{"start":{"line":1123,"column":1},"end":{"line":1123,"column":1}},"key":"h4t1I48weG"}],"key":"jmYvcmMPjD"}],"key":"UBm69vmEPb"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(\"\\n4. Performing linear fit to coverage dependence...\")\n\n# Linear fit\nfrom numpy.polynomial import Polynomial\n\np = Polynomial.fit(coverages, adsorption_energies, 1)\nslope = p.coef[1]\nintercept = p.coef[0]\n\nprint(f\"\\n{'='*60}\")\nprint(f\"Linear Fit: E_ads = {intercept:.2f} + {slope:.2f}θ (eV)\")\nprint(f\"Slope: {slope * 96.485:.1f} kJ/mol per ML\")\nprint(f\"Paper: 8.7 kJ/mol per ML\")\nprint(f\"{'='*60}\")","key":"Jx2lA89UYh"},{"type":"outputs","id":"lTJkoJQ9eAwYXNsIVFUbi","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"\n4. Performing linear fit to coverage dependence...\n\n============================================================\nLinear Fit: E_ads = -0.43 + 0.16θ (eV)\nSlope: 15.2 kJ/mol per ML\nPaper: 8.7 kJ/mol per ML\n============================================================\n"},"key":"dco79a8dvs"}],"key":"jnLwK3X6Kd"}],"key":"KMatEygH2M"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":1142,"column":1},"end":{"line":1142,"column":1}},"children":[{"type":"text","value":"Step 6: Visualize Coverage Dependence","position":{"start":{"line":1142,"column":1},"end":{"line":1142,"column":1}},"key":"PEEJGlfKr6"}],"identifier":"step-6-visualize-coverage-dependence","label":"Step 6: Visualize Coverage Dependence","html_id":"step-6-visualize-coverage-dependence","implicit":true,"key":"gw3PAL6xEi"},{"type":"paragraph","position":{"start":{"line":1144,"column":1},"end":{"line":1144,"column":1}},"children":[{"type":"text","value":"Create a plot showing how adsorption energy changes with coverage:","position":{"start":{"line":1144,"column":1},"end":{"line":1144,"column":1}},"key":"FSgwOHiIvT"}],"key":"WteLuXQnIO"}],"key":"kYozhPhkur"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(\"\\n5. Plotting coverage dependence...\")\n\n# Plot\nfig, ax = plt.subplots(figsize=(8, 6))\nax.scatter(\n    coverages,\n    adsorption_energies,\n    s=100,\n    marker=\"o\",\n    label=\"Calculated\",\n    zorder=3,\n    color=\"steelblue\",\n)\n\ncov_fit = np.linspace(0, max(coverages), 100)\nads_fit = p(cov_fit)\nax.plot(\n    cov_fit, ads_fit, \"r--\", label=f\"Fit: {intercept:.2f} + {slope:.2f}θ\", linewidth=2\n)\n\nax.set_xlabel(\"H Coverage (ML)\", fontsize=12)\nax.set_ylabel(\"Adsorption Energy (eV/H)\", fontsize=12)\nax.set_title(\"Coverage-Dependent H Adsorption on Ni(111)\", fontsize=14)\nax.legend(fontsize=11)\nax.grid(True, alpha=0.3)\nplt.tight_layout()\nplt.savefig(str(output_dir / part_dirs[\"part5\"] / \"coverage_dependence.png\"), dpi=300)\nplt.show()\n\nprint(\"\\n✓ Coverage dependence analysis complete!\")","key":"RvthRik1JN"},{"type":"outputs","id":"67P3P0kx8_lECA-wArxOT","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"\n5. Plotting coverage dependence...\n"},"key":"za38eW1ypx"},{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"\u003cFigure size 800x600 with 1 Axes\u003e","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"f0d4e3288431ea0b1ec4b7b13832ea97","path":"/build/f0d4e3288431ea0b1ec4b7b13832ea97.png"}}},"key":"Lw5Ry6nMWR"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"\n✓ Coverage dependence analysis complete!\n"},"key":"sME8A9Uuis"}],"key":"KmAGzxNaxV"}],"key":"M7TUwaJzXt"},{"type":"block","children":[{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Missing UMA access?","position":{"start":{"line":1179,"column":1},"end":{"line":1179,"column":1}},"key":"MmzBxo86XI"}],"key":"F1qlkVZB7O"},{"type":"paragraph","position":{"start":{"line":1182,"column":1},"end":{"line":1182,"column":1}},"children":[{"type":"text","value":"Don’t have access to UMA yet? You can still explore this calculation!","position":{"start":{"line":1182,"column":1},"end":{"line":1182,"column":1}},"key":"Z5SISHlxAR"}],"key":"m7SY4Td4px"},{"type":"paragraph","position":{"start":{"line":1184,"column":1},"end":{"line":1184,"column":1}},"children":[{"type":"link","url":"example_configs/4h_on_ni111.xyz","position":{"start":{"line":1184,"column":1},"end":{"line":1184,"column":1}},"children":[{"type":"text","value":"Download example multiple H on Ni(111) structure","position":{"start":{"line":1184,"column":1},"end":{"line":1184,"column":1}},"key":"aF5PEZiKSb"}],"urlSource":"example_configs/4h_on_ni111.xyz","key":"CKNY1Bke0B"},{"type":"text","value":" and test it in the ","position":{"start":{"line":1184,"column":1},"end":{"line":1184,"column":1}},"key":"f3B20GNUHd"},{"type":"link","url":"https://facebook-fairchem-uma-demo.hf.space/","position":{"start":{"line":1184,"column":1},"end":{"line":1184,"column":1}},"children":[{"type":"text","value":"UMA demo (no login required)","position":{"start":{"line":1184,"column":1},"end":{"line":1184,"column":1}},"key":"XYRgLsVowL"}],"urlSource":"https://facebook-fairchem-uma-demo.hf.space/","key":"LDcyG4wj8e"},{"type":"text","value":" to see how the model handles coverage-dependent binding.","position":{"start":{"line":1184,"column":1},"end":{"line":1184,"column":1}},"key":"Qgk6v7bSTo"}],"key":"ITCdzz4gVv"}],"class":"dropdown, tip","key":"hieL3kPRm4"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Comparison with Paper","position":{"start":{"line":1187,"column":1},"end":{"line":1187,"column":1}},"key":"zrzPV2sPyc"}],"key":"S8FmRaGKwo"},{"type":"paragraph","position":{"start":{"line":1190,"column":1},"end":{"line":1190,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1190,"column":1},"end":{"line":1190,"column":1}},"children":[{"type":"text","value":"Expected Results from Paper:","position":{"start":{"line":1190,"column":1},"end":{"line":1190,"column":1}},"key":"CjmK6ica0x"}],"key":"vQpYIDR0nQ"}],"key":"RLsU9jIOpx"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":1191,"column":1},"end":{"line":1193,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":1191,"column":1},"end":{"line":1191,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":1191,"column":1},"end":{"line":1191,"column":1}},"children":[{"type":"text","value":"Slope","position":{"start":{"line":1191,"column":1},"end":{"line":1191,"column":1}},"key":"M63IK7WR2M"}],"key":"n3tVob0zSs"},{"type":"text","value":": 8.7 kJ/mol per ML (indicating repulsive lateral H-H interactions)","position":{"start":{"line":1191,"column":1},"end":{"line":1191,"column":1}},"key":"HBaSpiji3v"}],"key":"tPOuxLyvlT"}],"key":"SqHB0wAFVT"},{"type":"listItem","spread":true,"position":{"start":{"line":1192,"column":1},"end":{"line":1193,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":1192,"column":1},"end":{"line":1192,"column":1}},"children":[{"type":"text","value":"Physical interpretation","position":{"start":{"line":1192,"column":1},"end":{"line":1192,"column":1}},"key":"jaM6aIcD7Q"}],"key":"yG8KHdg8gQ"},{"type":"text","value":": H atoms repel weakly due to electrostatic and Pauli effects","position":{"start":{"line":1192,"column":1},"end":{"line":1192,"column":1}},"key":"xu37H6ZWhP"}],"key":"ARIRx9ORMg"}],"key":"xUOraKnLDc"}],"key":"jyNyMjr1dX"},{"type":"paragraph","position":{"start":{"line":1194,"column":1},"end":{"line":1194,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1194,"column":1},"end":{"line":1194,"column":1}},"children":[{"type":"text","value":"What to Check:","position":{"start":{"line":1194,"column":1},"end":{"line":1194,"column":1}},"key":"gkvDdqpWNJ"}],"key":"XYisGkadd7"}],"key":"KHRyHSu59B"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":1195,"column":1},"end":{"line":1198,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":1195,"column":1},"end":{"line":1195,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Your fitted slope should be close to 8.7 kJ/mol per ML","position":{"start":{"line":1195,"column":1},"end":{"line":1195,"column":1}},"key":"ScIGVzgR9G"}],"key":"kdavyajZfO"}],"key":"e5ukO6QqJH"},{"type":"listItem","spread":true,"position":{"start":{"line":1196,"column":1},"end":{"line":1196,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"The relationship should be approximately linear for θ \u003c 1 ML","position":{"start":{"line":1196,"column":1},"end":{"line":1196,"column":1}},"key":"hZcE6CyM5U"}],"key":"WJ3XWjQaEP"}],"key":"eYM4iF16Fa"},{"type":"listItem","spread":true,"position":{"start":{"line":1197,"column":1},"end":{"line":1198,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Intercept (E_ads at θ → 0) should match the single-H result from Part 4 (~-0.60 eV)","position":{"start":{"line":1197,"column":1},"end":{"line":1197,"column":1}},"key":"cIXin6fLEz"}],"key":"sHpYRPmJRz"}],"key":"FIFeI39Ef8"}],"key":"dojpCud7ed"},{"type":"paragraph","position":{"start":{"line":1199,"column":1},"end":{"line":1199,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1199,"column":1},"end":{"line":1199,"column":1}},"children":[{"type":"text","value":"Typical Variations:","position":{"start":{"line":1199,"column":1},"end":{"line":1199,"column":1}},"key":"I5RVk8Kzt3"}],"key":"mDd4UTxuqr"}],"key":"KxAVHDXuJ4"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":1200,"column":1},"end":{"line":1202,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":1200,"column":1},"end":{"line":1200,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Slope can vary by ±2-3 kJ/mol depending on slab size and configuration sampling","position":{"start":{"line":1200,"column":1},"end":{"line":1200,"column":1}},"key":"frbAPBVVcb"}],"key":"oivrFwGkAG"}],"key":"cRVsokVOGI"},{"type":"listItem","spread":true,"position":{"start":{"line":1201,"column":1},"end":{"line":1201,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Non-linearity may appear at very high coverage (θ \u003e 0.75 ML)","position":{"start":{"line":1201,"column":1},"end":{"line":1201,"column":1}},"key":"jCrhIEmHrf"}],"key":"q5lt3KI90N"}],"key":"Y3mTeXOSBs"},{"type":"listItem","spread":true,"position":{"start":{"line":1202,"column":1},"end":{"line":1202,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Model differences can affect lateral interactions more than adsorption energies","position":{"start":{"line":1202,"column":1},"end":{"line":1202,"column":1}},"key":"mp4jlaZAyN"}],"key":"hjV3ooQbno"}],"key":"MsjsVNoulZ"}],"key":"RGI4Ifj6Fh"}],"class":"note","key":"NcEK8euIRU"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Physical Insights","position":{"start":{"line":1205,"column":1},"end":{"line":1205,"column":1}},"key":"bJsunEprDo"}],"key":"XHEbqnuBDb"},{"type":"paragraph","position":{"start":{"line":1208,"column":1},"end":{"line":1208,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1208,"column":1},"end":{"line":1208,"column":1}},"children":[{"type":"text","value":"Positive slope","position":{"start":{"line":1208,"column":1},"end":{"line":1208,"column":1}},"key":"hS7goS5JXV"}],"key":"aaFZOTqSLX"},{"type":"text","value":" (repulsive interactions):","position":{"start":{"line":1208,"column":1},"end":{"line":1208,"column":1}},"key":"lyvY7Y6KD4"}],"key":"QyQmBzbE5O"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":1209,"column":1},"end":{"line":1212,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":1209,"column":1},"end":{"line":1209,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Electrostatic: H atoms accumulate negative charge from Ni","position":{"start":{"line":1209,"column":1},"end":{"line":1209,"column":1}},"key":"fAil8fWmNT"}],"key":"VtvSopPj0u"}],"key":"MvfmkBWWNK"},{"type":"listItem","spread":true,"position":{"start":{"line":1210,"column":1},"end":{"line":1210,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Pauli repulsion: Overlapping electron clouds","position":{"start":{"line":1210,"column":1},"end":{"line":1210,"column":1}},"key":"jqFp8lvEZw"}],"key":"oEaY1yImTe"}],"key":"xCJGBRp21d"},{"type":"listItem","spread":true,"position":{"start":{"line":1211,"column":1},"end":{"line":1212,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Strain: Lattice distortions propagate","position":{"start":{"line":1211,"column":1},"end":{"line":1211,"column":1}},"key":"mUIAGkp9g4"}],"key":"U0nE5z3uGW"}],"key":"urDYzL7S4a"}],"key":"mQD78P7zOd"},{"type":"paragraph","position":{"start":{"line":1213,"column":1},"end":{"line":1213,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1213,"column":1},"end":{"line":1213,"column":1}},"children":[{"type":"text","value":"Magnitude","position":{"start":{"line":1213,"column":1},"end":{"line":1213,"column":1}},"key":"lcHb5mGeKA"}],"key":"qlkDMIJHfO"},{"type":"text","value":":","position":{"start":{"line":1213,"column":1},"end":{"line":1213,"column":1}},"key":"rvIMERETm3"}],"key":"uuI8Toisp1"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":1214,"column":1},"end":{"line":1216,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":1214,"column":1},"end":{"line":1214,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Weak (~10 kJ/mol/ML) → isolated adsorbates","position":{"start":{"line":1214,"column":1},"end":{"line":1214,"column":1}},"key":"tVOvO62DlV"}],"key":"RZkUZMj7xO"}],"key":"Xhp6r1CUq7"},{"type":"listItem","spread":true,"position":{"start":{"line":1215,"column":1},"end":{"line":1216,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Strong (\u003e50 kJ/mol/ML) → clustering or phase separation likely","position":{"start":{"line":1215,"column":1},"end":{"line":1215,"column":1}},"key":"cueFB7F01a"}],"key":"hpehPPhlgz"}],"key":"kuseh4SY7A"}],"key":"xptsWpBFZK"},{"type":"paragraph","position":{"start":{"line":1217,"column":1},"end":{"line":1217,"column":1}},"children":[{"type":"text","value":"The paper reports 8.7 kJ/mol/ML, indicating relatively weak lateral interactions for H on Ni(111).","position":{"start":{"line":1217,"column":1},"end":{"line":1217,"column":1}},"key":"VW88OB6SaH"}],"key":"P1t6lWTYUV"}],"class":"note","key":"u9pHDeruHx"},{"type":"heading","depth":3,"position":{"start":{"line":1220,"column":1},"end":{"line":1220,"column":1}},"children":[{"type":"text","value":"Explore on Your Own","position":{"start":{"line":1220,"column":1},"end":{"line":1220,"column":1}},"key":"b0wZuQzgWs"}],"identifier":"explore-on-your-own","label":"Explore on Your Own","html_id":"explore-on-your-own-3","implicit":true,"key":"a3bCO7dhHu"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":1222,"column":1},"end":{"line":1227,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":1222,"column":1},"end":{"line":1222,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":1222,"column":1},"end":{"line":1222,"column":1}},"children":[{"type":"text","value":"Non-linear behavior","position":{"start":{"line":1222,"column":1},"end":{"line":1222,"column":1}},"key":"sUyy1UCncN"}],"key":"cOF7N1zC69"},{"type":"text","value":": Use polynomial (degree 2) fit. Is there curvature at high coverage?","position":{"start":{"line":1222,"column":1},"end":{"line":1222,"column":1}},"key":"OBWZKZWjgT"}],"key":"hsrgbFi5G2"}],"key":"nLEpr5HHGC"},{"type":"listItem","spread":true,"position":{"start":{"line":1223,"column":1},"end":{"line":1223,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":1223,"column":1},"end":{"line":1223,"column":1}},"children":[{"type":"text","value":"Temperature effects","position":{"start":{"line":1223,"column":1},"end":{"line":1223,"column":1}},"key":"K58k0mXDpw"}],"key":"HJHCSY8j8N"},{"type":"text","value":": Estimate configurational entropy at each coverage. How does this affect free energy?","position":{"start":{"line":1223,"column":1},"end":{"line":1223,"column":1}},"key":"shW79i7j5F"}],"key":"vFxm3v1H3J"}],"key":"CctunJlu8P"},{"type":"listItem","spread":true,"position":{"start":{"line":1224,"column":1},"end":{"line":1224,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":1224,"column":1},"end":{"line":1224,"column":1}},"children":[{"type":"text","value":"Pattern formation","position":{"start":{"line":1224,"column":1},"end":{"line":1224,"column":1}},"key":"V6Pj46u5b9"}],"key":"NP4e2TSTSS"},{"type":"text","value":": Visualize the lowest-energy configuration at 0.5 ML. Are H atoms ordered?","position":{"start":{"line":1224,"column":1},"end":{"line":1224,"column":1}},"key":"O6c6EgsAeL"}],"key":"fJ03o9Yhe4"}],"key":"SxrQcNaRVq"},{"type":"listItem","spread":true,"position":{"start":{"line":1225,"column":1},"end":{"line":1225,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":1225,"column":1},"end":{"line":1225,"column":1}},"children":[{"type":"text","value":"Other adsorbates","position":{"start":{"line":1225,"column":1},"end":{"line":1225,"column":1}},"key":"hHvwPhSVNs"}],"key":"SJTcU4L0td"},{"type":"text","value":": Repeat for O or N. How do lateral interactions compare?","position":{"start":{"line":1225,"column":1},"end":{"line":1225,"column":1}},"key":"GFFftBZVGe"}],"key":"GUm6j8ZGJb"}],"key":"QBwxVbyYct"},{"type":"listItem","spread":true,"position":{"start":{"line":1226,"column":1},"end":{"line":1227,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":1226,"column":1},"end":{"line":1226,"column":1}},"children":[{"type":"text","value":"Phase diagrams","position":{"start":{"line":1226,"column":1},"end":{"line":1226,"column":1}},"key":"rcwc9hu4XX"}],"key":"dcjm8MYnLY"},{"type":"text","value":": At what coverage do you expect phase separation (islands vs uniform)?","position":{"start":{"line":1226,"column":1},"end":{"line":1226,"column":1}},"key":"HfQ6OkOzLJ"}],"key":"bvraZHJ1UA"}],"key":"ukXwzx5sYv"}],"key":"IFgpVAe5IO"},{"type":"thematicBreak","position":{"start":{"line":1228,"column":1},"end":{"line":1228,"column":1}},"key":"RENXzzlhVe"},{"type":"heading","depth":2,"position":{"start":{"line":1230,"column":1},"end":{"line":1230,"column":1}},"children":[{"type":"text","value":"Part 6: CO Formation/Dissociation Thermochemistry and Barrier","position":{"start":{"line":1230,"column":1},"end":{"line":1230,"column":1}},"key":"hjQrqRTEqT"}],"identifier":"part-6-co-formation-dissociation-thermochemistry-and-barrier","label":"Part 6: CO Formation/Dissociation Thermochemistry and Barrier","html_id":"part-6-co-formation-dissociation-thermochemistry-and-barrier","implicit":true,"key":"fsE6D7pceN"},{"type":"heading","depth":3,"position":{"start":{"line":1232,"column":1},"end":{"line":1232,"column":1}},"children":[{"type":"text","value":"Introduction","position":{"start":{"line":1232,"column":1},"end":{"line":1232,"column":1}},"key":"u5q6MOgxy9"}],"identifier":"introduction","label":"Introduction","html_id":"introduction-5","implicit":true,"key":"fT5Q5QsGjX"},{"type":"paragraph","position":{"start":{"line":1234,"column":1},"end":{"line":1234,"column":1}},"children":[{"type":"text","value":"CO dissociation (CO* → C* + O*) is the rate-limiting step in many catalytic processes (Fischer-Tropsch, CO oxidation, etc.). We’ll calculate the reaction energy for C* + O* → CO* and the activation barriers in both directions using the nudged elastic band (NEB) method.","position":{"start":{"line":1234,"column":1},"end":{"line":1234,"column":1}},"key":"kayLAi6ETx"}],"key":"eNchBmttiP"},{"type":"heading","depth":3,"position":{"start":{"line":1236,"column":1},"end":{"line":1236,"column":1}},"children":[{"type":"text","value":"Theory","position":{"start":{"line":1236,"column":1},"end":{"line":1236,"column":1}},"key":"sQxJHi84kg"}],"identifier":"theory","label":"Theory","html_id":"theory-5","implicit":true,"key":"qXMfHLdDsW"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":1238,"column":1},"end":{"line":1242,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":1238,"column":1},"end":{"line":1238,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":1238,"column":1},"end":{"line":1238,"column":1}},"children":[{"type":"text","value":"Forward Reaction","position":{"start":{"line":1238,"column":1},"end":{"line":1238,"column":1}},"key":"jmtzch8u3u"}],"key":"JJcUDzmfP0"},{"type":"text","value":": C* + O* → CO* + * (recombination)","position":{"start":{"line":1238,"column":1},"end":{"line":1238,"column":1}},"key":"tEYsFcHDpk"}],"key":"jI48JKuXGf"}],"key":"FfO5l0U7IG"},{"type":"listItem","spread":true,"position":{"start":{"line":1239,"column":1},"end":{"line":1239,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":1239,"column":1},"end":{"line":1239,"column":1}},"children":[{"type":"text","value":"Reverse Reaction","position":{"start":{"line":1239,"column":1},"end":{"line":1239,"column":1}},"key":"EHHHuAcAdc"}],"key":"uEqP2eCx9z"},{"type":"text","value":": CO* + ","position":{"start":{"line":1239,"column":1},"end":{"line":1239,"column":1}},"key":"dsO8eU5gs0"},{"type":"emphasis","position":{"start":{"line":1239,"column":1},"end":{"line":1239,"column":1}},"children":[{"type":"text","value":"→ C","position":{"start":{"line":1239,"column":1},"end":{"line":1239,"column":1}},"key":"MMSjqnzcxg"}],"key":"vstjH5xcKW"},{"type":"text","value":" + O* (dissociation)","position":{"start":{"line":1239,"column":1},"end":{"line":1239,"column":1}},"key":"rsgsF7X4eG"}],"key":"tSkVYxdWt1"}],"key":"gl0SJ0k3rx"},{"type":"listItem","spread":true,"position":{"start":{"line":1240,"column":1},"end":{"line":1240,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":1240,"column":1},"end":{"line":1240,"column":1}},"children":[{"type":"text","value":"Thermochemistry","position":{"start":{"line":1240,"column":1},"end":{"line":1240,"column":1}},"key":"xVGO6H6hUT"}],"key":"E6HCoBtPhY"},{"type":"text","value":": ","position":{"start":{"line":1240,"column":1},"end":{"line":1240,"column":1}},"key":"kCOuPsB3d8"},{"type":"inlineMath","value":"\\Delta E_{\\text{rxn}} = E(\\text{C}^* + \\text{O}^*) - E(\\text{CO}^*)","position":{"start":{"line":1240,"column":1},"end":{"line":1240,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi mathvariant=\"normal\"\u003eΔ\u003c/mi\u003e\u003cmsub\u003e\u003cmi\u003eE\u003c/mi\u003e\u003cmtext\u003erxn\u003c/mtext\u003e\u003c/msub\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmi\u003eE\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmsup\u003e\u003cmtext\u003eC\u003c/mtext\u003e\u003cmo\u003e∗\u003c/mo\u003e\u003c/msup\u003e\u003cmo\u003e+\u003c/mo\u003e\u003cmsup\u003e\u003cmtext\u003eO\u003c/mtext\u003e\u003cmo\u003e∗\u003c/mo\u003e\u003c/msup\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003cmo\u003e−\u003c/mo\u003e\u003cmi\u003eE\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmsup\u003e\u003cmtext\u003eCO\u003c/mtext\u003e\u003cmo\u003e∗\u003c/mo\u003e\u003c/msup\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\Delta E_{\\text{rxn}} = E(\\text{C}^* + \\text{O}^*) - E(\\text{CO}^*)\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003eΔ\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.05764em;\"\u003eE\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1514em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord text mtight\"\u003e\u003cspan class=\"mord mtight\"\u003erxn\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1.0119em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.05764em;\"\u003eE\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord text\"\u003e\u003cspan class=\"mord\"\u003eC\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.7619em;\"\u003e\u003cspan style=\"top:-3.1362em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mbin mtight\"\u003e∗\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e+\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1.0119em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord text\"\u003e\u003cspan class=\"mord\"\u003eO\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.7619em;\"\u003e\u003cspan style=\"top:-3.1362em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mbin mtight\"\u003e∗\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e−\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1.0119em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.05764em;\"\u003eE\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord text\"\u003e\u003cspan class=\"mord\"\u003eCO\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.7619em;\"\u003e\u003cspan style=\"top:-3.1362em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mbin mtight\"\u003e∗\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"U2bW6OQ27r"}],"key":"KAYPqEXlbU"}],"key":"eox1AwcagI"},{"type":"listItem","spread":true,"position":{"start":{"line":1241,"column":1},"end":{"line":1242,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":1241,"column":1},"end":{"line":1241,"column":1}},"children":[{"type":"text","value":"Barrier","position":{"start":{"line":1241,"column":1},"end":{"line":1241,"column":1}},"key":"dpMmzl3pd5"}],"key":"Qm9VxsXKus"},{"type":"text","value":": NEB finds the minimum energy path (MEP) and transition state: ","position":{"start":{"line":1241,"column":1},"end":{"line":1241,"column":1}},"key":"FWLxu3xl20"},{"type":"inlineMath","value":"E_a = E^{\\ddagger} - E_{\\text{initial}}","position":{"start":{"line":1241,"column":1},"end":{"line":1241,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsub\u003e\u003cmi\u003eE\u003c/mi\u003e\u003cmi\u003ea\u003c/mi\u003e\u003c/msub\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmsup\u003e\u003cmi\u003eE\u003c/mi\u003e\u003cmo lspace=\"0em\" rspace=\"0em\"\u003e‡\u003c/mo\u003e\u003c/msup\u003e\u003cmo\u003e−\u003c/mo\u003e\u003cmsub\u003e\u003cmi\u003eE\u003c/mi\u003e\u003cmtext\u003einitial\u003c/mtext\u003e\u003c/msub\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003eE_a = E^{\\ddagger} - E_{\\text{initial}}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.05764em;\"\u003eE\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1514em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003ea\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.9324em;vertical-align:-0.0833em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.05764em;\"\u003eE\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8491em;\"\u003e\u003cspan style=\"top:-3.063em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e‡\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e−\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.05764em;\"\u003eE\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3361em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord text mtight\"\u003e\u003cspan class=\"mord mtight\"\u003einitial\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"tUUadbMA0T"}],"key":"JSzmtkf47D"}],"key":"uTd8epi1vq"}],"key":"etL3U881RN"},{"type":"heading","depth":3,"position":{"start":{"line":1243,"column":1},"end":{"line":1243,"column":1}},"children":[{"type":"text","value":"Step 1: Setup Slab and Calculators","position":{"start":{"line":1243,"column":1},"end":{"line":1243,"column":1}},"key":"lqXsgZIIHo"}],"identifier":"step-1-setup-slab-and-calculators","label":"Step 1: Setup Slab and Calculators","html_id":"step-1-setup-slab-and-calculators-1","implicit":true,"key":"ywlHheD88n"},{"type":"paragraph","position":{"start":{"line":1245,"column":1},"end":{"line":1245,"column":1}},"children":[{"type":"text","value":"Initialize the Ni(111) surface and calculators:","position":{"start":{"line":1245,"column":1},"end":{"line":1245,"column":1}},"key":"ST58IxUVMJ"}],"key":"XjswcfwPZ4"}],"key":"Wmvab8Ssvv"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Create slab\nni_bulk_atoms = bulk(\"Ni\", \"fcc\", a=a_opt, cubic=True)\nni_bulk_obj = Bulk(bulk_atoms=ni_bulk_atoms)\nni_slabs = Slab.from_bulk_get_specific_millers(\n    bulk=ni_bulk_obj, specific_millers=(1, 1, 1)\n)\nslab = ni_slabs[0].atoms\n\nprint(f\"   Created {len(slab)} atom slab\")\n\nbase_calc = FAIRChemCalculator(predictor, task_name=\"oc20\")\nd3_calc = TorchDFTD3Calculator(device=\"cpu\", damping=\"bj\")\nprint(\"   \\u2713 Calculators initialized\")","key":"X8vwwUZVz1"},{"type":"outputs","id":"L02XW2fw3h2cdDVDiOnyJ","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"   Created 96 atom slab\n   ✓ Calculators initialized\n"},"key":"cvvadO6sxy"}],"key":"F4ytuwvDjr"}],"key":"xqnhC9WSg7"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":1263,"column":1},"end":{"line":1263,"column":1}},"children":[{"type":"text","value":"Step 2: Generate and Relax Final State (CO*)","position":{"start":{"line":1263,"column":1},"end":{"line":1263,"column":1}},"key":"xupZrh19ov"}],"identifier":"step-2-generate-and-relax-final-state-co","label":"Step 2: Generate and Relax Final State (CO*)","html_id":"step-2-generate-and-relax-final-state-co","implicit":true,"key":"x5RrqCkHPV"},{"type":"paragraph","position":{"start":{"line":1265,"column":1},"end":{"line":1265,"column":1}},"children":[{"type":"text","value":"Find the most stable CO adsorption configuration (this is the product of C+O recombination):","position":{"start":{"line":1265,"column":1},"end":{"line":1265,"column":1}},"key":"nQDNroRSHQ"}],"key":"fLDr3TPTXm"}],"key":"RgYOJ7cOjf"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(\"\\n1. Final State: CO* on Ni(111)\")\nprint(\"   Generating CO adsorption configurations...\")\n\nni_bulk_obj_co = Bulk(bulk_atoms=ni_bulk_atoms)\nni_slab_co = Slab.from_bulk_get_specific_millers(\n    bulk=ni_bulk_obj_co, specific_millers=(1, 1, 1)\n)[0]\nni_slab_co.atoms = slab.copy()\n\nadsorbate_co = Adsorbate(adsorbate_smiles_from_db=\"*CO\")\nmulti_ads_config_co = MultipleAdsorbateSlabConfig(\n    ni_slab_co, [adsorbate_co], num_configurations=num_sites\n)\n\nprint(f\"   Generated {len(multi_ads_config_co.atoms_list)} configurations\")\n\n# Relax and find best\nco_energies = []\nco_energies_ml = []\nco_energies_d3 = []\nco_configs = []\n\nfor idx, config in enumerate(multi_ads_config_co.atoms_list):\n    config_relaxed = config.copy()\n    config_relaxed.set_pbc([True, True, True])\n    config_relaxed.calc = base_calc\n    opt = LBFGS(config_relaxed, logfile=None)\n    opt.run(fmax=0.05, steps=relaxation_steps)\n\n    E_ml = config_relaxed.get_potential_energy()\n    config_relaxed.calc = d3_calc\n    E_d3 = config_relaxed.get_potential_energy()\n    E_total = E_ml + E_d3\n\n    co_energies.append(E_total)\n    co_energies_ml.append(E_ml)\n    co_energies_d3.append(E_d3)\n    co_configs.append(config_relaxed)\n    print(\n        f\"     Config {idx+1}: E_total = {E_total:.2f} eV (RPBE: {E_ml:.2f}, D3: {E_d3:.2f})\"\n    )\n\nbest_co_idx = np.argmin(co_energies)\nfinal_co = co_configs[best_co_idx]\nE_final_co = co_energies[best_co_idx]\nE_final_co_ml = co_energies_ml[best_co_idx]\nE_final_co_d3 = co_energies_d3[best_co_idx]\n\nprint(f\"\\n   → Best CO* (Config {best_co_idx+1}):\")\nprint(f\"      RPBE:  {E_final_co_ml:.2f} eV\")\nprint(f\"      D3:    {E_final_co_d3:.2f} eV\")\nprint(f\"      Total: {E_final_co:.2f} eV\")\n\n# Save best CO state\nase.io.write(str(output_dir / part_dirs[\"part6\"] / \"co_final_best.traj\"), final_co)\nprint(\"   ✓ Best CO* structure saved\")\n\n# Visualize best CO* structure\nprint(\"\\n   Visualizing best CO* structure...\")\nview(final_co, viewer='x3d')","key":"EtV3Nflc2U"},{"type":"outputs","id":"rTJlqKLkLuhCj3JMuMktL","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"\n1. Final State: CO* on Ni(111)\n   Generating CO adsorption configurations...\n"},"key":"nBqYSdBmwr"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"   Generated 2 configurations\n"},"key":"jwx8FBoAyP"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"     Config 1: E_total = -503.58 eV (RPBE: -466.73, D3: -36.85)\n"},"key":"rj2pNxLGzp"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"     Config 2: E_total = -503.78 eV (RPBE: -466.90, D3: -36.88)\n\n   → Best CO* (Config 2):\n      RPBE:  -466.90 eV\n      D3:    -36.88 eV\n      Total: -503.78 eV\n   ✓ Best CO* structure saved\n\n   Visualizing best CO* structure...\n"},"key":"SWJ9zkkBU2"},{"type":"output","children":[],"jupyter_data":{"output_type":"execute_result","execution_count":29,"metadata":{},"data":{"text/plain":{"content":"\u003cIPython.core.display.HTML object\u003e","content_type":"text/plain"},"text/html":{"content_type":"text/html","hash":"d31db5998ad98d0bc21619f4391b7f2e","path":"/build/d31db5998ad98d0bc21619f4391b7f2e.html"}}},"key":"qFWYwlTY8A"}],"key":"pIBMTUouoi"}],"key":"MVICjBMRLf"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":1330,"column":1},"end":{"line":1330,"column":1}},"children":[{"type":"text","value":"Step 3: Generate and Relax Initial State (C* + O*)","position":{"start":{"line":1330,"column":1},"end":{"line":1330,"column":1}},"key":"K3Ze3sRxzk"}],"identifier":"step-3-generate-and-relax-initial-state-c-o","label":"Step 3: Generate and Relax Initial State (C* + O*)","html_id":"step-3-generate-and-relax-initial-state-c-o","implicit":true,"key":"nWmwNK98T3"},{"type":"paragraph","position":{"start":{"line":1332,"column":1},"end":{"line":1332,"column":1}},"children":[{"type":"text","value":"Find the most stable configuration for dissociated C and O (reactants):","position":{"start":{"line":1332,"column":1},"end":{"line":1332,"column":1}},"key":"mGj8qXcHKb"}],"key":"Mna00Gy91r"}],"key":"CHX13HuI8r"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(\"\\n2. Initial State: C* + O* on Ni(111)\")\nprint(\"   Generating C+O configurations...\")\n\nni_bulk_obj_c_o = Bulk(bulk_atoms=ni_bulk_atoms)\nni_slab_c_o = Slab.from_bulk_get_specific_millers(\n    bulk=ni_bulk_obj_c_o, specific_millers=(1, 1, 1)\n)[0]\n\nadsorbate_c = Adsorbate(adsorbate_smiles_from_db=\"*C\")\nadsorbate_o = Adsorbate(adsorbate_smiles_from_db=\"*O\")\n\nmulti_ads_config_c_o = MultipleAdsorbateSlabConfig(\n    ni_slab_c_o, [adsorbate_c, adsorbate_o], num_configurations=num_sites\n)\n\nprint(f\"   Generated {len(multi_ads_config_c_o.atoms_list)} configurations\")\n\nc_o_energies = []\nc_o_energies_ml = []\nc_o_energies_d3 = []\nc_o_configs = []\n\nfor idx, config in enumerate(multi_ads_config_c_o.atoms_list):\n    config_relaxed = config.copy()\n    config_relaxed.set_pbc([True, True, True])\n    config_relaxed.calc = base_calc\n    opt = LBFGS(config_relaxed, logfile=None)\n    opt.run(fmax=0.05, steps=relaxation_steps)\n\n    # Check C-O bond distance to ensure they haven't formed CO molecule\n    c_o_dist = config_relaxed[config_relaxed.get_tags() == 2].get_distance(\n        0, 1, mic=True\n    )\n\n    # CO bond length is ~1.15 Å, so if distance \u003c 1.5 Å, they've formed a molecule\n    if c_o_dist \u003c 1.5:\n        print(\n            f\"     Config {idx+1}: ⚠ REJECTED - C and O formed CO molecule (d = {c_o_dist:.2f} Å)\"\n        )\n        continue\n\n    E_ml = config_relaxed.get_potential_energy()\n    config_relaxed.calc = d3_calc\n    E_d3 = config_relaxed.get_potential_energy()\n    E_total = E_ml + E_d3\n\n    c_o_energies.append(E_total)\n    c_o_energies_ml.append(E_ml)\n    c_o_energies_d3.append(E_d3)\n    c_o_configs.append(config_relaxed)\n    print(\n        f\"     Config {idx+1}: E_total = {E_total:.2f} eV (RPBE: {E_ml:.2f}, D3: {E_d3:.2f}, C-O dist: {c_o_dist:.2f} Å)\"\n    )\n\nbest_c_o_idx = np.argmin(c_o_energies)\ninitial_c_o = c_o_configs[best_c_o_idx]\nE_initial_c_o = c_o_energies[best_c_o_idx]\nE_initial_c_o_ml = c_o_energies_ml[best_c_o_idx]\nE_initial_c_o_d3 = c_o_energies_d3[best_c_o_idx]\n\nprint(f\"\\n   → Best C*+O* (Config {best_c_o_idx+1}):\")\nprint(f\"      RPBE:  {E_initial_c_o_ml:.2f} eV\")\nprint(f\"      D3:    {E_initial_c_o_d3:.2f} eV\")\nprint(f\"      Total: {E_initial_c_o:.2f} eV\")\n\n# Save best C+O state\nase.io.write(str(output_dir / part_dirs[\"part6\"] / \"co_initial_best.traj\"), initial_c_o)\nprint(\"   ✓ Best C*+O* structure saved\")\n\n# Visualize best C*+O* structure\nprint(\"\\n   Visualizing best C*+O* structure...\")\nview(initial_c_o, viewer='x3d')","key":"tUNj0F4Y62"},{"type":"outputs","id":"Q_6jRoMWvL4vz6fpe_GQb","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"\n2. Initial State: C* + O* on Ni(111)\n   Generating C+O configurations...\n"},"key":"gOivV4Gpsr"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"   Generated 2 configurations\n"},"key":"ukjNnPWu1D"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"     Config 1: E_total = -502.66 eV (RPBE: -465.77, D3: -36.89, C-O dist: 3.28 Å)\n"},"key":"x7v03iF4Fy"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"     Config 2: E_total = -500.64 eV (RPBE: -463.69, D3: -36.96, C-O dist: 3.53 Å)\n\n   → Best C*+O* (Config 1):\n      RPBE:  -465.77 eV\n      D3:    -36.89 eV\n      Total: -502.66 eV\n   ✓ Best C*+O* structure saved\n\n   Visualizing best C*+O* structure...\n"},"key":"G7NO6i3n2o"},{"type":"output","children":[],"jupyter_data":{"output_type":"execute_result","execution_count":30,"metadata":{},"data":{"text/plain":{"content":"\u003cIPython.core.display.HTML object\u003e","content_type":"text/plain"},"text/html":{"content_type":"text/html","hash":"492cbc58667f0609b0ab5bbe8a0f4465","path":"/build/492cbc58667f0609b0ab5bbe8a0f4465.html"}}},"key":"RdshrIkV2P"}],"key":"emyjuTPRS6"}],"key":"QBQLOHc0T5"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":1409,"column":1},"end":{"line":1409,"column":1}},"children":[{"type":"text","value":"Step 3b: Calculate C* and O* Energies Separately","position":{"start":{"line":1409,"column":1},"end":{"line":1409,"column":1}},"key":"E1U2JjAo6u"}],"identifier":"step-3b-calculate-c-and-o-energies-separately","label":"Step 3b: Calculate C* and O* Energies Separately","html_id":"step-3b-calculate-c-and-o-energies-separately","implicit":true,"key":"tzjFVPNAu3"},{"type":"paragraph","position":{"start":{"line":1411,"column":1},"end":{"line":1411,"column":1}},"children":[{"type":"text","value":"Another strategy to calculate the initial energies for *C and *O at very low coverage (without interactions between the two reactants) is to do two separate relaxations.","position":{"start":{"line":1411,"column":1},"end":{"line":1411,"column":1}},"key":"rDaN4olwSq"}],"key":"rm8cp6Wtxs"}],"key":"AQfnCAavoA"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Clean slab\nni_bulk_obj = Bulk(bulk_atoms=ni_bulk_atoms)\nclean_slab = Slab.from_bulk_get_specific_millers(\n    bulk=ni_bulk_obj_c_o, specific_millers=(1, 1, 1)\n)[0].atoms\nclean_slab.set_pbc([True, True, True])\nclean_slab.calc = base_calc\nopt = LBFGS(clean_slab, logfile=None)\nopt.run(fmax=0.05, steps=relaxation_steps)\n\nE_clean_ml = clean_slab.get_potential_energy()\nclean_slab.calc = d3_calc\nE_clean_d3 = clean_slab.get_potential_energy()\nE_clean = E_clean_ml + E_clean_d3\n\nprint(\n    f\"\\n   Clean slab: E_total = {E_clean:.2f} eV (RPBE: {E_clean_ml:.2f}, D3: {E_clean_d3:.2f})\"\n)","key":"z6a75qxKtq"},{"type":"outputs","id":"HjtYb9fULXo0pP3guZqzw","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"\n   Clean slab: E_total = -487.46 eV (RPBE: -450.89, D3: -36.57)\n"},"key":"Qe6OXrbbPi"}],"key":"iyl3GvJGB7"}],"key":"JisNxVeXu3"},{"type":"block","children":[],"key":"ZNlR2UvOk0"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(f\"\\n2b. Separate C* and O* Energies:\")\nprint(\"    Calculating energies in separate unit cells to avoid interactions\")\n\nni_bulk_obj_c_o = Bulk(bulk_atoms=ni_bulk_atoms)\nni_slab_c_o = Slab.from_bulk_get_specific_millers(\n    bulk=ni_bulk_obj_c_o, specific_millers=(1, 1, 1)\n)[0]\n\nprint(\"\\n   Generating C* configurations...\")\nmulti_ads_config_c = MultipleAdsorbateSlabConfig(\n    ni_slab_c_o,\n    adsorbates=[Adsorbate(adsorbate_smiles_from_db=\"*C\")],\n    num_configurations=num_sites,\n)\n\nc_energies = []\nc_energies_ml = []\nc_energies_d3 = []\nc_configs = []\n\nfor idx, config in enumerate(multi_ads_config_c.atoms_list):\n    config_relaxed = config.copy()\n    config_relaxed.set_pbc([True, True, True])\n    config_relaxed.calc = base_calc\n    opt = LBFGS(config_relaxed, logfile=None)\n    opt.run(fmax=0.05, steps=relaxation_steps)\n\n    E_ml = config_relaxed.get_potential_energy()\n    config_relaxed.calc = d3_calc\n    E_d3 = config_relaxed.get_potential_energy()\n    E_total = E_ml + E_d3\n\n    c_energies.append(E_total)\n    c_energies_ml.append(E_ml)\n    c_energies_d3.append(E_d3)\n    c_configs.append(config_relaxed)\n    print(\n        f\"     Config {idx+1}: E_total = {E_total:.2f} eV (RPBE: {E_ml:.2f}, D3: {E_d3:.2f})\"\n    )\n\nbest_c_idx = np.argmin(c_energies)\nc_ads = c_configs[best_c_idx]\nE_c = c_energies[best_c_idx]\nE_c_ml = c_energies_ml[best_c_idx]\nE_c_d3 = c_energies_d3[best_c_idx]\n\nprint(f\"\\n   → Best C* (Config {best_c_idx+1}):\")\nprint(f\"      RPBE:  {E_c_ml:.2f} eV\")\nprint(f\"      D3:    {E_c_d3:.2f} eV\")\nprint(f\"      Total: {E_c:.2f} eV\")\n\n# Save best C state\nase.io.write(str(output_dir / part_dirs[\"part6\"] / \"c_best.traj\"), c_ads)\n\n# Visualize best C* structure\nprint(\"\\n   Visualizing best C* structure...\")\nview(c_ads, viewer='x3d')\n\n# Generate O* configuration\nprint(\"\\n   Generating O* configurations...\")\nmulti_ads_config_o = MultipleAdsorbateSlabConfig(\n    ni_slab_c_o,\n    adsorbates=[Adsorbate(adsorbate_smiles_from_db=\"*O\")],\n    num_configurations=num_sites,\n)\no_energies = []\no_energies_ml = []\no_energies_d3 = []\no_configs = []\n\nfor idx, config in enumerate(multi_ads_config_o.atoms_list):\n    config_relaxed = config.copy()\n    config_relaxed.set_pbc([True, True, True])\n    config_relaxed.calc = base_calc\n    opt = LBFGS(config_relaxed, logfile=None)\n    opt.run(fmax=0.05, steps=relaxation_steps)\n\n    E_ml = config_relaxed.get_potential_energy()\n    config_relaxed.calc = d3_calc\n    E_d3 = config_relaxed.get_potential_energy()\n    E_total = E_ml + E_d3\n\n    o_energies.append(E_total)\n    o_energies_ml.append(E_ml)\n    o_energies_d3.append(E_d3)\n    o_configs.append(config_relaxed)\n    print(\n        f\"     Config {idx+1}: E_total = {E_total:.2f} eV (RPBE: {E_ml:.2f}, D3: {E_d3:.2f})\"\n    )\n\nbest_o_idx = np.argmin(o_energies)\no_ads = o_configs[best_o_idx]\nE_o = o_energies[best_o_idx]\nE_o_ml = o_energies_ml[best_o_idx]\nE_o_d3 = o_energies_d3[best_o_idx]\n\nprint(f\"\\n   → Best O* (Config {best_o_idx+1}):\")\nprint(f\"      RPBE:  {E_o_ml:.2f} eV\")\nprint(f\"      D3:    {E_o_d3:.2f} eV\")\nprint(f\"      Total: {E_o:.2f} eV\")\n\n# Save best O state\nase.io.write(str(output_dir / part_dirs[\"part6\"] / \"o_best.traj\"), o_ads)\n\n# Visualize best O* structure\nprint(\"\\n   Visualizing best O* structure...\")\nview(o_ads, viewer='x3d')\n\n# Calculate combined energy for separate C* and O*\nE_initial_c_o_separate = E_c + E_o\nE_initial_c_o_separate_ml = E_c_ml + E_o_ml\nE_initial_c_o_separate_d3 = E_c_d3 + E_o_d3","key":"jtFoRO6JIW"},{"type":"outputs","id":"GYVukmLkrynOhlkwSM6VB","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"\n2b. Separate C* and O* Energies:\n    Calculating energies in separate unit cells to avoid interactions\n"},"key":"m9lC5zgr1h"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"\n   Generating C* configurations...\n"},"key":"jA2kVNYln3"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"     Config 1: E_total = -493.02 eV (RPBE: -456.21, D3: -36.81)\n"},"key":"tTH9QWjUd1"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"     Config 2: E_total = -495.67 eV (RPBE: -458.89, D3: -36.78)\n\n   → Best C* (Config 2):\n      RPBE:  -458.89 eV\n      D3:    -36.78 eV\n      Total: -495.67 eV\n\n   Visualizing best C* structure...\n\n   Generating O* configurations...\n"},"key":"OL2PkSQivG"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"     Config 1: E_total = -494.66 eV (RPBE: -457.97, D3: -36.69)\n"},"key":"aq1TBM1Qdp"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"     Config 2: E_total = -494.46 eV (RPBE: -457.77, D3: -36.69)\n\n   → Best O* (Config 1):\n      RPBE:  -457.97 eV\n      D3:    -36.69 eV\n      Total: -494.66 eV\n\n   Visualizing best O* structure...\n"},"key":"Sk6r4yuule"}],"key":"AY7nGW1CqK"}],"key":"tAM679LI12"},{"type":"block","children":[],"key":"sYxD9rXpig"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(f\"\\n   Combined C* + O* (separate calculations):\")\nprint(f\"      RPBE:  {E_initial_c_o_separate_ml:.2f} eV\")\nprint(f\"      D3:    {E_initial_c_o_separate_d3:.2f} eV\")\nprint(f\"      Total: {E_initial_c_o_separate:.2f} eV\")\n\nprint(f\"\\n   Comparison:\")\nprint(f\"      C*+O* (same cell):  {E_initial_c_o - E_clean:.2f} eV\")\nprint(f\"      C* + O* (separate): {E_initial_c_o_separate - 2*E_clean:.2f} eV\")\nprint(\n    f\"      Difference:         {(E_initial_c_o - E_clean) - (E_initial_c_o_separate - 2*E_clean):.2f} eV\"\n)\nprint(\"   ✓ Separate C* and O* energies calculated\")","key":"uriHmq6QtX"},{"type":"outputs","id":"ILyrfRHgCLS9r5crXKY-o","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"\n   Combined C* + O* (separate calculations):\n      RPBE:  -916.86 eV\n      D3:    -73.46 eV\n      Total: -990.32 eV\n\n   Comparison:\n      C*+O* (same cell):  -15.20 eV\n      C* + O* (separate): -15.40 eV\n      Difference:         0.20 eV\n   ✓ Separate C* and O* energies calculated\n"},"key":"tOtptr5gTs"}],"key":"FmN2GHESAN"}],"key":"nEPCrK9UJX"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":1564,"column":1},"end":{"line":1564,"column":1}},"children":[{"type":"text","value":"Step 4: Calculate Reaction Energy with ZPE","position":{"start":{"line":1564,"column":1},"end":{"line":1564,"column":1}},"key":"PxG7te9pDb"}],"identifier":"step-4-calculate-reaction-energy-with-zpe","label":"Step 4: Calculate Reaction Energy with ZPE","html_id":"step-4-calculate-reaction-energy-with-zpe","implicit":true,"key":"hWlmwk70J2"},{"type":"paragraph","position":{"start":{"line":1566,"column":1},"end":{"line":1566,"column":1}},"children":[{"type":"text","value":"Compute the thermochemistry for C* + O* → CO* with ZPE corrections:","position":{"start":{"line":1566,"column":1},"end":{"line":1566,"column":1}},"key":"tRWnOw6D1m"}],"key":"IUgaY8VhLu"}],"key":"RVG1pM1JOy"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(f\"\\n3. Reaction Energy (C* + O* → CO*):\")\nprint(f\"   \" + \"=\" * 60)\n\n# Electronic energies\nprint(f\"\\n   Electronic Energies:\")\nprint(\n    f\"   Initial (C*+O*): RPBE = {E_initial_c_o_ml:.2f} eV, D3 = {E_initial_c_o_d3:.2f} eV, Total = {E_initial_c_o:.2f} eV\"\n)\nprint(\n    f\"   Final (CO*):     RPBE = {E_final_co_ml:.2f} eV, D3 = {E_final_co_d3:.2f} eV, Total = {E_final_co:.2f} eV\"\n)\n\n# Reaction energies without ZPE\ndelta_E_rpbe = E_final_co_ml - E_initial_c_o_ml\ndelta_E_d3_contrib = E_final_co_d3 - E_initial_c_o_d3\ndelta_E_elec = E_final_co - E_initial_c_o\n\nprint(f\"\\n   Reaction Energies (without ZPE):\")\nprint(f\"   ΔE(RPBE only):     {delta_E_rpbe:.2f} eV = {delta_E_rpbe*96.485:.1f} kJ/mol\")\nprint(\n    f\"   ΔE(D3 contrib):    {delta_E_d3_contrib:.2f} eV = {delta_E_d3_contrib*96.485:.1f} kJ/mol\"\n)\nprint(f\"   ΔE(RPBE+D3):       {delta_E_elec:.2f} eV = {delta_E_elec*96.485:.1f} kJ/mol\")\n\n# Calculate ZPE for CO* (final state)\nprint(f\"\\n   Computing ZPE for CO*...\")\nfinal_co.calc = base_calc\n\nco_indices = np.where(final_co.get_tags() == 2)[0]\nvib_co = Vibrations(final_co, indices=co_indices, delta=0.02, name=\"vib_co\")\nvib_co.run()\nvib_energies_co = vib_co.get_energies()\nzpe_co = np.sum(vib_energies_co[vib_energies_co \u003e 0]) / 2.0\nvib_co.clean()\nprint(f\"   ZPE(CO*): {zpe_co:.2f} eV ({zpe_co*1000:.1f} meV)\")\n\n\n# Calculate ZPE for C* and O* (initial state)\nprint(f\"\\n   Computing ZPE for C* and O*...\")\ninitial_c_o.calc = base_calc\nc_o_indices = np.where(initial_c_o.get_tags() == 2)[0]\nvib_c_o = Vibrations(initial_c_o, indices=c_o_indices, delta=0.02, name=\"vib_c_o\")\nvib_c_o.run()\nvib_energies_c_o = vib_c_o.get_energies()\nzpe_c_o = np.sum(vib_energies_c_o[vib_energies_c_o \u003e 0]) / 2.0\nvib_c_o.clean()\nprint(f\"   ZPE(C*+O*): {zpe_c_o:.2f} eV ({zpe_c_o*1000:.1f} meV)\")\n\n\n# Total reaction energy with ZPE\ndelta_zpe = zpe_co - zpe_c_o\ndelta_E_zpe = delta_E_elec + delta_zpe\n\nprint(f\"\\n   Reaction Energy (with ZPE):\")\nprint(f\"   ΔE(electronic):    {delta_E_elec:.2f} eV = {delta_E_elec*96.485:.1f} kJ/mol\")\nprint(\n    f\"   ΔZPE:              {delta_zpe:.2f} eV = {delta_zpe*96.485:.1f} kJ/mol ({delta_zpe*1000:.1f} meV)\"\n)\nprint(f\"   ΔE(total):         {delta_E_zpe:.2f} eV = {delta_E_zpe*96.485:.1f} kJ/mol\")\n\nprint(f\"\\n   Summary:\")\nprint(\n    f\"   Without D3, without ZPE: {delta_E_rpbe:.2f} eV = {delta_E_rpbe*96.485:.1f} kJ/mol\"\n)\nprint(\n    f\"   With D3, without ZPE:    {delta_E_elec:.2f} eV = {delta_E_elec*96.485:.1f} kJ/mol\"\n)\nprint(\n    f\"   With D3, with ZPE:       {delta_E_zpe:.2f} eV = {delta_E_zpe*96.485:.1f} kJ/mol\"\n)\n\nprint(f\"\\n   \" + \"=\" * 60)\nprint(f\"\\n   Comparison with Paper (Table 5):\")\nprint(f\"   Paper (DFT-D3): -142.7 kJ/mol = -1.48 eV\")\nprint(f\"   This work:      {delta_E_zpe*96.485:.1f} kJ/mol = {delta_E_zpe:.2f} eV\")\nprint(f\"   Difference:     {abs(delta_E_zpe - (-1.48)):.2f} eV\")\n\nif delta_E_zpe \u003c 0:\n    print(f\"\\n   ✓ Reaction is exothermic (C+O recombination favorable)\")\nelse:\n    print(f\"\\n   ⚠ Reaction is endothermic (dissociation favorable)\")","key":"T0fmVlrtTp"},{"type":"outputs","id":"WAgFle1iQA1MTTlwspRN5","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"\n3. Reaction Energy (C* + O* → CO*):\n   ============================================================\n\n   Electronic Energies:\n   Initial (C*+O*): RPBE = -465.77 eV, D3 = -36.89 eV, Total = -502.66 eV\n   Final (CO*):     RPBE = -466.90 eV, D3 = -36.88 eV, Total = -503.78 eV\n\n   Reaction Energies (without ZPE):\n   ΔE(RPBE only):     -1.13 eV = -108.6 kJ/mol\n   ΔE(D3 contrib):    0.01 eV = 0.7 kJ/mol\n   ΔE(RPBE+D3):       -1.12 eV = -107.9 kJ/mol\n\n   Computing ZPE for CO*...\n"},"key":"IwZKTK2YIR"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"   ZPE(CO*): 0.18+0.01j eV (183.5+5.1j meV)\n\n   Computing ZPE for C* and O*...\n"},"key":"BS5lspIFI9"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"   ZPE(C*+O*): 0.18+0.00j eV (177.8+0.0j meV)\n\n   Reaction Energy (with ZPE):\n   ΔE(electronic):    -1.12 eV = -107.9 kJ/mol\n   ΔZPE:              0.01+0.01j eV = 0.5+0.5j kJ/mol (5.7+5.1j meV)\n   ΔE(total):         -1.11+0.01j eV = -107.4+0.5j kJ/mol\n\n   Summary:\n   Without D3, without ZPE: -1.13 eV = -108.6 kJ/mol\n   With D3, without ZPE:    -1.12 eV = -107.9 kJ/mol\n   With D3, with ZPE:       -1.11+0.01j eV = -107.4+0.5j kJ/mol\n\n   ============================================================\n\n   Comparison with Paper (Table 5):\n   Paper (DFT-D3): -142.7 kJ/mol = -1.48 eV\n   This work:      -107.4+0.5j kJ/mol = -1.11+0.01j eV\n   Difference:     0.37 eV\n\n   ✓ Reaction is exothermic (C+O recombination favorable)\n"},"key":"mO9byxSyZs"}],"key":"d3i8yyGxKT"}],"key":"aSKq3CmQlz"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":1652,"column":1},"end":{"line":1652,"column":1}},"children":[{"type":"text","value":"Step 5: Calculate CO Adsorption Energy (Bonus)","position":{"start":{"line":1652,"column":1},"end":{"line":1652,"column":1}},"key":"BwT0uHkmO0"}],"identifier":"step-5-calculate-co-adsorption-energy-bonus","label":"Step 5: Calculate CO Adsorption Energy (Bonus)","html_id":"step-5-calculate-co-adsorption-energy-bonus","implicit":true,"key":"bZQID2Hf7O"},{"type":"paragraph","position":{"start":{"line":1654,"column":1},"end":{"line":1654,"column":1}},"children":[{"type":"text","value":"Calculate how strongly CO binds to the surface:","position":{"start":{"line":1654,"column":1},"end":{"line":1654,"column":1}},"key":"XHYjBeNGdm"}],"key":"pNoK5ZKCh8"}],"key":"xgPUvoMiSM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(f\"\\n4. CO Adsorption Energy ( CO(g) + * → CO*):\")\nprint(\"   This helps us understand CO binding strength\")\n\n# CO(g)\nco_gas = Atoms(\"CO\", positions=[[0, 0, 0], [0, 0, 1.15]])\nco_gas.center(vacuum=10.0)\nco_gas.set_pbc([True, True, True])\nco_gas.calc = base_calc\nopt = LBFGS(co_gas, logfile=None)\nopt.run(fmax=0.05, steps=relaxation_steps)\n\nE_co_gas_ml = co_gas.get_potential_energy()\nco_gas.calc = d3_calc\nE_co_gas_d3 = co_gas.get_potential_energy()\nE_co_gas = E_co_gas_ml + E_co_gas_d3\n\nprint(\n    f\"   CO(g):       E_total = {E_co_gas:.2f} eV (RPBE: {E_co_gas_ml:.2f}, D3: {E_co_gas_d3:.2f})\"\n)\n\n# Calculate ZPE for CO(g)\nco_gas.calc = base_calc\nvib_co_gas = Vibrations(co_gas, indices=[0, 1], delta=0.01, nfree=2)\nvib_co_gas.clean()\nvib_co_gas.run()\nvib_energies_co_gas = vib_co_gas.get_energies()\nzpe_co_gas = 0.5 * np.sum(vib_energies_co_gas[vib_energies_co_gas \u003e 0])\nvib_co_gas.clean()\n\nprint(f\"   ZPE(CO(g)):  {zpe_co_gas:.2f} eV\")\nprint(f\"   ZPE(CO*):    {zpe_co:.2f} eV (from Step 4 calculation)\")\n\n# Electronic adsorption energy\nE_ads_co_elec = E_final_co - E_clean - E_co_gas\n\n# ZPE contribution to adsorption energy\ndelta_zpe_ads = zpe_co - zpe_co_gas\n\n# Total adsorption energy with ZPE\nE_ads_co_total = E_ads_co_elec + delta_zpe_ads\n\nprint(f\"\\n   Electronic Energy Breakdown:\")\nprint(f\"   ΔE(RPBE only) = {(E_final_co_ml - E_clean_ml - E_co_gas_ml):.2f} eV\")\nprint(f\"   ΔE(D3 contrib) = {((E_final_co_d3 - E_clean_d3 - E_co_gas_d3)):.2f} eV\")\nprint(f\"   ΔE(RPBE+D3) = {E_ads_co_elec:.2f} eV\")\nprint(f\"\\n   ZPE Contribution:\")\nprint(f\"   ΔZPE = {delta_zpe_ads:.2f} eV\")\nprint(f\"\\n   Total Adsorption Energy:\")\nprint(f\"   ΔE(total) = {E_ads_co_total:.2f} eV = {E_ads_co_total*96.485:.1f} kJ/mol\")\nprint(f\"\\n   Summary:\")\nprint(\n    f\"   E_ads(CO) without ZPE = {-E_ads_co_elec:.2f} eV = {-E_ads_co_elec*96.485:.1f} kJ/mol\"\n)\nprint(\n    f\"   E_ads(CO) with ZPE    = {-E_ads_co_total:.2f} eV = {-E_ads_co_total*96.485:.1f} kJ/mol\"\n)\nprint(\n    f\"   → CO binds {abs(E_ads_co_total):.2f} eV stronger than H ({abs(E_ads_co_total)/0.60:.1f}x)\"\n)","key":"LOGv9jhsGJ"},{"type":"outputs","id":"LqRY2Qu9PycsBdfp27M-_","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"\n4. CO Adsorption Energy ( CO(g) + * → CO*):\n   This helps us understand CO binding strength\n"},"key":"IiWBj9yta0"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"   CO(g):       E_total = -14.43 eV (RPBE: -14.42, D3: -0.01)\n"},"key":"BH3D3cjwdv"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"   ZPE(CO(g)):  0.13+0.00j eV\n   ZPE(CO*):    0.18+0.01j eV (from Step 4 calculation)\n\n   Electronic Energy Breakdown:\n   ΔE(RPBE only) = -1.59 eV\n   ΔE(D3 contrib) = -0.30 eV\n   ΔE(RPBE+D3) = -1.89 eV\n\n   ZPE Contribution:\n   ΔZPE = 0.05+0.01j eV\n\n   Total Adsorption Energy:\n   ΔE(total) = -1.84+0.01j eV = -177.2+0.5j kJ/mol\n\n   Summary:\n   E_ads(CO) without ZPE = 1.89 eV = 182.2 kJ/mol\n   E_ads(CO) with ZPE    = 1.84-0.01j eV = 177.2-0.5j kJ/mol\n   → CO binds 1.84 eV stronger than H (3.1x)\n"},"key":"GwtYM3dCah"}],"key":"Qf2C2yu3Ld"}],"key":"o8vwWxvCUc"},{"type":"block","children":[{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Comparison with Paper Results","position":{"start":{"line":1718,"column":1},"end":{"line":1718,"column":1}},"key":"O1NbqicrFS"}],"key":"WTQFVRzCec"},{"type":"paragraph","position":{"start":{"line":1721,"column":1},"end":{"line":1721,"column":1}},"children":[{"type":"text","value":"The paper reports a CO adsorption energy of ","position":{"start":{"line":1721,"column":1},"end":{"line":1721,"column":1}},"key":"NZ8EN95hVD"},{"type":"strong","position":{"start":{"line":1721,"column":1},"end":{"line":1721,"column":1}},"children":[{"type":"text","value":"1.82 eV (175.6 kJ/mol)","position":{"start":{"line":1721,"column":1},"end":{"line":1721,"column":1}},"key":"JUknaNIzCS"}],"key":"LeXZpucJAg"},{"type":"text","value":" in Table 4, calculated using DFT (RPBE functional).","position":{"start":{"line":1721,"column":1},"end":{"line":1721,"column":1}},"key":"AEsILUt29W"}],"key":"iDrVE2QGtp"},{"type":"paragraph","position":{"start":{"line":1723,"column":1},"end":{"line":1723,"column":1}},"children":[{"type":"text","value":"These results show:","position":{"start":{"line":1723,"column":1},"end":{"line":1723,"column":1}},"key":"vDECO4QZaI"}],"key":"jP8Qea7Ojg"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":1724,"column":1},"end":{"line":1726,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":1724,"column":1},"end":{"line":1724,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":1724,"column":1},"end":{"line":1724,"column":1}},"children":[{"type":"text","value":"Without ZPE","position":{"start":{"line":1724,"column":1},"end":{"line":1724,"column":1}},"key":"Kz9RR304gB"}],"key":"iKJLkf3j8w"},{"type":"text","value":": The electronic binding energy matches well with DFT predictions","position":{"start":{"line":1724,"column":1},"end":{"line":1724,"column":1}},"key":"GqWFozofTo"}],"key":"eOQ9UbNnak"}],"key":"XVxftXPa0R"},{"type":"listItem","spread":true,"position":{"start":{"line":1725,"column":1},"end":{"line":1725,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":1725,"column":1},"end":{"line":1725,"column":1}},"children":[{"type":"text","value":"With ZPE","position":{"start":{"line":1725,"column":1},"end":{"line":1725,"column":1}},"key":"wjFXfU7pRU"}],"key":"YVr6nrPSRN"},{"type":"text","value":": The zero-point energy correction reduces the binding strength slightly","position":{"start":{"line":1725,"column":1},"end":{"line":1725,"column":1}},"key":"XVysRVxUWa"}],"key":"zwhtk7YoqT"}],"key":"Cf48ljDFj8"},{"type":"listItem","spread":true,"position":{"start":{"line":1726,"column":1},"end":{"line":1726,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":1726,"column":1},"end":{"line":1726,"column":1}},"children":[{"type":"text","value":"D3 Dispersion","position":{"start":{"line":1726,"column":1},"end":{"line":1726,"column":1}},"key":"Reab0zsxie"}],"key":"ZwKUJ6HZD7"},{"type":"text","value":": Contributes to stronger binding due to van der Waals interactions","position":{"start":{"line":1726,"column":1},"end":{"line":1726,"column":1}},"key":"uIaYwZM7cX"}],"key":"W95DauS4ts"}],"key":"Z3SKjoZu19"}],"key":"mDMPGlp01h"}],"class":"tip","key":"OcbeubVZiD"},{"type":"heading","depth":3,"position":{"start":{"line":1730,"column":1},"end":{"line":1730,"column":1}},"children":[{"type":"text","value":"Step 6: Find guesses for nearby initial and final states for the reaction","position":{"start":{"line":1730,"column":1},"end":{"line":1730,"column":1}},"key":"Lr3sRAoyk2"}],"identifier":"step-6-find-guesses-for-nearby-initial-and-final-states-for-the-reaction","label":"Step 6: Find guesses for nearby initial and final states for the reaction","html_id":"step-6-find-guesses-for-nearby-initial-and-final-states-for-the-reaction","implicit":true,"key":"YDGWfmrWDR"},{"type":"paragraph","position":{"start":{"line":1732,"column":1},"end":{"line":1732,"column":1}},"children":[{"type":"text","value":"Now that we have an estimate on the reaction energy from the best possible initial and final states, we want to find a transition state (barrier) for this reaction. There are MANY possible ways that we could do this. In this case, we’ll start with the *CO final state and then try and find a nearby local minimal of *C and *O, by fixing the C-O bond distance and finding a nearby local minima. Note that this approach required some insight into what the transition state might look like, and could be considerably more complicated for a reaction that did not involve breaking a single bond.","position":{"start":{"line":1732,"column":1},"end":{"line":1732,"column":1}},"key":"fiHVHZjW6o"}],"key":"EAzZn9Lvnt"}],"key":"fQ9GP7s9ii"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(f\"\\nFinding Transition State Initial and Final States\")\nprint(\"   Creating initial guess with stretched C-O bond...\")\nprint(\"   Starting from CO* and stretching the C-O bond...\")\n\n# Create a guess structure with stretched CO bond (start from CO*)\ninitial_guess = final_co.copy()\n\n# Set up a constraint to fix the bond length to ~2 Angstroms, which should be far enough that we'll be closer to *C+*O than *CO\nco_indices = np.where(initial_guess.get_tags() == 2)[0]\n\n# Rotate the atoms a bit just to break the symmetry and prevent the O from going straight up to satisfy the constraint\ninitial_slab = initial_guess[initial_guess.get_tags() != 2]\ninitial_co = initial_guess[initial_guess.get_tags() == 2]\ninitial_co.rotate(30, \"x\", center=initial_co.positions[0])\ninitial_guess = initial_slab + initial_co\n\ninitial_guess.calc = FAIRChemCalculator(predictor, task_name=\"oc20\")\n\n# Add constraints to keep the CO bond length extended\ninitial_guess.constraints += [\n    FixBondLengths([co_indices], tolerance=1e-2, iterations=5000, bondlengths=[2.0])\n]\n\n\ntry:\n    opt = LBFGS(\n        initial_guess,\n        trajectory=output_dir / part_dirs[\"part6\"] / \"initial_guess_with_constraint.traj\",\n    )\n    opt.run(fmax=0.01)\nexcept RuntimeError:\n    # The FixBondLength constraint is sometimes a little finicky,\n    # but it's ok if it doesn't finish as it's just an initial guess\n    # for the next step\n    pass\n\n# Now that we have a guess, re-relax without the constraints\ninitial_guess.constraints = initial_guess.constraints[:-1]\nopt = LBFGS(\n    initial_guess,\n    trajectory=output_dir\n    / part_dirs[\"part6\"]\n    / \"initial_guess_without_constraint.traj\",\n)\nopt.run(fmax=0.01)","key":"OqGQecOcnX"},{"type":"outputs","id":"N3mpPVeL_HTdBoVBJWhsc","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"\nFinding Transition State Initial and Final States\n   Creating initial guess with stretched C-O bond...\n   Starting from CO* and stretching the C-O bond...\n"},"key":"NeBIfCEvaK"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"       Step     Time          Energy          fmax\nLBFGS:    0 21:14:50     -466.586819        1.126528\n"},"key":"GjDIKm8sh5"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"LBFGS:    1 21:14:51     -466.631456        1.024523\n"},"key":"GkuCtdWdIp"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"LBFGS:    2 21:14:51     -466.833472        3.051798\n"},"key":"xDIydcvDwK"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"LBFGS:    3 21:14:52     -466.884462        0.871574\n"},"key":"s3KZ5TnOu4"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"LBFGS:    4 21:14:52     -466.911698        0.549930\n"},"key":"j5UprdD9ng"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"LBFGS:    5 21:14:53     -466.951743        0.590103\n"},"key":"kwO4luzMlE"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"LBFGS:    6 21:14:53     -466.969523        0.397013\n"},"key":"rs2I31HDs4"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"LBFGS:    7 21:14:54     -466.981476        0.392852\n"},"key":"uatir64uVN"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"LBFGS:    8 21:14:54     -466.986590        0.298904\n"},"key":"Zo96HJFxal"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"LBFGS:    9 21:14:54     -466.993401        0.259323\n"},"key":"tAbtaK4HG2"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"LBFGS:   10 21:14:55     -466.997520        0.277442\n"},"key":"elx9J0naYQ"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"LBFGS:   11 21:14:55     -466.999979        0.249170\n"},"key":"JL0XejJPb0"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"LBFGS:   12 21:14:56     -467.002311        0.145081\n"},"key":"bTIYIYpVnr"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"LBFGS:   13 21:14:56     -467.004330        0.117686\n"},"key":"gijX16HALT"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"LBFGS:   14 21:14:56     -467.005186        0.111491\n"},"key":"cPLt4NeuBu"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"LBFGS:   15 21:14:57     -467.006000        0.084512\n"},"key":"zDxqKJ1qrM"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"LBFGS:   16 21:14:57     -467.006792        0.082439\n"},"key":"F7Bvc9oQfE"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"LBFGS:   17 21:14:57     -467.007572        0.058191\n"},"key":"tACa84Ichu"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"LBFGS:   18 21:14:58     -467.008152        0.073206\n"},"key":"XFbk6VkYlG"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"LBFGS:   19 21:14:58     -467.008587        0.071630\n"},"key":"rqfuNL5u0f"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"LBFGS:   20 21:14:59     -467.009067        0.060635\n"},"key":"XZJhbB5O7h"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"LBFGS:   21 21:14:59     -467.009663        0.066588\n"},"key":"H75gA0uhhk"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"LBFGS:   22 21:14:59     -467.010343        0.118594\n"},"key":"Cbxw8fGPsY"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"LBFGS:   23 21:15:00     -467.011054        0.144746\n"},"key":"sjdLsi91ZS"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"LBFGS:   24 21:15:00     -467.011764        0.116407\n"},"key":"GTJTVRAHqB"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"LBFGS:   25 21:15:00     -467.012494        0.065354\n"},"key":"EXwjM5RzkA"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"LBFGS:   26 21:15:01     -467.013410        0.121565\n"},"key":"hi6gOHNCtz"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"LBFGS:   27 21:15:01     -467.014890        0.243838\n"},"key":"zVKpXrQjxF"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"LBFGS:   28 21:15:02     -467.017752        0.384512\n"},"key":"g7GfqhECFh"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"LBFGS:   29 21:15:02     -467.023440        0.537903\n"},"key":"eE7z5rXC8z"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"LBFGS:   30 21:15:02     -467.030595        0.628289\n"},"key":"Lqc4sVWg6I"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"LBFGS:   31 21:15:03     -467.043212        0.373476\n"},"key":"TJXhZbiAzo"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"LBFGS:   32 21:15:03     -467.074735        0.582289\n"},"key":"rKxhuHxtf4"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"LBFGS:   33 21:15:03     -467.066960        0.877857\n"},"key":"istZypYPpe"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"LBFGS:   34 21:15:04     -467.098999        0.780995\n"},"key":"vlpoyFHCPR"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"LBFGS:   35 21:15:04     -467.105918        0.501631\n"},"key":"k8y0D4WKbZ"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"LBFGS:   36 21:15:04     -467.116751        0.204056\n"},"key":"ngXZkAgrmW"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"LBFGS:   37 21:15:05     -467.120241        0.182302\n"},"key":"i5YYpTy0tT"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"LBFGS:   38 21:15:05     -467.123177        0.200803\n"},"key":"ZaHOFnvVPc"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"LBFGS:   39 21:15:05     -467.125401        0.164320\n"},"key":"fRxLUw9SZg"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"LBFGS:   40 21:15:06     -467.127870        0.136161\n"},"key":"D1YDaFCcVE"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"LBFGS:   41 21:15:06     -467.130722        0.127583\n"},"key":"MKLCkJnoct"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"LBFGS:   42 21:15:06     -467.132516        0.126120\n"},"key":"jxWWP0pJLr"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"LBFGS:   43 21:15:07     -467.133611        0.119503\n"},"key":"xjHbrAof6q"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"LBFGS:   44 21:15:07     -467.134573        0.092507\n"},"key":"pc2IQ5cqJv"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"LBFGS:   45 21:15:08     -467.135881        0.111032\n"},"key":"Cipb9xCJcV"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"LBFGS:   46 21:15:08     -467.137585        0.108930\n"},"key":"BcoUDk9KqG"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"LBFGS:   47 21:15:08     -467.139015        0.074102\n"},"key":"Zoe5eFzgQf"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"LBFGS:   48 21:15:09     -467.139748        0.051515\n"},"key":"uR6vXKaFpM"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"LBFGS:   49 21:15:09     -467.140103        0.042414\n"},"key":"Pb6Dk87I51"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"LBFGS:   50 21:15:09     -467.140421        0.039418\n"},"key":"geE7rEk2oN"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"LBFGS:   51 21:15:10     -467.140764        0.028931\n"},"key":"OlKroS5ppR"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"LBFGS:   52 21:15:10     -467.140954        0.019574\n"},"key":"vaeltUtBZZ"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"LBFGS:   53 21:15:10     -467.141028        0.016651\n"},"key":"GCET0a0L9g"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"LBFGS:   54 21:15:11     -467.141072        0.017189\n"},"key":"E9PJZWFhK9"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"LBFGS:   55 21:15:11     -467.141149        0.018255\n"},"key":"GOkuo46Tyy"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"LBFGS:   56 21:15:12     -467.141232        0.016314\n"},"key":"Nh8MlGKMOc"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"LBFGS:   57 21:15:12     -467.141301        0.015502\n"},"key":"jLXqvh711n"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"LBFGS:   58 21:15:13     -467.141335        0.013035\n"},"key":"qtn0uWB6Bb"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"LBFGS:   59 21:15:13     -467.141359        0.011771\n"},"key":"znmVHAEvGP"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"LBFGS:   60 21:15:14     -467.141387        0.013656\n"},"key":"jNzDekunTI"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"LBFGS:   61 21:15:14     -467.141425        0.013902\n"},"key":"FkUOLk3XYA"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"LBFGS:   62 21:15:15     -467.141451        0.009736\n"},"key":"UgCeDBYUvG"},{"type":"output","children":[],"jupyter_data":{"output_type":"execute_result","execution_count":36,"metadata":{},"data":{"text/plain":{"content":"np.True_","content_type":"text/plain"}}},"key":"RVwbETWH6f"}],"key":"wOWTuctv9N"}],"key":"v2351MdIRm"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":1782,"column":1},"end":{"line":1782,"column":1}},"children":[{"type":"text","value":"Step 7: Run NEB to Find Activation Barrier","position":{"start":{"line":1782,"column":1},"end":{"line":1782,"column":1}},"key":"wLcr2aNQBK"}],"identifier":"step-7-run-neb-to-find-activation-barrier","label":"Step 7: Run NEB to Find Activation Barrier","html_id":"step-7-run-neb-to-find-activation-barrier","implicit":true,"key":"paSrZMPfGW"},{"type":"paragraph","position":{"start":{"line":1784,"column":1},"end":{"line":1784,"column":1}},"children":[{"type":"text","value":"Use the nudged elastic band method to find the minimum energy path:","position":{"start":{"line":1784,"column":1},"end":{"line":1784,"column":1}},"key":"bhXpaXgPzH"}],"key":"NIzUkRGgp6"}],"key":"cCtnNTfjNu"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(f\"\\n7. NEB Barrier Calculation (C* + O* → CO*)\")\nprint(\"   Setting up 7-image NEB chain with TS guess in middle...\")\nprint(\"   Reaction: C* + O* (initial) → TS → CO* (final)\")\n\ninitial = initial_guess.copy()\ninitial.calc = FAIRChemCalculator(predictor, task_name=\"oc20\")\nimages = [initial]  # Start with C* + O*\n\nn_images = 10\nfor i in range(n_images):\n    image = initial.copy()\n    image.calc = FAIRChemCalculator(predictor, task_name=\"oc20\")\n    images.append(image)\n\nfinal = final_co.copy()\nfinal.calc = FAIRChemCalculator(predictor, task_name=\"oc20\")\nimages.append(final)  # End with CO*\n\n# Interpolate with better initial guess\ndyneb = DyNEB(images, climb=True, fmax=0.05)\n\n# Interpolate first half (C*+O* → TS)\nprint(\"\\n   Interpolating images...\")\ndyneb.interpolate(\"idpp\", mic=True)\n\n# Optimize\nprint(\"   Optimizing NEB path (this may take a while)...\")\nopt = FIRE(\n    dyneb,\n    trajectory=str(output_dir / part_dirs[\"part6\"] / \"neb.traj\"),\n    logfile=str(output_dir / part_dirs[\"part6\"] / \"neb.log\"),\n)\nopt.run(fmax=0.1, steps=relaxation_steps)\n\n# Extract barrier (from C*+O* to TS)\nenergies = [img.get_potential_energy() for img in images]\nenergies_rel = np.array(energies) - energies[0]\nE_barrier = np.max(energies_rel)\n\nprint(f\"\\n   ✓ NEB converged!\")\nprint(\n    f\"\\n   Forward barrier (C*+O* → CO*): {E_barrier:.2f} eV = {E_barrier*96.485:.1f} kJ/mol\"\n)\nprint(\n    f\"   Reverse barrier (CO* → C*+O*): {E_barrier - energies_rel[-1]:.2f} eV = {(E_barrier- energies_rel[-1])*96.485:.1f} kJ/mol\"\n)\nprint(f\"\\n   Paper (Table 5): 153 kJ/mol = 1.59 eV \")\nprint(f\"   Difference: {abs(E_barrier - 1.59):.2f} eV\")","key":"KjkK9AW7jY"},{"type":"outputs","id":"fYgRwMfypUS9PuSrt8lB_","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"\n7. NEB Barrier Calculation (C* + O* → CO*)\n   Setting up 7-image NEB chain with TS guess in middle...\n   Reaction: C* + O* (initial) → TS → CO* (final)\n\n   Interpolating images...\n"},"key":"pdma3pmuMj"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"   Optimizing NEB path (this may take a while)...\n"},"key":"WMeV6nKWuo"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"\n   ✓ NEB converged!\n\n   Forward barrier (C*+O* → CO*): 0.25 eV = 23.7 kJ/mol\n   Reverse barrier (CO* → C*+O*): 0.00 eV = 0.0 kJ/mol\n\n   Paper (Table 5): 153 kJ/mol = 1.59 eV \n   Difference: 1.34 eV\n"},"key":"KBVw7mejpZ"}],"key":"QaBtkKl1tG"}],"key":"z8uKldtvsN"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":1837,"column":1},"end":{"line":1837,"column":1}},"children":[{"type":"text","value":"Step 8: Visualize NEB Path and Key Structures","position":{"start":{"line":1837,"column":1},"end":{"line":1837,"column":1}},"key":"yZXvhNVF4o"}],"identifier":"step-8-visualize-neb-path-and-key-structures","label":"Step 8: Visualize NEB Path and Key Structures","html_id":"step-8-visualize-neb-path-and-key-structures","implicit":true,"key":"yLiKInggiZ"},{"type":"paragraph","position":{"start":{"line":1839,"column":1},"end":{"line":1839,"column":1}},"children":[{"type":"text","value":"Create plots showing the reaction pathway:","position":{"start":{"line":1839,"column":1},"end":{"line":1839,"column":1}},"key":"hKyPUz5qJT"}],"key":"IMMFAMxn72"}],"key":"Uh5s9dnadL"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(\"\\n   Creating NEB visualization...\")\n\n# Plot NEB path\nfig, ax = plt.subplots(figsize=(10, 6))\nax.plot(\n    range(len(energies_rel)),\n    energies_rel,\n    \"o-\",\n    linewidth=2,\n    markersize=10,\n    color=\"steelblue\",\n    label=\"NEB Path\",\n)\nax.axhline(0, color=\"green\", linestyle=\"--\", alpha=0.5, label=\"Initial: C*+O*\")\nax.axhline(delta_E_zpe, color=\"red\", linestyle=\"--\", alpha=0.5, label=\"Final: CO*\")\nax.axhline(\n    E_barrier,\n    color=\"orange\",\n    linestyle=\":\",\n    alpha=0.7,\n    linewidth=2,\n    label=f\"Forward Barrier = {E_barrier:.2f} eV\",\n)\n\n# Annotate transition state\nts_idx = np.argmax(energies_rel)\nax.annotate(\n    f\"TS\\n{energies_rel[ts_idx]:.2f} eV\",\n    xy=(ts_idx, energies_rel[ts_idx]),\n    xytext=(ts_idx, energies_rel[ts_idx] + 0.3),\n    ha=\"center\",\n    fontsize=11,\n    fontweight=\"bold\",\n    arrowprops=dict(arrowstyle=\"-\u003e\", lw=1.5, color=\"red\"),\n)\n\nax.set_xlabel(\"Image Number\", fontsize=13)\nax.set_ylabel(\"Relative Energy (eV)\", fontsize=13)\nax.set_title(\n    \"CO Formation on Ni(111): C* + O* → CO* - NEB Path\", fontsize=15, fontweight=\"bold\"\n)\nax.legend(fontsize=11, loc=\"upper left\")\nax.grid(True, alpha=0.3)\n\nplt.tight_layout()\nplt.savefig(\n    str(output_dir / part_dirs[\"part6\"] / \"neb_path.png\"), dpi=300, bbox_inches=\"tight\"\n)\nplt.show()\n\n# Create animation of NEB path\nprint(\"\\n   Creating NEB path animation...\")\nfrom ase.io import write as ase_write\n\nase.io.write(\n    str(output_dir / part_dirs[\"part6\"] / \"neb_path.gif\"), images, format=\"gif\"\n)\nprint(\"   → Saved as neb_path.gif\")\n\n# Visualize key structures\nprint(\"\\n   Visualizing initial state (C* + O*)...\")\nview(initial_c_o, viewer='x3d')\n\nprint(\"\\n   Visualizing transition state...\")\nview(images[ts_idx], viewer='x3d')\n\nprint(\"\\n   Visualizing final state (CO*)...\")\nview(final_co, viewer='x3d')\n\nprint(\"\\n✓ NEB analysis complete!\")","key":"dZws51oJaK"},{"type":"outputs","id":"GlV_u4S3YEYvZmFC3q2O8","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"\n   Creating NEB visualization...\n"},"key":"R83gA99jeO"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"/home/runner/work/_tool/Python/3.12.12/x64/lib/python3.12/site-packages/matplotlib/cbook.py:1355: ComplexWarning: Casting complex values to real discards the imaginary part\n  return np.asarray(x, float)\n"},"key":"GrHj5BPENX"},{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"\u003cFigure size 1000x600 with 1 Axes\u003e","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"16817b250821510773f9765309ea7671","path":"/build/16817b250821510773f9765309ea7671.png"}}},"key":"dqqvZjHdMO"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"\n   Creating NEB path animation...\n"},"key":"qOpFDPoF8v"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"   → Saved as neb_path.gif\n\n   Visualizing initial state (C* + O*)...\n\n   Visualizing transition state...\n\n   Visualizing final state (CO*)...\n\n✓ NEB analysis complete!\n"},"key":"fkRbW3Ptes"},{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"\u003cFigure size 640x480 with 1 Axes\u003e","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"8258dbc471c4ccc769a50effdf53c191","path":"/build/8258dbc471c4ccc769a50effdf53c191.png"}}},"key":"MX3uq2ztCD"}],"key":"ulB7WZ6kOm"}],"key":"MJENSF5Jzn"},{"type":"block","children":[{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Missing UMA access?","position":{"start":{"line":1914,"column":1},"end":{"line":1914,"column":1}},"key":"ue0VtHDJ4z"}],"key":"ezuo1nqhto"},{"type":"paragraph","position":{"start":{"line":1917,"column":1},"end":{"line":1917,"column":1}},"children":[{"type":"text","value":"Don’t have access to UMA yet? You can still explore this calculation!","position":{"start":{"line":1917,"column":1},"end":{"line":1917,"column":1}},"key":"V5qqpoHxKA"}],"key":"GTxPf0nmC7"},{"type":"paragraph","position":{"start":{"line":1919,"column":1},"end":{"line":1919,"column":1}},"children":[{"type":"link","url":"example_configs/co_on_ni111.xyz","position":{"start":{"line":1919,"column":1},"end":{"line":1919,"column":1}},"children":[{"type":"text","value":"Download example CO on Ni(111) structure","position":{"start":{"line":1919,"column":1},"end":{"line":1919,"column":1}},"key":"WJ7Xdi67KK"}],"urlSource":"example_configs/co_on_ni111.xyz","key":"XspBrLxQnb"},{"type":"text","value":" and ","position":{"start":{"line":1919,"column":1},"end":{"line":1919,"column":1}},"key":"v1iNXFvURo"},{"type":"link","url":"example_configs/c_o_on_ni111.xyz","position":{"start":{"line":1919,"column":1},"end":{"line":1919,"column":1}},"children":[{"type":"text","value":"Download C+O on Ni(111) structure","position":{"start":{"line":1919,"column":1},"end":{"line":1919,"column":1}},"key":"Pgdyn7emA7"}],"urlSource":"example_configs/c_o_on_ni111.xyz","key":"xPto9ZYuTm"},{"type":"text","value":" to test in the ","position":{"start":{"line":1919,"column":1},"end":{"line":1919,"column":1}},"key":"dq9qjrdaKF"},{"type":"link","url":"https://facebook-fairchem-uma-demo.hf.space/","position":{"start":{"line":1919,"column":1},"end":{"line":1919,"column":1}},"children":[{"type":"text","value":"UMA demo (no login required)","position":{"start":{"line":1919,"column":1},"end":{"line":1919,"column":1}},"key":"yf5prStMIK"}],"urlSource":"https://facebook-fairchem-uma-demo.hf.space/","key":"gv0pJ6pNTt"},{"type":"text","value":" and explore the reaction pathway.","position":{"start":{"line":1919,"column":1},"end":{"line":1919,"column":1}},"key":"AOdnFTZxdi"}],"key":"WaH7HHLxM5"}],"class":"dropdown, tip","key":"eBujSGD4hZ"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Comparison with Paper (Tables 4 \u0026 5)","position":{"start":{"line":1922,"column":1},"end":{"line":1922,"column":1}},"key":"q28KF9kaXh"}],"key":"JVpfFIWhId"},{"type":"paragraph","position":{"start":{"line":1925,"column":1},"end":{"line":1925,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1925,"column":1},"end":{"line":1925,"column":1}},"children":[{"type":"text","value":"Expected Results from Paper:","position":{"start":{"line":1925,"column":1},"end":{"line":1925,"column":1}},"key":"pPWg5Q0vES"}],"key":"Fdi4snTC8U"}],"key":"oR0bvR3btl"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":1926,"column":1},"end":{"line":1929,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":1926,"column":1},"end":{"line":1926,"column":1}},"children":[{"type":"paragraph","children":[{"type":"emphasis","position":{"start":{"line":1926,"column":1},"end":{"line":1926,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":1926,"column":1},"end":{"line":1926,"column":1}},"children":[{"type":"text","value":"Reaction Energy (C","position":{"start":{"line":1926,"column":1},"end":{"line":1926,"column":1}},"key":"ptZMXpnrUX"}],"key":"RLOOQfffYN"},{"type":"text","value":" + O","position":{"start":{"line":1926,"column":1},"end":{"line":1926,"column":1}},"key":"tVEnviuSmR"}],"key":"rzw0RqfvRF"},{"type":"text","value":" → CO*)**: ","position":{"start":{"line":1926,"column":1},"end":{"line":1926,"column":1}},"key":"l9hZCSiArG"},{"type":"strong","position":{"start":{"line":1926,"column":1},"end":{"line":1926,"column":1}},"children":[{"type":"text","value":"-142.7 kJ/mol = -1.48 eV","position":{"start":{"line":1926,"column":1},"end":{"line":1926,"column":1}},"key":"jiX6xvQ9ZI"}],"key":"vtokj0CnZZ"},{"type":"text","value":" (exothermic, DFT-D3)","position":{"start":{"line":1926,"column":1},"end":{"line":1926,"column":1}},"key":"e6WFDtonwA"}],"key":"bfFS4DeASY"}],"key":"mcW0qkLkRb"},{"type":"listItem","spread":true,"position":{"start":{"line":1927,"column":1},"end":{"line":1927,"column":1}},"children":[{"type":"paragraph","children":[{"type":"emphasis","position":{"start":{"line":1927,"column":1},"end":{"line":1927,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":1927,"column":1},"end":{"line":1927,"column":1}},"children":[{"type":"text","value":"Activation Barrier (C","position":{"start":{"line":1927,"column":1},"end":{"line":1927,"column":1}},"key":"h19DiDZ87r"}],"key":"ii965eA7FT"},{"type":"text","value":" + O","position":{"start":{"line":1927,"column":1},"end":{"line":1927,"column":1}},"key":"LENyQulY8J"}],"key":"GxSKHL4QE5"},{"type":"text","value":" → CO*)**: ","position":{"start":{"line":1927,"column":1},"end":{"line":1927,"column":1}},"key":"nP2CNvieJf"},{"type":"strong","position":{"start":{"line":1927,"column":1},"end":{"line":1927,"column":1}},"children":[{"type":"text","value":"153 kJ/mol = 1.59 eV","position":{"start":{"line":1927,"column":1},"end":{"line":1927,"column":1}},"key":"fu5yfAvodG"}],"key":"bJ7Fj6fx3L"},{"type":"text","value":" (reverse/dissociation, DFT-D3)","position":{"start":{"line":1927,"column":1},"end":{"line":1927,"column":1}},"key":"Iv1zCVTShG"}],"key":"ubtsk66CiR"}],"key":"dWcvFeuW1T"},{"type":"listItem","spread":true,"position":{"start":{"line":1928,"column":1},"end":{"line":1929,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":1928,"column":1},"end":{"line":1928,"column":1}},"children":[{"type":"text","value":"CO Adsorption Energy","position":{"start":{"line":1928,"column":1},"end":{"line":1928,"column":1}},"key":"iiUHVl1VYd"}],"key":"G1cVjF6Li6"},{"type":"text","value":": ","position":{"start":{"line":1928,"column":1},"end":{"line":1928,"column":1}},"key":"SyrrwW260g"},{"type":"strong","position":{"start":{"line":1928,"column":1},"end":{"line":1928,"column":1}},"children":[{"type":"text","value":"1.82 eV = 175.6 kJ/mol","position":{"start":{"line":1928,"column":1},"end":{"line":1928,"column":1}},"key":"fXY7imsfOl"}],"key":"f2hWrR4Fhg"},{"type":"text","value":" (DFT-D3)","position":{"start":{"line":1928,"column":1},"end":{"line":1928,"column":1}},"key":"kEfE551kZW"}],"key":"pPYvs7PSaB"}],"key":"H8UkEq3KSo"}],"key":"yEnTCrrUb8"},{"type":"paragraph","position":{"start":{"line":1930,"column":1},"end":{"line":1930,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1930,"column":1},"end":{"line":1930,"column":1}},"children":[{"type":"text","value":"Reaction Direction:","position":{"start":{"line":1930,"column":1},"end":{"line":1930,"column":1}},"key":"rUwLCb4bce"}],"key":"uvQZPZOP5z"}],"key":"RVRJmBtVF8"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":1931,"column":1},"end":{"line":1934,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":1931,"column":1},"end":{"line":1931,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Paper reports CO dissociation barrier (CO* → C* + O*), which is the ","position":{"start":{"line":1931,"column":1},"end":{"line":1931,"column":1}},"key":"Bvs0CTINMY"},{"type":"strong","position":{"start":{"line":1931,"column":1},"end":{"line":1931,"column":1}},"children":[{"type":"text","value":"reverse","position":{"start":{"line":1931,"column":1},"end":{"line":1931,"column":1}},"key":"ER8gI83MOD"}],"key":"V9OVBR79PQ"},{"type":"text","value":" of the recombination we calculate","position":{"start":{"line":1931,"column":1},"end":{"line":1931,"column":1}},"key":"aQiC2JuSTW"}],"key":"xS77ZXUGBY"}],"key":"U55NYE0C3C"},{"type":"listItem","spread":true,"position":{"start":{"line":1932,"column":1},"end":{"line":1932,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Forward (C* + O* → CO*): barrier = reverse_barrier - |ΔE| ≈ 1.59 - 1.48 ≈ 0.11 eV (very fast)","position":{"start":{"line":1932,"column":1},"end":{"line":1932,"column":1}},"key":"wCOeM0q7ji"}],"key":"DUMbUmint0"}],"key":"qsQSbgJUIo"},{"type":"listItem","spread":true,"position":{"start":{"line":1933,"column":1},"end":{"line":1934,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Reverse (CO* → C* + O*): barrier = 1.59 eV (very slow, kinetic bottleneck)","position":{"start":{"line":1933,"column":1},"end":{"line":1933,"column":1}},"key":"D1cMerAfKc"}],"key":"Pxdtluz5WB"}],"key":"N14ZY7hXSg"}],"key":"uY1HJ4qH6g"},{"type":"paragraph","position":{"start":{"line":1935,"column":1},"end":{"line":1935,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1935,"column":1},"end":{"line":1935,"column":1}},"children":[{"type":"text","value":"What to Check:","position":{"start":{"line":1935,"column":1},"end":{"line":1935,"column":1}},"key":"a06eNAonVy"}],"key":"ElkhNaRm0X"}],"key":"KlDyOj8rH3"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":1936,"column":1},"end":{"line":1940,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":1936,"column":1},"end":{"line":1936,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Reaction energy (C*+O* → CO*) should be strongly exothermic (~-1.5 eV)","position":{"start":{"line":1936,"column":1},"end":{"line":1936,"column":1}},"key":"TrlkP5vlSk"}],"key":"HwV7HQc1JL"}],"key":"dhLZQqlEKk"},{"type":"listItem","spread":true,"position":{"start":{"line":1937,"column":1},"end":{"line":1937,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Reverse barrier (CO dissociation) should be substantial (~1.6 eV)","position":{"start":{"line":1937,"column":1},"end":{"line":1937,"column":1}},"key":"NAtdV7MBS5"}],"key":"GRc0wSMaFr"}],"key":"qV11syNQiG"},{"type":"listItem","spread":true,"position":{"start":{"line":1938,"column":1},"end":{"line":1938,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Forward barrier (recombination) should be very small (~0.1 eV)","position":{"start":{"line":1938,"column":1},"end":{"line":1938,"column":1}},"key":"hrsbZMZ5Lq"}],"key":"ePhVBPAT78"}],"key":"A5aeJ4DwL8"},{"type":"listItem","spread":true,"position":{"start":{"line":1939,"column":1},"end":{"line":1940,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"CO binds much more strongly than H (1.82 eV vs 0.60 eV)","position":{"start":{"line":1939,"column":1},"end":{"line":1939,"column":1}},"key":"L3bjSsLi9b"}],"key":"xdR3NYmonf"}],"key":"qMiBByvVfN"}],"key":"NenRRl4mqs"},{"type":"paragraph","position":{"start":{"line":1941,"column":1},"end":{"line":1941,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1941,"column":1},"end":{"line":1941,"column":1}},"children":[{"type":"text","value":"Typical Variations:","position":{"start":{"line":1941,"column":1},"end":{"line":1941,"column":1}},"key":"OayswQ8JoZ"}],"key":"cOCB8BVraI"}],"key":"zMbKGTlsNy"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":1942,"column":1},"end":{"line":1946,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":1942,"column":1},"end":{"line":1942,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Reaction energies typically accurate within 0.1-0.2 eV","position":{"start":{"line":1942,"column":1},"end":{"line":1942,"column":1}},"key":"D9hxnRvtd3"}],"key":"L7zjmbVBqz"}],"key":"WIWNEPv8Qd"},{"type":"listItem","spread":true,"position":{"start":{"line":1943,"column":1},"end":{"line":1943,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Barriers more sensitive: expect ±0.2-0.3 eV variation","position":{"start":{"line":1943,"column":1},"end":{"line":1943,"column":1}},"key":"t6c81o9uHg"}],"key":"N163jEIybB"}],"key":"DOTMz32SOp"},{"type":"listItem","spread":true,"position":{"start":{"line":1944,"column":1},"end":{"line":1944,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"ZPE corrections typically add 0.05-0.15 eV to reaction energies","position":{"start":{"line":1944,"column":1},"end":{"line":1944,"column":1}},"key":"Hbs04MV2j8"}],"key":"Tlb1j7E8nk"}],"key":"HVp4NcKFn1"},{"type":"listItem","spread":true,"position":{"start":{"line":1945,"column":1},"end":{"line":1946,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"NEB convergence affects barrier more than reaction energy","position":{"start":{"line":1945,"column":1},"end":{"line":1945,"column":1}},"key":"vlHBapApBS"}],"key":"RrXgA4eT21"}],"key":"nTi3WYbimX"}],"key":"KGRyr7T6hS"},{"type":"paragraph","position":{"start":{"line":1947,"column":1},"end":{"line":1947,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1947,"column":1},"end":{"line":1947,"column":1}},"children":[{"type":"text","value":"Physical Insight:","position":{"start":{"line":1947,"column":1},"end":{"line":1947,"column":1}},"key":"J32hUriSVW"}],"key":"qMYqA37ppP"}],"key":"E49N4bv5gl"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":1948,"column":1},"end":{"line":1951,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":1948,"column":1},"end":{"line":1948,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Large reverse barrier (1.59 eV) makes CO dissociation very slow at low T","position":{"start":{"line":1948,"column":1},"end":{"line":1948,"column":1}},"key":"K05IS9JeIT"}],"key":"rbxUhPCDao"}],"key":"Lo0BzdZQ9a"},{"type":"listItem","spread":true,"position":{"start":{"line":1949,"column":1},"end":{"line":1949,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Small forward barrier (0.11 eV) means C+O rapidly recombine to CO","position":{"start":{"line":1949,"column":1},"end":{"line":1949,"column":1}},"key":"FqO5N9O6u9"}],"key":"NprteQBkBl"}],"key":"Oq2DvwcmSz"},{"type":"listItem","spread":true,"position":{"start":{"line":1950,"column":1},"end":{"line":1950,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"This explains why Ni produces CO in Fischer-Tropsch rather than keeping C and O separate","position":{"start":{"line":1950,"column":1},"end":{"line":1950,"column":1}},"key":"TildgYuVuv"}],"key":"bEphufvDmL"}],"key":"pQMAqQbBIv"},{"type":"listItem","spread":true,"position":{"start":{"line":1951,"column":1},"end":{"line":1951,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"High temperatures needed to overcome the dissociation barrier for further C-C coupling","position":{"start":{"line":1951,"column":1},"end":{"line":1951,"column":1}},"key":"Ys5ukgagnO"}],"key":"zyDwq2dIbU"}],"key":"PgsXZplLw9"}],"key":"PSn3kiNkDa"}],"class":"note","key":"LahcLEZFx3"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"NEB Method Explained","position":{"start":{"line":1954,"column":1},"end":{"line":1954,"column":1}},"key":"MJZ31ojKBo"}],"key":"IRsHQ7KpuS"},{"type":"paragraph","position":{"start":{"line":1957,"column":1},"end":{"line":1957,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":1957,"column":1},"end":{"line":1957,"column":1}},"key":"qtEeNb6yEy"},{"type":"strong","position":{"start":{"line":1957,"column":1},"end":{"line":1957,"column":1}},"children":[{"type":"text","value":"Nudged Elastic Band (NEB)","position":{"start":{"line":1957,"column":1},"end":{"line":1957,"column":1}},"key":"YEr1tL2axy"}],"key":"u03hFulS26"},{"type":"text","value":" method finds the minimum energy path between reactants and products:","position":{"start":{"line":1957,"column":1},"end":{"line":1957,"column":1}},"key":"nMAjn4VYJC"}],"key":"powuCo7r8q"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":1959,"column":1},"end":{"line":1963,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":1959,"column":1},"end":{"line":1959,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":1959,"column":1},"end":{"line":1959,"column":1}},"children":[{"type":"text","value":"Interpolate","position":{"start":{"line":1959,"column":1},"end":{"line":1959,"column":1}},"key":"s2HA4OBOVu"}],"key":"TSSvTmgEm2"},{"type":"text","value":" between initial and final states (5-9 images typical)","position":{"start":{"line":1959,"column":1},"end":{"line":1959,"column":1}},"key":"O9gEzP8BXc"}],"key":"tsNyAPpKpL"}],"key":"gIfppOivsa"},{"type":"listItem","spread":true,"position":{"start":{"line":1960,"column":1},"end":{"line":1960,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":1960,"column":1},"end":{"line":1960,"column":1}},"children":[{"type":"text","value":"Add spring forces","position":{"start":{"line":1960,"column":1},"end":{"line":1960,"column":1}},"key":"dlGJDgl7Rn"}],"key":"I9GjDuTtAV"},{"type":"text","value":" along the chain to maintain spacing","position":{"start":{"line":1960,"column":1},"end":{"line":1960,"column":1}},"key":"j3SEscXgzv"}],"key":"JvzvApEjVU"}],"key":"sXliAl3aei"},{"type":"listItem","spread":true,"position":{"start":{"line":1961,"column":1},"end":{"line":1961,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":1961,"column":1},"end":{"line":1961,"column":1}},"children":[{"type":"text","value":"Project out","position":{"start":{"line":1961,"column":1},"end":{"line":1961,"column":1}},"key":"WK91oJlY1o"}],"key":"BBh7QOgxXU"},{"type":"text","value":" spring components perpendicular to the path","position":{"start":{"line":1961,"column":1},"end":{"line":1961,"column":1}},"key":"Gokl0sGE3w"}],"key":"LJEVDXY6lH"}],"key":"NX2qC5yaOm"},{"type":"listItem","spread":true,"position":{"start":{"line":1962,"column":1},"end":{"line":1963,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":1962,"column":1},"end":{"line":1962,"column":1}},"children":[{"type":"text","value":"Climbing image","position":{"start":{"line":1962,"column":1},"end":{"line":1962,"column":1}},"key":"FfccNPdqF7"}],"key":"ViTs9mGnsQ"},{"type":"text","value":" variant: highest energy image climbs to saddle point","position":{"start":{"line":1962,"column":1},"end":{"line":1962,"column":1}},"key":"N2mq6BjgQ4"}],"key":"R5UxLlDgIg"}],"key":"k6SMy9ECVn"}],"key":"Y4H3ap7FPq"},{"type":"paragraph","position":{"start":{"line":1964,"column":1},"end":{"line":1964,"column":1}},"children":[{"type":"text","value":"Advantages:","position":{"start":{"line":1964,"column":1},"end":{"line":1964,"column":1}},"key":"CF2CiY7t16"}],"key":"yJzt1Ni4yt"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":1965,"column":1},"end":{"line":1968,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":1965,"column":1},"end":{"line":1965,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"No prior knowledge of transition state needed","position":{"start":{"line":1965,"column":1},"end":{"line":1965,"column":1}},"key":"IpTNX9pK03"}],"key":"jZX40z5eCq"}],"key":"CVoVNnXUF7"},{"type":"listItem","spread":true,"position":{"start":{"line":1966,"column":1},"end":{"line":1966,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Finds entire reaction coordinate","position":{"start":{"line":1966,"column":1},"end":{"line":1966,"column":1}},"key":"zBu05mhuGq"}],"key":"USOXWaiUdh"}],"key":"N6Yy6blk85"},{"type":"listItem","spread":true,"position":{"start":{"line":1967,"column":1},"end":{"line":1968,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Robust for complex reactions","position":{"start":{"line":1967,"column":1},"end":{"line":1967,"column":1}},"key":"lSyX0t3KcV"}],"key":"JgFyz2La8Z"}],"key":"qD1HRTHThR"}],"key":"S5LzKPGE8Y"},{"type":"paragraph","position":{"start":{"line":1969,"column":1},"end":{"line":1969,"column":1}},"children":[{"type":"text","value":"Limitations:","position":{"start":{"line":1969,"column":1},"end":{"line":1969,"column":1}},"key":"ihZqlfEhPg"}],"key":"Af2aPG87p8"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":1970,"column":1},"end":{"line":1971,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":1970,"column":1},"end":{"line":1970,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Computationally expensive (optimize N images)","position":{"start":{"line":1970,"column":1},"end":{"line":1970,"column":1}},"key":"A9pLbjtjLv"}],"key":"wfVcVbdL9m"}],"key":"TssCs8wiSH"},{"type":"listItem","spread":true,"position":{"start":{"line":1971,"column":1},"end":{"line":1971,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"May find wrong path if initial interpolation is poor","position":{"start":{"line":1971,"column":1},"end":{"line":1971,"column":1}},"key":"eupT4Hobib"}],"key":"ipzqCe9fk5"}],"key":"FVOQfgCurm"}],"key":"QeypcxIAU3"}],"class":"note","key":"ARkfm2IvUU"},{"type":"heading","depth":3,"position":{"start":{"line":1974,"column":1},"end":{"line":1974,"column":1}},"children":[{"type":"text","value":"Explore on Your Own","position":{"start":{"line":1974,"column":1},"end":{"line":1974,"column":1}},"key":"o4FMP9SUaf"}],"identifier":"explore-on-your-own","label":"Explore on Your Own","html_id":"explore-on-your-own-4","implicit":true,"key":"YsLmGQROMp"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":1976,"column":1},"end":{"line":1981,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":1976,"column":1},"end":{"line":1976,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":1976,"column":1},"end":{"line":1976,"column":1}},"children":[{"type":"text","value":"Image convergence","position":{"start":{"line":1976,"column":1},"end":{"line":1976,"column":1}},"key":"HtYt7Vi376"}],"key":"stBpbEXRc1"},{"type":"text","value":": Run with 7 or 9 images. Does the barrier change?","position":{"start":{"line":1976,"column":1},"end":{"line":1976,"column":1}},"key":"xsNfsQXDB4"}],"key":"d0V6TXtaJu"}],"key":"tWo24qqYig"},{"type":"listItem","spread":true,"position":{"start":{"line":1977,"column":1},"end":{"line":1977,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":1977,"column":1},"end":{"line":1977,"column":1}},"children":[{"type":"text","value":"Spring constant","position":{"start":{"line":1977,"column":1},"end":{"line":1977,"column":1}},"key":"CoCne6J0CQ"}],"key":"m5WzfeTB21"},{"type":"text","value":": Modify the NEB spring constant. How does this affect convergence?","position":{"start":{"line":1977,"column":1},"end":{"line":1977,"column":1}},"key":"FUVaGxoZwh"}],"key":"r7Byp1VbCu"}],"key":"gQ6QHoMs9v"},{"type":"listItem","spread":true,"position":{"start":{"line":1978,"column":1},"end":{"line":1978,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":1978,"column":1},"end":{"line":1978,"column":1}},"children":[{"type":"text","value":"Alternative paths","position":{"start":{"line":1978,"column":1},"end":{"line":1978,"column":1}},"key":"nXfZOn9xqx"}],"key":"ZW76Cl4m2d"},{"type":"text","value":": Try different initial CO/final C+O configurations. Are there multiple pathways?","position":{"start":{"line":1978,"column":1},"end":{"line":1978,"column":1}},"key":"kLV74zCvel"}],"key":"PioXkdACxG"}],"key":"qpxMUIqZUM"},{"type":"listItem","spread":true,"position":{"start":{"line":1979,"column":1},"end":{"line":1979,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":1979,"column":1},"end":{"line":1979,"column":1}},"children":[{"type":"text","value":"Reverse barrier","position":{"start":{"line":1979,"column":1},"end":{"line":1979,"column":1}},"key":"VTtRUOKbXr"}],"key":"Hgy9aV6HYb"},{"type":"text","value":": Calculate E_a(reverse) = E_a(forward) - ΔE. Check Brønsted-Evans-Polanyi relationship.","position":{"start":{"line":1979,"column":1},"end":{"line":1979,"column":1}},"key":"PM8TZIyYcJ"}],"key":"t3FgsNJ559"}],"key":"icXBEypWG1"},{"type":"listItem","spread":true,"position":{"start":{"line":1980,"column":1},"end":{"line":1981,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":1980,"column":1},"end":{"line":1980,"column":1}},"children":[{"type":"text","value":"Diffusion barriers","position":{"start":{"line":1980,"column":1},"end":{"line":1980,"column":1}},"key":"yUsfgJov6i"}],"key":"we8fOTqYio"},{"type":"text","value":": Compute NEB for C or O diffusion on the surface. How do they compare?","position":{"start":{"line":1980,"column":1},"end":{"line":1980,"column":1}},"key":"bdTLduw6xI"}],"key":"os0ZlVvHlq"}],"key":"HJ2cXzdfC6"}],"key":"fPSSeoMSsX"},{"type":"thematicBreak","position":{"start":{"line":1982,"column":1},"end":{"line":1982,"column":1}},"key":"aKROgZ4myT"},{"type":"heading","depth":2,"position":{"start":{"line":1984,"column":1},"end":{"line":1984,"column":1}},"children":[{"type":"text","value":"Summary and Best Practices","position":{"start":{"line":1984,"column":1},"end":{"line":1984,"column":1}},"key":"P3ZpiGFTsA"}],"identifier":"summary-and-best-practices","label":"Summary and Best Practices","html_id":"summary-and-best-practices","implicit":true,"key":"xBMf2InrnN"},{"type":"heading","depth":3,"position":{"start":{"line":1986,"column":1},"end":{"line":1986,"column":1}},"children":[{"type":"text","value":"Key Takeaways","position":{"start":{"line":1986,"column":1},"end":{"line":1986,"column":1}},"key":"McB5ni28UY"}],"identifier":"key-takeaways","label":"Key Takeaways","html_id":"key-takeaways","implicit":true,"key":"iH50taANRD"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":1988,"column":1},"end":{"line":1994,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":1988,"column":1},"end":{"line":1988,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":1988,"column":1},"end":{"line":1988,"column":1}},"children":[{"type":"text","value":"ML Potentials","position":{"start":{"line":1988,"column":1},"end":{"line":1988,"column":1}},"key":"FB6c0F00mj"}],"key":"hofMa7k1a8"},{"type":"text","value":": UMa-S-1P1 provides ~1000× speedup over DFT with reasonable accuracy","position":{"start":{"line":1988,"column":1},"end":{"line":1988,"column":1}},"key":"bKX0KneYcD"}],"key":"gzZqnnqxON"}],"key":"tLGpUZurpJ"},{"type":"listItem","spread":true,"position":{"start":{"line":1989,"column":1},"end":{"line":1989,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":1989,"column":1},"end":{"line":1989,"column":1}},"children":[{"type":"text","value":"Bulk optimization","position":{"start":{"line":1989,"column":1},"end":{"line":1989,"column":1}},"key":"aspvJLKeYy"}],"key":"XrVRLOkvC7"},{"type":"text","value":": Always use the ML-optimized lattice constant for consistency","position":{"start":{"line":1989,"column":1},"end":{"line":1989,"column":1}},"key":"G70ypQgEf9"}],"key":"WbasiCSfYE"}],"key":"tIh15pBGSt"},{"type":"listItem","spread":true,"position":{"start":{"line":1990,"column":1},"end":{"line":1990,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":1990,"column":1},"end":{"line":1990,"column":1}},"children":[{"type":"text","value":"Surface energies","position":{"start":{"line":1990,"column":1},"end":{"line":1990,"column":1}},"key":"xVqEtwFdmt"}],"key":"VNR9lRIjHC"},{"type":"text","value":": Linear extrapolation eliminates finite-size effects","position":{"start":{"line":1990,"column":1},"end":{"line":1990,"column":1}},"key":"a4alziQaZ0"}],"key":"LU5YcMZ5dq"}],"key":"S06fvbnkYK"},{"type":"listItem","spread":true,"position":{"start":{"line":1991,"column":1},"end":{"line":1991,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":1991,"column":1},"end":{"line":1991,"column":1}},"children":[{"type":"text","value":"Adsorption","position":{"start":{"line":1991,"column":1},"end":{"line":1991,"column":1}},"key":"R1EJ8hWTDU"}],"key":"FIwYrU3MkH"},{"type":"text","value":": Test multiple sites; lowest energy may not be intuitive","position":{"start":{"line":1991,"column":1},"end":{"line":1991,"column":1}},"key":"G4cEpu0fRq"}],"key":"Zx0c3x1Nnd"}],"key":"n1bfVQHpRB"},{"type":"listItem","spread":true,"position":{"start":{"line":1992,"column":1},"end":{"line":1992,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":1992,"column":1},"end":{"line":1992,"column":1}},"children":[{"type":"text","value":"Coverage","position":{"start":{"line":1992,"column":1},"end":{"line":1992,"column":1}},"key":"gBIpj4xatQ"}],"key":"x4Q38ipwMU"},{"type":"text","value":": Lateral interactions become significant above ~0.3 ML","position":{"start":{"line":1992,"column":1},"end":{"line":1992,"column":1}},"key":"VYNloE3wjo"}],"key":"vMGltOiNnG"}],"key":"JhPcOW3zJs"},{"type":"listItem","spread":true,"position":{"start":{"line":1993,"column":1},"end":{"line":1994,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":1993,"column":1},"end":{"line":1993,"column":1}},"children":[{"type":"text","value":"Barriers","position":{"start":{"line":1993,"column":1},"end":{"line":1993,"column":1}},"key":"hbiDznMZFf"}],"key":"t37xKvUj5Q"},{"type":"text","value":": NEB requires careful setup but yields full reaction pathway","position":{"start":{"line":1993,"column":1},"end":{"line":1993,"column":1}},"key":"yxIpkzmsEC"}],"key":"RJmFRt0J8o"}],"key":"MmAvy6gQbg"}],"key":"WN2HXpfmK8"},{"type":"heading","depth":3,"position":{"start":{"line":1995,"column":1},"end":{"line":1995,"column":1}},"children":[{"type":"text","value":"Recommended Workflow for New Systems","position":{"start":{"line":1995,"column":1},"end":{"line":1995,"column":1}},"key":"xvKdclcpIu"}],"identifier":"recommended-workflow-for-new-systems","label":"Recommended Workflow for New Systems","html_id":"recommended-workflow-for-new-systems","implicit":true,"key":"wC6R5E15aH"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":1997,"column":1},"end":{"line":2004,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":1997,"column":1},"end":{"line":1997,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":1997,"column":1},"end":{"line":1997,"column":1}},"children":[{"type":"text","value":"Optimize Bulk","position":{"start":{"line":1997,"column":1},"end":{"line":1997,"column":1}},"key":"zl3V4PfpfY"}],"key":"Wp2079n1Vz"},{"type":"text","value":" - Determine equilibrium lattice constant","position":{"start":{"line":1997,"column":1},"end":{"line":1997,"column":1}},"key":"HYawfxAueo"}],"key":"zk7i9ZVJ7t"}],"key":"I6DGSGLhDk"},{"type":"listItem","spread":true,"position":{"start":{"line":1998,"column":1},"end":{"line":1998,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":1998,"column":1},"end":{"line":1998,"column":1}},"children":[{"type":"text","value":"Calculate Surface Energies","position":{"start":{"line":1998,"column":1},"end":{"line":1998,"column":1}},"key":"mJoZ5vUJji"}],"key":"wxXylq2XHx"},{"type":"text","value":" - Identify stable facets","position":{"start":{"line":1998,"column":1},"end":{"line":1998,"column":1}},"key":"R67CWzXv7r"}],"key":"X9T3amvVaR"}],"key":"LlfJ7J3ZPi"},{"type":"listItem","spread":true,"position":{"start":{"line":1999,"column":1},"end":{"line":1999,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":1999,"column":1},"end":{"line":1999,"column":1}},"children":[{"type":"text","value":"Wulff Construction","position":{"start":{"line":1999,"column":1},"end":{"line":1999,"column":1}},"key":"rL7YvuQPd0"}],"key":"ryLZCNZIgk"},{"type":"text","value":" - Predict nanoparticle morphology","position":{"start":{"line":1999,"column":1},"end":{"line":1999,"column":1}},"key":"quG5lAUHvv"}],"key":"e5DsR9giPC"}],"key":"sXrEL3eDJI"},{"type":"listItem","spread":true,"position":{"start":{"line":2000,"column":1},"end":{"line":2000,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":2000,"column":1},"end":{"line":2000,"column":1}},"children":[{"type":"text","value":"Low-Coverage Adsorption","position":{"start":{"line":2000,"column":1},"end":{"line":2000,"column":1}},"key":"Y4IKvRvOuY"}],"key":"nLwCu4Q8BN"},{"type":"text","value":" - Find binding sites and energies","position":{"start":{"line":2000,"column":1},"end":{"line":2000,"column":1}},"key":"nXPxPsq1tQ"}],"key":"CRIhiC1Bhs"}],"key":"Aop0i6hIzl"},{"type":"listItem","spread":true,"position":{"start":{"line":2001,"column":1},"end":{"line":2001,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":2001,"column":1},"end":{"line":2001,"column":1}},"children":[{"type":"text","value":"Coverage Study","position":{"start":{"line":2001,"column":1},"end":{"line":2001,"column":1}},"key":"IUpYBDdEhy"}],"key":"QEnwPtYRjW"},{"type":"text","value":" (if coverage-dependent effects are important) - Determine lateral interactions","position":{"start":{"line":2001,"column":1},"end":{"line":2001,"column":1}},"key":"C7fqk9ZF9J"}],"key":"r6xKNQHoYr"}],"key":"CYaGTUj4A4"},{"type":"listItem","spread":true,"position":{"start":{"line":2002,"column":1},"end":{"line":2002,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":2002,"column":1},"end":{"line":2002,"column":1}},"children":[{"type":"text","value":"Reaction Barriers","position":{"start":{"line":2002,"column":1},"end":{"line":2002,"column":1}},"key":"I0MmA8pCWB"}],"key":"jGfOQ7jdt0"},{"type":"text","value":" - Calculate activation energies using NEB","position":{"start":{"line":2002,"column":1},"end":{"line":2002,"column":1}},"key":"xbNJF0mSvz"}],"key":"R7WBe7Cqht"}],"key":"J3DtbITyNt"},{"type":"listItem","spread":true,"position":{"start":{"line":2003,"column":1},"end":{"line":2004,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":2003,"column":1},"end":{"line":2003,"column":1}},"children":[{"type":"text","value":"Microkinetic Modeling","position":{"start":{"line":2003,"column":1},"end":{"line":2003,"column":1}},"key":"p9zftBAoqG"}],"key":"WLjk0JkDhn"},{"type":"text","value":" - Predict overall catalytic performance","position":{"start":{"line":2003,"column":1},"end":{"line":2003,"column":1}},"key":"RZwKomlG9f"}],"key":"EqVUnhnzdv"}],"key":"UjXGmqqVJC"}],"key":"mVcibhFGcQ"},{"type":"heading","depth":3,"position":{"start":{"line":2005,"column":1},"end":{"line":2005,"column":1}},"children":[{"type":"text","value":"Accuracy Considerations","position":{"start":{"line":2005,"column":1},"end":{"line":2005,"column":1}},"key":"WhY3JlCu8i"}],"identifier":"accuracy-considerations","label":"Accuracy Considerations","html_id":"accuracy-considerations","implicit":true,"key":"UgYwatiseP"},{"type":"table","position":{"start":{"line":2007,"column":1},"end":{"line":2012,"column":1}},"children":[{"type":"tableRow","position":{"start":{"line":2007,"column":1},"end":{"line":2007,"column":1}},"children":[{"type":"tableCell","header":true,"position":{"start":{"line":2007,"column":1},"end":{"line":2007,"column":1}},"children":[{"type":"text","value":"Property","position":{"start":{"line":2007,"column":1},"end":{"line":2007,"column":1}},"key":"o1YHirBMVZ"}],"key":"geN6hEqJmC"},{"type":"tableCell","header":true,"position":{"start":{"line":2007,"column":1},"end":{"line":2007,"column":1}},"children":[{"type":"text","value":"Typical Error","position":{"start":{"line":2007,"column":1},"end":{"line":2007,"column":1}},"key":"H3UN3gzM2a"}],"key":"Xaw66adQih"},{"type":"tableCell","header":true,"position":{"start":{"line":2007,"column":1},"end":{"line":2007,"column":1}},"children":[{"type":"text","value":"When Critical","position":{"start":{"line":2007,"column":1},"end":{"line":2007,"column":1}},"key":"eAIBQqC6aP"}],"key":"BFs2A7Gsh1"}],"key":"lepk3fldty"},{"type":"tableRow","position":{"start":{"line":2009,"column":1},"end":{"line":2009,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":2009,"column":1},"end":{"line":2009,"column":1}},"children":[{"type":"text","value":"Lattice constants","position":{"start":{"line":2009,"column":1},"end":{"line":2009,"column":1}},"key":"nhUHc7Grbl"}],"key":"XLlFxLXm9H"},{"type":"tableCell","position":{"start":{"line":2009,"column":1},"end":{"line":2009,"column":1}},"children":[{"type":"text","value":"1-2%","position":{"start":{"line":2009,"column":1},"end":{"line":2009,"column":1}},"key":"B8jTOTth8L"}],"key":"daVQc5r7Wd"},{"type":"tableCell","position":{"start":{"line":2009,"column":1},"end":{"line":2009,"column":1}},"children":[{"type":"text","value":"Strain effects, alloys","position":{"start":{"line":2009,"column":1},"end":{"line":2009,"column":1}},"key":"g0niFEByUQ"}],"key":"ZvsKP4Icni"}],"key":"rQsC4hFk0K"},{"type":"tableRow","position":{"start":{"line":2010,"column":1},"end":{"line":2010,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":2010,"column":1},"end":{"line":2010,"column":1}},"children":[{"type":"text","value":"Surface energies","position":{"start":{"line":2010,"column":1},"end":{"line":2010,"column":1}},"key":"H3JPsTTN1F"}],"key":"zBdydAxm3l"},{"type":"tableCell","position":{"start":{"line":2010,"column":1},"end":{"line":2010,"column":1}},"children":[{"type":"text","value":"10-20%","position":{"start":{"line":2010,"column":1},"end":{"line":2010,"column":1}},"key":"hNTgnW295k"}],"key":"Dhy9fpXIKx"},{"type":"tableCell","position":{"start":{"line":2010,"column":1},"end":{"line":2010,"column":1}},"children":[{"type":"text","value":"Nanoparticle shapes","position":{"start":{"line":2010,"column":1},"end":{"line":2010,"column":1}},"key":"LI8Lyywac6"}],"key":"jEUfAQBvuk"}],"key":"h6IRLnupFy"},{"type":"tableRow","position":{"start":{"line":2011,"column":1},"end":{"line":2011,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":2011,"column":1},"end":{"line":2011,"column":1}},"children":[{"type":"text","value":"Adsorption energies","position":{"start":{"line":2011,"column":1},"end":{"line":2011,"column":1}},"key":"dj6rZLaFr6"}],"key":"cNVqNscYqS"},{"type":"tableCell","position":{"start":{"line":2011,"column":1},"end":{"line":2011,"column":1}},"children":[{"type":"text","value":"0.1-0.3 eV","position":{"start":{"line":2011,"column":1},"end":{"line":2011,"column":1}},"key":"CuJB2Ptxpn"}],"key":"hE5ixL8Cxz"},{"type":"tableCell","position":{"start":{"line":2011,"column":1},"end":{"line":2011,"column":1}},"children":[{"type":"text","value":"Thermochemistry","position":{"start":{"line":2011,"column":1},"end":{"line":2011,"column":1}},"key":"R2rNo8bCmB"}],"key":"GJB0heSQZG"}],"key":"FXawwbeuzM"},{"type":"tableRow","position":{"start":{"line":2012,"column":1},"end":{"line":2012,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":2012,"column":1},"end":{"line":2012,"column":1}},"children":[{"type":"text","value":"Barriers","position":{"start":{"line":2012,"column":1},"end":{"line":2012,"column":1}},"key":"kI7PKXiPJE"}],"key":"q0SvoIpGVX"},{"type":"tableCell","position":{"start":{"line":2012,"column":1},"end":{"line":2012,"column":1}},"children":[{"type":"text","value":"0.2-0.5 eV","position":{"start":{"line":2012,"column":1},"end":{"line":2012,"column":1}},"key":"qkeiEeLmEe"}],"key":"UQhsNnr3C3"},{"type":"tableCell","position":{"start":{"line":2012,"column":1},"end":{"line":2012,"column":1}},"children":[{"type":"text","value":"Kinetics, selectivity","position":{"start":{"line":2012,"column":1},"end":{"line":2012,"column":1}},"key":"VxlK4cmxn3"}],"key":"LCbbgcjrrc"}],"key":"yg5IqxMl85"}],"key":"ux0pi7zQoq"},{"type":"paragraph","position":{"start":{"line":2014,"column":1},"end":{"line":2014,"column":1}},"children":[{"type":"strong","position":{"start":{"line":2014,"column":1},"end":{"line":2014,"column":1}},"children":[{"type":"text","value":"Rule of thumb","position":{"start":{"line":2014,"column":1},"end":{"line":2014,"column":1}},"key":"mIQoWeDbVt"}],"key":"yVuoTz5KKA"},{"type":"text","value":": Use ML for screening → DFT for validation → Experiment for verification","position":{"start":{"line":2014,"column":1},"end":{"line":2014,"column":1}},"key":"lEPKNv5BH3"}],"key":"DbVu6baQD3"},{"type":"heading","depth":3,"position":{"start":{"line":2016,"column":1},"end":{"line":2016,"column":1}},"children":[{"type":"text","value":"Further Reading","position":{"start":{"line":2016,"column":1},"end":{"line":2016,"column":1}},"key":"OJqS5IZzpn"}],"identifier":"further-reading","label":"Further Reading","html_id":"further-reading","implicit":true,"key":"Ma8eSBY59S"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2018,"column":1},"end":{"line":2021,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2018,"column":1},"end":{"line":2018,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":2018,"column":1},"end":{"line":2018,"column":1}},"children":[{"type":"text","value":"UMA Paper","position":{"start":{"line":2018,"column":1},"end":{"line":2018,"column":1}},"key":"GWqvuf4qOI"}],"key":"ZfHW7Et9xr"},{"type":"text","value":": ","position":{"start":{"line":2018,"column":1},"end":{"line":2018,"column":1}},"key":"Dgdd0jxftt"},{"type":"link","url":"https://arxiv.org/abs/2506.23971","position":{"start":{"line":2018,"column":1},"end":{"line":2018,"column":1}},"children":[{"type":"text","value":"Wood et al. 2025","position":{"start":{"line":2018,"column":1},"end":{"line":2018,"column":1}},"key":"imJ3fafGpk"}],"urlSource":"https://arxiv.org/abs/2506.23971","key":"PyLstOua00"}],"key":"yS1gXOWNeI"}],"key":"ZVUKd3qLOw"},{"type":"listItem","spread":true,"position":{"start":{"line":2019,"column":1},"end":{"line":2019,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":2019,"column":1},"end":{"line":2019,"column":1}},"children":[{"type":"text","value":"OMat24 Paper","position":{"start":{"line":2019,"column":1},"end":{"line":2019,"column":1}},"key":"ALPJPJglh4"}],"key":"qcStVlaPr6"},{"type":"text","value":": ","position":{"start":{"line":2019,"column":1},"end":{"line":2019,"column":1}},"key":"odB5PS0h99"},{"type":"link","url":"https://arxiv.org/abs/2410.12771","position":{"start":{"line":2019,"column":1},"end":{"line":2019,"column":1}},"children":[{"type":"text","value":"Barroso-Luque et al., 2024","position":{"start":{"line":2019,"column":1},"end":{"line":2019,"column":1}},"key":"wVrT4HaD54"}],"urlSource":"https://arxiv.org/abs/2410.12771","key":"pU9GS0lFkF"}],"key":"G6VmwhqPdM"}],"key":"YTCWg6ibgz"},{"type":"listItem","spread":true,"position":{"start":{"line":2020,"column":1},"end":{"line":2020,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":2020,"column":1},"end":{"line":2020,"column":1}},"children":[{"type":"text","value":"OC20 Dataset","position":{"start":{"line":2020,"column":1},"end":{"line":2020,"column":1}},"key":"rjjKHcLduF"}],"key":"DcLDBZ175T"},{"type":"text","value":": ","position":{"start":{"line":2020,"column":1},"end":{"line":2020,"column":1}},"key":"GQ0BfVmiiF"},{"type":"cite","url":"https://pubs.acs.org/doi/full/10.1021/acscatal.0c04525","position":{"start":{"line":2020,"column":1},"end":{"line":2020,"column":1}},"children":[{"type":"text","value":"Chanussot et al., ACS Catalysis, 2021","position":{"start":{"line":2020,"column":1},"end":{"line":2020,"column":1}},"key":"M4wS3Ofjdz"}],"kind":"narrative","label":"chanussot-2021-open-catal","identifier":"https://pubs.acs.org/doi/full/10.1021/acscatal.0c04525","enumerator":"2","key":"YI9SgK0enM"}],"key":"jo5ET35SiB"}],"key":"V88lojZH1o"},{"type":"listItem","spread":true,"position":{"start":{"line":2021,"column":1},"end":{"line":2021,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":2021,"column":1},"end":{"line":2021,"column":1}},"children":[{"type":"text","value":"ASE Tutorial","position":{"start":{"line":2021,"column":1},"end":{"line":2021,"column":1}},"key":"frOjDS6tV4"}],"key":"c74q5JPkbu"},{"type":"text","value":": ","position":{"start":{"line":2021,"column":1},"end":{"line":2021,"column":1}},"key":"ZkpF0qJVYO"},{"type":"link","url":"https://wiki.fysik.dtu.dk/ase/","position":{"start":{"line":2021,"column":1},"end":{"line":2021,"column":1}},"children":[{"type":"text","value":"https://​wiki​.fysik​.dtu​.dk​/ase/","position":{"start":{"line":2021,"column":1},"end":{"line":2021,"column":1}},"key":"kxjlqLLgHf"}],"urlSource":"https://wiki.fysik.dtu.dk/ase/","key":"c0uGsKxQP5"}],"key":"cASkUSmFJ1"}],"key":"eNoTkjTqbt"}],"key":"srGHVxj0V7"},{"type":"thematicBreak","position":{"start":{"line":2022,"column":1},"end":{"line":2022,"column":1}},"key":"Q3P00RbYim"},{"type":"heading","depth":2,"position":{"start":{"line":2024,"column":1},"end":{"line":2024,"column":1}},"children":[{"type":"text","value":"Appendix: Troubleshooting","position":{"start":{"line":2024,"column":1},"end":{"line":2024,"column":1}},"key":"Bof5f4mxiO"}],"identifier":"appendix-troubleshooting","label":"Appendix: Troubleshooting","html_id":"appendix-troubleshooting","implicit":true,"key":"MVl68phLvA"},{"type":"heading","depth":3,"position":{"start":{"line":2026,"column":1},"end":{"line":2026,"column":1}},"children":[{"type":"text","value":"Common Issues","position":{"start":{"line":2026,"column":1},"end":{"line":2026,"column":1}},"key":"jP1A3GlJ77"}],"identifier":"common-issues","label":"Common Issues","html_id":"common-issues","implicit":true,"key":"zoIYKU5j8f"},{"type":"paragraph","position":{"start":{"line":2028,"column":1},"end":{"line":2028,"column":1}},"children":[{"type":"strong","position":{"start":{"line":2028,"column":1},"end":{"line":2028,"column":1}},"children":[{"type":"text","value":"Problem","position":{"start":{"line":2028,"column":1},"end":{"line":2028,"column":1}},"key":"N9IXWgaNUj"}],"key":"eP3YQhQwox"},{"type":"text","value":": Convergence failures","position":{"start":{"line":2028,"column":1},"end":{"line":2028,"column":1}},"key":"LWKlbpYm5k"}],"key":"pkVe7vnuRu"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2029,"column":1},"end":{"line":2031,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2029,"column":1},"end":{"line":2029,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":2029,"column":1},"end":{"line":2029,"column":1}},"children":[{"type":"text","value":"Solution","position":{"start":{"line":2029,"column":1},"end":{"line":2029,"column":1}},"key":"TgoiQLPp2t"}],"key":"HmOAfreZqM"},{"type":"text","value":": Reduce ","position":{"start":{"line":2029,"column":1},"end":{"line":2029,"column":1}},"key":"OI5FVFIImG"},{"type":"inlineCode","value":"fmax","position":{"start":{"line":2029,"column":1},"end":{"line":2029,"column":1}},"key":"dfHcEpnqK0"},{"type":"text","value":" to 0.1 initially, tighten later","position":{"start":{"line":2029,"column":1},"end":{"line":2029,"column":1}},"key":"ZXsPhGKwg2"}],"key":"Yo06dZ3n5m"}],"key":"R5ICgbxfQw"},{"type":"listItem","spread":true,"position":{"start":{"line":2030,"column":1},"end":{"line":2031,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Check if system is metastable (try different starting geometry)","position":{"start":{"line":2030,"column":1},"end":{"line":2030,"column":1}},"key":"vqbKEim6QJ"}],"key":"g0VoGWfPVn"}],"key":"xNvFPLiAo0"}],"key":"xmxQiILbn9"},{"type":"paragraph","position":{"start":{"line":2032,"column":1},"end":{"line":2032,"column":1}},"children":[{"type":"strong","position":{"start":{"line":2032,"column":1},"end":{"line":2032,"column":1}},"children":[{"type":"text","value":"Problem","position":{"start":{"line":2032,"column":1},"end":{"line":2032,"column":1}},"key":"HbrDZVkf3e"}],"key":"zLe8g7KK7w"},{"type":"text","value":": NEB fails to find transition state","position":{"start":{"line":2032,"column":1},"end":{"line":2032,"column":1}},"key":"QtyJSotasY"}],"key":"wsHsMsbGXm"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2033,"column":1},"end":{"line":2035,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2033,"column":1},"end":{"line":2033,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":2033,"column":1},"end":{"line":2033,"column":1}},"children":[{"type":"text","value":"Solution","position":{"start":{"line":2033,"column":1},"end":{"line":2033,"column":1}},"key":"YWZe878cLd"}],"key":"c6slBKDPBT"},{"type":"text","value":": Use more images (9-11) or better initial guess","position":{"start":{"line":2033,"column":1},"end":{"line":2033,"column":1}},"key":"SzlRxY3MBp"}],"key":"NfPbCe2vO9"}],"key":"MGhrW3FKz1"},{"type":"listItem","spread":true,"position":{"start":{"line":2034,"column":1},"end":{"line":2035,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Try fixed-end NEB first, then climbing image","position":{"start":{"line":2034,"column":1},"end":{"line":2034,"column":1}},"key":"Rmz910ZRjw"}],"key":"Vp9cWoIita"}],"key":"XRIK1MYTHg"}],"key":"EsaOIaYfGo"},{"type":"paragraph","position":{"start":{"line":2036,"column":1},"end":{"line":2036,"column":1}},"children":[{"type":"strong","position":{"start":{"line":2036,"column":1},"end":{"line":2036,"column":1}},"children":[{"type":"text","value":"Problem","position":{"start":{"line":2036,"column":1},"end":{"line":2036,"column":1}},"key":"WFNSglKEG7"}],"key":"P9SBGkUcKT"},{"type":"text","value":": Unexpected adsorption energies","position":{"start":{"line":2036,"column":1},"end":{"line":2036,"column":1}},"key":"jwaufJ1NPD"}],"key":"DFxXz3Sajn"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2037,"column":1},"end":{"line":2040,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2037,"column":1},"end":{"line":2037,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":2037,"column":1},"end":{"line":2037,"column":1}},"children":[{"type":"text","value":"Solution","position":{"start":{"line":2037,"column":1},"end":{"line":2037,"column":1}},"key":"yzAB6muXa6"}],"key":"n1Qm9IbR65"},{"type":"text","value":": Visualize structures - check for distortions","position":{"start":{"line":2037,"column":1},"end":{"line":2037,"column":1}},"key":"NHZiyxsM0j"}],"key":"L87DNpWZk5"}],"key":"he6MFYMIQk"},{"type":"listItem","spread":true,"position":{"start":{"line":2038,"column":1},"end":{"line":2038,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Compare with multiple sites","position":{"start":{"line":2038,"column":1},"end":{"line":2038,"column":1}},"key":"sluWuYDQep"}],"key":"NFK4k6u2V0"}],"key":"AhnZad3R5I"},{"type":"listItem","spread":true,"position":{"start":{"line":2039,"column":1},"end":{"line":2040,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Add D3 corrections","position":{"start":{"line":2039,"column":1},"end":{"line":2039,"column":1}},"key":"eaEuTjOY2k"}],"key":"O02BUUHnxu"}],"key":"HSpJkjaMg6"}],"key":"iDeNGmu7zw"},{"type":"paragraph","position":{"start":{"line":2041,"column":1},"end":{"line":2041,"column":1}},"children":[{"type":"strong","position":{"start":{"line":2041,"column":1},"end":{"line":2041,"column":1}},"children":[{"type":"text","value":"Problem","position":{"start":{"line":2041,"column":1},"end":{"line":2041,"column":1}},"key":"CBqSUe1phP"}],"key":"XgMK5oigFc"},{"type":"text","value":": Out of memory","position":{"start":{"line":2041,"column":1},"end":{"line":2041,"column":1}},"key":"n7dVmF1byf"}],"key":"YVBqlJ5j3g"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2042,"column":1},"end":{"line":2045,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2042,"column":1},"end":{"line":2042,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":2042,"column":1},"end":{"line":2042,"column":1}},"children":[{"type":"text","value":"Solution","position":{"start":{"line":2042,"column":1},"end":{"line":2042,"column":1}},"key":"snQJroYapV"}],"key":"IQ0fwS8UQA"},{"type":"text","value":": Reduce system size (smaller supercells)","position":{"start":{"line":2042,"column":1},"end":{"line":2042,"column":1}},"key":"sf7nrL5xSS"}],"key":"rVkVKDQDje"}],"key":"NZjq8Z0uRc"},{"type":"listItem","spread":true,"position":{"start":{"line":2043,"column":1},"end":{"line":2043,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Use fewer NEB images","position":{"start":{"line":2043,"column":1},"end":{"line":2043,"column":1}},"key":"hv3G9V2dHD"}],"key":"SIyNYn7JA4"}],"key":"VqPyznIilI"},{"type":"listItem","spread":true,"position":{"start":{"line":2044,"column":1},"end":{"line":2045,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Run on HPC with more RAM","position":{"start":{"line":2044,"column":1},"end":{"line":2044,"column":1}},"key":"f4aldgUIOF"}],"key":"XaNPahxkut"}],"key":"TFx5L9XYBo"}],"key":"pDROVCS37A"},{"type":"heading","depth":3,"position":{"start":{"line":2046,"column":1},"end":{"line":2046,"column":1}},"children":[{"type":"text","value":"Performance Tips","position":{"start":{"line":2046,"column":1},"end":{"line":2046,"column":1}},"key":"BYqZ0DaheR"}],"identifier":"performance-tips","label":"Performance Tips","html_id":"performance-tips","implicit":true,"key":"G7JZ17vrPI"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":2048,"column":1},"end":{"line":2052,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2048,"column":1},"end":{"line":2048,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":2048,"column":1},"end":{"line":2048,"column":1}},"children":[{"type":"text","value":"Use batching","position":{"start":{"line":2048,"column":1},"end":{"line":2048,"column":1}},"key":"i3e1V88CFI"}],"key":"rTmStrKqOq"},{"type":"text","value":": Relax multiple configurations in parallel","position":{"start":{"line":2048,"column":1},"end":{"line":2048,"column":1}},"key":"o4LNzyuoiS"}],"key":"ZRXCSqe7fM"}],"key":"JTTVle00BW"},{"type":"listItem","spread":true,"position":{"start":{"line":2049,"column":1},"end":{"line":2049,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":2049,"column":1},"end":{"line":2049,"column":1}},"children":[{"type":"text","value":"Start with DEBUG_MAX_STEPS=50","position":{"start":{"line":2049,"column":1},"end":{"line":2049,"column":1}},"key":"nfiAcQer4h"}],"key":"zWh08oX6T2"},{"type":"text","value":": Get quick results, refine later","position":{"start":{"line":2049,"column":1},"end":{"line":2049,"column":1}},"key":"x4rIcM1jnw"}],"key":"GAiMWkTdCf"}],"key":"YPIb1YOhpf"},{"type":"listItem","spread":true,"position":{"start":{"line":2050,"column":1},"end":{"line":2050,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":2050,"column":1},"end":{"line":2050,"column":1}},"children":[{"type":"text","value":"Cache bulk energies","position":{"start":{"line":2050,"column":1},"end":{"line":2050,"column":1}},"key":"LQIlGNHDFM"}],"key":"E287TjiKwM"},{"type":"text","value":": Don’t recalculate reference systems","position":{"start":{"line":2050,"column":1},"end":{"line":2050,"column":1}},"key":"fQraBNutCs"}],"key":"rTeZ2BkjjF"}],"key":"xwuOO1WQcR"},{"type":"listItem","spread":true,"position":{"start":{"line":2051,"column":1},"end":{"line":2052,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":2051,"column":1},"end":{"line":2051,"column":1}},"children":[{"type":"text","value":"Trajectory analysis","position":{"start":{"line":2051,"column":1},"end":{"line":2051,"column":1}},"key":"ZV203bqTWD"}],"key":"hOEmuY0BtK"},{"type":"text","value":": Monitor optimization progress with ASE GUI","position":{"start":{"line":2051,"column":1},"end":{"line":2051,"column":1}},"key":"Yqaz4vCff0"}],"key":"u3fgnVrIWl"}],"key":"KC5tbv8PMJ"}],"key":"WaZ5alKyHS"},{"type":"thematicBreak","position":{"start":{"line":2053,"column":1},"end":{"line":2053,"column":1}},"key":"NbPCaHeiik"},{"type":"heading","depth":2,"position":{"start":{"line":2055,"column":1},"end":{"line":2055,"column":1}},"children":[{"type":"text","value":"Caveats and Pitfalls","position":{"start":{"line":2055,"column":1},"end":{"line":2055,"column":1}},"key":"OG8R7H9Zk1"}],"identifier":"caveats-and-pitfalls","label":"Caveats and Pitfalls","html_id":"caveats-and-pitfalls","implicit":true,"key":"AcNRXAm3sy"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Important Considerations","position":{"start":{"line":2057,"column":1},"end":{"line":2057,"column":1}},"key":"y6zZXp7QcE"}],"key":"z8rgBMsu9O"},{"type":"paragraph","position":{"start":{"line":2060,"column":1},"end":{"line":2060,"column":1}},"children":[{"type":"text","value":"When using ML potentials for surface catalysis, be aware of these critical issues!","position":{"start":{"line":2060,"column":1},"end":{"line":2060,"column":1}},"key":"c1DVMTyD8n"}],"key":"owiIEXqvrF"}],"class":"warning","key":"Q9OmZYKp7H"},{"type":"heading","depth":3,"position":{"start":{"line":2063,"column":1},"end":{"line":2063,"column":1}},"children":[{"type":"text","value":"1. Task Selection: OMAT vs OC20","position":{"start":{"line":2063,"column":1},"end":{"line":2063,"column":1}},"key":"vVFOK4ilC8"}],"identifier":"id-1-task-selection-omat-vs-oc20","label":"1. Task Selection: OMAT vs OC20","html_id":"id-1-task-selection-omat-vs-oc20","implicit":true,"key":"M2aHLMhcGF"},{"type":"paragraph","position":{"start":{"line":2065,"column":1},"end":{"line":2065,"column":1}},"children":[{"type":"strong","position":{"start":{"line":2065,"column":1},"end":{"line":2065,"column":1}},"children":[{"type":"text","value":"Critical choice","position":{"start":{"line":2065,"column":1},"end":{"line":2065,"column":1}},"key":"cYSCPolAkP"}],"key":"hDUakpwUYz"},{"type":"text","value":": Which task_name to use?","position":{"start":{"line":2065,"column":1},"end":{"line":2065,"column":1}},"key":"wBx3o2eW8q"}],"key":"y4iHKD7Vj8"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2066,"column":1},"end":{"line":2072,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2066,"column":1},"end":{"line":2068,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":2066,"column":1},"end":{"line":2066,"column":1}},"children":[{"type":"inlineCode","value":"task_name=\"omat\"","position":{"start":{"line":2066,"column":1},"end":{"line":2066,"column":1}},"key":"lYnUufyqdj"}],"key":"xzxVQX16FW"},{"type":"text","value":": Optimized for bulk and clean surface calculations","position":{"start":{"line":2066,"column":1},"end":{"line":2066,"column":1}},"key":"yZnt5S85Da"}],"key":"YNz52JTxz5"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2067,"column":1},"end":{"line":2068,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2067,"column":1},"end":{"line":2067,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Use for: Part 1 (bulk), Part 2 (surface energies), Part 3 (Wulff)","position":{"start":{"line":2067,"column":1},"end":{"line":2067,"column":1}},"key":"eoC9CvZG3a"}],"key":"OyM8kXQmuC"}],"key":"cf5rReIxsS"},{"type":"listItem","spread":true,"position":{"start":{"line":2068,"column":1},"end":{"line":2068,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Better for structural relaxations without adsorbates","position":{"start":{"line":2068,"column":1},"end":{"line":2068,"column":1}},"key":"x3nVojeTf1"}],"key":"HVjvNFRZqO"}],"key":"AXbdW0Vdsk"}],"key":"GRsf11paW2"}],"key":"a9w5pPoPsk"},{"type":"listItem","spread":true,"position":{"start":{"line":2069,"column":1},"end":{"line":2072,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":2069,"column":1},"end":{"line":2069,"column":1}},"children":[{"type":"inlineCode","value":"task_name=\"oc20\"","position":{"start":{"line":2069,"column":1},"end":{"line":2069,"column":1}},"key":"vojlLu8EDS"}],"key":"OX4I14jEgc"},{"type":"text","value":": Optimized for surface chemistry with adsorbates","position":{"start":{"line":2069,"column":1},"end":{"line":2069,"column":1}},"key":"UwceQgqtHq"}],"key":"ohQ8G2ONzz"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2070,"column":1},"end":{"line":2072,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2070,"column":1},"end":{"line":2070,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Use for: Part 4-6 (all adsorbate calculations)","position":{"start":{"line":2070,"column":1},"end":{"line":2070,"column":1}},"key":"DIhDKyr54M"}],"key":"HHCfZpa6Yt"}],"key":"rDtVLn8ZFM"},{"type":"listItem","spread":true,"position":{"start":{"line":2071,"column":1},"end":{"line":2072,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Trained on Open Catalyst data with adsorbate-surface interactions","position":{"start":{"line":2071,"column":1},"end":{"line":2071,"column":1}},"key":"NnVO1jSnMN"}],"key":"XtEUOrsf5X"}],"key":"iuAWfYdPpY"}],"key":"zr61NJXc1X"}],"key":"VoVkH59LSx"}],"key":"d3SFemzNbb"},{"type":"paragraph","position":{"start":{"line":2073,"column":1},"end":{"line":2073,"column":1}},"children":[{"type":"strong","position":{"start":{"line":2073,"column":1},"end":{"line":2073,"column":1}},"children":[{"type":"text","value":"Impact","position":{"start":{"line":2073,"column":1},"end":{"line":2073,"column":1}},"key":"yAgjqMoQrA"}],"key":"U71e1ve8RE"},{"type":"text","value":": Using wrong task can lead to 0.1-0.3 eV errors in adsorption energies!","position":{"start":{"line":2073,"column":1},"end":{"line":2073,"column":1}},"key":"EKY0cjMPlt"}],"key":"t25rioXkqA"},{"type":"heading","depth":3,"position":{"start":{"line":2075,"column":1},"end":{"line":2075,"column":1}},"children":[{"type":"text","value":"2. D3 Dispersion Corrections","position":{"start":{"line":2075,"column":1},"end":{"line":2075,"column":1}},"key":"xFleDlwHwG"}],"identifier":"id-2-d3-dispersion-corrections","label":"2. D3 Dispersion Corrections","html_id":"id-2-d3-dispersion-corrections","implicit":true,"key":"EbThBnS654"},{"type":"paragraph","position":{"start":{"line":2077,"column":1},"end":{"line":2077,"column":1}},"children":[{"type":"strong","position":{"start":{"line":2077,"column":1},"end":{"line":2077,"column":1}},"children":[{"type":"text","value":"Multiple decisions required","position":{"start":{"line":2077,"column":1},"end":{"line":2077,"column":1}},"key":"hyxqLj6vNR"}],"key":"eKfy9zGLAW"},{"type":"text","value":":","position":{"start":{"line":2077,"column":1},"end":{"line":2077,"column":1}},"key":"bMzlEzTEum"}],"key":"sJOf9Cjye4"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":2079,"column":1},"end":{"line":2093,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2079,"column":1},"end":{"line":2084,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":2079,"column":1},"end":{"line":2079,"column":1}},"children":[{"type":"strong","position":{"start":{"line":2079,"column":1},"end":{"line":2079,"column":1}},"children":[{"type":"text","value":"Whether to use D3 at all?","position":{"start":{"line":2079,"column":1},"end":{"line":2079,"column":1}},"key":"UapkrV78Td"}],"key":"zFJ93Mb4s7"}],"key":"cd69wUP12r"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2080,"column":1},"end":{"line":2084,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2080,"column":1},"end":{"line":2080,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Small adsorbates (H, O, N): D3 effect ~0.01-0.05 eV (often negligible)","position":{"start":{"line":2080,"column":1},"end":{"line":2080,"column":1}},"key":"nsLbFcv0v3"}],"key":"wPvZ5indtW"}],"key":"SyGYGdwisV"},{"type":"listItem","spread":true,"position":{"start":{"line":2081,"column":1},"end":{"line":2081,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Large molecules (CO, CO₂, aromatics): D3 effect ~0.1-0.3 eV (important!)","position":{"start":{"line":2081,"column":1},"end":{"line":2081,"column":1}},"key":"AAlgznMSpA"}],"key":"LySXcgwNa0"}],"key":"NZrUB4ItsD"},{"type":"listItem","spread":true,"position":{"start":{"line":2082,"column":1},"end":{"line":2082,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Physisorption: D3 critical (can change binding from repulsive to attractive)","position":{"start":{"line":2082,"column":1},"end":{"line":2082,"column":1}},"key":"V8k0EaGgaT"}],"key":"eCtG0RYMTt"}],"key":"l1kqjBlDE6"},{"type":"listItem","spread":true,"position":{"start":{"line":2083,"column":1},"end":{"line":2084,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"RPBE was originally fit for chemisorption energies without D3 corrections, so adding D3 corrections may actually cause small adsorbates to overbind. However, it probably would be important for larger molecules. It’s relatively uncommon to see RPBE+D3 as a choice in the catalysis literature (compared to PBE+D3, or RPBE, or BEEF-vdW).","position":{"start":{"line":2083,"column":1},"end":{"line":2083,"column":1}},"key":"VNpLAbCeNm"}],"key":"vk7lKuowP1"}],"key":"SCqAjq8XWi"}],"key":"TwxZ2pJ7Xk"}],"key":"JxdasD5lKh"},{"type":"listItem","spread":true,"position":{"start":{"line":2085,"column":1},"end":{"line":2088,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":2085,"column":1},"end":{"line":2085,"column":1}},"children":[{"type":"strong","position":{"start":{"line":2085,"column":1},"end":{"line":2085,"column":1}},"children":[{"type":"text","value":"Which DFT functional for D3?","position":{"start":{"line":2085,"column":1},"end":{"line":2085,"column":1}},"key":"zK1PmQntmt"}],"key":"ig8cunesqc"}],"key":"CB43Np2yN7"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2086,"column":1},"end":{"line":2088,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2086,"column":1},"end":{"line":2086,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"This tutorial uses ","position":{"start":{"line":2086,"column":1},"end":{"line":2086,"column":1}},"key":"U55ZUrHubv"},{"type":"inlineCode","value":"method=\"PBE\"","position":{"start":{"line":2086,"column":1},"end":{"line":2086,"column":1}},"key":"vJry2ml58K"},{"type":"text","value":" consistently for the D3 correction. This is often implied when papers say they use a D3 correction, but the results can be different if use the RPBE parameterizations.","position":{"start":{"line":2086,"column":1},"end":{"line":2086,"column":1}},"key":"j5pVxAHn2A"}],"key":"iXkIkeijUp"}],"key":"V8FCIkqBAG"},{"type":"listItem","spread":true,"position":{"start":{"line":2087,"column":1},"end":{"line":2088,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Original paper used PBE for bulk/surfaces, RPBE for adsorption. It’s not specified what D3 parameterization they used, but it’s likely PBE.","position":{"start":{"line":2087,"column":1},"end":{"line":2087,"column":1}},"key":"CufwAa8aw2"}],"key":"MQIWZrj5N7"}],"key":"HcIHSmK4SM"}],"key":"pLsGgKFHsS"}],"key":"fW65aNrEFk"},{"type":"listItem","spread":true,"position":{"start":{"line":2089,"column":1},"end":{"line":2093,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":2089,"column":1},"end":{"line":2089,"column":1}},"children":[{"type":"strong","position":{"start":{"line":2089,"column":1},"end":{"line":2089,"column":1}},"children":[{"type":"text","value":"When to apply D3?","position":{"start":{"line":2089,"column":1},"end":{"line":2089,"column":1}},"key":"T6kUkssQaj"}],"key":"aEauzPAefw"}],"key":"qnOO7djrD9"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2090,"column":1},"end":{"line":2093,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2090,"column":1},"end":{"line":2090,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":2090,"column":1},"end":{"line":2090,"column":1}},"children":[{"type":"text","value":"End-point correction","position":{"start":{"line":2090,"column":1},"end":{"line":2090,"column":1}},"key":"PSD3WAnBkQ"}],"key":"wiWf7twJPV"},{"type":"text","value":" (used here): Fast, run ML optimization then add D3 energy","position":{"start":{"line":2090,"column":1},"end":{"line":2090,"column":1}},"key":"UkNgp0RDBH"}],"key":"h6SvfnGsTW"}],"key":"acL97rWF0t"},{"type":"listItem","spread":true,"position":{"start":{"line":2091,"column":1},"end":{"line":2091,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":2091,"column":1},"end":{"line":2091,"column":1}},"children":[{"type":"text","value":"During optimization","position":{"start":{"line":2091,"column":1},"end":{"line":2091,"column":1}},"key":"jOKCzQr5ZZ"}],"key":"ZXkj9lRIsG"},{"type":"text","value":": Slower but more accurate geometries","position":{"start":{"line":2091,"column":1},"end":{"line":2091,"column":1}},"key":"he7akmgoCU"}],"key":"HZfErtkerz"}],"key":"hEYvlS5Au9"},{"type":"listItem","spread":true,"position":{"start":{"line":2092,"column":1},"end":{"line":2093,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":2092,"column":1},"end":{"line":2092,"column":1}},"children":[{"type":"text","value":"Impact","position":{"start":{"line":2092,"column":1},"end":{"line":2092,"column":1}},"key":"bEeiwhXWGB"}],"key":"UqSS7fMSaX"},{"type":"text","value":": Usually \u003c0.05 eV difference, but can be larger for weak interactions","position":{"start":{"line":2092,"column":1},"end":{"line":2092,"column":1}},"key":"JOApI4uPRP"}],"key":"zb7MLQBKEZ"}],"key":"D770eUyFzr"}],"key":"T49DzvCYph"}],"key":"pCgWAiYT9l"}],"key":"lmOABlJmAf"},{"type":"heading","depth":3,"position":{"start":{"line":2094,"column":1},"end":{"line":2094,"column":1}},"children":[{"type":"text","value":"3. Coverage Dependence Challenges","position":{"start":{"line":2094,"column":1},"end":{"line":2094,"column":1}},"key":"slQtVdzoEj"}],"identifier":"id-3-coverage-dependence-challenges","label":"3. Coverage Dependence Challenges","html_id":"id-3-coverage-dependence-challenges","implicit":true,"key":"Yr90fXLkvF"},{"type":"paragraph","position":{"start":{"line":2096,"column":1},"end":{"line":2096,"column":1}},"children":[{"type":"strong","position":{"start":{"line":2096,"column":1},"end":{"line":2096,"column":1}},"children":[{"type":"text","value":"Non-linearity at high coverage","position":{"start":{"line":2096,"column":1},"end":{"line":2096,"column":1}},"key":"mnEIGetcN0"}],"key":"Q31IXTuo09"},{"type":"text","value":":","position":{"start":{"line":2096,"column":1},"end":{"line":2096,"column":1}},"key":"FVj7S0t2dr"}],"key":"fgA7mWfXjj"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2097,"column":1},"end":{"line":2101,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2097,"column":1},"end":{"line":2097,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"This tutorial assumes linear E_ads(θ) = E₀ + βθ","position":{"start":{"line":2097,"column":1},"end":{"line":2097,"column":1}},"key":"Jzwvd3Uz77"}],"key":"GTxqNFnwUD"}],"key":"sYtoJR6bCr"},{"type":"listItem","spread":true,"position":{"start":{"line":2098,"column":1},"end":{"line":2098,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Reality: Often non-linear, especially near θ = 1 ML. See the plots generated - there is a linear regime for relatively high coverage, and relatively low coverage, but it’s not uniformly linear everywhere. As long as you consistently in one regime or the other a linear assumption is probably ok, but you could get into problems if solving microkinetic models where the coverage of the species in question changes significantly from very low to high.","position":{"start":{"line":2098,"column":1},"end":{"line":2098,"column":1}},"key":"FL77NUhH4j"}],"key":"TxSFkX9bNR"}],"key":"h2Jr3faZhO"},{"type":"listItem","spread":true,"position":{"start":{"line":2099,"column":1},"end":{"line":2099,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":2099,"column":1},"end":{"line":2099,"column":1}},"children":[{"type":"text","value":"Why","position":{"start":{"line":2099,"column":1},"end":{"line":2099,"column":1}},"key":"NVIGncCjUO"}],"key":"KhEr615Wnq"},{"type":"text","value":": Phase transitions, adsorbate ordering, surface reconstruction","position":{"start":{"line":2099,"column":1},"end":{"line":2099,"column":1}},"key":"yE62CAq4EN"}],"key":"BPCHsAR1ik"}],"key":"x0uEy04bFi"},{"type":"listItem","spread":true,"position":{"start":{"line":2100,"column":1},"end":{"line":2101,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":2100,"column":1},"end":{"line":2100,"column":1}},"children":[{"type":"text","value":"Solution","position":{"start":{"line":2100,"column":1},"end":{"line":2100,"column":1}},"key":"xGr2Z2qQ8P"}],"key":"B9O8JX6C9K"},{"type":"text","value":": Test polynomial fits, look for ordering in visualizations","position":{"start":{"line":2100,"column":1},"end":{"line":2100,"column":1}},"key":"O2vSCsAgBL"}],"key":"WP2kv91LaP"}],"key":"XBX4rgCaen"}],"key":"V82AjpoF4u"},{"type":"paragraph","position":{"start":{"line":2102,"column":1},"end":{"line":2102,"column":1}},"children":[{"type":"strong","position":{"start":{"line":2102,"column":1},"end":{"line":2102,"column":1}},"children":[{"type":"text","value":"Low coverage limit","position":{"start":{"line":2102,"column":1},"end":{"line":2102,"column":1}},"key":"u3qKmoxT1R"}],"key":"obNRIh8xT8"},{"type":"text","value":":","position":{"start":{"line":2102,"column":1},"end":{"line":2102,"column":1}},"key":"igrjcpCXKX"}],"key":"xtKELC36kW"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2103,"column":1},"end":{"line":2106,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2103,"column":1},"end":{"line":2103,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"At θ \u003c 0.1 ML, coverage effects are tiny (\u003c0.01 eV)","position":{"start":{"line":2103,"column":1},"end":{"line":2103,"column":1}},"key":"dndk4ItNgE"}],"key":"EzUPgop8mP"}],"key":"lroDDYMlsE"},{"type":"listItem","spread":true,"position":{"start":{"line":2104,"column":1},"end":{"line":2104,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Hard to distinguish from numerical noise","position":{"start":{"line":2104,"column":1},"end":{"line":2104,"column":1}},"key":"dXrbLEEzKD"}],"key":"b2UuBmNbmp"}],"key":"bv8ty5luEs"},{"type":"listItem","spread":true,"position":{"start":{"line":2105,"column":1},"end":{"line":2106,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":2105,"column":1},"end":{"line":2105,"column":1}},"children":[{"type":"text","value":"Best practice","position":{"start":{"line":2105,"column":1},"end":{"line":2105,"column":1}},"key":"WOfVaR1g4u"}],"key":"ISOWLXxJU5"},{"type":"text","value":": Focus on 0.25-1.0 ML range for fitting","position":{"start":{"line":2105,"column":1},"end":{"line":2105,"column":1}},"key":"Pcu6b88cvT"}],"key":"DqPp70SOGZ"}],"key":"AIaTVKv6br"}],"key":"pwajPPXKf5"},{"type":"heading","depth":3,"position":{"start":{"line":2107,"column":1},"end":{"line":2107,"column":1}},"children":[{"type":"text","value":"4. Periodic Boundary Conditions","position":{"start":{"line":2107,"column":1},"end":{"line":2107,"column":1}},"key":"kCM64xnRHk"}],"identifier":"id-4-periodic-boundary-conditions","label":"4. Periodic Boundary Conditions","html_id":"id-4-periodic-boundary-conditions","implicit":true,"key":"OfxyXOtH53"},{"type":"paragraph","position":{"start":{"line":2109,"column":1},"end":{"line":2109,"column":1}},"children":[{"type":"strong","position":{"start":{"line":2109,"column":1},"end":{"line":2109,"column":1}},"children":[{"type":"text","value":"UMa requires PBC=True in all directions!","position":{"start":{"line":2109,"column":1},"end":{"line":2109,"column":1}},"key":"aRJNvrY8kc"}],"key":"ox9ttD32IA"}],"key":"k3wLhpfdWd"},{"type":"code","lang":"python","value":"atoms.set_pbc([True, True, True])  # Always required","position":{"start":{"line":2110,"column":1},"end":{"line":2112,"column":1}},"key":"kdW39yvs3s"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2113,"column":1},"end":{"line":2115,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2113,"column":1},"end":{"line":2113,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Forgetting this causes crashes or wrong energies","position":{"start":{"line":2113,"column":1},"end":{"line":2113,"column":1}},"key":"KQj9waVVFg"}],"key":"o8d3MANmDw"}],"key":"g7YQ6Hj7ib"},{"type":"listItem","spread":true,"position":{"start":{"line":2114,"column":1},"end":{"line":2115,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Even for “gas phase” molecules in vacuum","position":{"start":{"line":2114,"column":1},"end":{"line":2114,"column":1}},"key":"jcIgxf3IaT"}],"key":"tjlQ07cL9A"}],"key":"oCl3fKDM6v"}],"key":"Qw7FuvuBvS"},{"type":"heading","depth":3,"position":{"start":{"line":2116,"column":1},"end":{"line":2116,"column":1}},"children":[{"type":"text","value":"5. Gas Phase Reference Energies","position":{"start":{"line":2116,"column":1},"end":{"line":2116,"column":1}},"key":"DZeHSkIPVq"}],"identifier":"id-5-gas-phase-reference-energies","label":"5. Gas Phase Reference Energies","html_id":"id-5-gas-phase-reference-energies","implicit":true,"key":"j89agHmXIM"},{"type":"paragraph","position":{"start":{"line":2118,"column":1},"end":{"line":2118,"column":1}},"children":[{"type":"strong","position":{"start":{"line":2118,"column":1},"end":{"line":2118,"column":1}},"children":[{"type":"text","value":"Tricky cases","position":{"start":{"line":2118,"column":1},"end":{"line":2118,"column":1}},"key":"uD0gKa4jsA"}],"key":"tMaO2KZ3v3"},{"type":"text","value":":","position":{"start":{"line":2118,"column":1},"end":{"line":2118,"column":1}},"key":"DUap6iHOjf"}],"key":"FtkyGuRC3K"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2119,"column":1},"end":{"line":2123,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2119,"column":1},"end":{"line":2119,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":2119,"column":1},"end":{"line":2119,"column":1}},"children":[{"type":"text","value":"H₂(g)","position":{"start":{"line":2119,"column":1},"end":{"line":2119,"column":1}},"key":"xWX97mOAqY"}],"key":"fueyRoGdx5"},{"type":"text","value":": UMa handles well (used in this tutorial)","position":{"start":{"line":2119,"column":1},"end":{"line":2119,"column":1}},"key":"yH6EzFb1I2"}],"key":"MQNdsouBnB"}],"key":"lovvKbqvxl"},{"type":"listItem","spread":true,"position":{"start":{"line":2120,"column":1},"end":{"line":2120,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":2120,"column":1},"end":{"line":2120,"column":1}},"children":[{"type":"text","value":"H(g)","position":{"start":{"line":2120,"column":1},"end":{"line":2120,"column":1}},"key":"uHB8bhB1fy"}],"key":"t2JoyewwTH"},{"type":"text","value":": May not be reliable (use H₂/2 instead)","position":{"start":{"line":2120,"column":1},"end":{"line":2120,"column":1}},"key":"U7BGI7ObBV"}],"key":"RBKvgjcbNv"}],"key":"Vnq0qzApF7"},{"type":"listItem","spread":true,"position":{"start":{"line":2121,"column":1},"end":{"line":2121,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":2121,"column":1},"end":{"line":2121,"column":1}},"children":[{"type":"text","value":"CO(g)","position":{"start":{"line":2121,"column":1},"end":{"line":2121,"column":1}},"key":"Z67W7quykr"}],"key":"si3LSNrB4e"},{"type":"text","value":", ","position":{"start":{"line":2121,"column":1},"end":{"line":2121,"column":1}},"key":"xBpnkZS1DA"},{"type":"strong","position":{"start":{"line":2121,"column":1},"end":{"line":2121,"column":1}},"children":[{"type":"text","value":"O₂(g)","position":{"start":{"line":2121,"column":1},"end":{"line":2121,"column":1}},"key":"FLe4614KTn"}],"key":"IQNyuKYev3"},{"type":"text","value":": Usually okay, but check against DFT","position":{"start":{"line":2121,"column":1},"end":{"line":2121,"column":1}},"key":"ep9IWX2t9F"}],"key":"ZyUPemQyqk"}],"key":"wtNxpmWK8h"},{"type":"listItem","spread":true,"position":{"start":{"line":2122,"column":1},"end":{"line":2123,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":2122,"column":1},"end":{"line":2122,"column":1}},"children":[{"type":"text","value":"Radicals","position":{"start":{"line":2122,"column":1},"end":{"line":2122,"column":1}},"key":"YwKN3fjJQG"}],"key":"BHhKa4dOmJ"},{"type":"text","value":": Often problematic","position":{"start":{"line":2122,"column":1},"end":{"line":2122,"column":1}},"key":"uhY6mCPd1W"}],"key":"XSA5w1UuB3"}],"key":"X68BWloS5R"}],"key":"GvPleRdTb8"},{"type":"paragraph","position":{"start":{"line":2124,"column":1},"end":{"line":2124,"column":1}},"children":[{"type":"strong","position":{"start":{"line":2124,"column":1},"end":{"line":2124,"column":1}},"children":[{"type":"text","value":"Best practice","position":{"start":{"line":2124,"column":1},"end":{"line":2124,"column":1}},"key":"upIyB6tZyX"}],"key":"frUHH5rwJi"},{"type":"text","value":": Always use stable molecules as references (H₂, not H; H₂O, not OH)","position":{"start":{"line":2124,"column":1},"end":{"line":2124,"column":1}},"key":"ecX9KEhf8b"}],"key":"bZ7Lt3lRC0"},{"type":"heading","depth":3,"position":{"start":{"line":2126,"column":1},"end":{"line":2126,"column":1}},"children":[{"type":"text","value":"6. Spin Polarization","position":{"start":{"line":2126,"column":1},"end":{"line":2126,"column":1}},"key":"KAoicsSCSH"}],"identifier":"id-6-spin-polarization","label":"6. Spin Polarization","html_id":"id-6-spin-polarization","implicit":true,"key":"trsTicme3l"},{"type":"paragraph","position":{"start":{"line":2128,"column":1},"end":{"line":2128,"column":1}},"children":[{"type":"strong","position":{"start":{"line":2128,"column":1},"end":{"line":2128,"column":1}},"children":[{"type":"text","value":"Key limitation","position":{"start":{"line":2128,"column":1},"end":{"line":2128,"column":1}},"key":"dVxoCASo5F"}],"key":"wyst87o1qx"},{"type":"text","value":": OC20/UMa does not include spin!","position":{"start":{"line":2128,"column":1},"end":{"line":2128,"column":1}},"key":"U2jrmTPJKq"}],"key":"BDlIenAqte"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2129,"column":1},"end":{"line":2135,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2129,"column":1},"end":{"line":2129,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Paper used spin-polarized DFT","position":{"start":{"line":2129,"column":1},"end":{"line":2129,"column":1}},"key":"IOB0Gcy4JH"}],"key":"TkYwfP50Np"}],"key":"Jzgp3vnjV1"},{"type":"listItem","spread":true,"position":{"start":{"line":2130,"column":1},"end":{"line":2130,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":2130,"column":1},"end":{"line":2130,"column":1}},"children":[{"type":"text","value":"Impact","position":{"start":{"line":2130,"column":1},"end":{"line":2130,"column":1}},"key":"f4dqJAW0Eh"}],"key":"ZPFaBhvgUa"},{"type":"text","value":": Usually small (0.05-0.1 eV)","position":{"start":{"line":2130,"column":1},"end":{"line":2130,"column":1}},"key":"yr9SZEAlnr"}],"key":"v0LTE9FvZm"}],"key":"BjDi8rnh3N"},{"type":"listItem","spread":true,"position":{"start":{"line":2131,"column":1},"end":{"line":2135,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":2131,"column":1},"end":{"line":2131,"column":1}},"children":[{"type":"text","value":"Larger","position":{"start":{"line":2131,"column":1},"end":{"line":2131,"column":1}},"key":"S6AYcfywOa"}],"key":"nCb3CsaiP0"},{"type":"text","value":" for:","position":{"start":{"line":2131,"column":1},"end":{"line":2131,"column":1}},"key":"mNL0BymQLe"}],"key":"Lop5PhGN7M"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2132,"column":1},"end":{"line":2135,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2132,"column":1},"end":{"line":2132,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Magnetic metals (Fe, Co, Ni)","position":{"start":{"line":2132,"column":1},"end":{"line":2132,"column":1}},"key":"X762dUTOHe"}],"key":"srWGs77SZE"}],"key":"hDzYDdSoRR"},{"type":"listItem","spread":true,"position":{"start":{"line":2133,"column":1},"end":{"line":2133,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Open-shell adsorbates (O*, OH*)","position":{"start":{"line":2133,"column":1},"end":{"line":2133,"column":1}},"key":"aD2PaCj2F0"}],"key":"McIRtL3hpN"}],"key":"Jwf3suljEi"},{"type":"listItem","spread":true,"position":{"start":{"line":2134,"column":1},"end":{"line":2135,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Reaction barriers with radicals","position":{"start":{"line":2134,"column":1},"end":{"line":2134,"column":1}},"key":"qfAgO21p6L"}],"key":"Gwynmfqb8O"}],"key":"irflfzEktU"}],"key":"I7eW1NcUN8"}],"key":"VO1cYxc6Jm"}],"key":"l7rL7t589X"},{"type":"heading","depth":3,"position":{"start":{"line":2136,"column":1},"end":{"line":2136,"column":1}},"children":[{"type":"text","value":"7. Constraint Philosophy","position":{"start":{"line":2136,"column":1},"end":{"line":2136,"column":1}},"key":"m6sXQ63bJM"}],"identifier":"id-7-constraint-philosophy","label":"7. Constraint Philosophy","html_id":"id-7-constraint-philosophy","implicit":true,"key":"tmnls5TouJ"},{"type":"paragraph","position":{"start":{"line":2138,"column":1},"end":{"line":2138,"column":1}},"children":[{"type":"strong","position":{"start":{"line":2138,"column":1},"end":{"line":2138,"column":1}},"children":[{"type":"text","value":"Clean slabs","position":{"start":{"line":2138,"column":1},"end":{"line":2138,"column":1}},"key":"LjlZJUPXoV"}],"key":"p6Xj7SqQBb"},{"type":"text","value":" (Part 2): No constraints (both surfaces relax)","position":{"start":{"line":2138,"column":1},"end":{"line":2138,"column":1}},"key":"QjQzo6o4k4"}],"key":"hhyzKyWCWm"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2139,"column":1},"end":{"line":2141,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2139,"column":1},"end":{"line":2139,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Best for surface energy calculations","position":{"start":{"line":2139,"column":1},"end":{"line":2139,"column":1}},"key":"gfl9yHQFA9"}],"key":"bXMas1xbjb"}],"key":"BfCQ5lLkb4"},{"type":"listItem","spread":true,"position":{"start":{"line":2140,"column":1},"end":{"line":2141,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"More physical for symmetric slabs","position":{"start":{"line":2140,"column":1},"end":{"line":2140,"column":1}},"key":"ORPNRPk5gF"}],"key":"iWn4ShdwIi"}],"key":"lT5WtmzmJ1"}],"key":"cDNTXfrhZU"},{"type":"paragraph","position":{"start":{"line":2142,"column":1},"end":{"line":2142,"column":1}},"children":[{"type":"strong","position":{"start":{"line":2142,"column":1},"end":{"line":2142,"column":1}},"children":[{"type":"text","value":"Adsorbate slabs","position":{"start":{"line":2142,"column":1},"end":{"line":2142,"column":1}},"key":"A4dsWeW6ht"}],"key":"HYU3MvsgxX"},{"type":"text","value":" (Part 4-6): Bottom layers fixed","position":{"start":{"line":2142,"column":1},"end":{"line":2142,"column":1}},"key":"i7qW0pjnwL"}],"key":"crbeLcjnfK"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2143,"column":1},"end":{"line":2146,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2143,"column":1},"end":{"line":2143,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Faster convergence","position":{"start":{"line":2143,"column":1},"end":{"line":2143,"column":1}},"key":"tm0OUURgtp"}],"key":"Myntw02vD1"}],"key":"U1uH81gDOI"},{"type":"listItem","spread":true,"position":{"start":{"line":2144,"column":1},"end":{"line":2144,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Prevents adsorbate-induced reconstruction","position":{"start":{"line":2144,"column":1},"end":{"line":2144,"column":1}},"key":"RvbVt0dvp7"}],"key":"pLPECL2Ets"}],"key":"rUnxBBddzY"},{"type":"listItem","spread":true,"position":{"start":{"line":2145,"column":1},"end":{"line":2146,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Standard practice in surface chemistry","position":{"start":{"line":2145,"column":1},"end":{"line":2145,"column":1}},"key":"uM5CckQtKy"}],"key":"kjumzkMqvf"}],"key":"yUgV80dcdi"}],"key":"wdpCNHv4sf"},{"type":"paragraph","position":{"start":{"line":2147,"column":1},"end":{"line":2147,"column":1}},"children":[{"type":"strong","position":{"start":{"line":2147,"column":1},"end":{"line":2147,"column":1}},"children":[{"type":"text","value":"Fairchem helper functions","position":{"start":{"line":2147,"column":1},"end":{"line":2147,"column":1}},"key":"S3pIBQmMBO"}],"key":"k7MahoXm3a"},{"type":"text","value":": Automatically apply sensible constraints","position":{"start":{"line":2147,"column":1},"end":{"line":2147,"column":1}},"key":"FcGYO0YNUT"}],"key":"yXlkRx5iqU"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2148,"column":1},"end":{"line":2150,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2148,"column":1},"end":{"line":2148,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Trust their heuristics unless you have good reason not to","position":{"start":{"line":2148,"column":1},"end":{"line":2148,"column":1}},"key":"z4T1bubujb"}],"key":"ZZyAgGc2Iq"}],"key":"NFpc1kMkJh"},{"type":"listItem","spread":true,"position":{"start":{"line":2149,"column":1},"end":{"line":2150,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Check ","position":{"start":{"line":2149,"column":1},"end":{"line":2149,"column":1}},"key":"VOP8sLHrtf"},{"type":"inlineCode","value":"atoms.constraints","position":{"start":{"line":2149,"column":1},"end":{"line":2149,"column":1}},"key":"idBFQ9aqz0"},{"type":"text","value":" to see what was applied","position":{"start":{"line":2149,"column":1},"end":{"line":2149,"column":1}},"key":"fKUITwcP7G"}],"key":"Chwtm0NFpj"}],"key":"GAsw25TvbJ"}],"key":"pM2Bd84dOY"},{"type":"heading","depth":3,"position":{"start":{"line":2151,"column":1},"end":{"line":2151,"column":1}},"children":[{"type":"text","value":"8. Complex Surface Structures","position":{"start":{"line":2151,"column":1},"end":{"line":2151,"column":1}},"key":"JZpXhauuBm"}],"identifier":"id-8-complex-surface-structures","label":"8. Complex Surface Structures","html_id":"id-8-complex-surface-structures","implicit":true,"key":"pzv1fO5MEp"},{"type":"paragraph","position":{"start":{"line":2153,"column":1},"end":{"line":2153,"column":1}},"children":[{"type":"strong","position":{"start":{"line":2153,"column":1},"end":{"line":2153,"column":1}},"children":[{"type":"text","value":"This tutorial uses low-index facets","position":{"start":{"line":2153,"column":1},"end":{"line":2153,"column":1}},"key":"TN229SkwEv"}],"key":"hSL9OwGVpd"},{"type":"text","value":" (111, 100, 110, 211)","position":{"start":{"line":2153,"column":1},"end":{"line":2153,"column":1}},"key":"YRsgA8Q8wh"}],"key":"sSi1HwQT1u"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2154,"column":1},"end":{"line":2156,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2154,"column":1},"end":{"line":2154,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Well-defined, symmetric","position":{"start":{"line":2154,"column":1},"end":{"line":2154,"column":1}},"key":"CDuii2YBpG"}],"key":"Mulz4MEp5f"}],"key":"Vt45jdfII8"},{"type":"listItem","spread":true,"position":{"start":{"line":2155,"column":1},"end":{"line":2156,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Easy to generate and analyze","position":{"start":{"line":2155,"column":1},"end":{"line":2155,"column":1}},"key":"jrWrH6FFiF"}],"key":"m3MqGH6mjM"}],"key":"x9VP8hUWhK"}],"key":"B1b1a00XYv"},{"type":"paragraph","position":{"start":{"line":2157,"column":1},"end":{"line":2157,"column":1}},"children":[{"type":"strong","position":{"start":{"line":2157,"column":1},"end":{"line":2157,"column":1}},"children":[{"type":"text","value":"Real catalysts","position":{"start":{"line":2157,"column":1},"end":{"line":2157,"column":1}},"key":"bP6HOor31l"}],"key":"vn6W0DkBxz"},{"type":"text","value":" have:","position":{"start":{"line":2157,"column":1},"end":{"line":2157,"column":1}},"key":"U75xkaLjrZ"}],"key":"OpdViQdKVg"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2158,"column":1},"end":{"line":2162,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2158,"column":1},"end":{"line":2158,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Steps, kinks, grain boundaries","position":{"start":{"line":2158,"column":1},"end":{"line":2158,"column":1}},"key":"YsIECpbysw"}],"key":"U3L2Li98jA"}],"key":"jPkq9WHAJw"},{"type":"listItem","spread":true,"position":{"start":{"line":2159,"column":1},"end":{"line":2159,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Support interfaces","position":{"start":{"line":2159,"column":1},"end":{"line":2159,"column":1}},"key":"j0G1TqhJcn"}],"key":"iK9nHp1kJq"}],"key":"RnAnPMrOVZ"},{"type":"listItem","spread":true,"position":{"start":{"line":2160,"column":1},"end":{"line":2160,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Defects and vacancies","position":{"start":{"line":2160,"column":1},"end":{"line":2160,"column":1}},"key":"XjZbfnpB8z"}],"key":"Wc5ergk5p9"}],"key":"cJqIyov7LN"},{"type":"listItem","spread":true,"position":{"start":{"line":2161,"column":1},"end":{"line":2162,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":2161,"column":1},"end":{"line":2161,"column":1}},"children":[{"type":"text","value":"Challenge","position":{"start":{"line":2161,"column":1},"end":{"line":2161,"column":1}},"key":"u1i3Ww1iBM"}],"key":"vsvm9QAYen"},{"type":"text","value":": Harder to generate, more configurations to test","position":{"start":{"line":2161,"column":1},"end":{"line":2161,"column":1}},"key":"OLjgfxBluz"}],"key":"dFgTmuQ9xc"}],"key":"ni5B64F6SI"}],"key":"NQI76xfypK"},{"type":"heading","depth":3,"position":{"start":{"line":2163,"column":1},"end":{"line":2163,"column":1}},"children":[{"type":"text","value":"9. Slab Thickness and Vacuum","position":{"start":{"line":2163,"column":1},"end":{"line":2163,"column":1}},"key":"qckbPUt1fW"}],"identifier":"id-9-slab-thickness-and-vacuum","label":"9. Slab Thickness and Vacuum","html_id":"id-9-slab-thickness-and-vacuum","implicit":true,"key":"eP0CDsRNt1"},{"type":"paragraph","position":{"start":{"line":2165,"column":1},"end":{"line":2165,"column":1}},"children":[{"type":"strong","position":{"start":{"line":2165,"column":1},"end":{"line":2165,"column":1}},"children":[{"type":"text","value":"Convergence tests critical","position":{"start":{"line":2165,"column":1},"end":{"line":2165,"column":1}},"key":"V5QpfTdyUe"}],"key":"pPWtWypSN5"},{"type":"text","value":" but expensive:","position":{"start":{"line":2165,"column":1},"end":{"line":2165,"column":1}},"key":"hUWY1iRIdW"}],"key":"uiDtoOs5pA"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2166,"column":1},"end":{"line":2172,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2166,"column":1},"end":{"line":2166,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"This tutorial uses “reasonable” values (4-8 layers, 10 Å vacuum)","position":{"start":{"line":2166,"column":1},"end":{"line":2166,"column":1}},"key":"ZIfHYPB9un"}],"key":"jNLJ01yPUZ"}],"key":"UXobUcFSai"},{"type":"listItem","spread":true,"position":{"start":{"line":2167,"column":1},"end":{"line":2167,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":2167,"column":1},"end":{"line":2167,"column":1}},"children":[{"type":"text","value":"Always check","position":{"start":{"line":2167,"column":1},"end":{"line":2167,"column":1}},"key":"Rjd3SAfA3X"}],"key":"BaWzoq8mA8"},{"type":"text","value":" convergence for new systems","position":{"start":{"line":2167,"column":1},"end":{"line":2167,"column":1}},"key":"OxEuh4yI2S"}],"key":"PJaGYYHqwf"}],"key":"nZeMnnRNQP"},{"type":"listItem","spread":true,"position":{"start":{"line":2168,"column":1},"end":{"line":2172,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":2168,"column":1},"end":{"line":2168,"column":1}},"children":[{"type":"text","value":"Especially important","position":{"start":{"line":2168,"column":1},"end":{"line":2168,"column":1}},"key":"sA8U9QUTVH"}],"key":"aTNH0aS52Z"},{"type":"text","value":" for:","position":{"start":{"line":2168,"column":1},"end":{"line":2168,"column":1}},"key":"xYtGLKGPme"}],"key":"yB6k9WrRdL"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2169,"column":1},"end":{"line":2172,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2169,"column":1},"end":{"line":2169,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Metals with long electron screening (Au, Ag)","position":{"start":{"line":2169,"column":1},"end":{"line":2169,"column":1}},"key":"VysZ0KJNVE"}],"key":"GSAxny8nY7"}],"key":"bhXRGKv21n"},{"type":"listItem","spread":true,"position":{"start":{"line":2170,"column":1},"end":{"line":2170,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Charged adsorbates","position":{"start":{"line":2170,"column":1},"end":{"line":2170,"column":1}},"key":"he01rVTNBk"}],"key":"imPX4vNEhn"}],"key":"Pk2lPHhHVt"},{"type":"listItem","spread":true,"position":{"start":{"line":2171,"column":1},"end":{"line":2172,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Strong adsorbate-induced reconstruction","position":{"start":{"line":2171,"column":1},"end":{"line":2171,"column":1}},"key":"ZeP0xXFtIZ"}],"key":"jTK39WZ0at"}],"key":"y6RJ7p5YDl"}],"key":"QMSujZICt5"}],"key":"iGUJVPitwl"}],"key":"ILB0bXWEz6"},{"type":"heading","depth":3,"position":{"start":{"line":2173,"column":1},"end":{"line":2173,"column":1}},"children":[{"type":"text","value":"10. NEB Convergence","position":{"start":{"line":2173,"column":1},"end":{"line":2173,"column":1}},"key":"PrKVp1k7b7"}],"identifier":"id-10-neb-convergence","label":"10. NEB Convergence","html_id":"id-10-neb-convergence","implicit":true,"key":"JTVxBloddx"},{"type":"paragraph","position":{"start":{"line":2175,"column":1},"end":{"line":2175,"column":1}},"children":[{"type":"strong","position":{"start":{"line":2175,"column":1},"end":{"line":2175,"column":1}},"children":[{"type":"text","value":"Most computationally expensive part","position":{"start":{"line":2175,"column":1},"end":{"line":2175,"column":1}},"key":"nB9EZjnOsO"}],"key":"rmWbHL4ITl"},{"type":"text","value":":","position":{"start":{"line":2175,"column":1},"end":{"line":2175,"column":1}},"key":"RJZHS3igpq"}],"key":"dOJ5354hao"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2176,"column":1},"end":{"line":2179,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2176,"column":1},"end":{"line":2176,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"May need 7-11 images (not just 5)","position":{"start":{"line":2176,"column":1},"end":{"line":2176,"column":1}},"key":"kqtZDCbTkx"}],"key":"sIW37wOwbL"}],"key":"JsBwt6bqtl"},{"type":"listItem","spread":true,"position":{"start":{"line":2177,"column":1},"end":{"line":2177,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Initial guess matters a lot","position":{"start":{"line":2177,"column":1},"end":{"line":2177,"column":1}},"key":"V4qlMwWgMA"}],"key":"cEWyolF7Sq"}],"key":"yrAYaGnuZg"},{"type":"listItem","spread":true,"position":{"start":{"line":2178,"column":1},"end":{"line":2179,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Can get stuck in local minima","position":{"start":{"line":2178,"column":1},"end":{"line":2178,"column":1}},"key":"hZAfGtyDSq"}],"key":"CdtL3M0L8X"}],"key":"dOp1jMC0Zv"}],"key":"Jp2TP3T2PV"},{"type":"paragraph","position":{"start":{"line":2180,"column":1},"end":{"line":2180,"column":1}},"children":[{"type":"strong","position":{"start":{"line":2180,"column":1},"end":{"line":2180,"column":1}},"children":[{"type":"text","value":"Tricks","position":{"start":{"line":2180,"column":1},"end":{"line":2180,"column":1}},"key":"z87SlSq2Sa"}],"key":"loQxJZVG6x"},{"type":"text","value":":","position":{"start":{"line":2180,"column":1},"end":{"line":2180,"column":1}},"key":"OO8W6UdEFw"}],"key":"AupRwsLdVC"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":2181,"column":1},"end":{"line":2185,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2181,"column":1},"end":{"line":2181,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Use dimer method to find better TS guess (as shown in Part 6)","position":{"start":{"line":2181,"column":1},"end":{"line":2181,"column":1}},"key":"WoD9nOdXyT"}],"key":"rx2qJAZfje"}],"key":"i0TClDz7kl"},{"type":"listItem","spread":true,"position":{"start":{"line":2182,"column":1},"end":{"line":2182,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Start with coarse convergence (fmax=0.2), refine later","position":{"start":{"line":2182,"column":1},"end":{"line":2182,"column":1}},"key":"NFhCAf2fUD"}],"key":"upZ2dIxoTh"}],"key":"ipPODl1nxS"},{"type":"listItem","spread":true,"position":{"start":{"line":2183,"column":1},"end":{"line":2183,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Visualize the path - does it make chemical sense?","position":{"start":{"line":2183,"column":1},"end":{"line":2183,"column":1}},"key":"NJAmjM7suU"}],"key":"NFXPi0qYZk"}],"key":"BcQ9rfGoUa"},{"type":"listItem","spread":true,"position":{"start":{"line":2184,"column":1},"end":{"line":2185,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Try different spring constants (0.1-1.0 eV/Å)","position":{"start":{"line":2184,"column":1},"end":{"line":2184,"column":1}},"key":"S0DozjL4RH"}],"key":"d8bO48EZg7"}],"key":"cinpIOaP2x"}],"key":"Alv1hDotn9"},{"type":"heading","depth":3,"position":{"start":{"line":2186,"column":1},"end":{"line":2186,"column":1}},"children":[{"type":"text","value":"11. Lattice Constant Source","position":{"start":{"line":2186,"column":1},"end":{"line":2186,"column":1}},"key":"Ryr8ZKNaxP"}],"identifier":"id-11-lattice-constant-source","label":"11. Lattice Constant Source","html_id":"id-11-lattice-constant-source","implicit":true,"key":"FzOnL8saoD"},{"type":"paragraph","position":{"start":{"line":2188,"column":1},"end":{"line":2188,"column":1}},"children":[{"type":"strong","position":{"start":{"line":2188,"column":1},"end":{"line":2188,"column":1}},"children":[{"type":"text","value":"Consistency is key","position":{"start":{"line":2188,"column":1},"end":{"line":2188,"column":1}},"key":"vH0VwddO0E"}],"key":"bksuEyqBHi"},{"type":"text","value":":","position":{"start":{"line":2188,"column":1},"end":{"line":2188,"column":1}},"key":"qgT1wdoCRl"}],"key":"QBRQLT16wT"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2189,"column":1},"end":{"line":2192,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2189,"column":1},"end":{"line":2189,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Use ML-optimized lattice constant throughout (as done here)","position":{"start":{"line":2189,"column":1},"end":{"line":2189,"column":1}},"key":"HNfuKBrieX"}],"key":"pDf8oEmZoS"}],"key":"tFG0OI4Qso"},{"type":"listItem","spread":true,"position":{"start":{"line":2190,"column":1},"end":{"line":2190,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":2190,"column":1},"end":{"line":2190,"column":1}},"children":[{"type":"text","value":"Don’t mix","position":{"start":{"line":2190,"column":1},"end":{"line":2190,"column":1}},"key":"eAsGvJCaEU"}],"key":"zaI4MgpiTw"},{"type":"text","value":": ML lattice + DFT surface energies = inconsistent","position":{"start":{"line":2190,"column":1},"end":{"line":2190,"column":1}},"key":"LHh16ZbbyU"}],"key":"HI54rdZaPE"}],"key":"w2R4ZBztlx"},{"type":"listItem","spread":true,"position":{"start":{"line":2191,"column":1},"end":{"line":2192,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Alternative: Use experimental lattice constant for everything","position":{"start":{"line":2191,"column":1},"end":{"line":2191,"column":1}},"key":"PZBaNScb1A"}],"key":"WBGYgTcaTW"}],"key":"Pwyz0BFdlV"}],"key":"LRIkLTn2iU"},{"type":"heading","depth":3,"position":{"start":{"line":2193,"column":1},"end":{"line":2193,"column":1}},"children":[{"type":"text","value":"12. Adsorbate Placement","position":{"start":{"line":2193,"column":1},"end":{"line":2193,"column":1}},"key":"NWQJtOQ0om"}],"identifier":"id-12-adsorbate-placement","label":"12. Adsorbate Placement","html_id":"id-12-adsorbate-placement","implicit":true,"key":"URWgZwI1Od"},{"type":"paragraph","position":{"start":{"line":2195,"column":1},"end":{"line":2195,"column":1}},"children":[{"type":"strong","position":{"start":{"line":2195,"column":1},"end":{"line":2195,"column":1}},"children":[{"type":"text","value":"Multiple local minima","position":{"start":{"line":2195,"column":1},"end":{"line":2195,"column":1}},"key":"tecPcItHEI"}],"key":"zgPAeVv9lK"},{"type":"text","value":":","position":{"start":{"line":2195,"column":1},"end":{"line":2195,"column":1}},"key":"Q8IVBiL5uv"}],"key":"cfSiJv4RwM"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2196,"column":1},"end":{"line":2199,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2196,"column":1},"end":{"line":2196,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Surface chemistry is ","position":{"start":{"line":2196,"column":1},"end":{"line":2196,"column":1}},"key":"oXGvO7PBAI"},{"type":"strong","position":{"start":{"line":2196,"column":1},"end":{"line":2196,"column":1}},"children":[{"type":"text","value":"not","position":{"start":{"line":2196,"column":1},"end":{"line":2196,"column":1}},"key":"IMhdhuEdp5"}],"key":"dRQHQeP1PX"},{"type":"text","value":" convex!","position":{"start":{"line":2196,"column":1},"end":{"line":2196,"column":1}},"key":"aBF7vOOhza"}],"key":"GGRB7WxBG9"}],"key":"E0R9NMXQy0"},{"type":"listItem","spread":true,"position":{"start":{"line":2197,"column":1},"end":{"line":2197,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Always test multiple adsorption sites","position":{"start":{"line":2197,"column":1},"end":{"line":2197,"column":1}},"key":"AqRa4wygdk"}],"key":"cXgiUf9yo4"}],"key":"ppEmlFTTze"},{"type":"listItem","spread":true,"position":{"start":{"line":2198,"column":1},"end":{"line":2199,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Fairchem helpers generate ~5 configurations in this tutorial, but you may need more to search many modes. You can already try methods like minima hopping or other global optimization methods to sample more configurations.","position":{"start":{"line":2198,"column":1},"end":{"line":2198,"column":1}},"key":"CRUfV7Zb69"}],"key":"VNBgi0loFL"}],"key":"AOEEblvs7D"}],"key":"a089q9iazq"},{"type":"paragraph","position":{"start":{"line":2200,"column":1},"end":{"line":2200,"column":1}},"children":[{"type":"strong","position":{"start":{"line":2200,"column":1},"end":{"line":2200,"column":1}},"children":[{"type":"text","value":"For complex adsorbates","position":{"start":{"line":2200,"column":1},"end":{"line":2200,"column":1}},"key":"iLAMPrZV4h"}],"key":"oUKECqL5Mp"},{"type":"text","value":":","position":{"start":{"line":2200,"column":1},"end":{"line":2200,"column":1}},"key":"lNudDL3uEt"}],"key":"Y6Q4Gc9vF4"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2201,"column":1},"end":{"line":2204,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2201,"column":1},"end":{"line":2201,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Test different orientations","position":{"start":{"line":2201,"column":1},"end":{"line":2201,"column":1}},"key":"lOd6jz9pmU"}],"key":"XmjPBx8ZKq"}],"key":"vk99PKkof7"},{"type":"listItem","spread":true,"position":{"start":{"line":2202,"column":1},"end":{"line":2202,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"May need 10-20 configurations","position":{"start":{"line":2202,"column":1},"end":{"line":2202,"column":1}},"key":"G4hSKx5vHb"}],"key":"SuCwUnrgHM"}],"key":"j1Gcibik2N"},{"type":"listItem","spread":true,"position":{"start":{"line":2203,"column":1},"end":{"line":2204,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Consider genetic algorithms or basin hopping","position":{"start":{"line":2203,"column":1},"end":{"line":2203,"column":1}},"key":"BxBVBC4QvU"}],"key":"cuWfMCRFDR"}],"key":"xiEaRCaTi4"}],"key":"sezDlOUvJ2"},{"type":"thematicBreak","position":{"start":{"line":2205,"column":1},"end":{"line":2205,"column":1}},"key":"c0jq4CQaZT"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Congratulations! 🎉","position":{"start":{"line":2207,"column":1},"end":{"line":2207,"column":1}},"key":"RyADFQIrM5"}],"key":"Lajcv2B4qI"},{"type":"paragraph","position":{"start":{"line":2210,"column":1},"end":{"line":2210,"column":1}},"children":[{"type":"text","value":"You’ve completed a comprehensive computational catalysis workflow using state-of-the-art ML potentials. You can now:","position":{"start":{"line":2210,"column":1},"end":{"line":2210,"column":1}},"key":"rnSCLTC2uW"}],"key":"hom2pE2122"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2212,"column":1},"end":{"line":2216,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2212,"column":1},"end":{"line":2212,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Characterize catalyst surfaces computationally","position":{"start":{"line":2212,"column":1},"end":{"line":2212,"column":1}},"key":"TiBKiguTYz"}],"key":"TLSsrusMa6"}],"key":"vwTTT8StSI"},{"type":"listItem","spread":true,"position":{"start":{"line":2213,"column":1},"end":{"line":2213,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Predict nanoparticle shapes","position":{"start":{"line":2213,"column":1},"end":{"line":2213,"column":1}},"key":"DwdbnIXRcv"}],"key":"RGXsE6fpvu"}],"key":"S0vh8f1Quj"},{"type":"listItem","spread":true,"position":{"start":{"line":2214,"column":1},"end":{"line":2214,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Calculate reaction thermodynamics and kinetics","position":{"start":{"line":2214,"column":1},"end":{"line":2214,"column":1}},"key":"ppqdQT5Ga0"}],"key":"ZDJ2CeOqbQ"}],"key":"zZqJ3w2K3S"},{"type":"listItem","spread":true,"position":{"start":{"line":2215,"column":1},"end":{"line":2216,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Apply these methods to your own research questions","position":{"start":{"line":2215,"column":1},"end":{"line":2215,"column":1}},"key":"DyVCeEing8"}],"key":"xc2snIeHai"}],"key":"vafyBl7b9g"}],"key":"MjVirVTaW7"},{"type":"paragraph","position":{"start":{"line":2217,"column":1},"end":{"line":2217,"column":1}},"children":[{"type":"strong","position":{"start":{"line":2217,"column":1},"end":{"line":2217,"column":1}},"children":[{"type":"text","value":"Next steps","position":{"start":{"line":2217,"column":1},"end":{"line":2217,"column":1}},"key":"LcydjXvsfR"}],"key":"CxJXP35hl3"},{"type":"text","value":":","position":{"start":{"line":2217,"column":1},"end":{"line":2217,"column":1}},"key":"QqjHU6QplC"}],"key":"uh92oIOhB2"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2218,"column":1},"end":{"line":2221,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2218,"column":1},"end":{"line":2218,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Apply to your catalyst system of interest","position":{"start":{"line":2218,"column":1},"end":{"line":2218,"column":1}},"key":"UNLFfcBa4U"}],"key":"SGm4aKGLUP"}],"key":"a42DpjBF9l"},{"type":"listItem","spread":true,"position":{"start":{"line":2219,"column":1},"end":{"line":2219,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Validate key results with DFT","position":{"start":{"line":2219,"column":1},"end":{"line":2219,"column":1}},"key":"t7w1bi343p"}],"key":"NxSk9K3mtK"}],"key":"zVdfArjGpB"},{"type":"listItem","spread":true,"position":{"start":{"line":2220,"column":1},"end":{"line":2220,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Develop microkinetic models","position":{"start":{"line":2220,"column":1},"end":{"line":2220,"column":1}},"key":"CqSDOoBEpI"}],"key":"jEOhLXjyPx"}],"key":"UuELsthWDf"},{"type":"listItem","spread":true,"position":{"start":{"line":2221,"column":1},"end":{"line":2221,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Publish your findings!","position":{"start":{"line":2221,"column":1},"end":{"line":2221,"column":1}},"key":"VA2qp9RnT9"}],"key":"pu24Fj52tX"}],"key":"BuMK08pX2F"}],"key":"YyXEOC0cWI"}],"class":"tip","key":"gk03D11Eed"}],"key":"KbqPFoRKXB"}],"key":"QTQvu4lFVN"},"references":{"cite":{"order":["Kreitz_2021","chanussot-2021-open-catal"],"data":{"Kreitz_2021":{"label":"Kreitz_2021","enumerator":"1","doi":"10.1021/acs.jpcc.0c09985","html":"Kreitz, B., Wehinger, G. D., Goldsmith, C. F., \u0026 Turek, T. (2021). Microkinetic Modeling of the CO2 Desorption from Supported Multifaceted Ni Catalysts. \u003ci\u003eThe Journal of Physical Chemistry C\u003c/i\u003e, \u003ci\u003e125\u003c/i\u003e(5), 2984–3000. \u003ca target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.1021/acs.jpcc.0c09985\"\u003e10.1021/acs.jpcc.0c09985\u003c/a\u003e","url":"https://doi.org/10.1021/acs.jpcc.0c09985"},"chanussot-2021-open-catal":{"label":"chanussot-2021-open-catal","enumerator":"2","doi":"10.1021/acscatal.0c04525","html":"Chanussot, L., Das, A., Goyal, S., Lavril, T., Shuaibi, M., Riviere, M., Tran, K., Heras-Domingo, J., Ho, C., Hu, W., Palizhati, A., Sriram, A., Wood, B., Yoon, J., Parikh, D., Zitnick, C. L., \u0026 Ulissi, Z. (2021). Open Catalyst 2020 (OC20) Dataset and Community Challenges. \u003ci\u003eACS Catalysis\u003c/i\u003e, \u003ci\u003e11\u003c/i\u003e(10), 6059–6072. \u003ca target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.1021/acscatal.0c04525\"\u003e10.1021/acscatal.0c04525\u003c/a\u003e","url":"https://doi.org/10.1021/acscatal.0c04525"}}}},"footer":{"navigation":{"prev":{"title":"UMA Intro Tutorial","url":"/uma-tutorial","group":"AI/ML Models \u0026 Usage"},"next":{"title":"Generative Models","url":"/generative-models","group":"AI/ML Models \u0026 Usage"}}},"domain":"http://localhost:3000"},"project":{"bibliography":["/home/runner/work/fairchem/fairchem/docs/references.bib"],"exports":[],"title":"fairchem","authors":[{"nameParsed":{"literal":"FAIR Chemistry \u0026 Collaborators","given":"FAIR Chemistry \u0026","family":"Collaborators"},"name":"FAIR Chemistry \u0026 Collaborators","id":"contributors-myst-generated-uid-0"}],"github":"https://github.com/facebookresearch/fairchem","copyright":"Meta Platforms, Inc","thebe":{"binder":{"url":"https://mybinder.org/","provider":"github","repo":"https://github.com/facebookresearch/fairchem","ref":"HEAD"}},"toc":[{"file":"index.md"},{"children":[{"file":"core/install.md"},{"file":"core/quickstart.md"},{"file":"core/fairchemv1_v2.md"},{"url":"https://facebook-fairchem-uma-demo.hf.space/","title":"UMA Demo"}],"title":"Quickstart"},{"children":[{"file":"core/uma.md"},{"file":"core/intro.md"},{"children":[{"file":"core/common_tasks/ase_calculator.md"},{"file":"core/common_tasks/lammps.md"},{"file":"core/common_tasks/batch_inference.md"},{"file":"core/common_tasks/inference_batcher.md"},{"file":"core/common_tasks/ase_dataset_creation.md"},{"file":"core/common_tasks/training.md"},{"file":"core/common_tasks/evaluation.md"},{"file":"core/common_tasks/fine_tuning.md"},{"file":"core/common_tasks/workflows.md"},{"file":"core/uma_faq.md"}],"file":"core/common_tasks/summary.md"},{"children":[{"file":"uma_tutorials/uma_tutorial.md"},{"file":"uma_tutorials/uma_catalysis_tutorial.md"}],"file":"uma_tutorials/summary.md"},{"file":"core/generative_models.md"}],"title":"AI/ML Models \u0026 Usage"},{"file":"core/fair_chemistry_papers.md"},{"children":[{"children":[{"file":"molecules/datasets/omol25.md"},{"file":"molecules/datasets/omol25_elec.md"},{"file":"molecules/datasets/omc25.md"}],"file":"molecules/datasets/summary.md"},{"file":"molecules/models.md"},{"file":"molecules/leaderboard.md"},{"file":"molecules/FAQ.md"}],"title":"Organic Molecules"},{"children":[{"children":[{"file":"catalysts/datasets/oc20.md"},{"file":"catalysts/datasets/oc20_mads.md"},{"file":"catalysts/datasets/oc22.md"},{"file":"catalysts/datasets/oc20dense.md"},{"file":"catalysts/datasets/oc20neb.md"},{"file":"catalysts/datasets/ocx24.md"},{"file":"catalysts/datasets/oc25.md"}],"file":"catalysts/datasets/summary.md"},{"file":"catalysts/models.md"},{"children":[{"file":"catalysts/examples_tutorials/OCP-introduction.md"},{"file":"catalysts/examples_tutorials/adsorption_energies/adsorption_energies.md"},{"file":"catalysts/examples_tutorials/adsorbml_walkthrough.md"},{"file":"catalysts/examples_tutorials/cattsunami_tutorial.md"},{"file":"catalysts/examples_tutorials/ocpapi.md"}],"file":"catalysts/examples_tutorials/summary.md"},{"file":"catalysts/FAQ.md"},{"url":"https://opencatalystproject.org","title":"OCP Leaderboard"},{"url":"https://open-catalyst.metademolab.com/","title":"OCP Demo (no install required!)"}],"title":"Heterogeneous Catalysis"},{"children":[{"children":[{"file":"inorganic_materials/datasets/omat24.md"}],"file":"inorganic_materials/datasets/summary.md"},{"file":"inorganic_materials/models.md"},{"children":[{"file":"inorganic_materials/examples_tutorials/formation_energy.md"},{"file":"inorganic_materials/examples_tutorials/phonons.md"},{"file":"inorganic_materials/examples_tutorials/elastic.md"}],"file":"inorganic_materials/examples_tutorials/summary.md"},{"file":"inorganic_materials/FAQ.md"}],"title":"Inorganic Materials"},{"children":[{"children":[{"file":"dac/datasets/odac25.md"},{"file":"dac/datasets/odac23.md"}],"file":"dac/datasets/summary.md"},{"file":"dac/models.md"},{"children":[{"file":"dac/examples_tutorials/adsorption_energy.md"}],"file":"dac/examples_tutorials/summary.md"}],"title":"MOFs for Direct Air Capture"},{"children":[{"file":"core/intro_series.md"},{"file":"videos/technical_talks.md"}],"title":"Learn More"}],"thumbnail":"/build/fair_chem_logo_v2-8db274e987822faff08820502b8c23f7.png","index":"index","pages":[{"level":1,"title":"Quickstart"},{"slug":"install","title":"Installation \u0026 License","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"quickstart","title":"UMA Quick Start w/ ASE","description":"","date":"","thumbnail":"/build/catalysis-46d81ff52ef6683423606a40c88cf856.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fairchemv1-v2","title":"fairchem\u003e=2.0","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"title":"UMA Demo","url":"https://facebook-fairchem-uma-demo.hf.space/","level":2},{"level":1,"title":"AI/ML Models \u0026 Usage"},{"slug":"uma","title":"UMA Models","description":"","date":"","thumbnail":"/build/uma-bdcbdfbd6337128d63e4cb5f70d43863.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"intro","title":"GNNs for Chemistry","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"summary","title":"Common Tasks","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"ase-calculator","title":"Inference using ASE and Predictor Interface","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"lammps","title":"LAMMPS Integration","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"batch-inference","title":"Batch Inference with UMA Models","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"inference-batcher","title":"Batched Atomic Simulations with InferenceBatcher","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"ase-dataset-creation","title":"FAIRChem and Custom Datasets","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"training","title":"Training Models from Scratch","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"evaluation","title":"Evaluating Pretrained Models","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"fine-tuning","title":"Fine-tuning","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"workflows","title":"Calculation Workflows with FAIRChem Models","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"uma-faq","title":"UMA FAQ","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"summary-1","title":"UMA Tutorials","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"uma-tutorial","title":"UMA Intro Tutorial","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"uma-catalysis-tutorial","title":"UMA Catalysis Tutorial","description":"","date":"","thumbnail":"/build/vib.0-3108e0682b2bf05fbb952db933022aed.gif","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"generative-models","title":"Generative Models","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fair-chemistry-papers","title":"FAIR Chemistry Papers","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"level":1,"title":"Organic Molecules"},{"slug":"summary-2","title":"Datasets","description":"","date":"","thumbnail":"/build/molecules-0c3863e2a7881b28ef685d7bab791a4b.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"omol25","title":"OMol25","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"omol25-elec","title":"OMol25 Electronic Structures","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"omc25","title":"OMC25","description":"","date":"","thumbnail":"/build/molecular-crystals-c1b430e11ac0b275e001102948aa37b4.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"models","title":"Pretrained models","description":"","date":"","thumbnail":"/build/molecules-0c3863e2a7881b28ef685d7bab791a4b.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"leaderboard","title":"OMol25 Leaderboard","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"faq","title":"FAQ","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Heterogeneous Catalysis"},{"slug":"summary-3","title":"Datasets","description":"","date":"","thumbnail":"/build/catalysis-46d81ff52ef6683423606a40c88cf856.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"oc20","title":"Open Catalyst 2020 (OC20)","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"oc20-mads","title":"Open Catalyst 2020 Multi-Adsorbate (mAds) Dataset","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"oc22","title":"Open Catalyst 2022 (OC22)","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"oc20dense","title":"Open Catalyst 2020 Dense (OC20Dense)","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"oc20neb","title":"Open Catalyst 2020 Nudged Elastic Band (OC20NEB)","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"ocx24","title":"Open Catalyst Experiments 2024 (OCx24): Bridging Experiments and Computational Models","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"oc25","title":"OC25","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"models-1","title":"Pretrained Models","description":"","date":"","thumbnail":"/build/catalysis-46d81ff52ef6683423606a40c88cf856.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"summary-4","title":"Examples \u0026 Tutorials","description":"","date":"","thumbnail":"/build/catalysis-46d81ff52ef6683423606a40c88cf856.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"ocp-introduction","title":"Intro to Adsorption Energies","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"adsorption-energies","title":"Expert Adsorption Energies","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"adsorbml-walkthrough","title":"AdsorbML Tutorial","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"cattsunami-tutorial","title":"Transition State Search (NEBs)","description":"","date":"","thumbnail":"/build/dissociation_scheme-47cce37d377d250edbdf6ecb162d70d1.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"ocpapi","title":"ocpapi","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"faq-1","title":"FAQ","description":"","date":"","thumbnail":"/build/catalysis-46d81ff52ef6683423606a40c88cf856.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"title":"OCP Leaderboard","url":"https://opencatalystproject.org","level":2},{"title":"OCP Demo (no install required!)","url":"https://open-catalyst.metademolab.com/","level":2},{"level":1,"title":"Inorganic Materials"},{"slug":"summary-5","title":"Datasets","description":"","date":"","thumbnail":"/build/inorganic-18a9d87f97ae5338c855175a2b943bdf.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"omat24","title":"OMat24","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"models-2","title":"Pretrained models","description":"","date":"","thumbnail":"/build/inorganic-18a9d87f97ae5338c855175a2b943bdf.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"summary-6","title":"Examples \u0026 Tutorials","description":"","date":"","thumbnail":"/build/inorganic-18a9d87f97ae5338c855175a2b943bdf.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"formation-energy","title":"Formation Energy","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"phonons","title":"Phonon Calculations","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"elastic","title":"Elastic Tensors","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"faq-2","title":"FAQ","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"MOFs for Direct Air Capture"},{"slug":"summary-7","title":"Datasets","description":"","date":"","thumbnail":"/build/mofs-dac-83d34cd34c6bcd547d2dff49ac93510c.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"odac25","title":"ODAC25","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"odac23","title":"Open Direct Air Capture 2023 (ODAC23)","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"models-3","title":"Pretrained models","description":"","date":"","thumbnail":"/build/mofs-dac-83d34cd34c6bcd547d2dff49ac93510c.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"summary-8","title":"Examples \u0026 Tutorials","description":"","date":"","thumbnail":"/build/mofs-dac-83d34cd34c6bcd547d2dff49ac93510c.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"adsorption-energy","title":"Adsorption Energies in MOFs","description":"","date":"","thumbnail":"/build/WOBHEB_flexible-39c59a36534a0b0af95c2a688f1e2b26.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":1,"title":"Learn More"},{"slug":"intro-series","title":"Why model atoms for climate?","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"technical-talks","title":"Technical Presentations","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2}]}}},"actionData":null,"errors":null},"future":{"unstable_dev":false,"unstable_postcss":false,"unstable_tailwind":false,"v2_errorBoundary":true,"v2_headers":true,"v2_meta":true,"v2_normalizeFormMethod":true,"v2_routeConvention":true}};</script><script type="module" async="">import "/build/manifest-54BD5942.js";
import * as route0 from "/build/root-PMP5BIHC.js";
import * as route1 from "/build/routes/$-5ZLZ2O3Y.js";
window.__remixRouteModules = {"root":route0,"routes/$":route1};

import("/build/entry.client-PCJPW7TK.js");</script></body></html>