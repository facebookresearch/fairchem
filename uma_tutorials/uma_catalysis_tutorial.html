
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>UMA Catalysis Tutorial &#8212; fairchem</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=9c3e77be" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=fd3f3429" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=1ae7504c"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/d3@7.9.0/dist/d3.min.js"></script>
    <script type="module">import mermaid from "https://cdn.jsdelivr.net/npm/mermaid@11.12.1/dist/mermaid.esm.min.mjs";





const initStyles = () => {
    const defaultStyle = document.createElement('style');
    defaultStyle.textContent = `pre.mermaid {
    /* Same as .mermaid-container > pre */
    display: block;
    width: 100%;
}

pre.mermaid > svg {
    /* Same as .mermaid-container > pre > svg */
    height: 500px;
    width: 100%;
    max-width: 100% !important;
}`;
    document.head.appendChild(defaultStyle);

    const fullscreenStyle = document.createElement('style');
    fullscreenStyle.textContent = `.mermaid-container {
    display: flex;
    flex-direction: row;
    width: 100%;
}

.mermaid-container > pre {
    display: block;
    width: 100%;
}

.mermaid-container > pre > svg {
    height: 500px;
    width: 100%;
    max-width: 100% !important;
}

.mermaid-fullscreen-btn {
    width: 28px;
    height: 28px;
    background: rgba(255, 255, 255, 0.95);
    border: 1px solid rgba(0, 0, 0, 0.3);
    border-radius: 4px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s;
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
    font-size: 14px;
    line-height: 1;
    padding: 0;
    color: #333;
}

.mermaid-fullscreen-btn:hover {
    opacity: 100% !important;
    background: rgba(255, 255, 255, 1);
    box-shadow: 0 3px 10px rgba(0, 0, 0, 0.3);
    transform: scale(1.1);
}

.mermaid-fullscreen-btn.dark-theme {
    background: rgba(50, 50, 50, 0.95);
    border: 1px solid rgba(255, 255, 255, 0.3);
    color: #e0e0e0;
}

.mermaid-fullscreen-btn.dark-theme:hover {
    background: rgba(60, 60, 60, 1);
    box-shadow: 0 3px 10px rgba(255, 255, 255, 0.2);
}

.mermaid-fullscreen-modal {
    display: none;
    position: fixed !important;
    top: 0 !important;
    left: 0 !important;
    width: 95vw;
    height: 100vh;
    background: rgba(255, 255, 255, 0.98);
    z-index: 9999;
    padding: 20px;
    overflow: auto;
}

.mermaid-fullscreen-modal.dark-theme {
    background: rgba(0, 0, 0, 0.98);
}

.mermaid-fullscreen-modal.active {
    display: flex;
    align-items: center;
    justify-content: center;
}

.mermaid-container-fullscreen {
    position: relative;
    width: 95vw;
    height: 90vh;
    max-width: 95vw;
    max-height: 90vh;
    background: white;
    border-radius: 8px;
    padding: 20px;
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
    overflow: auto;
    display: flex;
    align-items: center;
    justify-content: center;
}

.mermaid-container-fullscreen.dark-theme {
    background: #1a1a1a;
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.8);
}

.mermaid-container-fullscreen pre.mermaid {
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
}

.mermaid-container-fullscreen .mermaid svg {
    height: 100% !important;
    width: 100% !important;
    cursor: grab;
}

.mermaid-fullscreen-close {
    position: fixed !important;
    top: 20px !important;
    right: 20px !important;
    width: 40px;
    height: 40px;
    background: rgba(255, 255, 255, 0.95);
    border: 1px solid rgba(0, 0, 0, 0.2);
    border-radius: 50%;
    cursor: pointer;
    z-index: 10000;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
    transition: all 0.2s;
    font-size: 24px;
    line-height: 1;
    color: #333;
}

.mermaid-fullscreen-close:hover {
    background: white;
    box-shadow: 0 6px 16px rgba(0, 0, 0, 0.4);
    transform: scale(1.1);
}

.mermaid-fullscreen-close.dark-theme {
    background: rgba(50, 50, 50, 0.95);
    border: 1px solid rgba(255, 255, 255, 0.2);
    color: #e0e0e0;
}

.mermaid-fullscreen-close.dark-theme:hover {
    background: rgba(60, 60, 60, 1);
    box-shadow: 0 6px 16px rgba(255, 255, 255, 0.2);
}

.mermaid-fullscreen-modal .mermaid-fullscreen-btn {
    display: none !important;
}`;
    document.head.appendChild(fullscreenStyle);
}

// Detect if page has dark background
const isDarkTheme = () => {
    // We use a set of heuristics:
    // 1. Check for common dark mode classes or attributes
    // 2. Check computed background color brightness
    if (document.documentElement.classList.contains('dark') ||
        document.documentElement.getAttribute('data-theme') === 'dark' ||
        document.body.classList.contains('dark') ||
        document.body.getAttribute('data-theme') === 'dark') {
        // console.log("Dark theme detected via class/attribute");
        return true;
    }
    if (document.documentElement.classList.contains('light') ||
        document.documentElement.getAttribute('data-theme') === 'light' ||
        document.body.classList.contains('light') ||
        document.body.getAttribute('data-theme') === 'light') {
        // console.log("Light theme detected via class/attribute");
        return false;
    }
    if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
        // console.log("Dark theme detected via prefers-color-scheme");
        return true;
    }
    const bgColor = window.getComputedStyle(document.body).backgroundColor;
    const match = bgColor.match(/rgb\((\d+),\s*(\d+),\s*(\d+)/);
    if (match) {
        const r = parseInt(match[1]);
        const g = parseInt(match[2]);
        const b = parseInt(match[3]);
        const brightness = (r * 299 + g * 587 + b * 114) / 1000;
        // console.log("Background color brightness:", brightness);
        return brightness < 128;
    }
    // console.log("No dark or light theme detected, defaulting to light theme");
    return false;
};

let darkTheme = isDarkTheme();
let modal = null;
let modalContent = null;
let previousScrollOffset = [window.scrollX, window.scrollY];

const runMermaid = async (rerun) => {
    console.log("Running mermaid diagrams, rerun =", rerun);
    // clear all existing mermaid charts
    let all_mermaids = document.querySelectorAll(".mermaid");

    if (rerun) {
        all_mermaids.forEach((el) => {
            if(!el.hasAttribute("data-original-code")) {
                // store original code
                // console.log(`Storing original code for first run: `, el.innerHTML);
                el.setAttribute('data-original-code', el.innerHTML);
            }
            if(el.getAttribute("data-processed") === "true") {
                // remove and restore original
                el.removeAttribute("data-processed");
                // console.log(`Restoring original code for re-run: `, el.getAttribute('data-original-code'));
                el.innerHTML = el.getAttribute('data-original-code');
            } else {
                // store original code
                // console.log(`Storing original code for re-run: `, el.innerHTML);
                el.setAttribute('data-original-code', el.innerHTML);
            }
        });
        await mermaid.run();
    }

    all_mermaids = document.querySelectorAll(".mermaid");
    const mermaids_processed = document.querySelectorAll(".mermaid[data-processed='true']");

    if ("False" === "True") {
        const mermaids_to_add_zoom = -1 === -1 ? all_mermaids.length : -1;
        if(mermaids_to_add_zoom > 0) {
            var svgs = d3.selectAll("");
            if(all_mermaids.length !== mermaids_processed.length) {
                setTimeout(() => runMermaid(false), 200);
                return;
            } else if(svgs.size() !== mermaids_to_add_zoom) {
                setTimeout(() => runMermaid(false), 200);
                return;
            } else {
                svgs.each(function() {
                    var svg = d3.select(this);
                    svg.html("<g class='wrapper'>" + svg.html() + "</g>");
                    var inner = svg.select("g");
                    var zoom = d3.zoom().on("zoom", function(event) {
                        inner.attr("transform", event.transform);
                    });
                    svg.call(zoom);
                });
            }
        }
    } else if(all_mermaids.length !== mermaids_processed.length) {
        // Wait for mermaid to process all diagrams
        setTimeout(() => runMermaid(false), 200);
        return;
    }

    // Stop here if not adding fullscreen capability
    if ("True" !== "True") return;

    if (modal !== null ) {
        // Destroy existing modal
        modal.remove();
        modal = null;
        modalContent = null;
    }

    modal = document.createElement('div');
    modal.className = 'mermaid-fullscreen-modal' + (darkTheme ? ' dark-theme' : '');
    modal.setAttribute('role', 'dialog');
    modal.setAttribute('aria-modal', 'true');
    modal.setAttribute('aria-label', 'Fullscreen diagram viewer');
    modal.innerHTML = `
        <button class="mermaid-fullscreen-close${darkTheme ? ' dark-theme' : ''}" aria-label="Close fullscreen">✕</button>
        <div class="mermaid-container-fullscreen${darkTheme ? ' dark-theme' : ''}"></div>
    `;
    document.body.appendChild(modal);

    modalContent = modal.querySelector('.mermaid-container-fullscreen');
    const closeBtn = modal.querySelector('.mermaid-fullscreen-close');

    const closeModal = () => {
        modal.classList.remove('active');
        modalContent.innerHTML = '';
        document.body.style.overflow = ''
        window.scrollTo({left: previousScrollOffset[0], top: previousScrollOffset[1], behavior: 'instant'});
    };

    closeBtn.addEventListener('click', closeModal);
    modal.addEventListener('click', (e) => {
        if (e.target === modal) closeModal();
    });
    document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && modal.classList.contains('active')) {
            closeModal();
        }
    });

    document.querySelectorAll('.mermaid').forEach((mermaidDiv) => {
        if (mermaidDiv.parentNode.classList.contains('mermaid-container') ||
            mermaidDiv.closest('.mermaid-fullscreen-modal')) {
            // Already processed, adjust button class if needed
            const existingBtn = mermaidDiv.parentNode.querySelector('.mermaid-fullscreen-btn');
            if (existingBtn) {
                existingBtn.className = 'mermaid-fullscreen-btn' + (darkTheme ? ' dark-theme' : '');
            }
            return;
        }

        const container = document.createElement('div');
        container.className = 'mermaid-container';
        mermaidDiv.parentNode.insertBefore(container, mermaidDiv);
        container.appendChild(mermaidDiv);

        const fullscreenBtn = document.createElement('button');
        fullscreenBtn.className = 'mermaid-fullscreen-btn' + (darkTheme ? ' dark-theme' : '');
        fullscreenBtn.setAttribute('aria-label', 'View diagram in fullscreen');
        fullscreenBtn.textContent = '⛶';
        fullscreenBtn.style.opacity = '50%';

        // Calculate dynamic position based on diagram's margin and padding
        const diagramStyle = window.getComputedStyle(mermaidDiv);
        const marginTop = parseFloat(diagramStyle.marginTop) || 0;
        const marginRight = parseFloat(diagramStyle.marginRight) || 0;
        const paddingTop = parseFloat(diagramStyle.paddingTop) || 0;
        const paddingRight = parseFloat(diagramStyle.paddingRight) || 0;
        fullscreenBtn.style.top = `${marginTop + paddingTop + 4}px`;
        fullscreenBtn.style.right = `${marginRight + paddingRight + 4}px`;

        fullscreenBtn.addEventListener('click', () => {
            previousScrollOffset = [window.scroll, window.scrollY];
            const clone = mermaidDiv.cloneNode(true);
            modalContent.innerHTML = '';
            modalContent.appendChild(clone);

            const svg = clone.querySelector('svg');
            if (svg) {
                svg.removeAttribute('width');
                svg.removeAttribute('height');
                svg.style.width = '100%';
                svg.style.height = 'auto';
                svg.style.maxWidth = '100%';
                svg.style.sdisplay = 'block';

                if ("False" === "True") {
                    setTimeout(() => {
                        const g = svg.querySelector('g');
                        if (g) {
                            var svgD3 = d3.select(svg);
                            svgD3.html("<g class='wrapper'>" + svgD3.html() + "</g>");
                            var inner = svgD3.select("g");
                            var zoom = d3.zoom().on("zoom", function(event) {
                                inner.attr("transform", event.transform);
                            });
                            svgD3.call(zoom);
                        }
                    }, 100);
                }
            }

            modal.classList.add('active');
            document.body.style.overflow = 'hidden';
        });
        container.appendChild(fullscreenBtn);
    });
};

const load = async () => {
    initStyles();

    await runMermaid(true);

    const reRunIfThemeChanges = async () => {
        const newDarkTheme = isDarkTheme();
        if (newDarkTheme !== darkTheme) {
            darkTheme = newDarkTheme;
            console.log("Theme change detected, re-running mermaid with", darkTheme ? "dark" : "default", "theme");
            await mermaid.initialize(
                {...JSON.parse(
                    `{"startOnLoad": false}`
                ),
                ...{ darkMode: darkTheme, theme: darkTheme ? 'dark' : 'default' },
                }
            );
            await runMermaid(true);
        }
    };

    // Update theme classes when theme changes
    const themeObserver = new MutationObserver(reRunIfThemeChanges);
    themeObserver.observe(document.documentElement, {
        attributes: true,
        attributeFilter: ['class', 'style', 'data-theme']
    });
    themeObserver.observe(document.body, {
        attributes: true,
        attributeFilter: ['class', 'style', 'data-theme']
    });
};





console.log("Initializing mermaid with", darkTheme ? "dark" : "default", "theme");
mermaid.initialize(
    {...JSON.parse(
        `{"startOnLoad": false}`
    ),
    ...{ darkMode: darkTheme, theme: darkTheme ? 'dark' : 'default' },
    }
);

window.addEventListener("load", load);</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'uma_tutorials/uma_catalysis_tutorial';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Generative Models" href="../core/generative_models.html" />
    <link rel="prev" title="UMA Intro Tutorial" href="uma_tutorial.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">fairchem</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    fairchem by FAIR Chemistry
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Quickstart</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../core/install.html">Installation &amp; License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core/quickstart.html">UMA Quick Start w/ ASE</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core/fairchemv1_v2.html"><code class="docutils literal notranslate"><span class="pre">fairchem&gt;=2.0</span></code></a></li>
<li class="toctree-l1"><a class="reference external" href="https://facebook-fairchem-uma-demo.hf.space/">UMA Demo</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">AI/ML Interatomic Potentials</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../core/intro.html">GNNs for Chemistry</a></li>


<li class="toctree-l1"><a class="reference internal" href="../core/uma.html">UMA Models</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../core/common_tasks/summary.html">Common tasks</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../core/common_tasks/ase_calculator.html">Inference using ASE and Predictor interface</a></li>




<li class="toctree-l2"><a class="reference internal" href="../core/common_tasks/lammps.html">LAMMPs Integration</a></li>



<li class="toctree-l2"><a class="reference internal" href="../core/common_tasks/batch_inference.html">Batch inference with UMA models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../core/common_tasks/inference_batcher.html">Batched atomic simulations with an <code class="docutils literal notranslate"><span class="pre">InferenceBatcher</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../core/common_tasks/ase_dataset_creation.html">FAIRChem &amp; custom datasets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../core/common_tasks/training.html">Training models from scratch</a></li>
<li class="toctree-l2"><a class="reference internal" href="../core/common_tasks/evaluation.html">Evaluating pretrained models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../core/common_tasks/fine_tuning.html">Fine-tuning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../core/common_tasks/workflows.html">Calculation workflows with FAIRChem models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../core/uma_faq.html">FAQ</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="summary.html">UMA tutorials</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="uma_tutorial.html">UMA Intro Tutorial</a></li>









<li class="toctree-l2 current active"><a class="current reference internal" href="#">UMA Catalysis Tutorial</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../core/generative_models.html">Generative Models</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Molecules &amp; Molecular Crystals</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../molecules/datasets/summary.html">Datasets</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../molecules/datasets/omol25.html">OMol25</a></li>
<li class="toctree-l2"><a class="reference internal" href="../molecules/datasets/omol25_elec.html">OMol25 Electronic Structures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../molecules/datasets/omc25.html">OMC25</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../molecules/models.html">Pretrained models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../molecules/leaderboard.html">OMol25 Leaderboard</a></li>
<li class="toctree-l1"><a class="reference internal" href="../molecules/FAQ.html">FAQ</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Heterogeneous Catalysis</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference external" href="https://opencatalystproject.org">OCP Leaderboard</a></li>
<li class="toctree-l1"><a class="reference external" href="https://open-catalyst.metademolab.com/">OCP Demo (no install required!)</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../catalysts/datasets/summary.html">Datasets</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../catalysts/datasets/oc20.html">Open Catalyst 2020 (OC20)</a></li>

<li class="toctree-l2"><a class="reference internal" href="../catalysts/datasets/oc20_mads.html">Open Catalyst 2020 Multi-Adsorbate (mAds) Dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="../catalysts/datasets/oc22.html">Open Catalyst 2022 (OC22)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../catalysts/datasets/oc20dense.html">Open Catalyst 2020 Dense (OC20Dense)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../catalysts/datasets/oc20neb.html">Open Catalyst 2020 Nudged Elastic Band (OC20NEB)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../catalysts/datasets/ocx24.html">Open Catalyst Experiments 2024 (OCx24): Bridging Experiments and Computational Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../catalysts/datasets/oc25.html">OC25</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../catalysts/models.html">Pretrained models</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../catalysts/examples_tutorials/summary.html">Examples &amp; Tutorials</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../catalysts/examples_tutorials/OCP-introduction.html">Intro to  adsorption energies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../catalysts/examples_tutorials/adsorption_energies/adsorption_energies.html">Expert adsorption energies</a></li>






<li class="toctree-l2"><a class="reference internal" href="../catalysts/examples_tutorials/adsorbml_walkthrough.html">AdsorbML tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="../catalysts/examples_tutorials/cattsunami_tutorial.html">Transition State Search (NEBs)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../catalysts/examples_tutorials/ocpapi.html">ocpapi</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../catalysts/FAQ.html">FAQ</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Inorganic Materials</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../inorganic_materials/datasets/summary.html">Datasets</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../inorganic_materials/datasets/omat24.html">OMat24</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../inorganic_materials/models.html">Pretrained models</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../inorganic_materials/examples_tutorials/summary.html">Examples &amp; Tutorials</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../inorganic_materials/examples_tutorials/formation_energy.html">Formation energies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../inorganic_materials/examples_tutorials/phonons.html">Phonons</a></li>
<li class="toctree-l2"><a class="reference internal" href="../inorganic_materials/examples_tutorials/elastic.html">Elastic Tensors</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../inorganic_materials/FAQ.html">FAQ</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">MOFs for Direct Air Capture</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../dac/datasets/summary.html">Datasets</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../dac/datasets/odac25.html">ODAC25</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dac/datasets/odac23.html">Open Direct Air Capture 2023 (ODAC23) [Deprecated]</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../dac/models.html">Pretrained models</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../dac/examples_tutorials/summary.html">Examples &amp; Tutorials</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../dac/examples_tutorials/adsorption_energy.html">Adsorption Energies</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Learn More</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../core/intro_series.html">Why model atoms for climate?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../videos/technical_talks.html">Technical presentations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core/papers_using_models.html">Studies leveraging FAIR-Chem</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">fairchem documentation</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../autoapi/index.html">API Reference</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../autoapi/core/index.html">core</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../autoapi/core/_cli/index.html">core._cli</a></li>
<li class="toctree-l3"><a class="reference internal" href="../autoapi/core/_config/index.html">core._config</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../autoapi/core/calculate/index.html">core.calculate</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/calculate/_batch/index.html">core.calculate._batch</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/calculate/ase_calculator/index.html">core.calculate.ase_calculator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/calculate/pretrained_mlip/index.html">core.calculate.pretrained_mlip</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../autoapi/core/common/index.html">core.common</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/common/data_parallel/index.html">core.common.data_parallel</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/common/distutils/index.html">core.common.distutils</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/common/gp_utils/index.html">core.common.gp_utils</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/common/logger/index.html">core.common.logger</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/common/profiler_utils/index.html">core.common.profiler_utils</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/common/registry/index.html">core.common.registry</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/common/test_utils/index.html">core.common.test_utils</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/common/typing/index.html">core.common.typing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/common/utils/index.html">core.common.utils</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../autoapi/core/datasets/index.html">core.datasets</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/datasets/_utils/index.html">core.datasets._utils</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/datasets/ase_datasets/index.html">core.datasets.ase_datasets</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/datasets/atomic_data/index.html">core.datasets.atomic_data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/datasets/atoms_sequence/index.html">core.datasets.atoms_sequence</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/datasets/base_dataset/index.html">core.datasets.base_dataset</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/datasets/common_structures/index.html">core.datasets.common_structures</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/datasets/embeddings/index.html">core.datasets.embeddings</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/datasets/mt_concat_dataset/index.html">core.datasets.mt_concat_dataset</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/datasets/target_metadata_guesser/index.html">core.datasets.target_metadata_guesser</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../autoapi/core/models/index.html">core.models</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/models/base/index.html">core.models.base</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/models/escaip/index.html">core.models.escaip</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/models/uma/index.html">core.models.uma</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/models/utils/index.html">core.models.utils</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../autoapi/core/modules/index.html">core.modules</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/modules/evaluator/index.html">core.modules.evaluator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/modules/exponential_moving_average/index.html">core.modules.exponential_moving_average</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/modules/loss/index.html">core.modules.loss</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/modules/normalization/index.html">core.modules.normalization</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/modules/scaling/index.html">core.modules.scaling</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/modules/scheduler/index.html">core.modules.scheduler</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/modules/transforms/index.html">core.modules.transforms</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../autoapi/core/scripts/index.html">core.scripts</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/scripts/convert_hydra_to_release/index.html">core.scripts.convert_hydra_to_release</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/scripts/create_finetune_dataset/index.html">core.scripts.create_finetune_dataset</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/scripts/create_uma_finetune_dataset/index.html">core.scripts.create_uma_finetune_dataset</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/scripts/diatomic_tests/index.html">core.scripts.diatomic_tests</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/scripts/download_data/index.html">core.scripts.download_data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/scripts/download_large_files/index.html">core.scripts.download_large_files</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/scripts/eqv2_to_hydra_eqv2/index.html">core.scripts.eqv2_to_hydra_eqv2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/scripts/fit_normalizers/index.html">core.scripts.fit_normalizers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/scripts/fit_references/index.html">core.scripts.fit_references</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/scripts/gif_maker_parallelized/index.html">core.scripts.gif_maker_parallelized</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/scripts/make_challenge_submission_file/index.html">core.scripts.make_challenge_submission_file</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/scripts/make_lmdb_sizes/index.html">core.scripts.make_lmdb_sizes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/scripts/make_submission_file/index.html">core.scripts.make_submission_file</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/scripts/migrate_checkpoint/index.html">core.scripts.migrate_checkpoint</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/scripts/migrate_imports/index.html">core.scripts.migrate_imports</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/scripts/preprocess_ef/index.html">core.scripts.preprocess_ef</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/scripts/preprocess_relaxed/index.html">core.scripts.preprocess_relaxed</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/scripts/uncompress/index.html">core.scripts.uncompress</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../autoapi/core/units/index.html">core.units</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/units/mlip_unit/index.html">core.units.mlip_unit</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../autoapi/data/index.html">data</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../autoapi/data/oc/index.html">data.oc</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/data/oc/core/index.html">data.oc.core</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/data/oc/databases/index.html">data.oc.databases</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/data/oc/structure_generator/index.html">data.oc.structure_generator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/data/oc/utils/index.html">data.oc.utils</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../autoapi/data/odac/index.html">data.odac</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/data/odac/setup_vasp/index.html">data.odac.setup_vasp</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../autoapi/data/omat/index.html">data.omat</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/data/omat/entries/index.html">data.omat.entries</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/data/omat/vasp/index.html">data.omat.vasp</a></li>
</ul>
</details></li>
<li class="toctree-l3"><a class="reference internal" href="../autoapi/data/omc/index.html">data.omc</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../autoapi/data/omol/index.html">data.omol</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/data/omol/orca/index.html">data.omol.orca</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../autoapi/ocpapi/index.html">ocpapi</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../autoapi/ocpapi/client/index.html">ocpapi.client</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/ocpapi/client/client/index.html">ocpapi.client.client</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/ocpapi/client/models/index.html">ocpapi.client.models</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/ocpapi/client/ui/index.html">ocpapi.client.ui</a></li>
</ul>
</details></li>
<li class="toctree-l3"><a class="reference internal" href="../autoapi/ocpapi/version/index.html">ocpapi.version</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../autoapi/ocpapi/workflows/index.html">ocpapi.workflows</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/ocpapi/workflows/adsorbates/index.html">ocpapi.workflows.adsorbates</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/ocpapi/workflows/context/index.html">ocpapi.workflows.context</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/ocpapi/workflows/filter/index.html">ocpapi.workflows.filter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/ocpapi/workflows/log/index.html">ocpapi.workflows.log</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/ocpapi/workflows/retry/index.html">ocpapi.workflows.retry</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../autoapi/cattsunami/index.html">cattsunami</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../autoapi/cattsunami/core/index.html">cattsunami.core</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/cattsunami/core/autoframe/index.html">cattsunami.core.autoframe</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/cattsunami/core/reaction/index.html">cattsunami.core.reaction</a></li>
</ul>
</details></li>
<li class="toctree-l3"><a class="reference internal" href="../autoapi/cattsunami/databases/index.html">cattsunami.databases</a></li>
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Notebook execution times</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../execution_time.html">Notebook execution times</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/facebookresearch/fairchem/blob/main/docs/uma_tutorials/uma_catalysis_tutorial.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Colab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Colab logo" src="../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/facebookresearch/fairchem" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/facebookresearch/fairchem/issues/new?title=Issue%20on%20page%20%2Fuma_tutorials/uma_catalysis_tutorial.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/uma_tutorials/uma_catalysis_tutorial.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>UMA Catalysis Tutorial</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#installation-and-setup">Installation and Setup</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#huggingface-setups">Huggingface setups</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fair-chemistry-uma-installation">FAIR Chemistry (UMA) installation</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#package-imports">Package imports</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-1-bulk-crystal-optimization">Part 1: Bulk Crystal Optimization</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#theory">Theory</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-2-surface-energy-calculations">Part 2: Surface Energy Calculations</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Introduction</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Theory</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-1-setup-and-bulk-energy-reference">Step 1: Setup and Bulk Energy Reference</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-generate-and-relax-slabs">Step 2: Generate and Relax Slabs</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-3-visualize-linear-fits">Step 3: Visualize Linear Fits</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-4-compare-with-literature">Step 4: Compare with Literature</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#explore-on-your-own">Explore on Your Own</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-3-wulff-construction">Part 3: Wulff Construction</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Introduction</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">Theory</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-1-prepare-surface-energies">Step 1: Prepare Surface Energies</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-generate-wulff-construction">Step 2: Generate Wulff Construction</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-3-visualize-and-compare">Step 3: Visualize and Compare</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">Explore on Your Own</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-4-h-adsorption-energy-with-zpe-correction">Part 4: H Adsorption Energy with ZPE Correction</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">Introduction</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">Theory</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-1-setup-and-relax-clean-slab">Step 1: Setup and Relax Clean Slab</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-relax-clean-slab">Step 2: Relax Clean Slab</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-3-generate-h-adsorption-sites">Step 3: Generate H Adsorption Sites</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-4-relax-all-h-configurations">Step 4: Relax All H Configurations</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-5-calculate-h2-reference-energy">Step 5: Calculate H₂ Reference Energy</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-6-compute-adsorption-energy">Step 6: Compute Adsorption Energy</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-7-zero-point-energy-zpe-corrections">Step 7: Zero-Point Energy (ZPE) Corrections</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-8-visualize-and-compare-results">Step 8: Visualize and Compare Results</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">Explore on Your Own</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-5-coverage-dependent-h-adsorption">Part 5: Coverage-Dependent H Adsorption</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">Introduction</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">Theory</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-1-setup-slab-and-calculators">Step 1: Setup Slab and Calculators</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-calculate-reference-energies">Step 2: Calculate Reference Energies</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-3-set-up-coverage-study">Step 3: Set Up Coverage Study</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-4-generate-and-relax-configurations-at-each-coverage">Step 4: Generate and Relax Configurations at Each Coverage</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-5-perform-linear-fit">Step 5: Perform Linear Fit</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-6-visualize-coverage-dependence">Step 6: Visualize Coverage Dependence</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">Explore on Your Own</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-6-co-formation-dissociation-thermochemistry-and-barrier">Part 6: CO Formation/Dissociation Thermochemistry and Barrier</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">Introduction</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">Theory</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id14">Step 1: Setup Slab and Calculators</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-generate-and-relax-final-state-co">Step 2: Generate and Relax Final State (CO*)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-3-generate-and-relax-initial-state-c-o">Step 3: Generate and Relax Initial State (C* + O*)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-3b-calculate-c-and-o-energies-separately">Step 3b: Calculate C* and O* Energies Separately</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-4-calculate-reaction-energy-with-zpe">Step 4: Calculate Reaction Energy with ZPE</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-5-calculate-co-adsorption-energy-bonus">Step 5: Calculate CO Adsorption Energy (Bonus)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-6-find-guesses-for-nearby-initial-and-final-states-for-the-reaction">Step 6: Find guesses for nearby initial and final states for the reaction</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-7-run-neb-to-find-activation-barrier">Step 7: Run NEB to Find Activation Barrier</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-8-visualize-neb-path-and-key-structures">Step 8: Visualize NEB Path and Key Structures</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id15">Explore on Your Own</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary-and-best-practices">Summary and Best Practices</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-takeaways">Key Takeaways</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommended-workflow-for-new-systems">Recommended Workflow for New Systems</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#accuracy-considerations">Accuracy Considerations</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#further-reading">Further Reading</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#appendix-troubleshooting">Appendix: Troubleshooting</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#common-issues">Common Issues</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#performance-tips">Performance Tips</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#caveats-and-pitfalls">Caveats and Pitfalls</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#task-selection-omat-vs-oc20">1. Task Selection: OMAT vs OC20</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#d3-dispersion-corrections">2. D3 Dispersion Corrections</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#coverage-dependence-challenges">3. Coverage Dependence Challenges</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#periodic-boundary-conditions">4. Periodic Boundary Conditions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#gas-phase-reference-energies">5. Gas Phase Reference Energies</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#spin-polarization">6. Spin Polarization</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#constraint-philosophy">7. Constraint Philosophy</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#complex-surface-structures">8. Complex Surface Structures</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#slab-thickness-and-vacuum">9. Slab Thickness and Vacuum</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#neb-convergence">10. NEB Convergence</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lattice-constant-source">11. Lattice Constant Source</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#adsorbate-placement">12. Adsorbate Placement</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="uma-catalysis-tutorial">
<h1>UMA Catalysis Tutorial<a class="headerlink" href="#uma-catalysis-tutorial" title="Link to this heading">#</a></h1>
<p>Author: Zack Ulissi (Meta, CMU), with help from AI coding agents / LLMs</p>
<p>Original paper: Bjarne Kreitz et al. JPCC (2021)</p>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading">#</a></h2>
<p>This tutorial demonstrates how to use the Universal Model for Atoms (UMA) machine learning potential to perform comprehensive catalyst surface analysis. We replicate key computational workflows from <a class="reference external" href="https://pubs.acs.org/doi/10.1021/acs.jpcc.0c09985">“Microkinetic Modeling of CO₂ Desorption from Supported Multifaceted Ni Catalysts”</a> by Bjarne Kreitz (now faculty at Georgia Tech!), showing how ML potentials can accelerate computational catalysis research.</p>
<div class="note admonition">
<p class="admonition-title">Learning Objectives</p>
<p>By the end of this tutorial, you will be able to:</p>
<ul class="simple">
<li><p>Optimize bulk crystal structures and extract lattice constants</p></li>
<li><p>Calculate surface energies using linear extrapolation methods</p></li>
<li><p>Construct Wulff shapes to predict nanoparticle morphologies</p></li>
<li><p>Compute adsorption energies with zero-point energy corrections</p></li>
<li><p>Study coverage-dependent binding phenomena</p></li>
<li><p>Calculate reaction barriers using the nudged elastic band (NEB) method</p></li>
<li><p>Apply D3 dispersion corrections to improve accuracy</p></li>
</ul>
</div>
<div class="tip admonition">
<p class="admonition-title">About UMA-S-1P1</p>
<p>The <strong>UMA-S-1P1</strong> model is a state-of-the-art universal machine learning potential trained on the OMat24, OC20, OMol25, ODAC23, and OMC25 datasets, covering diverse materials and surface chemistries. It provides ~1000× speedup over DFT while maintaining reasonable accuracy for screening studies. Here we’ll use the UMA-s-1p1 checkpoint which is the small (=faster) 1.1 version released in June. The UMA-s-1p1 checkpoint is open science with a lightweight license that users have to agree to through Huggingface.</p>
<p>You can read more about the UMA models here: https://arxiv.org/abs/2506.23971</p>
</div>
</section>
<section id="installation-and-setup">
<h2>Installation and Setup<a class="headerlink" href="#installation-and-setup" title="Link to this heading">#</a></h2>
<p>This tutorial uses a number of helpful open source packages:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ase</span></code> - Atomic Simulation Environment</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">fairchem</span></code> - FAIR Chemistry ML potentials (formerly OCP)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pymatgen</span></code> - Materials analysis</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> - Visualization</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">numpy</span></code> - Numerical computing</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">torch-dftd</span></code> - Dispersion corrections
among many others!</p></li>
</ul>
<section id="huggingface-setups">
<h3>Huggingface setups<a class="headerlink" href="#huggingface-setups" title="Link to this heading">#</a></h3>
<p>You need to get a HuggingFace account and request access to the UMA models.</p>
<p>You need a Huggingface account, request access to https://huggingface.co/facebook/UMA, and to create a Huggingface token at https://huggingface.co/settings/tokens/ with these permission:</p>
<p>Permissions: Read access to contents of all public gated repos you can access</p>
<p>Then, add the token as an environment variable using <code class="docutils literal notranslate"><span class="pre">huggingface-cli</span> <span class="pre">login</span></code>:</p>
<div class="cell tag_skip-execution docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Enter token via huggingface-cli</span>
<span class="o">!</span><span class="w"> </span>huggingface-cli<span class="w"> </span>login
</pre></div>
</div>
</div>
</div>
<p>or you can set the token via HF_TOKEN variable:</p>
<div class="cell tag_skip-execution docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set token via env variable</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>

<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;HF_TOKEN&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;MYTOKEN&quot;</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="fair-chemistry-uma-installation">
<h3>FAIR Chemistry (UMA) installation<a class="headerlink" href="#fair-chemistry-uma-installation" title="Link to this heading">#</a></h3>
<p>It may be enough to use <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">fairchem-core</span></code>. This gets you the latest version on PyPi (https://pypi.org/project/fairchem-core/)</p>
<p>Here we install some sub-packages. This can take 2-5 minutes to run.</p>
<div class="cell tag_skip-execution docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span><span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>fairchem-core<span class="o">[</span>docs<span class="o">]</span><span class="w"> </span>fairchem-data-oc<span class="w"> </span>fairchem-applications-cattsunami<span class="w"> </span>x3dase
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Check that packages are installed</span>
<span class="o">!</span>pip<span class="w"> </span>list<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>fairchem
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>fairchem-applications-cattsunami   1.1.2.dev154+gd5f816bf
fairchem-core                      2.13.1.dev32+gd5f816bf
fairchem-data-oc                   1.0.3.dev154+gd5f816bf
fairchem-data-omat                 0.2.1.dev59+gd5f816bf
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">fairchem.core</span>

<span class="n">fairchem</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">__version__</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;2.13.1.dev32+gd5f816bf&#39;
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="package-imports">
<h2>Package imports<a class="headerlink" href="#package-imports" title="Link to this heading">#</a></h2>
<p>First, let’s import all necessary libraries and initialize the UMA-S-1P1 predictor:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">ase.io</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ase</span><span class="w"> </span><span class="kn">import</span> <span class="n">Atoms</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ase.build</span><span class="w"> </span><span class="kn">import</span> <span class="n">bulk</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ase.constraints</span><span class="w"> </span><span class="kn">import</span> <span class="n">FixBondLengths</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ase.io</span><span class="w"> </span><span class="kn">import</span> <span class="n">write</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ase.mep</span><span class="w"> </span><span class="kn">import</span> <span class="n">interpolate</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ase.mep.dyneb</span><span class="w"> </span><span class="kn">import</span> <span class="n">DyNEB</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ase.optimize</span><span class="w"> </span><span class="kn">import</span> <span class="n">FIRE</span><span class="p">,</span> <span class="n">LBFGS</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ase.vibrations</span><span class="w"> </span><span class="kn">import</span> <span class="n">Vibrations</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ase.visualize</span><span class="w"> </span><span class="kn">import</span> <span class="n">view</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">fairchem.core</span><span class="w"> </span><span class="kn">import</span> <span class="n">FAIRChemCalculator</span><span class="p">,</span> <span class="n">pretrained_mlip</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">fairchem.data.oc.core</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">Adsorbate</span><span class="p">,</span>
    <span class="n">AdsorbateSlabConfig</span><span class="p">,</span>
    <span class="n">Bulk</span><span class="p">,</span>
    <span class="n">MultipleAdsorbateSlabConfig</span><span class="p">,</span>
    <span class="n">Slab</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pymatgen.analysis.wulff</span><span class="w"> </span><span class="kn">import</span> <span class="n">WulffShape</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pymatgen.core</span><span class="w"> </span><span class="kn">import</span> <span class="n">Lattice</span><span class="p">,</span> <span class="n">Structure</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pymatgen.core.surface</span><span class="w"> </span><span class="kn">import</span> <span class="n">SlabGenerator</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pymatgen.io.ase</span><span class="w"> </span><span class="kn">import</span> <span class="n">AseAtomsAdaptor</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">torch_dftd.torch_dftd3_calculator</span><span class="w"> </span><span class="kn">import</span> <span class="n">TorchDFTD3Calculator</span>

<span class="c1"># Set up output directory structure</span>
<span class="n">output_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;ni_tutorial_results&quot;</span><span class="p">)</span>
<span class="n">output_dir</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Create subdirectories for each part</span>
<span class="n">part_dirs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;part1&quot;</span><span class="p">:</span> <span class="s2">&quot;part1-bulk-optimization&quot;</span><span class="p">,</span>
    <span class="s2">&quot;part2&quot;</span><span class="p">:</span> <span class="s2">&quot;part2-surface-energies&quot;</span><span class="p">,</span>
    <span class="s2">&quot;part3&quot;</span><span class="p">:</span> <span class="s2">&quot;part3-wulff-construction&quot;</span><span class="p">,</span>
    <span class="s2">&quot;part4&quot;</span><span class="p">:</span> <span class="s2">&quot;part4-h-adsorption&quot;</span><span class="p">,</span>
    <span class="s2">&quot;part5&quot;</span><span class="p">:</span> <span class="s2">&quot;part5-coverage-dependence&quot;</span><span class="p">,</span>
    <span class="s2">&quot;part6&quot;</span><span class="p">:</span> <span class="s2">&quot;part6-co-dissociation&quot;</span><span class="p">,</span>
<span class="p">}</span>

<span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">dirname</span> <span class="ow">in</span> <span class="n">part_dirs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="p">(</span><span class="n">output_dir</span> <span class="o">/</span> <span class="n">dirname</span><span class="p">)</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Create subdirectories for different facets in part2</span>
<span class="k">for</span> <span class="n">facet</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;111&quot;</span><span class="p">,</span> <span class="s2">&quot;100&quot;</span><span class="p">,</span> <span class="s2">&quot;110&quot;</span><span class="p">,</span> <span class="s2">&quot;211&quot;</span><span class="p">]:</span>
    <span class="p">(</span><span class="n">output_dir</span> <span class="o">/</span> <span class="n">part_dirs</span><span class="p">[</span><span class="s2">&quot;part2&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;ni</span><span class="si">{</span><span class="n">facet</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Initialize the UMA-S-1P1 predictor</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Loading UMA-S-1P1 model...&quot;</span><span class="p">)</span>
<span class="n">predictor</span> <span class="o">=</span> <span class="n">pretrained_mlip</span><span class="o">.</span><span class="n">get_predict_unit</span><span class="p">(</span><span class="s2">&quot;uma-s-1p1&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;✓ Model loaded successfully!&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Loading UMA-S-1P1 model...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>WARNING:root:device was not explicitly set, using device=&#39;cuda&#39;.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>✓ Model loaded successfully!
</pre></div>
</div>
</div>
</div>
<p>It is somewhat time consuming to run this. We’re going to use a small number of bulks for the testing of this documentation, but otherwise run all of the results for the actual documentation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>

<span class="n">fast_docs</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;FAST_DOCS&quot;</span><span class="p">,</span> <span class="s2">&quot;false&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;true&quot;</span>
<span class="k">if</span> <span class="n">fast_docs</span><span class="p">:</span>
    <span class="n">num_sites</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">relaxation_steps</span> <span class="o">=</span> <span class="mi">20</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">num_sites</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="n">relaxation_steps</span> <span class="o">=</span> <span class="mi">300</span>
</pre></div>
</div>
</div>
</div>
</section>
<hr class="docutils" />
<section id="part-1-bulk-crystal-optimization">
<h2>Part 1: Bulk Crystal Optimization<a class="headerlink" href="#part-1-bulk-crystal-optimization" title="Link to this heading">#</a></h2>
<section id="introduction">
<h3>Introduction<a class="headerlink" href="#introduction" title="Link to this heading">#</a></h3>
<p>Before studying surfaces, we need to determine the equilibrium lattice constant of bulk Ni. This is crucial because surface energies and adsorbate binding depend strongly on the underlying lattice parameter.</p>
</section>
<section id="theory">
<h3>Theory<a class="headerlink" href="#theory" title="Link to this heading">#</a></h3>
<p>For FCC metals like Ni, the lattice constant <strong>a</strong> defines the unit cell size. The experimental value for Ni is <strong>a = 3.524 Å</strong> at room temperature. We’ll optimize both atomic positions and the cell volume to find the ML potential’s equilibrium structure.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create initial FCC Ni structure</span>
<span class="n">a_initial</span> <span class="o">=</span> <span class="mf">3.52</span>  <span class="c1"># Å, close to experimental</span>
<span class="n">ni_bulk</span> <span class="o">=</span> <span class="n">bulk</span><span class="p">(</span><span class="s2">&quot;Ni&quot;</span><span class="p">,</span> <span class="s2">&quot;fcc&quot;</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="n">a_initial</span><span class="p">,</span> <span class="n">cubic</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Initial lattice constant: </span><span class="si">{</span><span class="n">a_initial</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Å&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of atoms: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">ni_bulk</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Set up calculator for bulk optimization</span>
<span class="n">calc</span> <span class="o">=</span> <span class="n">FAIRChemCalculator</span><span class="p">(</span><span class="n">predictor</span><span class="p">,</span> <span class="n">task_name</span><span class="o">=</span><span class="s2">&quot;omat&quot;</span><span class="p">)</span>
<span class="n">ni_bulk</span><span class="o">.</span><span class="n">calc</span> <span class="o">=</span> <span class="n">calc</span>

<span class="c1"># Use ExpCellFilter to allow cell relaxation</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ase.filters</span><span class="w"> </span><span class="kn">import</span> <span class="n">ExpCellFilter</span>

<span class="n">ecf</span> <span class="o">=</span> <span class="n">ExpCellFilter</span><span class="p">(</span><span class="n">ni_bulk</span><span class="p">)</span>

<span class="c1"># Optimize with LBFGS</span>
<span class="n">opt</span> <span class="o">=</span> <span class="n">LBFGS</span><span class="p">(</span>
    <span class="n">ecf</span><span class="p">,</span>
    <span class="n">trajectory</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">output_dir</span> <span class="o">/</span> <span class="n">part_dirs</span><span class="p">[</span><span class="s2">&quot;part1&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="s2">&quot;ni_bulk_opt.traj&quot;</span><span class="p">),</span>
    <span class="n">logfile</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">output_dir</span> <span class="o">/</span> <span class="n">part_dirs</span><span class="p">[</span><span class="s2">&quot;part1&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="s2">&quot;ni_bulk_opt.log&quot;</span><span class="p">),</span>
<span class="p">)</span>
<span class="n">opt</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">fmax</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="n">relaxation_steps</span><span class="p">)</span>

<span class="c1"># Extract results</span>
<span class="n">cell</span> <span class="o">=</span> <span class="n">ni_bulk</span><span class="o">.</span><span class="n">get_cell</span><span class="p">()</span>
<span class="n">a_optimized</span> <span class="o">=</span> <span class="n">cell</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">a_exp</span> <span class="o">=</span> <span class="mf">3.524</span>  <span class="c1"># Experimental value</span>
<span class="n">error</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">a_optimized</span> <span class="o">-</span> <span class="n">a_exp</span><span class="p">)</span> <span class="o">/</span> <span class="n">a_exp</span> <span class="o">*</span> <span class="mi">100</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="s1">&#39;=&#39;</span><span class="o">*</span><span class="mi">50</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Experimental lattice constant: </span><span class="si">{</span><span class="n">a_exp</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Å&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Optimized lattice constant:    </span><span class="si">{</span><span class="n">a_optimized</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Å&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Relative error:                </span><span class="si">{</span><span class="n">error</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;=&#39;</span><span class="o">*</span><span class="mi">50</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">ase</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">output_dir</span> <span class="o">/</span> <span class="n">part_dirs</span><span class="p">[</span><span class="s2">&quot;part1&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="s2">&quot;ni_bulk_relaxed.cif&quot;</span><span class="p">),</span> <span class="n">ni_bulk</span><span class="p">)</span>

<span class="c1"># Store results for later use</span>
<span class="n">a_opt</span> <span class="o">=</span> <span class="n">a_optimized</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Initial lattice constant: 3.52 Å
Number of atoms: 4
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_6567/3959847705.py:15: DeprecationWarning: Use FrechetCellFilter for better convergence w.r.t. cell variables.
  ecf = ExpCellFilter(ni_bulk)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>==================================================
Experimental lattice constant: 3.52 Å
Optimized lattice constant:    3.52 Å
Relative error:                0.25%
==================================================
</pre></div>
</div>
</div>
</div>
<div class="dropdown tip admonition">
<p class="admonition-title">Missing UMA access?</p>
<p>Don’t have access to UMA yet? You can still explore this calculation!</p>
<p><a class="reference internal" href="#example_configs/ni_bulk.xyz"><span class="xref myst">Download example Ni bulk structure</span></a> and test it in the <a class="reference external" href="https://facebook-fairchem-uma-demo.hf.space/">UMA demo (no login required)</a> to see how the model predicts properties for bulk Ni.</p>
</div>
<div class="tip admonition">
<p class="admonition-title">Understanding the Results</p>
<p>UMA-s-1p1 using the <code class="docutils literal notranslate"><span class="pre">omat</span></code> task name will predict lattice constants at the PBE level of DFT. For metals, PBE typically predicts lattice constants within 1-2% of experimental values.</p>
<p>Small discrepancies arise from:</p>
<ul class="simple">
<li><p>Training data biases (if your structure is far from OMAT24)</p></li>
<li><p>Temperature effects (0 K vs room temperature). You can do a quasi-harmonic analysis to include finite temperature effects if desired.</p></li>
<li><p>Quantum effects not captured by the underlying DFT/PBE simulations</p></li>
</ul>
<p>For surface calculations, using the ML-optimized lattice constant maintains internal consistency.</p>
</div>
<div class="note admonition">
<p class="admonition-title">Comparison with Paper</p>
<p><strong>Paper (Table 1):</strong> Ni lattice constant = 3.524 Å (experimental reference)</p>
<p>The UMA-S-1P1 model with OMAT provides excellent agreement with experiment, as would be expected for the PBE functional for simple BCC Ni. The underlying calculations for OMat24 and the original results cited in the paper should be very similar (both PBE), so the fact that the results are a little closer to experiment than the original results is within the numerical noise of the ML model.</p>
</div>
<div class="seealso admonition">
<p class="admonition-title">Further exploration</p>
<p>Try modifying the following parameters and observe the effects:</p>
<ol class="arabic simple">
<li><p><strong>Task name</strong>: The original paper re-relaxed the structures at the RPBE level of theory before continuing. Try that with the UMA-s-1p1 model (using the oc20 task name) and see if it matters here.</p></li>
<li><p><strong>Initial guess</strong>: Change <code class="docutils literal notranslate"><span class="pre">a_initial</span></code> to 3.0 or 4.0 Å. Does the optimizer still converge to the same value?</p></li>
<li><p><strong>Convergence criterion</strong>: Tighten <code class="docutils literal notranslate"><span class="pre">fmax</span></code> to 0.01 eV/Å. How many more steps are required?</p></li>
<li><p><strong>Different metals</strong>: Replace <code class="docutils literal notranslate"><span class="pre">&quot;Ni&quot;</span></code> with <code class="docutils literal notranslate"><span class="pre">&quot;Cu&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Pd&quot;</span></code>, or <code class="docutils literal notranslate"><span class="pre">&quot;Pt&quot;</span></code>. Compare predicted vs experimental lattice constants.</p></li>
<li><p><strong>Cell shape</strong>: Remove <code class="docutils literal notranslate"><span class="pre">cubic=True</span></code> and allow the cell to distort. Does FCC remain stable?</p></li>
</ol>
</div>
</section>
</section>
<hr class="docutils" />
<section id="part-2-surface-energy-calculations">
<h2>Part 2: Surface Energy Calculations<a class="headerlink" href="#part-2-surface-energy-calculations" title="Link to this heading">#</a></h2>
<section id="id1">
<h3>Introduction<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<p>Surface energy (γ) quantifies the thermodynamic cost of creating a surface. It determines surface stability, morphology, and catalytic activity. We’ll calculate γ for four low-index Ni facets: (111), (100), (110), and (211).</p>
</section>
<section id="id2">
<h3>Theory<a class="headerlink" href="#id2" title="Link to this heading">#</a></h3>
<p>The surface energy is defined as:</p>
<div class="math notranslate nohighlight">
\[
\gamma = \frac{E_{\text{slab}} - N \cdot E_{\text{bulk}}}{2A}
\]</div>
<p>where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(E_{\text{slab}}\)</span> = total energy of the slab</p></li>
<li><p><span class="math notranslate nohighlight">\(N\)</span> = number of atoms in the slab</p></li>
<li><p><span class="math notranslate nohighlight">\(E_{\text{bulk}}\)</span> = bulk energy per atom</p></li>
<li><p><span class="math notranslate nohighlight">\(A\)</span> = surface area</p></li>
<li><p>Factor of 2 accounts for two surfaces (top and bottom)</p></li>
</ul>
<p><strong>Challenge</strong>: Direct calculation suffers from quantum size effects, and if you were doing DFT calculations small numerical errors in the simulation or from the K-point grid sampling can lead to small (but significant) errors in the bulk lattice energy.</p>
<p><strong>Solution</strong>: It is fairly common when calculating surface energies to use the bulk energy from a bulk relaxation in the above equation. However, because DFT often has some small numerical noise in the predictions from k-point convergence, this might lead to the wrong surface energy. Instead, two more careful schemes are either:</p>
<ol class="arabic simple">
<li><p>Calculate the energy of a bulk structure oriented to each slab to maximize cancellation of small numerical errors or</p></li>
<li><p>Calculate the energy of multiple slabs at multiple thicknesses and extrapolate to zero thickness. The intercept will be the surface energy, and the slope will be a fitted bulk energy. A benefit of this approach is that it also forces us to check that we have a sufficiently thick slab for a well defined surface energy; if the fit is non-linear we need thicker slabs.</p></li>
</ol>
<p>We’ll use the linear extrapolation method here as it’s more likely to work in future DFT studies if you use this code!</p>
</section>
<section id="step-1-setup-and-bulk-energy-reference">
<h3>Step 1: Setup and Bulk Energy Reference<a class="headerlink" href="#step-1-setup-and-bulk-energy-reference" title="Link to this heading">#</a></h3>
<p>First, we’ll set up the calculation parameters and get the bulk energy reference:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate surface energies for all facets</span>
<span class="n">facets</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]</span>
<span class="n">surface_energies</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">surface_energies_SI</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">all_fit_data</span> <span class="o">=</span> <span class="p">{}</span>

<span class="c1"># Get bulk energy reference (only need to do this once)</span>
<span class="n">E_bulk_total</span> <span class="o">=</span> <span class="n">ni_bulk</span><span class="o">.</span><span class="n">get_potential_energy</span><span class="p">()</span>
<span class="n">N_bulk</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ni_bulk</span><span class="p">)</span>
<span class="n">E_bulk_per_atom</span> <span class="o">=</span> <span class="n">E_bulk_total</span> <span class="o">/</span> <span class="n">N_bulk</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Bulk energy reference:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Total energy: </span><span class="si">{</span><span class="n">E_bulk_total</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Number of atoms: </span><span class="si">{</span><span class="n">N_bulk</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Energy per atom: </span><span class="si">{</span><span class="n">E_bulk_per_atom</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2"> eV/atom&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Bulk energy reference:
  Total energy: -21.97 eV
  Number of atoms: 4
  Energy per atom: -5.491441 eV/atom
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-2-generate-and-relax-slabs">
<h3>Step 2: Generate and Relax Slabs<a class="headerlink" href="#step-2-generate-and-relax-slabs" title="Link to this heading">#</a></h3>
<p>Now we’ll loop through each facet, generating slabs at three different thicknesses:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Convert bulk to pymatgen structure for slab generation</span>
<span class="n">adaptor</span> <span class="o">=</span> <span class="n">AseAtomsAdaptor</span><span class="p">()</span>
<span class="n">ni_structure</span> <span class="o">=</span> <span class="n">adaptor</span><span class="o">.</span><span class="n">get_structure</span><span class="p">(</span><span class="n">ni_bulk</span><span class="p">)</span>

<span class="k">for</span> <span class="n">facet</span> <span class="ow">in</span> <span class="n">facets</span><span class="p">:</span>
    <span class="n">facet_str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">facet</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="s1">&#39;=&#39;</span><span class="o">*</span><span class="mi">60</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Calculating Ni(</span><span class="si">{</span><span class="n">facet_str</span><span class="si">}</span><span class="s2">) surface energy&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;=&#39;</span><span class="o">*</span><span class="mi">60</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Calculate for three thicknesses</span>
    <span class="n">thicknesses</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">]</span>  <span class="c1"># layers</span>
    <span class="n">n_atoms_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">energies_list</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">n_layers</span> <span class="ow">in</span> <span class="n">thicknesses</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">  Thickness: </span><span class="si">{</span><span class="n">n_layers</span><span class="si">}</span><span class="s2"> layers&quot;</span><span class="p">)</span>

        <span class="c1"># Generate slab</span>
        <span class="n">slabgen</span> <span class="o">=</span> <span class="n">SlabGenerator</span><span class="p">(</span>
            <span class="n">ni_structure</span><span class="p">,</span>
            <span class="n">facet</span><span class="p">,</span>
            <span class="n">min_slab_size</span><span class="o">=</span><span class="n">n_layers</span> <span class="o">*</span> <span class="n">a_opt</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">([</span><span class="n">h</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">facet</span><span class="p">])),</span>
            <span class="n">min_vacuum_size</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span>
            <span class="n">center_slab</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">pmg_slab</span> <span class="o">=</span> <span class="n">slabgen</span><span class="o">.</span><span class="n">get_slabs</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">slab</span> <span class="o">=</span> <span class="n">adaptor</span><span class="o">.</span><span class="n">get_atoms</span><span class="p">(</span><span class="n">pmg_slab</span><span class="p">)</span>
        <span class="n">slab</span><span class="o">.</span><span class="n">center</span><span class="p">(</span><span class="n">vacuum</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    Atoms: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">slab</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># Relax slab (no constraints - both surfaces free)</span>
        <span class="n">calc</span> <span class="o">=</span> <span class="n">FAIRChemCalculator</span><span class="p">(</span><span class="n">predictor</span><span class="p">,</span> <span class="n">task_name</span><span class="o">=</span><span class="s2">&quot;omat&quot;</span><span class="p">)</span>
        <span class="n">slab</span><span class="o">.</span><span class="n">calc</span> <span class="o">=</span> <span class="n">calc</span>
        <span class="n">opt</span> <span class="o">=</span> <span class="n">LBFGS</span><span class="p">(</span><span class="n">slab</span><span class="p">,</span> <span class="n">logfile</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
        <span class="n">opt</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">fmax</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="n">relaxation_steps</span><span class="p">)</span>

        <span class="n">E_slab</span> <span class="o">=</span> <span class="n">slab</span><span class="o">.</span><span class="n">get_potential_energy</span><span class="p">()</span>
        <span class="n">n_atoms_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">slab</span><span class="p">))</span>
        <span class="n">energies_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_slab</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    Energy: </span><span class="si">{</span><span class="n">E_slab</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>

    <span class="c1"># Linear regression: E_slab = slope * N + intercept</span>
    <span class="n">coeffs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">n_atoms_list</span><span class="p">,</span> <span class="n">energies_list</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">slope</span> <span class="o">=</span> <span class="n">coeffs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">intercept</span> <span class="o">=</span> <span class="n">coeffs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="c1"># Extract surface energy from intercept</span>
    <span class="n">cell</span> <span class="o">=</span> <span class="n">slab</span><span class="o">.</span><span class="n">get_cell</span><span class="p">()</span>
    <span class="n">area</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">cell</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cell</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
    <span class="n">gamma</span> <span class="o">=</span> <span class="n">intercept</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">area</span><span class="p">)</span>  <span class="c1"># eV/Å²</span>
    <span class="n">gamma_SI</span> <span class="o">=</span> <span class="n">gamma</span> <span class="o">*</span> <span class="mf">16.0218</span>  <span class="c1"># J/m²</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">  Linear fit:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    Slope:     </span><span class="si">{</span><span class="n">slope</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2"> eV/atom (cf. bulk </span><span class="si">{</span><span class="n">E_bulk_per_atom</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    Intercept: </span><span class="si">{</span><span class="n">intercept</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">  Surface energy:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    γ = </span><span class="si">{</span><span class="n">gamma</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2"> eV/Å² = </span><span class="si">{</span><span class="n">gamma_SI</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> J/m²&quot;</span><span class="p">)</span>

    <span class="c1"># Store results and fit data</span>
    <span class="n">surface_energies</span><span class="p">[</span><span class="n">facet</span><span class="p">]</span> <span class="o">=</span> <span class="n">gamma</span>
    <span class="n">surface_energies_SI</span><span class="p">[</span><span class="n">facet</span><span class="p">]</span> <span class="o">=</span> <span class="n">gamma_SI</span>
    <span class="n">all_fit_data</span><span class="p">[</span><span class="n">facet</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;n_atoms&quot;</span><span class="p">:</span> <span class="n">n_atoms_list</span><span class="p">,</span>
        <span class="s2">&quot;energies&quot;</span><span class="p">:</span> <span class="n">energies_list</span><span class="p">,</span>
        <span class="s2">&quot;slope&quot;</span><span class="p">:</span> <span class="n">slope</span><span class="p">,</span>
        <span class="s2">&quot;intercept&quot;</span><span class="p">:</span> <span class="n">intercept</span><span class="p">,</span>
    <span class="p">}</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>============================================================
Calculating Ni(111) surface energy
============================================================

  Thickness: 4 layers
    Atoms: 4
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Energy: -20.69 eV

  Thickness: 6 layers
    Atoms: 6
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Energy: -31.67 eV

  Thickness: 8 layers
    Atoms: 8
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Energy: -42.66 eV

  Linear fit:
    Slope:     -5.492960 eV/atom (cf. bulk -5.491441)
    Intercept: 1.28 eV

  Surface energy:
    γ = 0.120067 eV/Å² = 1.92 J/m²

============================================================
Calculating Ni(100) surface energy
============================================================

  Thickness: 4 layers
    Atoms: 8
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Energy: -42.16 eV

  Thickness: 6 layers
    Atoms: 12
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Energy: -64.12 eV

  Thickness: 8 layers
    Atoms: 16
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Energy: -86.09 eV

  Linear fit:
    Slope:     -5.491520 eV/atom (cf. bulk -5.491441)
    Intercept: 1.78 eV

  Surface energy:
    γ = 0.143730 eV/Å² = 2.30 J/m²

============================================================
Calculating Ni(110) surface energy
============================================================

  Thickness: 4 layers
    Atoms: 8
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Energy: -41.36 eV

  Thickness: 6 layers
    Atoms: 12
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Energy: -63.34 eV

  Thickness: 8 layers
    Atoms: 16
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Energy: -85.30 eV

  Linear fit:
    Slope:     -5.492427 eV/atom (cf. bulk -5.491441)
    Intercept: 2.57 eV

  Surface energy:
    γ = 0.147336 eV/Å² = 2.36 J/m²

============================================================
Calculating Ni(211) surface energy
============================================================

  Thickness: 4 layers
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Atoms: 8
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Energy: -39.69 eV

  Thickness: 6 layers
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Atoms: 12
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Energy: -61.61 eV

  Thickness: 8 layers
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Atoms: 16
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Energy: -83.58 eV

  Linear fit:
    Slope:     -5.485733 eV/atom (cf. bulk -5.491441)
    Intercept: 4.20 eV

  Surface energy:
    γ = 0.138877 eV/Å² = 2.23 J/m²
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-3-visualize-linear-fits">
<h3>Step 3: Visualize Linear Fits<a class="headerlink" href="#step-3-visualize-linear-fits" title="Link to this heading">#</a></h3>
<p>Let’s visualize the linear extrapolation for all four facets:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Visualize linear fits for all facets</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">axes</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>

<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">facet</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">facets</span><span class="p">):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">all_fit_data</span><span class="p">[</span><span class="n">facet</span><span class="p">]</span>

    <span class="c1"># Plot data points</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
        <span class="n">data</span><span class="p">[</span><span class="s2">&quot;n_atoms&quot;</span><span class="p">],</span>
        <span class="n">data</span><span class="p">[</span><span class="s2">&quot;energies&quot;</span><span class="p">],</span>
        <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;steelblue&quot;</span><span class="p">,</span>
        <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
        <span class="n">zorder</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Calculated&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># Plot fit line</span>
    <span class="n">n_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;n_atoms&quot;</span><span class="p">])</span> <span class="o">-</span> <span class="mi">5</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;n_atoms&quot;</span><span class="p">])</span> <span class="o">+</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
    <span class="n">E_fit</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;slope&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">n_range</span> <span class="o">+</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;intercept&quot;</span><span class="p">]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">n_range</span><span class="p">,</span>
        <span class="n">E_fit</span><span class="p">,</span>
        <span class="s2">&quot;r--&quot;</span><span class="p">,</span>
        <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Fit: </span><span class="si">{</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;slope&quot;</span><span class="p">]</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">N + </span><span class="si">{</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;intercept&quot;</span><span class="p">]</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># Formatting</span>
    <span class="n">facet_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Ni(</span><span class="si">{</span><span class="n">facet</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}{</span><span class="n">facet</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}{</span><span class="n">facet</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">}</span><span class="s2">)&quot;</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Number of Atoms&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Slab Energy (eV)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">facet_str</span><span class="si">}</span><span class="s2">: γ = </span><span class="si">{</span><span class="n">surface_energies_SI</span><span class="p">[</span><span class="n">facet</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> J/m²&quot;</span><span class="p">,</span>
        <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
        <span class="n">fontweight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span>
    <span class="nb">str</span><span class="p">(</span><span class="n">output_dir</span> <span class="o">/</span> <span class="n">part_dirs</span><span class="p">[</span><span class="s2">&quot;part2&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="s2">&quot;surface_energy_fits.png&quot;</span><span class="p">),</span>
    <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span>
    <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/c5baec690c11f2d05e43d5c52eb92e19f70b9c6a6b5f7a7e859ff6f47d9f0dcf.png" src="../_images/c5baec690c11f2d05e43d5c52eb92e19f70b9c6a6b5f7a7e859ff6f47d9f0dcf.png" />
</div>
</div>
</section>
<section id="step-4-compare-with-literature">
<h3>Step 4: Compare with Literature<a class="headerlink" href="#step-4-compare-with-literature" title="Link to this heading">#</a></h3>
<p>Finally, let’s compare our calculated surface energies with DFT literature values:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="s1">&#39;=&#39;</span><span class="o">*</span><span class="mi">70</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Comparison with DFT Literature (Tran et al., 2016)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;=&#39;</span><span class="o">*</span><span class="mi">70</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">lit_values</span> <span class="o">=</span> <span class="p">{</span>
    <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span> <span class="mf">1.92</span><span class="p">,</span>
    <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span> <span class="mf">2.21</span><span class="p">,</span>
    <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span> <span class="mf">2.29</span><span class="p">,</span>
    <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span> <span class="mf">2.24</span><span class="p">,</span>
<span class="p">}</span>  <span class="c1"># J/m²</span>

<span class="k">for</span> <span class="n">facet</span> <span class="ow">in</span> <span class="n">facets</span><span class="p">:</span>
    <span class="n">facet_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Ni(</span><span class="si">{</span><span class="n">facet</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}{</span><span class="n">facet</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}{</span><span class="n">facet</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">}</span><span class="s2">)&quot;</span>
    <span class="n">calc</span> <span class="o">=</span> <span class="n">surface_energies_SI</span><span class="p">[</span><span class="n">facet</span><span class="p">]</span>
    <span class="n">lit</span> <span class="o">=</span> <span class="n">lit_values</span><span class="p">[</span><span class="n">facet</span><span class="p">]</span>
    <span class="n">diff</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">calc</span> <span class="o">-</span> <span class="n">lit</span><span class="p">)</span> <span class="o">/</span> <span class="n">lit</span> <span class="o">*</span> <span class="mi">100</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">facet_str</span><span class="si">:</span><span class="s2">&lt;10</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">calc</span><span class="si">:</span><span class="s2">&gt;8.2f</span><span class="si">}</span><span class="s2"> J/m²  (Lit: </span><span class="si">{</span><span class="n">lit</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, Δ=</span><span class="si">{</span><span class="n">diff</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">%)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>======================================================================
Comparison with DFT Literature (Tran et al., 2016)
======================================================================
Ni(111)        1.92 J/m²  (Lit: 1.92, Δ=0.2%)
Ni(100)        2.30 J/m²  (Lit: 2.21, Δ=4.2%)
Ni(110)        2.36 J/m²  (Lit: 2.29, Δ=3.1%)
Ni(211)        2.23 J/m²  (Lit: 2.24, Δ=0.7%)
</pre></div>
</div>
</div>
</div>
<div class="dropdown tip admonition">
<p class="admonition-title">Missing UMA access?</p>
<p>Don’t have access to UMA yet? You can still explore this calculation!</p>
<p><a class="reference internal" href="#example_configs/ni111_slab.xyz"><span class="xref myst">Download example Ni(111) slab structure</span></a> and test it in the <a class="reference external" href="https://facebook-fairchem-uma-demo.hf.space/">UMA demo (no login required)</a> to see how the model predicts energies for Ni surfaces.</p>
</div>
<div class="note admonition">
<p class="admonition-title">Comparison with Paper (Table 1)</p>
<p><strong>Paper Results (PBE-DFT, Tran et al.):</strong></p>
<ul class="simple">
<li><p>Ni(111): 1.92 J/m²</p></li>
<li><p>Ni(100): 2.21 J/m²</p></li>
<li><p>Ni(110): 2.29 J/m²</p></li>
<li><p>Ni(211): 2.24 J/m²</p></li>
</ul>
<p><strong>Key Observations:</strong></p>
<ol class="arabic simple">
<li><p><strong>Energy ordering preserved</strong>: (111) &lt; (100) &lt; (110) ≈ (211), matching DFT</p></li>
<li><p><strong>Absolute errors</strong>: Typically 10-20%, within expected range for ML potentials</p></li>
<li><p><strong>(111) most stable</strong>: Both methods agree this is the lowest energy surface</p></li>
<li><p><strong>Physical trend correct</strong>: Close-packed surfaces have lower energy</p></li>
</ol>
<p><strong>Why differences exist:</strong></p>
<ul class="simple">
<li><p>Training data biases in ML model, which has seen mostly periodic bulk structures, not surfaces.</p></li>
<li><p>Slab thickness effects (even with extrapolation)</p></li>
<li><p>Lack of explicit spin polarization in ML model. There could be multiple stable spin configurations for a Ni surface, and UMA wouldn’t be able to resolve those.</p></li>
</ul>
<p><strong>Caveat</strong>
Both methods here use PBE as the underlying functional in DFT. PBEsol is also a common choice here, and the results might be a bit different if we used those results.</p>
<p><strong>Bottom line</strong>: Surface energy <em>ordering</em> is more reliable than absolute values. Use ML for screening, validate critical cases with DFT.</p>
</div>
<div class="note admonition">
<p class="admonition-title">Why Linear Extrapolation?</p>
<p>Single-thickness slabs suffer from:</p>
<ul class="simple">
<li><p><strong>Quantum confinement</strong>: Electronic structure depends on slab thickness</p></li>
<li><p><strong>Surface-surface interactions</strong>: Bottom and top surfaces couple at small thicknesses</p></li>
<li><p><strong>Relaxation artifacts</strong>: Atoms at center may not reach bulk-like coordination</p></li>
</ul>
<p>Linear extrapolation eliminates these by fitting <span class="math notranslate nohighlight">\(E_{\text{slab}}(N)\)</span> and extracting the asymptotic surface energy.</p>
</div>
</section>
<section id="explore-on-your-own">
<h3>Explore on Your Own<a class="headerlink" href="#explore-on-your-own" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p><strong>Thickness convergence</strong>: Add 10 and 12 layer calculations. Is the linear fit still valid?</p></li>
<li><p><strong>Constraint effects</strong>: Fix the bottom 2 layers during relaxation. How does this affect γ?</p></li>
<li><p><strong>Vacuum size</strong>: Vary <code class="docutils literal notranslate"><span class="pre">min_vacuum_size</span></code> from 8 to 15 Å. When does γ converge?</p></li>
<li><p><strong>High-index facets</strong>: Try (311) or (331) surfaces. Are they more or less stable?</p></li>
<li><p><strong>Alternative fitting</strong>: Use polynomial (degree 2) instead of linear fit. Does the intercept change?</p></li>
</ol>
</section>
</section>
<hr class="docutils" />
<section id="part-3-wulff-construction">
<h2>Part 3: Wulff Construction<a class="headerlink" href="#part-3-wulff-construction" title="Link to this heading">#</a></h2>
<section id="id3">
<h3>Introduction<a class="headerlink" href="#id3" title="Link to this heading">#</a></h3>
<p>The <strong>Wulff construction</strong> predicts the equilibrium shape of a crystalline particle by minimizing total surface energy. This determines the morphology of supported catalyst nanoparticles.</p>
</section>
<section id="id4">
<h3>Theory<a class="headerlink" href="#id4" title="Link to this heading">#</a></h3>
<p>The Wulff theorem states that at equilibrium, the distance from the particle center to a facet is proportional to its surface energy:</p>
<div class="math notranslate nohighlight">
\[
\frac{h_i}{\gamma_i} = \text{constant}
\]</div>
<p>Facets with lower surface energy have larger areas in the equilibrium shape.</p>
</section>
<section id="step-1-prepare-surface-energies">
<h3>Step 1: Prepare Surface Energies<a class="headerlink" href="#step-1-prepare-surface-energies" title="Link to this heading">#</a></h3>
<p>We’ll use the surface energies calculated in Part 2 to construct the Wulff shape:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Constructing Wulff Shape&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">50</span><span class="p">)</span>

<span class="c1"># Use optimized bulk structure</span>
<span class="n">adaptor</span> <span class="o">=</span> <span class="n">AseAtomsAdaptor</span><span class="p">()</span>
<span class="n">ni_structure</span> <span class="o">=</span> <span class="n">adaptor</span><span class="o">.</span><span class="n">get_structure</span><span class="p">(</span><span class="n">ni_bulk</span><span class="p">)</span>

<span class="n">miller_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">surface_energies_SI</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="n">energy_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">surface_energies_SI</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">miller_list</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Using </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">miller_list</span><span class="p">)</span><span class="si">}</span><span class="s2"> facets:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">miller</span><span class="p">,</span> <span class="n">energy</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">miller_list</span><span class="p">,</span> <span class="n">energy_list</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">miller</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">energy</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> J/m²&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Constructing Wulff Shape
==================================================
Using 4 facets:
  (1, 1, 1): 1.92 J/m²
  (1, 0, 0): 2.30 J/m²
  (1, 1, 0): 2.36 J/m²
  (2, 1, 1): 2.23 J/m²
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-2-generate-wulff-construction">
<h3>Step 2: Generate Wulff Construction<a class="headerlink" href="#step-2-generate-wulff-construction" title="Link to this heading">#</a></h3>
<p>Now we create the Wulff shape and analyze its properties:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create Wulff shape</span>
<span class="n">wulff</span> <span class="o">=</span> <span class="n">WulffShape</span><span class="p">(</span><span class="n">ni_structure</span><span class="o">.</span><span class="n">lattice</span><span class="p">,</span> <span class="n">miller_list</span><span class="p">,</span> <span class="n">energy_list</span><span class="p">)</span>

<span class="c1"># Print properties</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Wulff Shape Properties:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Volume:          </span><span class="si">{</span><span class="n">wulff</span><span class="o">.</span><span class="n">volume</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Å³&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Surface area:    </span><span class="si">{</span><span class="n">wulff</span><span class="o">.</span><span class="n">surface_area</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Å²&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Effective radius: </span><span class="si">{</span><span class="n">wulff</span><span class="o">.</span><span class="n">effective_radius</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Å&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Weighted γ:      </span><span class="si">{</span><span class="n">wulff</span><span class="o">.</span><span class="n">weighted_surface_energy</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> J/m²&quot;</span><span class="p">)</span>

<span class="c1"># Area fractions</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Facet Area Fractions:&quot;</span><span class="p">)</span>
<span class="n">area_frac</span> <span class="o">=</span> <span class="n">wulff</span><span class="o">.</span><span class="n">area_fraction_dict</span>
<span class="k">for</span> <span class="n">hkl</span><span class="p">,</span> <span class="n">frac</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">area_frac</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">hkl</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">frac</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Wulff Shape Properties:
  Volume:          44.54 Å³
  Surface area:    66.03 Å²
  Effective radius: 2.20 Å
  Weighted γ:      2.02 J/m²

Facet Area Fractions:
  (1, 1, 1): 70.1%
  (2, 1, 1): 16.9%
  (1, 0, 0): 13.0%
  (1, 1, 0): 0.0%
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-3-visualize-and-compare">
<h3>Step 3: Visualize and Compare<a class="headerlink" href="#step-3-visualize-and-compare" title="Link to this heading">#</a></h3>
<p>Let’s visualize the Wulff shape and compare with literature:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Visualize</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">wulff</span><span class="o">.</span><span class="n">get_plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Wulff Construction: Ni Nanoparticle&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span>
    <span class="nb">str</span><span class="p">(</span><span class="n">output_dir</span> <span class="o">/</span> <span class="n">part_dirs</span><span class="p">[</span><span class="s2">&quot;part3&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="s2">&quot;wulff_shape.png&quot;</span><span class="p">),</span>
    <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span>
    <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Compare with paper</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Comparison with Paper (Table 2):&quot;</span><span class="p">)</span>
<span class="n">paper_fractions</span> <span class="o">=</span> <span class="p">{(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span> <span class="mf">69.23</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span> <span class="mf">21.10</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span> <span class="mf">5.28</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span> <span class="mf">4.39</span><span class="p">}</span>
<span class="k">for</span> <span class="n">hkl</span> <span class="ow">in</span> <span class="n">miller_list</span><span class="p">:</span>
    <span class="n">calc_frac</span> <span class="o">=</span> <span class="n">area_frac</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">hkl</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
    <span class="n">paper_frac</span> <span class="o">=</span> <span class="n">paper_fractions</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">hkl</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">hkl</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">calc_frac</span><span class="si">:</span><span class="s2">&gt;6.1f</span><span class="si">}</span><span class="s2">% (Paper: </span><span class="si">{</span><span class="n">paper_frac</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">%)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/39a2add292971f0815207c23c71c7292d2888a295eda1eb798ace8cc712b592d.png" src="../_images/39a2add292971f0815207c23c71c7292d2888a295eda1eb798ace8cc712b592d.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Comparison with Paper (Table 2):
  (1, 1, 1):   70.1% (Paper: 69.2%)
  (1, 0, 0):   13.0% (Paper: 21.1%)
  (1, 1, 0):    0.0% (Paper: 5.3%)
  (2, 1, 1):   16.9% (Paper: 4.4%)
</pre></div>
</div>
</div>
</div>
<div class="note admonition">
<p class="admonition-title">Comparison with Paper (Table 2)</p>
<p><strong>Paper Results (Wulff Construction):</strong></p>
<ul class="simple">
<li><p>Ni(111): 69.23% of surface area</p></li>
<li><p>Ni(100): 21.10%</p></li>
<li><p>Ni(110): 5.28%</p></li>
<li><p>Ni(211): 4.39%</p></li>
</ul>
<p><strong>Key Findings:</strong></p>
<ol class="arabic simple">
<li><p><strong>(111) dominance</strong>: Both ML and DFT show &gt;65% of surface is (111) facets</p></li>
<li><p><strong>Shape prediction</strong>: Truncated octahedron with primarily {111} and {100} faces</p></li>
<li><p><strong>Minor facets</strong>: (110) and (211) have small contributions (&lt;10%)</p></li>
<li><p><strong>Agreement</strong>: Area fraction ordering matches perfectly with paper</p></li>
</ol>
<p><strong>Physical interpretation:</strong></p>
<ul class="simple">
<li><p>Real Ni nanoparticles are (111)-terminated octahedra</p></li>
<li><p>(100) facets appear at corners/edges as truncations</p></li>
<li><p>This morphology is confirmed experimentally by TEM</p></li>
<li><p>Explains why (111) surface chemistry dominates catalysis</p></li>
</ul>
<p><strong>Impact on catalysis:</strong></p>
<ul class="simple">
<li><p>Must study (111) surface for representative results</p></li>
<li><p>(100) sites may be important for minority reaction pathways</p></li>
<li><p>Edge/corner sites (not captured here) can be highly active</p></li>
</ul>
</div>
<div class="note admonition">
<p class="admonition-title">Physical Interpretation</p>
<p>The Wulff shape shows:</p>
<ul class="simple">
<li><p><strong>(111) dominance</strong>: Close-packed surface has lowest energy → largest area</p></li>
<li><p><strong>(100) presence</strong>: Moderate energy → significant area fraction</p></li>
<li><p><strong>(110), (211) minor</strong>: Higher energy → small or absent</p></li>
</ul>
<p>This predicts that Ni nanoparticles will be predominantly {111}-faceted octahedra with {100} truncations, matching experimental observations.</p>
</div>
</section>
<section id="id5">
<h3>Explore on Your Own<a class="headerlink" href="#id5" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p><strong>Particle size effects</strong>: How would including edge/corner energies modify the shape?</p></li>
<li><p><strong>Anisotropic strain</strong>: Apply 2% compressive strain to the lattice. How does the shape change?</p></li>
<li><p><strong>Temperature effects</strong>: Surface energies decrease with T. Estimate γ(T) and recompute Wulff shape.</p></li>
<li><p><strong>Alloy nanoparticles</strong>: Replace some Ni with Cu or Au. How would segregation affect the shape?</p></li>
<li><p><strong>Support effects</strong>: Some facets interact more strongly with supports. Model this by reducing their γ.</p></li>
</ol>
</section>
</section>
<hr class="docutils" />
<section id="part-4-h-adsorption-energy-with-zpe-correction">
<h2>Part 4: H Adsorption Energy with ZPE Correction<a class="headerlink" href="#part-4-h-adsorption-energy-with-zpe-correction" title="Link to this heading">#</a></h2>
<section id="id6">
<h3>Introduction<a class="headerlink" href="#id6" title="Link to this heading">#</a></h3>
<p>Hydrogen adsorption is a fundamental step in many catalytic reactions (hydrogenation, dehydrogenation, etc.). We’ll calculate the binding energy with vibrational zero-point energy (ZPE) corrections.</p>
</section>
<section id="id7">
<h3>Theory<a class="headerlink" href="#id7" title="Link to this heading">#</a></h3>
<p>The adsorption energy is:</p>
<div class="math notranslate nohighlight">
\[
E_{\text{ads}} = E(\text{slab+H}) - E(\text{slab}) - \frac{1}{2}E(\text{H}_2)
\]</div>
<p>ZPE correction accounts for quantum vibrational effects:</p>
<div class="math notranslate nohighlight">
\[
E_{\text{ads}}^{\text{ZPE}} = E_{\text{ads}} + \text{ZPE}(\text{H}^*) - \frac{1}{2}\text{ZPE}(\text{H}_2)
\]</div>
<p>The ZPE correction is calculated by analyzing the vibrational modes of the molecule/adsorbate.</p>
</section>
<section id="step-1-setup-and-relax-clean-slab">
<h3>Step 1: Setup and Relax Clean Slab<a class="headerlink" href="#step-1-setup-and-relax-clean-slab" title="Link to this heading">#</a></h3>
<p>First, we create the Ni(111) surface and relax it:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create Ni(111) slab</span>
<span class="n">ni_bulk_atoms</span> <span class="o">=</span> <span class="n">bulk</span><span class="p">(</span><span class="s2">&quot;Ni&quot;</span><span class="p">,</span> <span class="s2">&quot;fcc&quot;</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="n">a_opt</span><span class="p">,</span> <span class="n">cubic</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ni_bulk_obj</span> <span class="o">=</span> <span class="n">Bulk</span><span class="p">(</span><span class="n">bulk_atoms</span><span class="o">=</span><span class="n">ni_bulk_atoms</span><span class="p">)</span>
<span class="n">ni_slabs</span> <span class="o">=</span> <span class="n">Slab</span><span class="o">.</span><span class="n">from_bulk_get_specific_millers</span><span class="p">(</span>
    <span class="n">bulk</span><span class="o">=</span><span class="n">ni_bulk_obj</span><span class="p">,</span> <span class="n">specific_millers</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">ni_slab</span> <span class="o">=</span> <span class="n">ni_slabs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">atoms</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   Created </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">ni_slab</span><span class="p">)</span><span class="si">}</span><span class="s2"> atom slab&quot;</span><span class="p">)</span>

<span class="c1"># Set up calculators</span>
<span class="n">calc</span> <span class="o">=</span> <span class="n">FAIRChemCalculator</span><span class="p">(</span><span class="n">predictor</span><span class="p">,</span> <span class="n">task_name</span><span class="o">=</span><span class="s2">&quot;oc20&quot;</span><span class="p">)</span>
<span class="n">d3_calc</span> <span class="o">=</span> <span class="n">TorchDFTD3Calculator</span><span class="p">(</span><span class="n">device</span><span class="o">=</span><span class="s2">&quot;cpu&quot;</span><span class="p">,</span> <span class="n">damping</span><span class="o">=</span><span class="s2">&quot;bj&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   Calculators initialized (ML + D3)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   Created 96 atom slab
   Calculators initialized (ML + D3)
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-2-relax-clean-slab">
<h3>Step 2: Relax Clean Slab<a class="headerlink" href="#step-2-relax-clean-slab" title="Link to this heading">#</a></h3>
<p>Relax the bare Ni(111) surface as our reference:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">1. Relaxing clean Ni(111) slab...&quot;</span><span class="p">)</span>
<span class="n">clean_slab</span> <span class="o">=</span> <span class="n">ni_slab</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">clean_slab</span><span class="o">.</span><span class="n">set_pbc</span><span class="p">([</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">])</span>
<span class="n">clean_slab</span><span class="o">.</span><span class="n">calc</span> <span class="o">=</span> <span class="n">calc</span>

<span class="n">opt</span> <span class="o">=</span> <span class="n">LBFGS</span><span class="p">(</span>
    <span class="n">clean_slab</span><span class="p">,</span>
    <span class="n">trajectory</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">output_dir</span> <span class="o">/</span> <span class="n">part_dirs</span><span class="p">[</span><span class="s2">&quot;part4&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="s2">&quot;ni111_clean.traj&quot;</span><span class="p">),</span>
    <span class="n">logfile</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">output_dir</span> <span class="o">/</span> <span class="n">part_dirs</span><span class="p">[</span><span class="s2">&quot;part4&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="s2">&quot;ni111_clean.log&quot;</span><span class="p">),</span>
<span class="p">)</span>
<span class="n">opt</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">fmax</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="n">relaxation_steps</span><span class="p">)</span>

<span class="n">E_clean_ml</span> <span class="o">=</span> <span class="n">clean_slab</span><span class="o">.</span><span class="n">get_potential_energy</span><span class="p">()</span>
<span class="n">clean_slab</span><span class="o">.</span><span class="n">calc</span> <span class="o">=</span> <span class="n">d3_calc</span>
<span class="n">E_clean_d3</span> <span class="o">=</span> <span class="n">clean_slab</span><span class="o">.</span><span class="n">get_potential_energy</span><span class="p">()</span>
<span class="n">E_clean</span> <span class="o">=</span> <span class="n">E_clean_ml</span> <span class="o">+</span> <span class="n">E_clean_d3</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   E(clean): </span><span class="si">{</span><span class="n">E_clean</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV (ML: </span><span class="si">{</span><span class="n">E_clean_ml</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, D3: </span><span class="si">{</span><span class="n">E_clean_d3</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

<span class="c1"># Save clean slab</span>
<span class="n">ase</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">output_dir</span> <span class="o">/</span> <span class="n">part_dirs</span><span class="p">[</span><span class="s2">&quot;part4&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="s2">&quot;ni111_clean.xyz&quot;</span><span class="p">),</span> <span class="n">clean_slab</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   ✓ Clean slab relaxed and saved&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1. Relaxing clean Ni(111) slab...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/runner/work/_tool/Python/3.12.12/x64/lib/python3.12/site-packages/torch_dftd/torch_dftd3_calculator.py:98: UserWarning: Creating a tensor from a list of numpy.ndarrays is extremely slow. Please consider converting the list to a single numpy.ndarray with numpy.array() before converting to a tensor. (Triggered internally at /pytorch/torch/csrc/utils/tensor_new.cpp:253.)
  cell: Optional[Tensor] = torch.tensor(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   E(clean): -487.46 eV (ML: -450.89, D3: -36.57)
   ✓ Clean slab relaxed and saved
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-3-generate-h-adsorption-sites">
<h3>Step 3: Generate H Adsorption Sites<a class="headerlink" href="#step-3-generate-h-adsorption-sites" title="Link to this heading">#</a></h3>
<p>Use heuristic placement to generate multiple candidate H adsorption sites:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">2. Generating 5 H adsorption sites...&quot;</span><span class="p">)</span>
<span class="n">ni_slab_for_ads</span> <span class="o">=</span> <span class="n">ni_slabs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">ni_slab_for_ads</span><span class="o">.</span><span class="n">atoms</span> <span class="o">=</span> <span class="n">clean_slab</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="n">adsorbate_h</span> <span class="o">=</span> <span class="n">Adsorbate</span><span class="p">(</span><span class="n">adsorbate_smiles_from_db</span><span class="o">=</span><span class="s2">&quot;*H&quot;</span><span class="p">)</span>
<span class="n">ads_slab_config</span> <span class="o">=</span> <span class="n">AdsorbateSlabConfig</span><span class="p">(</span>
    <span class="n">ni_slab_for_ads</span><span class="p">,</span>
    <span class="n">adsorbate_h</span><span class="p">,</span>
    <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;random_site_heuristic_placement&quot;</span><span class="p">,</span>
    <span class="n">num_sites</span><span class="o">=</span><span class="n">num_sites</span><span class="p">,</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   Generated </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">ads_slab_config</span><span class="o">.</span><span class="n">atoms_list</span><span class="p">)</span><span class="si">}</span><span class="s2"> initial configurations&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   These include fcc, hcp, bridge, and top sites&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2. Generating 5 H adsorption sites...
   Generated 2 initial configurations
   These include fcc, hcp, bridge, and top sites
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-4-relax-all-h-configurations">
<h3>Step 4: Relax All H Configurations<a class="headerlink" href="#step-4-relax-all-h-configurations" title="Link to this heading">#</a></h3>
<p>Relax each configuration and identify the most stable site:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">3. Relaxing all H adsorption configurations...&quot;</span><span class="p">)</span>
<span class="n">h_energies</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">h_configs</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">h_d3_energies</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">config</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ads_slab_config</span><span class="o">.</span><span class="n">atoms_list</span><span class="p">):</span>
    <span class="n">config_relaxed</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">config_relaxed</span><span class="o">.</span><span class="n">set_pbc</span><span class="p">([</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">])</span>
    <span class="n">config_relaxed</span><span class="o">.</span><span class="n">calc</span> <span class="o">=</span> <span class="n">calc</span>

    <span class="n">opt</span> <span class="o">=</span> <span class="n">LBFGS</span><span class="p">(</span>
        <span class="n">config_relaxed</span><span class="p">,</span>
        <span class="n">trajectory</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">output_dir</span> <span class="o">/</span> <span class="n">part_dirs</span><span class="p">[</span><span class="s2">&quot;part4&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;h_site_</span><span class="si">{</span><span class="n">idx</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">.traj&quot;</span><span class="p">),</span>
        <span class="n">logfile</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">output_dir</span> <span class="o">/</span> <span class="n">part_dirs</span><span class="p">[</span><span class="s2">&quot;part4&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;h_site_</span><span class="si">{</span><span class="n">idx</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">.log&quot;</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="n">opt</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">fmax</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="n">relaxation_steps</span><span class="p">)</span>

    <span class="n">E_ml</span> <span class="o">=</span> <span class="n">config_relaxed</span><span class="o">.</span><span class="n">get_potential_energy</span><span class="p">()</span>
    <span class="n">config_relaxed</span><span class="o">.</span><span class="n">calc</span> <span class="o">=</span> <span class="n">d3_calc</span>
    <span class="n">E_d3</span> <span class="o">=</span> <span class="n">config_relaxed</span><span class="o">.</span><span class="n">get_potential_energy</span><span class="p">()</span>
    <span class="n">E_total</span> <span class="o">=</span> <span class="n">E_ml</span> <span class="o">+</span> <span class="n">E_d3</span>

    <span class="n">h_energies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_total</span><span class="p">)</span>
    <span class="n">h_configs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">config_relaxed</span><span class="p">)</span>
    <span class="n">h_d3_energies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_d3</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   Config </span><span class="si">{</span><span class="n">idx</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">E_total</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV (ML: </span><span class="si">{</span><span class="n">E_ml</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, D3: </span><span class="si">{</span><span class="n">E_d3</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

    <span class="c1"># Save structure</span>
    <span class="n">ase</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
        <span class="nb">str</span><span class="p">(</span><span class="n">output_dir</span> <span class="o">/</span> <span class="n">part_dirs</span><span class="p">[</span><span class="s2">&quot;part4&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;h_site_</span><span class="si">{</span><span class="n">idx</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">.xyz&quot;</span><span class="p">),</span> <span class="n">config_relaxed</span>
    <span class="p">)</span>

<span class="c1"># Select best configuration</span>
<span class="n">best_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">h_energies</span><span class="p">)</span>
<span class="n">slab_with_h</span> <span class="o">=</span> <span class="n">h_configs</span><span class="p">[</span><span class="n">best_idx</span><span class="p">]</span>
<span class="n">E_with_h</span> <span class="o">=</span> <span class="n">h_energies</span><span class="p">[</span><span class="n">best_idx</span><span class="p">]</span>
<span class="n">E_with_h_d3</span> <span class="o">=</span> <span class="n">h_d3_energies</span><span class="p">[</span><span class="n">best_idx</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   ✓ Best site: Config </span><span class="si">{</span><span class="n">best_idx</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">, E = </span><span class="si">{</span><span class="n">E_with_h</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   Energy spread: </span><span class="si">{</span><span class="nb">max</span><span class="p">(</span><span class="n">h_energies</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nb">min</span><span class="p">(</span><span class="n">h_energies</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   This spread indicates the importance of testing multiple sites!&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3. Relaxing all H adsorption configurations...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   Config 1: -491.51 eV (ML: -454.86, D3: -36.65)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   Config 2: -491.53 eV (ML: -454.87, D3: -36.65)

   ✓ Best site: Config 2, E = -491.53 eV
   Energy spread: 0.01 eV
   This spread indicates the importance of testing multiple sites!
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-5-calculate-h2-reference-energy">
<h3>Step 5: Calculate H₂ Reference Energy<a class="headerlink" href="#step-5-calculate-h2-reference-energy" title="Link to this heading">#</a></h3>
<p>We need the H₂ molecule energy as a reference:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">4. Calculating H₂ reference energy...&quot;</span><span class="p">)</span>
<span class="n">h2</span> <span class="o">=</span> <span class="n">Atoms</span><span class="p">(</span><span class="s2">&quot;H2&quot;</span><span class="p">,</span> <span class="n">positions</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.74</span><span class="p">]])</span>
<span class="n">h2</span><span class="o">.</span><span class="n">center</span><span class="p">(</span><span class="n">vacuum</span><span class="o">=</span><span class="mf">10.0</span><span class="p">)</span>
<span class="n">h2</span><span class="o">.</span><span class="n">set_pbc</span><span class="p">([</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">])</span>
<span class="n">h2</span><span class="o">.</span><span class="n">calc</span> <span class="o">=</span> <span class="n">calc</span>

<span class="n">opt</span> <span class="o">=</span> <span class="n">LBFGS</span><span class="p">(</span>
    <span class="n">h2</span><span class="p">,</span>
    <span class="n">trajectory</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">output_dir</span> <span class="o">/</span> <span class="n">part_dirs</span><span class="p">[</span><span class="s2">&quot;part4&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="s2">&quot;h2.traj&quot;</span><span class="p">),</span>
    <span class="n">logfile</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">output_dir</span> <span class="o">/</span> <span class="n">part_dirs</span><span class="p">[</span><span class="s2">&quot;part4&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="s2">&quot;h2.log&quot;</span><span class="p">),</span>
<span class="p">)</span>
<span class="n">opt</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">fmax</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="n">relaxation_steps</span><span class="p">)</span>

<span class="n">E_h2_ml</span> <span class="o">=</span> <span class="n">h2</span><span class="o">.</span><span class="n">get_potential_energy</span><span class="p">()</span>
<span class="n">h2</span><span class="o">.</span><span class="n">calc</span> <span class="o">=</span> <span class="n">d3_calc</span>
<span class="n">E_h2_d3</span> <span class="o">=</span> <span class="n">h2</span><span class="o">.</span><span class="n">get_potential_energy</span><span class="p">()</span>
<span class="n">E_h2</span> <span class="o">=</span> <span class="n">E_h2_ml</span> <span class="o">+</span> <span class="n">E_h2_d3</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   E(H₂): </span><span class="si">{</span><span class="n">E_h2</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV (ML: </span><span class="si">{</span><span class="n">E_h2_ml</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, D3: </span><span class="si">{</span><span class="n">E_h2_d3</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

<span class="c1"># Save H2 structure</span>
<span class="n">ase</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">output_dir</span> <span class="o">/</span> <span class="n">part_dirs</span><span class="p">[</span><span class="s2">&quot;part4&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="s2">&quot;h2_optimized.xyz&quot;</span><span class="p">),</span> <span class="n">h2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>4. Calculating H₂ reference energy...
   E(H₂): -6.97 eV (ML: -6.97, D3: -0.00)
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-6-compute-adsorption-energy">
<h3>Step 6: Compute Adsorption Energy<a class="headerlink" href="#step-6-compute-adsorption-energy" title="Link to this heading">#</a></h3>
<p>Calculate the adsorption energy using the formula: E_ads = E(slab+H) - E(slab) - 0.5×E(H₂)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">4. Computing Adsorption Energy:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   E_ads = E(slab+H) - E(slab) - 0.5×E(H₂)&quot;</span><span class="p">)</span>

<span class="n">E_ads</span> <span class="o">=</span> <span class="n">E_with_h</span> <span class="o">-</span> <span class="n">E_clean</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">E_h2</span>
<span class="n">E_ads_no_d3</span> <span class="o">=</span> <span class="p">(</span><span class="n">E_with_h</span> <span class="o">-</span> <span class="n">E_with_h_d3</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">E_clean</span> <span class="o">-</span> <span class="n">E_clean_d3</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">E_h2</span> <span class="o">-</span> <span class="n">E_h2_d3</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Without D3: </span><span class="si">{</span><span class="n">E_ads_no_d3</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   With D3:    </span><span class="si">{</span><span class="n">E_ads</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   D3 effect:  </span><span class="si">{</span><span class="n">E_ads</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">E_ads_no_d3</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   → D3 corrections are negligible for H* (small, covalent bonding)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>4. Computing Adsorption Energy:
   E_ads = E(slab+H) - E(slab) - 0.5×E(H₂)

   Without D3: -0.50 eV
   With D3:    -0.58 eV
   D3 effect:  -0.08 eV

   → D3 corrections are negligible for H* (small, covalent bonding)
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-7-zero-point-energy-zpe-corrections">
<h3>Step 7: Zero-Point Energy (ZPE) Corrections<a class="headerlink" href="#step-7-zero-point-energy-zpe-corrections" title="Link to this heading">#</a></h3>
<p>Calculate vibrational frequencies to get ZPE corrections:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">6. Computing ZPE corrections...&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   This accounts for quantum vibrational effects&quot;</span><span class="p">)</span>
<span class="n">h_index</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">slab_with_h</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
<span class="n">slab_with_h</span><span class="o">.</span><span class="n">calc</span> <span class="o">=</span> <span class="n">calc</span>
<span class="n">vib</span> <span class="o">=</span> <span class="n">Vibrations</span><span class="p">(</span><span class="n">slab_with_h</span><span class="p">,</span> <span class="n">indices</span><span class="o">=</span><span class="p">[</span><span class="n">h_index</span><span class="p">],</span> <span class="n">delta</span><span class="o">=</span><span class="mf">0.02</span><span class="p">)</span>
<span class="n">vib</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">vib_energies</span> <span class="o">=</span> <span class="n">vib</span><span class="o">.</span><span class="n">get_energies</span><span class="p">()</span>
<span class="n">zpe_ads</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">vib_energies</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.0</span>

<span class="n">h2</span><span class="o">.</span><span class="n">calc</span> <span class="o">=</span> <span class="n">calc</span>
<span class="n">vib_h2</span> <span class="o">=</span> <span class="n">Vibrations</span><span class="p">(</span><span class="n">h2</span><span class="p">,</span> <span class="n">indices</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">delta</span><span class="o">=</span><span class="mf">0.02</span><span class="p">)</span>
<span class="n">vib_h2</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">vib_energies_h2</span> <span class="o">=</span> <span class="n">vib_h2</span><span class="o">.</span><span class="n">get_energies</span><span class="p">()</span>
<span class="n">zpe_h2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">vib_energies_h2</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.0</span>

<span class="n">E_ads_zpe</span> <span class="o">=</span> <span class="n">E_ads</span> <span class="o">+</span> <span class="n">zpe_ads</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">zpe_h2</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   ZPE(H*):  </span><span class="si">{</span><span class="n">zpe_ads</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   ZPE(H₂):  </span><span class="si">{</span><span class="n">zpe_h2</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   E_ads(ZPE): </span><span class="si">{</span><span class="n">E_ads_zpe</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>

<span class="c1"># Visualize vibrational modes</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Creating animations of vibrational modes...&quot;</span><span class="p">)</span>
<span class="n">vib</span><span class="o">.</span><span class="n">write_mode</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ase</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;vib.0.gif&quot;</span><span class="p">,</span> <span class="n">ase</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s2">&quot;vib.0.traj@:&quot;</span><span class="p">),</span> <span class="n">rotation</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;-45x,0y,0z&quot;</span><span class="p">))</span>

<span class="n">vib</span><span class="o">.</span><span class="n">clean</span><span class="p">()</span>
<span class="n">vib_h2</span><span class="o">.</span><span class="n">clean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>6. Computing ZPE corrections...
   This accounts for quantum vibrational effects
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   ZPE(H*):  0.18+0.00j eV
   ZPE(H₂):  0.27+0.00j eV
   E_ads(ZPE): -0.54-0.00j eV

   Creating animations of vibrational modes...
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
</pre></div>
</div>
<img alt="../_images/67ad47e864bdaaa218d44f3dc066b6db5829725b419bde977aae1f519a7b9d1d.png" src="../_images/67ad47e864bdaaa218d44f3dc066b6db5829725b419bde977aae1f519a7b9d1d.png" />
</div>
</div>
<img src="vib.0.gif" width="750" align="center"></section>
<section id="step-8-visualize-and-compare-results">
<h3>Step 8: Visualize and Compare Results<a class="headerlink" href="#step-8-visualize-and-compare-results" title="Link to this heading">#</a></h3>
<p>Visualize the best configuration and compare with literature:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">7. Visualizing best H* configuration...&quot;</span><span class="p">)</span>
<span class="n">view</span><span class="p">(</span><span class="n">slab_with_h</span><span class="p">,</span> <span class="n">viewer</span><span class="o">=</span><span class="s1">&#39;x3d&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>7. Visualizing best H* configuration...
</pre></div>
</div>
<div class="output text_html"><html>
    <head>
        <title>ASE atomic visualization</title>
        <link rel="stylesheet" type="text/css"             href="https://www.x3dom.org/release/x3dom.css"></link>
        <script type="text/javascript"             src="https://www.x3dom.org/release/x3dom.js"></script>
    </head>
    <body>
        <X3D width="400px"; height="300px";>

<!--Inserting Generated X3D Scene-->
<scene>
  <viewpoint position="0 0 73.06016852732809">
    <group/>
  </viewpoint>
  <transform translation="-4.971114817047235 -4.305111716692138 -18.265042131832022">
    <group>
      <group>
        <transform translation="0 0 0">
          <shape>
            <appearance>
              <material diffuseColor="0 0 0"/>
            </appearance>
            <lineset vertexCount="5">
              <coordinate point="0 0 0 9.94222963409447 0.0 6.087859848890877e-16 4.971114817047231 8.610223433384276 1.2175719697781757e-15 -4.97111481704724 8.610223433384276 6.087859848890878e-16 0 0 0"/>
            </lineset>
          </shape>
        </transform>
        <transform translation="0.0 0.0 36.530084263664044">
          <shape>
            <appearance>
              <material diffuseColor="0 0 0"/>
            </appearance>
            <lineset vertexCount="5">
              <coordinate point="0 0 0 9.94222963409447 0.0 6.087859848890877e-16 4.971114817047231 8.610223433384276 1.2175719697781757e-15 -4.97111481704724 8.610223433384276 6.087859848890878e-16 0 0 0"/>
            </lineset>
          </shape>
        </transform>
        <transform translation="0 0 0">
          <shape>
            <appearance>
              <material diffuseColor="0 0 0"/>
            </appearance>
            <lineset vertexCount="5">
              <coordinate point="0 0 0 9.94222963409447 0.0 6.087859848890877e-16 9.94222963409447 0.0 36.530084263664044 0.0 0.0 36.530084263664044 0 0 0"/>
            </lineset>
          </shape>
        </transform>
        <transform translation="-4.97111481704724 8.610223433384276 6.087859848890878e-16">
          <shape>
            <appearance>
              <material diffuseColor="0 0 0"/>
            </appearance>
            <lineset vertexCount="5">
              <coordinate point="0 0 0 9.94222963409447 0.0 6.087859848890877e-16 9.94222963409447 0.0 36.530084263664044 0.0 0.0 36.530084263664044 0 0 0"/>
            </lineset>
          </shape>
        </transform>
      </group>
      <group>
        <transform translation="1.2427787042618053 2.152555858346066 17.25031756895247">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="-1.3322676295501878e-15 1.435037238897378 13.19141931743424">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="1.242778704261809 0.7175186194486851 15.22086844319335">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="1.260575004638175 2.1625560286676984 23.35017817876149">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="-1.887379141862766e-15 1.4350372388973789 19.27976669471158">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="1.2427787042618061 0.7175186194486871 21.30921582047069">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="-4.6629367034256575e-15 4.305111716692135 17.25031756895247">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="-1.2427787042618113 3.587593097243447 13.19141931743424">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="-8.881784197001252e-16 2.8700744777947538 15.22086844319335">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="0.012384430279594572 4.307404426574568 23.3504440949253">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="-1.242778704261812 3.587593097243448 19.27976669471158">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="-3.774758283725532e-15 2.870074477794756 21.30921582047069">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="-1.2427787042618146 6.457667575038204 17.25031756895247">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="-2.485557408523621 5.7401489555895155 13.19141931743424">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="-1.2427787042618108 5.022630336140823 15.22086844319335">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="-1.2282807502878839 6.46472705104374 23.35478161565407">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="-2.4855574085236216 5.740148955589516 19.27976669471158">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="-1.2427787042618137 5.022630336140825 21.30921582047069">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="-2.4855574085236243 8.610223433384272 17.25031756895247">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="-3.728336112785431 7.892704813935584 13.19141931743424">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="-2.4855574085236203 7.1751861944868915 15.22086844319335">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="-2.4690342188749814 8.62202102555521 23.354284093218034">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="-3.7283361127854313 7.892704813935585 19.27976669471158">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="-2.4855574085236234 7.175186194486893 21.30921582047069">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="3.728336112785423 2.152555858346066 17.25031756895247">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="2.4855574085236163 1.435037238897378 13.19141931743424">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="3.728336112785427 0.7175186194486851 15.22086844319335">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="3.7492923641071423 2.1598173878301328 23.35149195389777">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="2.485557408523616 1.4350372388973789 19.27976669471158">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="3.7283361127854238 0.7175186194486871 21.30921582047069">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="2.485557408523613 4.305111716692135 17.25031756895247">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="1.2427787042618064 3.587593097243447 13.19141931743424">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="2.4855574085236167 2.8700744777947538 15.22086844319335">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="2.5024495250783794 4.309407224330819 23.35398882748114">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="1.2427787042618057 3.587593097243448 19.27976669471158">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="2.485557408523614 2.870074477794756 21.30921582047069">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="1.242778704261803 6.457667575038204 17.25031756895247">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="-3.552713678800501e-15 5.7401489555895155 13.19141931743424">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="1.2427787042618068 5.022630336140823 15.22086844319335">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="1.2540748177117769 6.455628685338242 23.350732077374964">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="-4.107825191113079e-15 5.740148955589516 19.27976669471158">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="1.242778704261804 5.022630336140825 21.30921582047069">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="-6.661338147750939e-15 8.610223433384272 17.25031756895247">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="-1.2427787042618132 7.892704813935584 13.19141931743424">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="-2.886579864025407e-15 7.1751861944868915 15.22086844319335">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="0.0010275028815305287 8.607997409284362 23.349729348494115">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="-1.2427787042618137 7.892704813935585 19.27976669471158">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="-5.773159728050814e-15 7.175186194486893 21.30921582047069">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="6.213893521309041 2.152555858346066 17.25031756895247">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="4.9711148170472335 1.435037238897378 13.19141931743424">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="6.2138935213090445 0.7175186194486851 15.22086844319335">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="6.233713088960808 2.154102416386327 23.395571838587607">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="4.9711148170472335 1.4350372388973789 19.27976669471158">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="6.213893521309041 0.7175186194486871 21.30921582047069">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="4.97111481704723 4.305111716692135 17.25031756895247">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="3.7283361127854238 3.587593097243447 13.19141931743424">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="4.971114817047234 2.8700744777947538 15.22086844319335">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="4.994017825055577 4.303637351995798 23.35080241366432">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="3.7283361127854233 3.587593097243448 19.27976669471158">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="4.971114817047232 2.870074477794756 21.30921582047069">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="3.7283361127854207 6.457667575038204 17.25031756895247">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="2.485557408523614 5.7401489555895155 13.19141931743424">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="3.728336112785424 5.022630336140823 15.22086844319335">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="3.748024913243727 6.454100699469338 23.350913249301634">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="2.4855574085236136 5.740148955589516 19.27976669471158">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="3.7283361127854215 5.022630336140825 21.30921582047069">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="2.485557408523611 8.610223433384272 17.25031756895247">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="1.2427787042618044 7.892704813935584 13.19141931743424">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="2.485557408523615 7.1751861944868915 15.22086844319335">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="2.5064038266588033 8.594617733032468 23.37077490423308">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="1.242778704261804 7.892704813935585 19.27976669471158">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="2.485557408523612 7.175186194486893 21.30921582047069">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="8.699450929832658 2.152555858346066 17.25031756895247">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="7.456672225570852 1.435037238897378 13.19141931743424">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="8.699450929832661 0.7175186194486851 15.22086844319335">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="8.727700217391117 2.1549867712050976 23.396626883211688">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="7.456672225570851 1.4350372388973789 19.27976669471158">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="8.69945092983266 0.7175186194486871 21.30921582047069">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="7.456672225570848 4.305111716692135 17.25031756895247">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="6.213893521309041 3.587593097243447 13.19141931743424">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="7.456672225570852 2.8700744777947538 15.22086844319335">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="7.4745862352796735 4.324319820111388 23.34873967392496">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="6.213893521309041 3.587593097243448 19.27976669471158">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="7.456672225570848 2.870074477794756 21.30921582047069">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="6.213893521309039 6.457667575038204 17.25031756895247">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="4.971114817047232 5.7401489555895155 13.19141931743424">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="6.213893521309043 5.022630336140823 15.22086844319335">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="6.2296220785125955 6.46285448522138 23.35426263195648">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="4.971114817047232 5.740148955589516 19.27976669471158">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="6.213893521309039 5.022630336140825 21.30921582047069">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="4.971114817047228 8.610223433384272 17.25031756895247">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="3.728336112785422 7.892704813935584 13.191419317434242">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="4.971114817047233 7.1751861944868915 15.220868443193352">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="5.005185622779975 8.606674548143323 23.349190391414417">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="3.7283361127854215 7.892704813935585 19.27976669471158">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="4.97111481704723 7.175186194486893 21.30921582047069">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="7.502468862554721 1.4030472109338843 24.281991833156173">
          <shape>
            <appearance>
              <material diffuseColor="1.0 1.0 1.0"/>
            </appearance>
            <sphere radius="0.31"/>
          </shape>
        </transform>
      </group>
    </group>
  </transform>
</scene>
<!--End of Inserted Scene-->

        </X3D>
    </body>
</html>

</div></div>
</div>
<div class="dropdown tip admonition">
<p class="admonition-title">Missing UMA access?</p>
<p>Don’t have access to UMA yet? You can still explore this calculation!</p>
<p><a class="reference internal" href="#example_configs/h_on_ni111.xyz"><span class="xref myst">Download example H on Ni(111) structure</span></a> and test it in the <a class="reference external" href="https://facebook-fairchem-uma-demo.hf.space/">UMA demo (no login required)</a> to see how the model predicts adsorption properties.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 6. Compare with literature</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="s1">&#39;=&#39;</span><span class="o">*</span><span class="mi">60</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Comparison with Literature:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;=&#39;</span><span class="o">*</span><span class="mi">60</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Table 4 (DFT): -0.60 eV (Ni(111), ref H₂)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;This work:     </span><span class="si">{</span><span class="n">E_ads_zpe</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Difference:    </span><span class="si">{</span><span class="nb">abs</span><span class="p">(</span><span class="n">E_ads_zpe</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="o">-</span><span class="mf">0.60</span><span class="p">))</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>============================================================
Comparison with Literature:
============================================================
Table 4 (DFT): -0.60 eV (Ni(111), ref H₂)
This work:     -0.54-0.00j eV
Difference:    0.06 eV
</pre></div>
</div>
</div>
</div>
<div class="tip admonition">
<p class="admonition-title">D3 Dispersion Corrections</p>
<p>Dispersion (van der Waals) interactions are important for:</p>
<ul class="simple">
<li><p>Large molecules (CO, CO₂)</p></li>
<li><p>Physisorption</p></li>
<li><p>Metal-support interfaces</p></li>
</ul>
<p>For H adsorption, D3 corrections are typically small (&lt;0.1 eV) because H forms strong covalent bonds with the surface. However, always check the magnitude!</p>
</div>
</section>
<section id="id8">
<h3>Explore on Your Own<a class="headerlink" href="#id8" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p><strong>Site preference</strong>: Identify which site (fcc, hcp, bridge, top) the H prefers. Visualize with <code class="docutils literal notranslate"><span class="pre">view(atoms,</span> <span class="pre">viewer='x3d')</span></code>.</p></li>
<li><p><strong>Coverage effects</strong>: Place 2 H atoms on the slab. How does binding change with separation?</p></li>
<li><p><strong>Different facets</strong>: Compare H adsorption on (100) and (110) surfaces. Which is strongest?</p></li>
<li><p><strong>Subsurface H</strong>: Place H below the surface layer. Is it stable?</p></li>
<li><p><strong>ZPE uncertainty</strong>: How sensitive is E_ads to the vibrational delta parameter (try 0.01, 0.03 Å)?</p></li>
</ol>
</section>
</section>
<hr class="docutils" />
<section id="part-5-coverage-dependent-h-adsorption">
<h2>Part 5: Coverage-Dependent H Adsorption<a class="headerlink" href="#part-5-coverage-dependent-h-adsorption" title="Link to this heading">#</a></h2>
<section id="id9">
<h3>Introduction<a class="headerlink" href="#id9" title="Link to this heading">#</a></h3>
<p>At higher coverages, adsorbate-adsorbate interactions become significant. We’ll study how H binding energy changes from dilute (1 atom) to saturated (full monolayer) coverage.</p>
</section>
<section id="id10">
<h3>Theory<a class="headerlink" href="#id10" title="Link to this heading">#</a></h3>
<p>The differential adsorption energy at coverage θ is:</p>
<div class="math notranslate nohighlight">
\[
E_{\text{ads}}(\theta) = \frac{E(n\text{H}^*) - E(*) - n \cdot \frac{1}{2}E(\text{H}_2)}{n}
\]</div>
<p>For many systems, this varies linearly:</p>
<div class="math notranslate nohighlight">
\[
E_{\text{ads}}(\theta) = E_{\text{ads}}(0) + \beta \theta
\]</div>
<p>where β quantifies lateral interactions (repulsive if β &gt; 0).</p>
</section>
<section id="step-1-setup-slab-and-calculators">
<h3>Step 1: Setup Slab and Calculators<a class="headerlink" href="#step-1-setup-slab-and-calculators" title="Link to this heading">#</a></h3>
<p>Create a larger Ni(111) slab to accommodate multiple adsorbates:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create large Ni(111) slab</span>
<span class="n">ni_bulk_atoms</span> <span class="o">=</span> <span class="n">bulk</span><span class="p">(</span><span class="s2">&quot;Ni&quot;</span><span class="p">,</span> <span class="s2">&quot;fcc&quot;</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="n">a_opt</span><span class="p">,</span> <span class="n">cubic</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ni_bulk_obj</span> <span class="o">=</span> <span class="n">Bulk</span><span class="p">(</span><span class="n">bulk_atoms</span><span class="o">=</span><span class="n">ni_bulk_atoms</span><span class="p">)</span>
<span class="n">ni_slabs</span> <span class="o">=</span> <span class="n">Slab</span><span class="o">.</span><span class="n">from_bulk_get_specific_millers</span><span class="p">(</span>
    <span class="n">bulk</span><span class="o">=</span><span class="n">ni_bulk_obj</span><span class="p">,</span> <span class="n">specific_millers</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">slab</span> <span class="o">=</span> <span class="n">ni_slabs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   Created </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">slab</span><span class="p">)</span><span class="si">}</span><span class="s2"> atom slab&quot;</span><span class="p">)</span>

<span class="c1"># Set up calculators</span>
<span class="n">base_calc</span> <span class="o">=</span> <span class="n">FAIRChemCalculator</span><span class="p">(</span><span class="n">predictor</span><span class="p">,</span> <span class="n">task_name</span><span class="o">=</span><span class="s2">&quot;oc20&quot;</span><span class="p">)</span>
<span class="n">d3_calc</span> <span class="o">=</span> <span class="n">TorchDFTD3Calculator</span><span class="p">(</span><span class="n">device</span><span class="o">=</span><span class="s2">&quot;cpu&quot;</span><span class="p">,</span> <span class="n">damping</span><span class="o">=</span><span class="s2">&quot;bj&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   ✓ Calculators initialized&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   Created 96 atom slab
   ✓ Calculators initialized
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-2-calculate-reference-energies">
<h3>Step 2: Calculate Reference Energies<a class="headerlink" href="#step-2-calculate-reference-energies" title="Link to this heading">#</a></h3>
<p>Get reference energies for clean surface and H₂:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">1. Relaxing clean slab...&quot;</span><span class="p">)</span>
<span class="n">clean_slab</span> <span class="o">=</span> <span class="n">slab</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">clean_slab</span><span class="o">.</span><span class="n">pbc</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">clean_slab</span><span class="o">.</span><span class="n">calc</span> <span class="o">=</span> <span class="n">base_calc</span>

<span class="n">opt</span> <span class="o">=</span> <span class="n">LBFGS</span><span class="p">(</span>
    <span class="n">clean_slab</span><span class="p">,</span>
    <span class="n">trajectory</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">output_dir</span> <span class="o">/</span> <span class="n">part_dirs</span><span class="p">[</span><span class="s2">&quot;part5&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="s2">&quot;ni111_clean.traj&quot;</span><span class="p">),</span>
    <span class="n">logfile</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">output_dir</span> <span class="o">/</span> <span class="n">part_dirs</span><span class="p">[</span><span class="s2">&quot;part5&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="s2">&quot;ni111_clean.log&quot;</span><span class="p">),</span>
<span class="p">)</span>
<span class="n">opt</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">fmax</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="n">relaxation_steps</span><span class="p">)</span>

<span class="n">E_clean_ml</span> <span class="o">=</span> <span class="n">clean_slab</span><span class="o">.</span><span class="n">get_potential_energy</span><span class="p">()</span>
<span class="n">clean_slab</span><span class="o">.</span><span class="n">calc</span> <span class="o">=</span> <span class="n">d3_calc</span>
<span class="n">E_clean_d3</span> <span class="o">=</span> <span class="n">clean_slab</span><span class="o">.</span><span class="n">get_potential_energy</span><span class="p">()</span>
<span class="n">E_clean</span> <span class="o">=</span> <span class="n">E_clean_ml</span> <span class="o">+</span> <span class="n">E_clean_d3</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   E(clean): </span><span class="si">{</span><span class="n">E_clean</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">2. Calculating H₂ reference...&quot;</span><span class="p">)</span>
<span class="n">h2</span> <span class="o">=</span> <span class="n">Atoms</span><span class="p">(</span><span class="s2">&quot;H2&quot;</span><span class="p">,</span> <span class="n">positions</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.74</span><span class="p">]])</span>
<span class="n">h2</span><span class="o">.</span><span class="n">center</span><span class="p">(</span><span class="n">vacuum</span><span class="o">=</span><span class="mf">10.0</span><span class="p">)</span>
<span class="n">h2</span><span class="o">.</span><span class="n">set_pbc</span><span class="p">([</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">])</span>
<span class="n">h2</span><span class="o">.</span><span class="n">calc</span> <span class="o">=</span> <span class="n">base_calc</span>

<span class="n">opt</span> <span class="o">=</span> <span class="n">LBFGS</span><span class="p">(</span>
    <span class="n">h2</span><span class="p">,</span>
    <span class="n">trajectory</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">output_dir</span> <span class="o">/</span> <span class="n">part_dirs</span><span class="p">[</span><span class="s2">&quot;part5&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="s2">&quot;h2.traj&quot;</span><span class="p">),</span>
    <span class="n">logfile</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">output_dir</span> <span class="o">/</span> <span class="n">part_dirs</span><span class="p">[</span><span class="s2">&quot;part5&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="s2">&quot;h2.log&quot;</span><span class="p">),</span>
<span class="p">)</span>
<span class="n">opt</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">fmax</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="n">relaxation_steps</span><span class="p">)</span>

<span class="n">E_h2_ml</span> <span class="o">=</span> <span class="n">h2</span><span class="o">.</span><span class="n">get_potential_energy</span><span class="p">()</span>
<span class="n">h2</span><span class="o">.</span><span class="n">calc</span> <span class="o">=</span> <span class="n">d3_calc</span>
<span class="n">E_h2_d3</span> <span class="o">=</span> <span class="n">h2</span><span class="o">.</span><span class="n">get_potential_energy</span><span class="p">()</span>
<span class="n">E_h2</span> <span class="o">=</span> <span class="n">E_h2_ml</span> <span class="o">+</span> <span class="n">E_h2_d3</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   E(H₂): </span><span class="si">{</span><span class="n">E_h2</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1. Relaxing clean slab...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   E(clean): -487.46 eV

2. Calculating H₂ reference...
   E(H₂): -6.97 eV
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-3-set-up-coverage-study">
<h3>Step 3: Set Up Coverage Study<a class="headerlink" href="#step-3-set-up-coverage-study" title="Link to this heading">#</a></h3>
<p>Define the coverages we’ll test (from dilute to nearly 1 ML):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Count surface sites</span>
<span class="n">tags</span> <span class="o">=</span> <span class="n">slab</span><span class="o">.</span><span class="n">get_tags</span><span class="p">()</span>
<span class="n">n_sites</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">tags</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">3. Surface sites: </span><span class="si">{</span><span class="n">n_sites</span><span class="si">}</span><span class="s2"> (4×4 Ni(111))&quot;</span><span class="p">)</span>

<span class="c1"># Test coverages: 1 H, 0.25 ML, 0.5 ML, 0.75 ML, 1.0 ML</span>
<span class="n">coverages_to_test</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">16</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Will test coverages: </span><span class="si">{</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">n</span><span class="o">/</span><span class="n">n_sites</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> ML&#39;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">coverages_to_test</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   This spans from dilute to nearly full monolayer&quot;</span><span class="p">)</span>

<span class="n">coverages</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">adsorption_energies</span> <span class="o">=</span> <span class="p">[]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3. Surface sites: 16 (4×4 Ni(111))

   Will test coverages: [&#39;0.06 ML&#39;, &#39;0.25 ML&#39;, &#39;0.50 ML&#39;, &#39;0.75 ML&#39;, &#39;1.00 ML&#39;]
   This spans from dilute to nearly full monolayer
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-4-generate-and-relax-configurations-at-each-coverage">
<h3>Step 4: Generate and Relax Configurations at Each Coverage<a class="headerlink" href="#step-4-generate-and-relax-configurations-at-each-coverage" title="Link to this heading">#</a></h3>
<p>For each coverage, generate multiple configurations and find the lowest energy:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">n_h</span> <span class="ow">in</span> <span class="n">coverages_to_test</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">3. Coverage: </span><span class="si">{</span><span class="n">n_h</span><span class="si">}</span><span class="s2"> H (</span><span class="si">{</span><span class="n">n_h</span><span class="o">/</span><span class="n">n_sites</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> ML)&quot;</span><span class="p">)</span>

    <span class="c1"># Generate configurations</span>
    <span class="n">ni_bulk_obj_h</span> <span class="o">=</span> <span class="n">Bulk</span><span class="p">(</span><span class="n">bulk_atoms</span><span class="o">=</span><span class="n">ni_bulk_atoms</span><span class="p">)</span>
    <span class="n">ni_slabs_h</span> <span class="o">=</span> <span class="n">Slab</span><span class="o">.</span><span class="n">from_bulk_get_specific_millers</span><span class="p">(</span>
        <span class="n">bulk</span><span class="o">=</span><span class="n">ni_bulk_obj_h</span><span class="p">,</span> <span class="n">specific_millers</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="n">slab_for_ads</span> <span class="o">=</span> <span class="n">ni_slabs_h</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">slab_for_ads</span><span class="o">.</span><span class="n">atoms</span> <span class="o">=</span> <span class="n">clean_slab</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="n">adsorbates_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">Adsorbate</span><span class="p">(</span><span class="n">adsorbate_smiles_from_db</span><span class="o">=</span><span class="s2">&quot;*H&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_h</span><span class="p">)]</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">multi_ads_config</span> <span class="o">=</span> <span class="n">MultipleAdsorbateSlabConfig</span><span class="p">(</span>
            <span class="n">slab_for_ads</span><span class="p">,</span> <span class="n">adsorbates_list</span><span class="p">,</span> <span class="n">num_configurations</span><span class="o">=</span><span class="n">num_sites</span>
        <span class="p">)</span>
    <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   ⚠ Configuration generation failed: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">continue</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">multi_ads_config</span><span class="o">.</span><span class="n">atoms_list</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   ⚠ No configurations generated&quot;</span><span class="p">)</span>
        <span class="k">continue</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   Generated </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">multi_ads_config</span><span class="o">.</span><span class="n">atoms_list</span><span class="p">)</span><span class="si">}</span><span class="s2"> configurations&quot;</span><span class="p">)</span>

    <span class="c1"># Relax each and find best</span>
    <span class="n">config_energies</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">config</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">multi_ads_config</span><span class="o">.</span><span class="n">atoms_list</span><span class="p">):</span>
        <span class="n">config_relaxed</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">config_relaxed</span><span class="o">.</span><span class="n">set_pbc</span><span class="p">([</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">])</span>
        <span class="n">config_relaxed</span><span class="o">.</span><span class="n">calc</span> <span class="o">=</span> <span class="n">base_calc</span>

        <span class="n">opt</span> <span class="o">=</span> <span class="n">LBFGS</span><span class="p">(</span><span class="n">config_relaxed</span><span class="p">,</span> <span class="n">logfile</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
        <span class="n">opt</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">fmax</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="n">relaxation_steps</span><span class="p">)</span>

        <span class="n">E_ml</span> <span class="o">=</span> <span class="n">config_relaxed</span><span class="o">.</span><span class="n">get_potential_energy</span><span class="p">()</span>
        <span class="n">config_relaxed</span><span class="o">.</span><span class="n">calc</span> <span class="o">=</span> <span class="n">d3_calc</span>
        <span class="n">E_d3</span> <span class="o">=</span> <span class="n">config_relaxed</span><span class="o">.</span><span class="n">get_potential_energy</span><span class="p">()</span>
        <span class="n">E_total</span> <span class="o">=</span> <span class="n">E_ml</span> <span class="o">+</span> <span class="n">E_d3</span>

        <span class="n">config_energies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_total</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;     Config </span><span class="si">{</span><span class="n">idx</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">E_total</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>

    <span class="n">best_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">config_energies</span><span class="p">)</span>
    <span class="n">best_energy</span> <span class="o">=</span> <span class="n">config_energies</span><span class="p">[</span><span class="n">best_idx</span><span class="p">]</span>
    <span class="n">best_config</span> <span class="o">=</span> <span class="n">multi_ads_config</span><span class="o">.</span><span class="n">atoms_list</span><span class="p">[</span><span class="n">best_idx</span><span class="p">]</span>
    <span class="n">E_ads_per_h</span> <span class="o">=</span> <span class="p">(</span><span class="n">best_energy</span> <span class="o">-</span> <span class="n">E_clean</span> <span class="o">-</span> <span class="n">n_h</span> <span class="o">*</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">E_h2</span><span class="p">)</span> <span class="o">/</span> <span class="n">n_h</span>

    <span class="n">coverage</span> <span class="o">=</span> <span class="n">n_h</span> <span class="o">/</span> <span class="n">n_sites</span>
    <span class="n">coverages</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">coverage</span><span class="p">)</span>
    <span class="n">adsorption_energies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_ads_per_h</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   → E_ads/H: </span><span class="si">{</span><span class="n">E_ads_per_h</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>

    <span class="c1"># Visualize best configuration at this coverage</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   Visualizing configuration with </span><span class="si">{</span><span class="n">n_h</span><span class="si">}</span><span class="s2"> H atoms...&quot;</span><span class="p">)</span>
    <span class="n">view</span><span class="p">(</span><span class="n">best_config</span><span class="p">,</span> <span class="n">viewer</span><span class="o">=</span><span class="s1">&#39;x3d&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">✓ Completed coverage study: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">coverages</span><span class="p">)</span><span class="si">}</span><span class="s2"> data points&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3. Coverage: 1 H (0.06 ML)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   Generated 2 configurations
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     Config 1: -491.53 eV
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     Config 2: -491.53 eV
   → E_ads/H: -0.59 eV
   Visualizing configuration with 1 H atoms...

3. Coverage: 4 H (0.25 ML)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   Generated 2 configurations
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     Config 1: -503.51 eV
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     Config 2: -502.98 eV
   → E_ads/H: -0.53 eV
   Visualizing configuration with 4 H atoms...

3. Coverage: 8 H (0.50 ML)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   Generated 2 configurations
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     Config 1: -518.92 eV
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     Config 2: -519.31 eV
   → E_ads/H: -0.50 eV
   Visualizing configuration with 8 H atoms...

3. Coverage: 12 H (0.75 ML)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   Generated 2 configurations
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     Config 1: -534.65 eV
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     Config 2: -532.49 eV
   → E_ads/H: -0.45 eV
   Visualizing configuration with 12 H atoms...

3. Coverage: 16 H (1.00 ML)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   Generated 2 configurations
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     Config 1: -547.36 eV
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     Config 2: -547.33 eV
   → E_ads/H: -0.26 eV
   Visualizing configuration with 16 H atoms...

✓ Completed coverage study: 5 data points
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-5-perform-linear-fit">
<h3>Step 5: Perform Linear Fit<a class="headerlink" href="#step-5-perform-linear-fit" title="Link to this heading">#</a></h3>
<p>Fit E_ads vs coverage to extract the slope (lateral interaction strength):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">4. Performing linear fit to coverage dependence...&quot;</span><span class="p">)</span>

<span class="c1"># Linear fit</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">numpy.polynomial</span><span class="w"> </span><span class="kn">import</span> <span class="n">Polynomial</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">Polynomial</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">coverages</span><span class="p">,</span> <span class="n">adsorption_energies</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">slope</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">coef</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">intercept</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">coef</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="s1">&#39;=&#39;</span><span class="o">*</span><span class="mi">60</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Linear Fit: E_ads = </span><span class="si">{</span><span class="n">intercept</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> + </span><span class="si">{</span><span class="n">slope</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">θ (eV)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Slope: </span><span class="si">{</span><span class="n">slope</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">96.485</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> kJ/mol per ML&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Paper: 8.7 kJ/mol per ML&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;=&#39;</span><span class="o">*</span><span class="mi">60</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>4. Performing linear fit to coverage dependence...

============================================================
Linear Fit: E_ads = -0.46 + 0.15θ (eV)
Slope: 14.1 kJ/mol per ML
Paper: 8.7 kJ/mol per ML
============================================================
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-6-visualize-coverage-dependence">
<h3>Step 6: Visualize Coverage Dependence<a class="headerlink" href="#step-6-visualize-coverage-dependence" title="Link to this heading">#</a></h3>
<p>Create a plot showing how adsorption energy changes with coverage:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">5. Plotting coverage dependence...&quot;</span><span class="p">)</span>

<span class="c1"># Plot</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
    <span class="n">coverages</span><span class="p">,</span>
    <span class="n">adsorption_energies</span><span class="p">,</span>
    <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
    <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Calculated&quot;</span><span class="p">,</span>
    <span class="n">zorder</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;steelblue&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">cov_fit</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">coverages</span><span class="p">),</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">ads_fit</span> <span class="o">=</span> <span class="n">p</span><span class="p">(</span><span class="n">cov_fit</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">cov_fit</span><span class="p">,</span> <span class="n">ads_fit</span><span class="p">,</span> <span class="s2">&quot;r--&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Fit: </span><span class="si">{</span><span class="n">intercept</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> + </span><span class="si">{</span><span class="n">slope</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">θ&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span>
<span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;H Coverage (ML)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Adsorption Energy (eV/H)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Coverage-Dependent H Adsorption on Ni(111)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">output_dir</span> <span class="o">/</span> <span class="n">part_dirs</span><span class="p">[</span><span class="s2">&quot;part5&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="s2">&quot;coverage_dependence.png&quot;</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">✓ Coverage dependence analysis complete!&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5. Plotting coverage dependence...
</pre></div>
</div>
<img alt="../_images/3d84712c3d6dd85d55b657afa513303c89de5719384e5b5c870f0e343985a04c.png" src="../_images/3d84712c3d6dd85d55b657afa513303c89de5719384e5b5c870f0e343985a04c.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>✓ Coverage dependence analysis complete!
</pre></div>
</div>
</div>
</div>
<div class="dropdown tip admonition">
<p class="admonition-title">Missing UMA access?</p>
<p>Don’t have access to UMA yet? You can still explore this calculation!</p>
<p><a class="reference internal" href="#example_configs/4h_on_ni111.xyz"><span class="xref myst">Download example multiple H on Ni(111) structure</span></a> and test it in the <a class="reference external" href="https://facebook-fairchem-uma-demo.hf.space/">UMA demo (no login required)</a> to see how the model handles coverage-dependent binding.</p>
</div>
<div class="note admonition">
<p class="admonition-title">Comparison with Paper</p>
<p><strong>Expected Results from Paper:</strong></p>
<ul class="simple">
<li><p><strong>Slope</strong>: 8.7 kJ/mol per ML (indicating repulsive lateral H-H interactions)</p></li>
<li><p><strong>Physical interpretation</strong>: H atoms repel weakly due to electrostatic and Pauli effects</p></li>
</ul>
<p><strong>What to Check:</strong></p>
<ul class="simple">
<li><p>Your fitted slope should be close to 8.7 kJ/mol per ML</p></li>
<li><p>The relationship should be approximately linear for θ &lt; 1 ML</p></li>
<li><p>Intercept (E_ads at θ → 0) should match the single-H result from Part 4 (~-0.60 eV)</p></li>
</ul>
<p><strong>Typical Variations:</strong></p>
<ul class="simple">
<li><p>Slope can vary by ±2-3 kJ/mol depending on slab size and configuration sampling</p></li>
<li><p>Non-linearity may appear at very high coverage (θ &gt; 0.75 ML)</p></li>
<li><p>Model differences can affect lateral interactions more than adsorption energies</p></li>
</ul>
</div>
<div class="note admonition">
<p class="admonition-title">Physical Insights</p>
<p><strong>Positive slope</strong> (repulsive interactions):</p>
<ul class="simple">
<li><p>Electrostatic: H atoms accumulate negative charge from Ni</p></li>
<li><p>Pauli repulsion: Overlapping electron clouds</p></li>
<li><p>Strain: Lattice distortions propagate</p></li>
</ul>
<p><strong>Magnitude</strong>:</p>
<ul class="simple">
<li><p>Weak (~10 kJ/mol/ML) → isolated adsorbates</p></li>
<li><p>Strong (&gt;50 kJ/mol/ML) → clustering or phase separation likely</p></li>
</ul>
<p>The paper reports 8.7 kJ/mol/ML, indicating relatively weak lateral interactions for H on Ni(111).</p>
</div>
</section>
<section id="id11">
<h3>Explore on Your Own<a class="headerlink" href="#id11" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p><strong>Non-linear behavior</strong>: Use polynomial (degree 2) fit. Is there curvature at high coverage?</p></li>
<li><p><strong>Temperature effects</strong>: Estimate configurational entropy at each coverage. How does this affect free energy?</p></li>
<li><p><strong>Pattern formation</strong>: Visualize the lowest-energy configuration at 0.5 ML. Are H atoms ordered?</p></li>
<li><p><strong>Other adsorbates</strong>: Repeat for O or N. How do lateral interactions compare?</p></li>
<li><p><strong>Phase diagrams</strong>: At what coverage do you expect phase separation (islands vs uniform)?</p></li>
</ol>
</section>
</section>
<hr class="docutils" />
<section id="part-6-co-formation-dissociation-thermochemistry-and-barrier">
<h2>Part 6: CO Formation/Dissociation Thermochemistry and Barrier<a class="headerlink" href="#part-6-co-formation-dissociation-thermochemistry-and-barrier" title="Link to this heading">#</a></h2>
<section id="id12">
<h3>Introduction<a class="headerlink" href="#id12" title="Link to this heading">#</a></h3>
<p>CO dissociation (CO* → C* + O*) is the rate-limiting step in many catalytic processes (Fischer-Tropsch, CO oxidation, etc.). We’ll calculate the reaction energy for C* + O* → CO* and the activation barriers in both directions using the nudged elastic band (NEB) method.</p>
</section>
<section id="id13">
<h3>Theory<a class="headerlink" href="#id13" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Forward Reaction</strong>: C* + O* → CO* + * (recombination)</p></li>
<li><p><strong>Reverse Reaction</strong>: CO* + <em>→ C</em> + O* (dissociation)</p></li>
<li><p><strong>Thermochemistry</strong>: <span class="math notranslate nohighlight">\(\Delta E_{\text{rxn}} = E(\text{C}^* + \text{O}^*) - E(\text{CO}^*)\)</span></p></li>
<li><p><strong>Barrier</strong>: NEB finds the minimum energy path (MEP) and transition state: <span class="math notranslate nohighlight">\(E_a = E^{\ddagger} - E_{\text{initial}}\)</span></p></li>
</ul>
</section>
<section id="id14">
<h3>Step 1: Setup Slab and Calculators<a class="headerlink" href="#id14" title="Link to this heading">#</a></h3>
<p>Initialize the Ni(111) surface and calculators:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create slab</span>
<span class="n">ni_bulk_atoms</span> <span class="o">=</span> <span class="n">bulk</span><span class="p">(</span><span class="s2">&quot;Ni&quot;</span><span class="p">,</span> <span class="s2">&quot;fcc&quot;</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="n">a_opt</span><span class="p">,</span> <span class="n">cubic</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ni_bulk_obj</span> <span class="o">=</span> <span class="n">Bulk</span><span class="p">(</span><span class="n">bulk_atoms</span><span class="o">=</span><span class="n">ni_bulk_atoms</span><span class="p">)</span>
<span class="n">ni_slabs</span> <span class="o">=</span> <span class="n">Slab</span><span class="o">.</span><span class="n">from_bulk_get_specific_millers</span><span class="p">(</span>
    <span class="n">bulk</span><span class="o">=</span><span class="n">ni_bulk_obj</span><span class="p">,</span> <span class="n">specific_millers</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">slab</span> <span class="o">=</span> <span class="n">ni_slabs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">atoms</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   Created </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">slab</span><span class="p">)</span><span class="si">}</span><span class="s2"> atom slab&quot;</span><span class="p">)</span>

<span class="n">base_calc</span> <span class="o">=</span> <span class="n">FAIRChemCalculator</span><span class="p">(</span><span class="n">predictor</span><span class="p">,</span> <span class="n">task_name</span><span class="o">=</span><span class="s2">&quot;oc20&quot;</span><span class="p">)</span>
<span class="n">d3_calc</span> <span class="o">=</span> <span class="n">TorchDFTD3Calculator</span><span class="p">(</span><span class="n">device</span><span class="o">=</span><span class="s2">&quot;cpu&quot;</span><span class="p">,</span> <span class="n">damping</span><span class="o">=</span><span class="s2">&quot;bj&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   </span><span class="se">\u2713</span><span class="s2"> Calculators initialized&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   Created 96 atom slab
   ✓ Calculators initialized
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-2-generate-and-relax-final-state-co">
<h3>Step 2: Generate and Relax Final State (CO*)<a class="headerlink" href="#step-2-generate-and-relax-final-state-co" title="Link to this heading">#</a></h3>
<p>Find the most stable CO adsorption configuration (this is the product of C+O recombination):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">1. Final State: CO* on Ni(111)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   Generating CO adsorption configurations...&quot;</span><span class="p">)</span>

<span class="n">ni_bulk_obj_co</span> <span class="o">=</span> <span class="n">Bulk</span><span class="p">(</span><span class="n">bulk_atoms</span><span class="o">=</span><span class="n">ni_bulk_atoms</span><span class="p">)</span>
<span class="n">ni_slab_co</span> <span class="o">=</span> <span class="n">Slab</span><span class="o">.</span><span class="n">from_bulk_get_specific_millers</span><span class="p">(</span>
    <span class="n">bulk</span><span class="o">=</span><span class="n">ni_bulk_obj_co</span><span class="p">,</span> <span class="n">specific_millers</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">ni_slab_co</span><span class="o">.</span><span class="n">atoms</span> <span class="o">=</span> <span class="n">slab</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="n">adsorbate_co</span> <span class="o">=</span> <span class="n">Adsorbate</span><span class="p">(</span><span class="n">adsorbate_smiles_from_db</span><span class="o">=</span><span class="s2">&quot;*CO&quot;</span><span class="p">)</span>
<span class="n">multi_ads_config_co</span> <span class="o">=</span> <span class="n">MultipleAdsorbateSlabConfig</span><span class="p">(</span>
    <span class="n">ni_slab_co</span><span class="p">,</span> <span class="p">[</span><span class="n">adsorbate_co</span><span class="p">],</span> <span class="n">num_configurations</span><span class="o">=</span><span class="n">num_sites</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   Generated </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">multi_ads_config_co</span><span class="o">.</span><span class="n">atoms_list</span><span class="p">)</span><span class="si">}</span><span class="s2"> configurations&quot;</span><span class="p">)</span>

<span class="c1"># Relax and find best</span>
<span class="n">co_energies</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">co_energies_ml</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">co_energies_d3</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">co_configs</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">config</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">multi_ads_config_co</span><span class="o">.</span><span class="n">atoms_list</span><span class="p">):</span>
    <span class="n">config_relaxed</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">config_relaxed</span><span class="o">.</span><span class="n">set_pbc</span><span class="p">([</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">])</span>
    <span class="n">config_relaxed</span><span class="o">.</span><span class="n">calc</span> <span class="o">=</span> <span class="n">base_calc</span>
    <span class="n">opt</span> <span class="o">=</span> <span class="n">LBFGS</span><span class="p">(</span><span class="n">config_relaxed</span><span class="p">,</span> <span class="n">logfile</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">opt</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">fmax</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="n">relaxation_steps</span><span class="p">)</span>

    <span class="n">E_ml</span> <span class="o">=</span> <span class="n">config_relaxed</span><span class="o">.</span><span class="n">get_potential_energy</span><span class="p">()</span>
    <span class="n">config_relaxed</span><span class="o">.</span><span class="n">calc</span> <span class="o">=</span> <span class="n">d3_calc</span>
    <span class="n">E_d3</span> <span class="o">=</span> <span class="n">config_relaxed</span><span class="o">.</span><span class="n">get_potential_energy</span><span class="p">()</span>
    <span class="n">E_total</span> <span class="o">=</span> <span class="n">E_ml</span> <span class="o">+</span> <span class="n">E_d3</span>

    <span class="n">co_energies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_total</span><span class="p">)</span>
    <span class="n">co_energies_ml</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_ml</span><span class="p">)</span>
    <span class="n">co_energies_d3</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_d3</span><span class="p">)</span>
    <span class="n">co_configs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">config_relaxed</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;     Config </span><span class="si">{</span><span class="n">idx</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">: E_total = </span><span class="si">{</span><span class="n">E_total</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV (RPBE: </span><span class="si">{</span><span class="n">E_ml</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, D3: </span><span class="si">{</span><span class="n">E_d3</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">)&quot;</span>
    <span class="p">)</span>

<span class="n">best_co_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">co_energies</span><span class="p">)</span>
<span class="n">final_co</span> <span class="o">=</span> <span class="n">co_configs</span><span class="p">[</span><span class="n">best_co_idx</span><span class="p">]</span>
<span class="n">E_final_co</span> <span class="o">=</span> <span class="n">co_energies</span><span class="p">[</span><span class="n">best_co_idx</span><span class="p">]</span>
<span class="n">E_final_co_ml</span> <span class="o">=</span> <span class="n">co_energies_ml</span><span class="p">[</span><span class="n">best_co_idx</span><span class="p">]</span>
<span class="n">E_final_co_d3</span> <span class="o">=</span> <span class="n">co_energies_d3</span><span class="p">[</span><span class="n">best_co_idx</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   → Best CO* (Config </span><span class="si">{</span><span class="n">best_co_idx</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;      RPBE:  </span><span class="si">{</span><span class="n">E_final_co_ml</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;      D3:    </span><span class="si">{</span><span class="n">E_final_co_d3</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;      Total: </span><span class="si">{</span><span class="n">E_final_co</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>

<span class="c1"># Save best CO state</span>
<span class="n">ase</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">output_dir</span> <span class="o">/</span> <span class="n">part_dirs</span><span class="p">[</span><span class="s2">&quot;part6&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="s2">&quot;co_final_best.traj&quot;</span><span class="p">),</span> <span class="n">final_co</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   ✓ Best CO* structure saved&quot;</span><span class="p">)</span>

<span class="c1"># Visualize best CO* structure</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Visualizing best CO* structure...&quot;</span><span class="p">)</span>
<span class="n">view</span><span class="p">(</span><span class="n">final_co</span><span class="p">,</span> <span class="n">viewer</span><span class="o">=</span><span class="s1">&#39;x3d&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1. Final State: CO* on Ni(111)
   Generating CO adsorption configurations...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   Generated 2 configurations
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     Config 1: E_total = -503.61 eV (RPBE: -466.74, D3: -36.87)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     Config 2: E_total = -503.59 eV (RPBE: -466.73, D3: -36.86)

   → Best CO* (Config 1):
      RPBE:  -466.74 eV
      D3:    -36.87 eV
      Total: -503.61 eV
   ✓ Best CO* structure saved

   Visualizing best CO* structure...
</pre></div>
</div>
<div class="output text_html"><html>
    <head>
        <title>ASE atomic visualization</title>
        <link rel="stylesheet" type="text/css"             href="https://www.x3dom.org/release/x3dom.css"></link>
        <script type="text/javascript"             src="https://www.x3dom.org/release/x3dom.js"></script>
    </head>
    <body>
        <X3D width="400px"; height="300px";>

<!--Inserting Generated X3D Scene-->
<scene>
  <viewpoint position="0 0 73.06016852732809">
    <group/>
  </viewpoint>
  <transform translation="-4.971114817047235 -4.305111716692138 -18.265042131832022">
    <group>
      <group>
        <transform translation="0 0 0">
          <shape>
            <appearance>
              <material diffuseColor="0 0 0"/>
            </appearance>
            <lineset vertexCount="5">
              <coordinate point="0 0 0 9.94222963409447 0.0 6.087859848890877e-16 4.971114817047231 8.610223433384276 1.2175719697781757e-15 -4.97111481704724 8.610223433384276 6.087859848890878e-16 0 0 0"/>
            </lineset>
          </shape>
        </transform>
        <transform translation="0.0 0.0 36.530084263664044">
          <shape>
            <appearance>
              <material diffuseColor="0 0 0"/>
            </appearance>
            <lineset vertexCount="5">
              <coordinate point="0 0 0 9.94222963409447 0.0 6.087859848890877e-16 4.971114817047231 8.610223433384276 1.2175719697781757e-15 -4.97111481704724 8.610223433384276 6.087859848890878e-16 0 0 0"/>
            </lineset>
          </shape>
        </transform>
        <transform translation="0 0 0">
          <shape>
            <appearance>
              <material diffuseColor="0 0 0"/>
            </appearance>
            <lineset vertexCount="5">
              <coordinate point="0 0 0 9.94222963409447 0.0 6.087859848890877e-16 9.94222963409447 0.0 36.530084263664044 0.0 0.0 36.530084263664044 0 0 0"/>
            </lineset>
          </shape>
        </transform>
        <transform translation="-4.97111481704724 8.610223433384276 6.087859848890878e-16">
          <shape>
            <appearance>
              <material diffuseColor="0 0 0"/>
            </appearance>
            <lineset vertexCount="5">
              <coordinate point="0 0 0 9.94222963409447 0.0 6.087859848890877e-16 9.94222963409447 0.0 36.530084263664044 0.0 0.0 36.530084263664044 0 0 0"/>
            </lineset>
          </shape>
        </transform>
      </group>
      <group>
        <transform translation="1.2427787042618053 2.152555858346066 17.25031756895247">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="-1.3322676295501878e-15 1.435037238897378 13.19141931743424">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="1.242778704261809 0.7175186194486851 15.22086844319335">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="1.2451952223202623 2.149755321978634 23.347730356275683">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="-1.887379141862766e-15 1.4350372388973789 19.27976669471158">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="1.2427787042618061 0.7175186194486871 21.30921582047069">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="-4.6629367034256575e-15 4.305111716692135 17.25031756895247">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="-1.2427787042618113 3.587593097243447 13.19141931743424">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="-8.881784197001252e-16 2.8700744777947538 15.22086844319335">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="-5.766735557788394e-05 4.310911659525752 23.373532374261963">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="-1.242778704261812 3.587593097243448 19.27976669471158">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="-3.774758283725532e-15 2.870074477794756 21.30921582047069">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="-1.2427787042618146 6.457667575038204 17.25031756895247">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="-2.485557408523621 5.7401489555895155 13.19141931743424">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="-1.2427787042618108 5.022630336140823 15.22086844319335">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="-1.2428992626230426 6.4821316066541375 23.346922107630967">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="-2.4855574085236216 5.740148955589516 19.27976669471158">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="-1.2427787042618137 5.022630336140825 21.30921582047069">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="-2.4855574085236243 8.610223433384272 17.25031756895247">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="-3.728336112785431 7.892704813935584 13.19141931743424">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="-2.4855574085236203 7.1751861944868915 15.22086844319335">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="-2.489588122191437 8.615068952980117 23.352400839346778">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="-3.7283361127854313 7.892704813935585 19.27976669471158">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="-2.4855574085236234 7.175186194486893 21.30921582047069">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="3.728336112785423 2.152555858346066 17.25031756895247">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="2.4855574085236163 1.435037238897378 13.19141931743424">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="3.728336112785427 0.7175186194486851 15.22086844319335">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="3.7222233965865135 2.152872590239755 23.352301347967845">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="2.485557408523616 1.4350372388973789 19.27976669471158">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="3.7283361127854238 0.7175186194486871 21.30921582047069">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="2.485557408523613 4.305111716692135 17.25031756895247">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="1.2427787042618064 3.587593097243447 13.19141931743424">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="2.4855574085236167 2.8700744777947538 15.22086844319335">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="2.4725728508697085 4.302977583533854 23.350645884473856">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="1.2427787042618057 3.587593097243448 19.27976669471158">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="2.485557408523614 2.870074477794756 21.30921582047069">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="1.242778704261803 6.457667575038204 17.25031756895247">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="-3.552713678800501e-15 5.7401489555895155 13.19141931743424">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="1.2427787042618068 5.022630336140823 15.22086844319335">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="1.2437168086032646 6.46023945570896 23.349277492373226">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="-4.107825191113079e-15 5.740148955589516 19.27976669471158">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="1.242778704261804 5.022630336140825 21.30921582047069">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="-6.661338147750939e-15 8.610223433384272 17.25031756895247">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="-1.2427787042618132 7.892704813935584 13.19141931743424">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="-2.886579864025407e-15 7.1751861944868915 15.22086844319335">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="0.0016927061324139014 8.608700650488935 23.3518337423373">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="-1.2427787042618137 7.892704813935585 19.27976669471158">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="-5.773159728050814e-15 7.175186194486893 21.30921582047069">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="6.213893521309041 2.152555858346066 17.25031756895247">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="4.9711148170472335 1.435037238897378 13.19141931743424">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="6.2138935213090445 0.7175186194486851 15.22086844319335">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="6.19304332332217 2.1408302133357635 23.34464705844203">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="4.9711148170472335 1.4350372388973789 19.27976669471158">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="6.213893521309041 0.7175186194486871 21.30921582047069">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="4.97111481704723 4.305111716692135 17.25031756895247">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="3.7283361127854238 3.587593097243447 13.19141931743424">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="4.971114817047234 2.8700744777947538 15.22086844319335">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="4.954088767016398 4.309415483579594 23.342989851822317">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="3.7283361127854233 3.587593097243448 19.27976669471158">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="4.971114817047232 2.870074477794756 21.30921582047069">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="3.7283361127854207 6.457667575038204 17.25031756895247">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="2.485557408523614 5.7401489555895155 13.19141931743424">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="3.728336112785424 5.022630336140823 15.22086844319335">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="3.7216485490177966 6.459714766230308 23.353400723011696">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="2.4855574085236136 5.740148955589516 19.27976669471158">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="3.7283361127854215 5.022630336140825 21.30921582047069">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="2.485557408523611 8.610223433384272 17.25031756895247">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="1.2427787042618044 7.892704813935584 13.19141931743424">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="2.485557408523615 7.1751861944868915 15.22086844319335">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="2.482603791489961 8.607156660854706 23.350286453771155">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="1.242778704261804 7.892704813935585 19.27976669471158">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="2.485557408523612 7.175186194486893 21.30921582047069">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="8.699450929832658 2.152555858346066 17.25031756895247">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="7.456672225570852 1.435037238897378 13.19141931743424">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="8.699450929832661 0.7175186194486851 15.22086844319335">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="8.695296521511178 2.1402339971617463 23.36431185138263">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="7.456672225570851 1.4350372388973789 19.27976669471158">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="8.69945092983266 0.7175186194486871 21.30921582047069">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="7.456672225570848 4.305111716692135 17.25031756895247">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="6.213893521309041 3.587593097243447 13.19141931743424">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="7.456672225570852 2.8700744777947538 15.22086844319335">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="7.4373941282697125 4.313938235829207 23.41376906432179">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="6.213893521309041 3.587593097243448 19.27976669471158">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="7.456672225570848 2.870074477794756 21.30921582047069">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="6.213893521309039 6.457667575038204 17.25031756895247">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="4.971114817047232 5.7401489555895155 13.19141931743424">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="6.213893521309043 5.022630336140823 15.22086844319335">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="6.199474935966688 6.470604819240679 23.342889526393087">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="4.971114817047232 5.740148955589516 19.27976669471158">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="6.213893521309039 5.022630336140825 21.30921582047069">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="4.971114817047228 8.610223433384272 17.25031756895247">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="3.728336112785422 7.892704813935584 13.191419317434242">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="4.971114817047233 7.1751861944868915 15.220868443193352">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="4.966471482414586 8.619525679943216 23.35088056570185">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="3.7283361127854215 7.892704813935585 19.27976669471158">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="4.97111481704723 7.175186194486893 21.30921582047069">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="-1.8943824489375716 4.070607808785063 25.051864425528976">
          <shape>
            <appearance>
              <material diffuseColor="0.565 0.565 0.565"/>
            </appearance>
            <sphere radius="0.76"/>
          </shape>
        </transform>
        <transform translation="-1.7240518082088812 4.007878768922952 26.214314907601434">
          <shape>
            <appearance>
              <material diffuseColor="1.0 0.051 0.051"/>
            </appearance>
            <sphere radius="0.66"/>
          </shape>
        </transform>
      </group>
    </group>
  </transform>
</scene>
<!--End of Inserted Scene-->

        </X3D>
    </body>
</html>

</div></div>
</div>
</section>
<section id="step-3-generate-and-relax-initial-state-c-o">
<h3>Step 3: Generate and Relax Initial State (C* + O*)<a class="headerlink" href="#step-3-generate-and-relax-initial-state-c-o" title="Link to this heading">#</a></h3>
<p>Find the most stable configuration for dissociated C and O (reactants):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">2. Initial State: C* + O* on Ni(111)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   Generating C+O configurations...&quot;</span><span class="p">)</span>

<span class="n">ni_bulk_obj_c_o</span> <span class="o">=</span> <span class="n">Bulk</span><span class="p">(</span><span class="n">bulk_atoms</span><span class="o">=</span><span class="n">ni_bulk_atoms</span><span class="p">)</span>
<span class="n">ni_slab_c_o</span> <span class="o">=</span> <span class="n">Slab</span><span class="o">.</span><span class="n">from_bulk_get_specific_millers</span><span class="p">(</span>
    <span class="n">bulk</span><span class="o">=</span><span class="n">ni_bulk_obj_c_o</span><span class="p">,</span> <span class="n">specific_millers</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">adsorbate_c</span> <span class="o">=</span> <span class="n">Adsorbate</span><span class="p">(</span><span class="n">adsorbate_smiles_from_db</span><span class="o">=</span><span class="s2">&quot;*C&quot;</span><span class="p">)</span>
<span class="n">adsorbate_o</span> <span class="o">=</span> <span class="n">Adsorbate</span><span class="p">(</span><span class="n">adsorbate_smiles_from_db</span><span class="o">=</span><span class="s2">&quot;*O&quot;</span><span class="p">)</span>

<span class="n">multi_ads_config_c_o</span> <span class="o">=</span> <span class="n">MultipleAdsorbateSlabConfig</span><span class="p">(</span>
    <span class="n">ni_slab_c_o</span><span class="p">,</span> <span class="p">[</span><span class="n">adsorbate_c</span><span class="p">,</span> <span class="n">adsorbate_o</span><span class="p">],</span> <span class="n">num_configurations</span><span class="o">=</span><span class="n">num_sites</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   Generated </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">multi_ads_config_c_o</span><span class="o">.</span><span class="n">atoms_list</span><span class="p">)</span><span class="si">}</span><span class="s2"> configurations&quot;</span><span class="p">)</span>

<span class="n">c_o_energies</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">c_o_energies_ml</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">c_o_energies_d3</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">c_o_configs</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">config</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">multi_ads_config_c_o</span><span class="o">.</span><span class="n">atoms_list</span><span class="p">):</span>
    <span class="n">config_relaxed</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">config_relaxed</span><span class="o">.</span><span class="n">set_pbc</span><span class="p">([</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">])</span>
    <span class="n">config_relaxed</span><span class="o">.</span><span class="n">calc</span> <span class="o">=</span> <span class="n">base_calc</span>
    <span class="n">opt</span> <span class="o">=</span> <span class="n">LBFGS</span><span class="p">(</span><span class="n">config_relaxed</span><span class="p">,</span> <span class="n">logfile</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">opt</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">fmax</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="n">relaxation_steps</span><span class="p">)</span>

    <span class="c1"># Check C-O bond distance to ensure they haven&#39;t formed CO molecule</span>
    <span class="n">c_o_dist</span> <span class="o">=</span> <span class="n">config_relaxed</span><span class="p">[</span><span class="n">config_relaxed</span><span class="o">.</span><span class="n">get_tags</span><span class="p">()</span> <span class="o">==</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">get_distance</span><span class="p">(</span>
        <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">mic</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>

    <span class="c1"># CO bond length is ~1.15 Å, so if distance &lt; 1.5 Å, they&#39;ve formed a molecule</span>
    <span class="k">if</span> <span class="n">c_o_dist</span> <span class="o">&lt;</span> <span class="mf">1.5</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;     Config </span><span class="si">{</span><span class="n">idx</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">: ⚠ REJECTED - C and O formed CO molecule (d = </span><span class="si">{</span><span class="n">c_o_dist</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Å)&quot;</span>
        <span class="p">)</span>
        <span class="k">continue</span>

    <span class="n">E_ml</span> <span class="o">=</span> <span class="n">config_relaxed</span><span class="o">.</span><span class="n">get_potential_energy</span><span class="p">()</span>
    <span class="n">config_relaxed</span><span class="o">.</span><span class="n">calc</span> <span class="o">=</span> <span class="n">d3_calc</span>
    <span class="n">E_d3</span> <span class="o">=</span> <span class="n">config_relaxed</span><span class="o">.</span><span class="n">get_potential_energy</span><span class="p">()</span>
    <span class="n">E_total</span> <span class="o">=</span> <span class="n">E_ml</span> <span class="o">+</span> <span class="n">E_d3</span>

    <span class="n">c_o_energies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_total</span><span class="p">)</span>
    <span class="n">c_o_energies_ml</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_ml</span><span class="p">)</span>
    <span class="n">c_o_energies_d3</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_d3</span><span class="p">)</span>
    <span class="n">c_o_configs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">config_relaxed</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;     Config </span><span class="si">{</span><span class="n">idx</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">: E_total = </span><span class="si">{</span><span class="n">E_total</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV (RPBE: </span><span class="si">{</span><span class="n">E_ml</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, D3: </span><span class="si">{</span><span class="n">E_d3</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, C-O dist: </span><span class="si">{</span><span class="n">c_o_dist</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Å)&quot;</span>
    <span class="p">)</span>

<span class="n">best_c_o_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">c_o_energies</span><span class="p">)</span>
<span class="n">initial_c_o</span> <span class="o">=</span> <span class="n">c_o_configs</span><span class="p">[</span><span class="n">best_c_o_idx</span><span class="p">]</span>
<span class="n">E_initial_c_o</span> <span class="o">=</span> <span class="n">c_o_energies</span><span class="p">[</span><span class="n">best_c_o_idx</span><span class="p">]</span>
<span class="n">E_initial_c_o_ml</span> <span class="o">=</span> <span class="n">c_o_energies_ml</span><span class="p">[</span><span class="n">best_c_o_idx</span><span class="p">]</span>
<span class="n">E_initial_c_o_d3</span> <span class="o">=</span> <span class="n">c_o_energies_d3</span><span class="p">[</span><span class="n">best_c_o_idx</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   → Best C*+O* (Config </span><span class="si">{</span><span class="n">best_c_o_idx</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;      RPBE:  </span><span class="si">{</span><span class="n">E_initial_c_o_ml</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;      D3:    </span><span class="si">{</span><span class="n">E_initial_c_o_d3</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;      Total: </span><span class="si">{</span><span class="n">E_initial_c_o</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>

<span class="c1"># Save best C+O state</span>
<span class="n">ase</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">output_dir</span> <span class="o">/</span> <span class="n">part_dirs</span><span class="p">[</span><span class="s2">&quot;part6&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="s2">&quot;co_initial_best.traj&quot;</span><span class="p">),</span> <span class="n">initial_c_o</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   ✓ Best C*+O* structure saved&quot;</span><span class="p">)</span>

<span class="c1"># Visualize best C*+O* structure</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Visualizing best C*+O* structure...&quot;</span><span class="p">)</span>
<span class="n">view</span><span class="p">(</span><span class="n">initial_c_o</span><span class="p">,</span> <span class="n">viewer</span><span class="o">=</span><span class="s1">&#39;x3d&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2. Initial State: C* + O* on Ni(111)
   Generating C+O configurations...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   Generated 2 configurations
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     Config 1: E_total = -502.74 eV (RPBE: -465.84, D3: -36.90, C-O dist: 4.25 Å)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     Config 2: E_total = -502.83 eV (RPBE: -465.93, D3: -36.90, C-O dist: 5.55 Å)

   → Best C*+O* (Config 2):
      RPBE:  -465.93 eV
      D3:    -36.90 eV
      Total: -502.83 eV
   ✓ Best C*+O* structure saved

   Visualizing best C*+O* structure...
</pre></div>
</div>
<div class="output text_html"><html>
    <head>
        <title>ASE atomic visualization</title>
        <link rel="stylesheet" type="text/css"             href="https://www.x3dom.org/release/x3dom.css"></link>
        <script type="text/javascript"             src="https://www.x3dom.org/release/x3dom.js"></script>
    </head>
    <body>
        <X3D width="400px"; height="300px";>

<!--Inserting Generated X3D Scene-->
<scene>
  <viewpoint position="0 0 73.06016852732809">
    <group/>
  </viewpoint>
  <transform translation="-4.971114817047235 -4.305111716692138 -18.265042131832022">
    <group>
      <group>
        <transform translation="0 0 0">
          <shape>
            <appearance>
              <material diffuseColor="0 0 0"/>
            </appearance>
            <lineset vertexCount="5">
              <coordinate point="0 0 0 9.94222963409447 0.0 6.087859848890877e-16 4.971114817047231 8.610223433384276 1.2175719697781757e-15 -4.97111481704724 8.610223433384276 6.087859848890878e-16 0 0 0"/>
            </lineset>
          </shape>
        </transform>
        <transform translation="0.0 0.0 36.530084263664044">
          <shape>
            <appearance>
              <material diffuseColor="0 0 0"/>
            </appearance>
            <lineset vertexCount="5">
              <coordinate point="0 0 0 9.94222963409447 0.0 6.087859848890877e-16 4.971114817047231 8.610223433384276 1.2175719697781757e-15 -4.97111481704724 8.610223433384276 6.087859848890878e-16 0 0 0"/>
            </lineset>
          </shape>
        </transform>
        <transform translation="0 0 0">
          <shape>
            <appearance>
              <material diffuseColor="0 0 0"/>
            </appearance>
            <lineset vertexCount="5">
              <coordinate point="0 0 0 9.94222963409447 0.0 6.087859848890877e-16 9.94222963409447 0.0 36.530084263664044 0.0 0.0 36.530084263664044 0 0 0"/>
            </lineset>
          </shape>
        </transform>
        <transform translation="-4.97111481704724 8.610223433384276 6.087859848890878e-16">
          <shape>
            <appearance>
              <material diffuseColor="0 0 0"/>
            </appearance>
            <lineset vertexCount="5">
              <coordinate point="0 0 0 9.94222963409447 0.0 6.087859848890877e-16 9.94222963409447 0.0 36.530084263664044 0.0 0.0 36.530084263664044 0 0 0"/>
            </lineset>
          </shape>
        </transform>
      </group>
      <group>
        <transform translation="1.2427787042618053 2.152555858346066 17.25031756895247">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="-1.3322676295501878e-15 1.435037238897378 13.19141931743424">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="1.242778704261809 0.7175186194486851 15.22086844319335">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="1.1749015582538502 2.090364102194914 23.395525225521673">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="-1.887379141862766e-15 1.4350372388973789 19.27976669471158">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="1.2427787042618061 0.7175186194486871 21.30921582047069">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="-4.6629367034256575e-15 4.305111716692135 17.25031756895247">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="-1.2427787042618113 3.587593097243447 13.19141931743424">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="-8.881784197001252e-16 2.8700744777947538 15.22086844319335">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="0.02744924242142499 4.293733114654694 23.3131185076707">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="-1.242778704261812 3.587593097243448 19.27976669471158">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="-3.774758283725532e-15 2.870074477794756 21.30921582047069">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="-1.2427787042618146 6.457667575038204 17.25031756895247">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="-2.485557408523621 5.7401489555895155 13.19141931743424">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="-1.2427787042618108 5.022630336140823 15.22086844319335">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="-1.175501127662075 6.494405620697352 23.44246032085703">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="-2.4855574085236216 5.740148955589516 19.27976669471158">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="-1.2427787042618137 5.022630336140825 21.30921582047069">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="-2.4855574085236243 8.610223433384272 17.25031756895247">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="-3.728336112785431 7.892704813935584 13.19141931743424">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="-2.4855574085236203 7.1751861944868915 15.22086844319335">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="-2.460530588698477 8.637972817089938 23.336188209108336">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="-3.7283361127854313 7.892704813935585 19.27976669471158">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="-2.4855574085236234 7.175186194486893 21.30921582047069">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="3.728336112785423 2.152555858346066 17.25031756895247">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="2.4855574085236163 1.435037238897378 13.19141931743424">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="3.728336112785427 0.7175186194486851 15.22086844319335">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="3.8629870256197583 2.0836582078853523 23.412999848394797">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="2.485557408523616 1.4350372388973789 19.27976669471158">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="3.7283361127854238 0.7175186194486871 21.30921582047069">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="2.485557408523613 4.305111716692135 17.25031756895247">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="1.2427787042618064 3.587593097243447 13.19141931743424">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="2.4855574085236167 2.8700744777947538 15.22086844319335">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="2.5139967447762483 4.275779198783946 23.492455608855202">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="1.2427787042618057 3.587593097243448 19.27976669471158">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="2.485557408523614 2.870074477794756 21.30921582047069">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="1.242778704261803 6.457667575038204 17.25031756895247">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="-3.552713678800501e-15 5.7401489555895155 13.19141931743424">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="1.2427787042618068 5.022630336140823 15.22086844319335">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="1.2755307470581532 6.421191294396111 23.347485482703455">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="-4.107825191113079e-15 5.740148955589516 19.27976669471158">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="1.242778704261804 5.022630336140825 21.30921582047069">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="-6.661338147750939e-15 8.610223433384272 17.25031756895247">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="-1.2427787042618132 7.892704813935584 13.19141931743424">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="-2.886579864025407e-15 7.1751861944868915 15.22086844319335">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="0.058905928279270325 8.550791075099731 23.344601628170317">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="-1.2427787042618137 7.892704813935585 19.27976669471158">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="-5.773159728050814e-15 7.175186194486893 21.30921582047069">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="6.213893521309041 2.152555858346066 17.25031756895247">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="4.9711148170472335 1.435037238897378 13.19141931743424">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="6.2138935213090445 0.7175186194486851 15.22086844319335">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="6.271489122337924 2.128330620006497 23.351822500870007">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="4.9711148170472335 1.4350372388973789 19.27976669471158">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="6.213893521309041 0.7175186194486871 21.30921582047069">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="4.97111481704723 4.305111716692135 17.25031756895247">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="3.7283361127854238 3.587593097243447 13.19141931743424">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="4.971114817047234 2.8700744777947538 15.22086844319335">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="4.998784366559446 4.287334534079216 23.314462729426218">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="3.7283361127854233 3.587593097243448 19.27976669471158">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="4.971114817047232 2.870074477794756 21.30921582047069">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="3.7283361127854207 6.457667575038204 17.25031756895247">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="2.485557408523614 5.7401489555895155 13.19141931743424">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="3.728336112785424 5.022630336140823 15.22086844319335">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="3.730739224972009 6.417952918478976 23.34638250138942">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="2.4855574085236136 5.740148955589516 19.27976669471158">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="3.7283361127854215 5.022630336140825 21.30921582047069">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="2.485557408523611 8.610223433384272 17.25031756895247">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="1.2427787042618044 7.892704813935584 13.19141931743424">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="2.485557408523615 7.1751861944868915 15.22086844319335">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="2.510935256498211 8.573944643834146 23.35322609841824">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="1.242778704261804 7.892704813935585 19.27976669471158">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="2.485557408523612 7.175186194486893 21.30921582047069">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="8.699450929832658 2.152555858346066 17.25031756895247">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="7.456672225570852 1.435037238897378 13.19141931743424">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="8.699450929832661 0.7175186194486851 15.22086844319335">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="8.677089012324128 2.136955961214741 23.347870505978612">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="7.456672225570851 1.4350372388973789 19.27976669471158">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="8.69945092983266 0.7175186194486871 21.30921582047069">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="7.456672225570848 4.305111716692135 17.25031756895247">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="6.213893521309041 3.587593097243447 13.19141931743424">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="7.456672225570852 2.8700744777947538 15.22086844319335">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="7.476460445513563 4.290302356546542 23.436835946133037">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="6.213893521309041 3.587593097243448 19.27976669471158">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="7.456672225570848 2.870074477794756 21.30921582047069">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="6.213893521309039 6.457667575038204 17.25031756895247">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="4.971114817047232 5.7401489555895155 13.19141931743424">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="6.213893521309043 5.022630336140823 15.22086844319335">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="6.218314062652322 6.476942594034471 23.43700146270185">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="4.971114817047232 5.740148955589516 19.27976669471158">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="6.213893521309039 5.022630336140825 21.30921582047069">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="4.971114817047228 8.610223433384272 17.25031756895247">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="3.728336112785422 7.892704813935584 13.191419317434242">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="4.971114817047233 7.1751861944868915 15.220868443193352">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="4.951074242534555 8.5799664097025 23.343923561589968">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="3.7283361127854215 7.892704813935585 19.27976669471158">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="4.97111481704723 7.175186194486893 21.30921582047069">
          <shape>
            <appearance>
              <material diffuseColor="0.314 0.816 0.314"/>
            </appearance>
            <sphere radius="1.24"/>
          </shape>
        </transform>
        <transform translation="2.5253573553356765 2.702188568661349 24.35327773496841">
          <shape>
            <appearance>
              <material diffuseColor="0.565 0.565 0.565"/>
            </appearance>
            <sphere radius="0.76"/>
          </shape>
        </transform>
        <transform translation="-2.444235533825006 5.768718131973518 24.53221795848159">
          <shape>
            <appearance>
              <material diffuseColor="1.0 0.051 0.051"/>
            </appearance>
            <sphere radius="0.66"/>
          </shape>
        </transform>
      </group>
    </group>
  </transform>
</scene>
<!--End of Inserted Scene-->

        </X3D>
    </body>
</html>

</div></div>
</div>
</section>
<section id="step-3b-calculate-c-and-o-energies-separately">
<h3>Step 3b: Calculate C* and O* Energies Separately<a class="headerlink" href="#step-3b-calculate-c-and-o-energies-separately" title="Link to this heading">#</a></h3>
<p>Another strategy to calculate the initial energies for *C and *O at very low coverage (without interactions between the two reactants) is to do two separate relaxations.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Clean slab</span>
<span class="n">ni_bulk_obj</span> <span class="o">=</span> <span class="n">Bulk</span><span class="p">(</span><span class="n">bulk_atoms</span><span class="o">=</span><span class="n">ni_bulk_atoms</span><span class="p">)</span>
<span class="n">clean_slab</span> <span class="o">=</span> <span class="n">Slab</span><span class="o">.</span><span class="n">from_bulk_get_specific_millers</span><span class="p">(</span>
    <span class="n">bulk</span><span class="o">=</span><span class="n">ni_bulk_obj_c_o</span><span class="p">,</span> <span class="n">specific_millers</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">atoms</span>
<span class="n">clean_slab</span><span class="o">.</span><span class="n">set_pbc</span><span class="p">([</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">])</span>
<span class="n">clean_slab</span><span class="o">.</span><span class="n">calc</span> <span class="o">=</span> <span class="n">base_calc</span>
<span class="n">opt</span> <span class="o">=</span> <span class="n">LBFGS</span><span class="p">(</span><span class="n">clean_slab</span><span class="p">,</span> <span class="n">logfile</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">opt</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">fmax</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="n">relaxation_steps</span><span class="p">)</span>

<span class="n">E_clean_ml</span> <span class="o">=</span> <span class="n">clean_slab</span><span class="o">.</span><span class="n">get_potential_energy</span><span class="p">()</span>
<span class="n">clean_slab</span><span class="o">.</span><span class="n">calc</span> <span class="o">=</span> <span class="n">d3_calc</span>
<span class="n">E_clean_d3</span> <span class="o">=</span> <span class="n">clean_slab</span><span class="o">.</span><span class="n">get_potential_energy</span><span class="p">()</span>
<span class="n">E_clean</span> <span class="o">=</span> <span class="n">E_clean_ml</span> <span class="o">+</span> <span class="n">E_clean_d3</span>

<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Clean slab: E_total = </span><span class="si">{</span><span class="n">E_clean</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV (RPBE: </span><span class="si">{</span><span class="n">E_clean_ml</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, D3: </span><span class="si">{</span><span class="n">E_clean_d3</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">)&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   Clean slab: E_total = -487.46 eV (RPBE: -450.89, D3: -36.57)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">2b. Separate C* and O* Energies:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    Calculating energies in separate unit cells to avoid interactions&quot;</span><span class="p">)</span>

<span class="n">ni_bulk_obj_c_o</span> <span class="o">=</span> <span class="n">Bulk</span><span class="p">(</span><span class="n">bulk_atoms</span><span class="o">=</span><span class="n">ni_bulk_atoms</span><span class="p">)</span>
<span class="n">ni_slab_c_o</span> <span class="o">=</span> <span class="n">Slab</span><span class="o">.</span><span class="n">from_bulk_get_specific_millers</span><span class="p">(</span>
    <span class="n">bulk</span><span class="o">=</span><span class="n">ni_bulk_obj_c_o</span><span class="p">,</span> <span class="n">specific_millers</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Generating C* configurations...&quot;</span><span class="p">)</span>
<span class="n">multi_ads_config_c</span> <span class="o">=</span> <span class="n">MultipleAdsorbateSlabConfig</span><span class="p">(</span>
    <span class="n">ni_slab_c_o</span><span class="p">,</span>
    <span class="n">adsorbates</span><span class="o">=</span><span class="p">[</span><span class="n">Adsorbate</span><span class="p">(</span><span class="n">adsorbate_smiles_from_db</span><span class="o">=</span><span class="s2">&quot;*C&quot;</span><span class="p">)],</span>
    <span class="n">num_configurations</span><span class="o">=</span><span class="n">num_sites</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">c_energies</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">c_energies_ml</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">c_energies_d3</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">c_configs</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">config</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">multi_ads_config_c</span><span class="o">.</span><span class="n">atoms_list</span><span class="p">):</span>
    <span class="n">config_relaxed</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">config_relaxed</span><span class="o">.</span><span class="n">set_pbc</span><span class="p">([</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">])</span>
    <span class="n">config_relaxed</span><span class="o">.</span><span class="n">calc</span> <span class="o">=</span> <span class="n">base_calc</span>
    <span class="n">opt</span> <span class="o">=</span> <span class="n">LBFGS</span><span class="p">(</span><span class="n">config_relaxed</span><span class="p">,</span> <span class="n">logfile</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">opt</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">fmax</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="n">relaxation_steps</span><span class="p">)</span>

    <span class="n">E_ml</span> <span class="o">=</span> <span class="n">config_relaxed</span><span class="o">.</span><span class="n">get_potential_energy</span><span class="p">()</span>
    <span class="n">config_relaxed</span><span class="o">.</span><span class="n">calc</span> <span class="o">=</span> <span class="n">d3_calc</span>
    <span class="n">E_d3</span> <span class="o">=</span> <span class="n">config_relaxed</span><span class="o">.</span><span class="n">get_potential_energy</span><span class="p">()</span>
    <span class="n">E_total</span> <span class="o">=</span> <span class="n">E_ml</span> <span class="o">+</span> <span class="n">E_d3</span>

    <span class="n">c_energies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_total</span><span class="p">)</span>
    <span class="n">c_energies_ml</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_ml</span><span class="p">)</span>
    <span class="n">c_energies_d3</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_d3</span><span class="p">)</span>
    <span class="n">c_configs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">config_relaxed</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;     Config </span><span class="si">{</span><span class="n">idx</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">: E_total = </span><span class="si">{</span><span class="n">E_total</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV (RPBE: </span><span class="si">{</span><span class="n">E_ml</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, D3: </span><span class="si">{</span><span class="n">E_d3</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">)&quot;</span>
    <span class="p">)</span>

<span class="n">best_c_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">c_energies</span><span class="p">)</span>
<span class="n">c_ads</span> <span class="o">=</span> <span class="n">c_configs</span><span class="p">[</span><span class="n">best_c_idx</span><span class="p">]</span>
<span class="n">E_c</span> <span class="o">=</span> <span class="n">c_energies</span><span class="p">[</span><span class="n">best_c_idx</span><span class="p">]</span>
<span class="n">E_c_ml</span> <span class="o">=</span> <span class="n">c_energies_ml</span><span class="p">[</span><span class="n">best_c_idx</span><span class="p">]</span>
<span class="n">E_c_d3</span> <span class="o">=</span> <span class="n">c_energies_d3</span><span class="p">[</span><span class="n">best_c_idx</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   → Best C* (Config </span><span class="si">{</span><span class="n">best_c_idx</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;      RPBE:  </span><span class="si">{</span><span class="n">E_c_ml</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;      D3:    </span><span class="si">{</span><span class="n">E_c_d3</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;      Total: </span><span class="si">{</span><span class="n">E_c</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>

<span class="c1"># Save best C state</span>
<span class="n">ase</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">output_dir</span> <span class="o">/</span> <span class="n">part_dirs</span><span class="p">[</span><span class="s2">&quot;part6&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="s2">&quot;c_best.traj&quot;</span><span class="p">),</span> <span class="n">c_ads</span><span class="p">)</span>

<span class="c1"># Visualize best C* structure</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Visualizing best C* structure...&quot;</span><span class="p">)</span>
<span class="n">view</span><span class="p">(</span><span class="n">c_ads</span><span class="p">,</span> <span class="n">viewer</span><span class="o">=</span><span class="s1">&#39;x3d&#39;</span><span class="p">)</span>

<span class="c1"># Generate O* configuration</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Generating O* configurations...&quot;</span><span class="p">)</span>
<span class="n">multi_ads_config_o</span> <span class="o">=</span> <span class="n">MultipleAdsorbateSlabConfig</span><span class="p">(</span>
    <span class="n">ni_slab_c_o</span><span class="p">,</span>
    <span class="n">adsorbates</span><span class="o">=</span><span class="p">[</span><span class="n">Adsorbate</span><span class="p">(</span><span class="n">adsorbate_smiles_from_db</span><span class="o">=</span><span class="s2">&quot;*O&quot;</span><span class="p">)],</span>
    <span class="n">num_configurations</span><span class="o">=</span><span class="n">num_sites</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">o_energies</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">o_energies_ml</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">o_energies_d3</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">o_configs</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">config</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">multi_ads_config_o</span><span class="o">.</span><span class="n">atoms_list</span><span class="p">):</span>
    <span class="n">config_relaxed</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">config_relaxed</span><span class="o">.</span><span class="n">set_pbc</span><span class="p">([</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">])</span>
    <span class="n">config_relaxed</span><span class="o">.</span><span class="n">calc</span> <span class="o">=</span> <span class="n">base_calc</span>
    <span class="n">opt</span> <span class="o">=</span> <span class="n">LBFGS</span><span class="p">(</span><span class="n">config_relaxed</span><span class="p">,</span> <span class="n">logfile</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">opt</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">fmax</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="n">relaxation_steps</span><span class="p">)</span>

    <span class="n">E_ml</span> <span class="o">=</span> <span class="n">config_relaxed</span><span class="o">.</span><span class="n">get_potential_energy</span><span class="p">()</span>
    <span class="n">config_relaxed</span><span class="o">.</span><span class="n">calc</span> <span class="o">=</span> <span class="n">d3_calc</span>
    <span class="n">E_d3</span> <span class="o">=</span> <span class="n">config_relaxed</span><span class="o">.</span><span class="n">get_potential_energy</span><span class="p">()</span>
    <span class="n">E_total</span> <span class="o">=</span> <span class="n">E_ml</span> <span class="o">+</span> <span class="n">E_d3</span>

    <span class="n">o_energies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_total</span><span class="p">)</span>
    <span class="n">o_energies_ml</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_ml</span><span class="p">)</span>
    <span class="n">o_energies_d3</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_d3</span><span class="p">)</span>
    <span class="n">o_configs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">config_relaxed</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;     Config </span><span class="si">{</span><span class="n">idx</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">: E_total = </span><span class="si">{</span><span class="n">E_total</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV (RPBE: </span><span class="si">{</span><span class="n">E_ml</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, D3: </span><span class="si">{</span><span class="n">E_d3</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">)&quot;</span>
    <span class="p">)</span>

<span class="n">best_o_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">o_energies</span><span class="p">)</span>
<span class="n">o_ads</span> <span class="o">=</span> <span class="n">o_configs</span><span class="p">[</span><span class="n">best_o_idx</span><span class="p">]</span>
<span class="n">E_o</span> <span class="o">=</span> <span class="n">o_energies</span><span class="p">[</span><span class="n">best_o_idx</span><span class="p">]</span>
<span class="n">E_o_ml</span> <span class="o">=</span> <span class="n">o_energies_ml</span><span class="p">[</span><span class="n">best_o_idx</span><span class="p">]</span>
<span class="n">E_o_d3</span> <span class="o">=</span> <span class="n">o_energies_d3</span><span class="p">[</span><span class="n">best_o_idx</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   → Best O* (Config </span><span class="si">{</span><span class="n">best_o_idx</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;      RPBE:  </span><span class="si">{</span><span class="n">E_o_ml</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;      D3:    </span><span class="si">{</span><span class="n">E_o_d3</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;      Total: </span><span class="si">{</span><span class="n">E_o</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>

<span class="c1"># Save best O state</span>
<span class="n">ase</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">output_dir</span> <span class="o">/</span> <span class="n">part_dirs</span><span class="p">[</span><span class="s2">&quot;part6&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="s2">&quot;o_best.traj&quot;</span><span class="p">),</span> <span class="n">o_ads</span><span class="p">)</span>

<span class="c1"># Visualize best O* structure</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Visualizing best O* structure...&quot;</span><span class="p">)</span>
<span class="n">view</span><span class="p">(</span><span class="n">o_ads</span><span class="p">,</span> <span class="n">viewer</span><span class="o">=</span><span class="s1">&#39;x3d&#39;</span><span class="p">)</span>

<span class="c1"># Calculate combined energy for separate C* and O*</span>
<span class="n">E_initial_c_o_separate</span> <span class="o">=</span> <span class="n">E_c</span> <span class="o">+</span> <span class="n">E_o</span>
<span class="n">E_initial_c_o_separate_ml</span> <span class="o">=</span> <span class="n">E_c_ml</span> <span class="o">+</span> <span class="n">E_o_ml</span>
<span class="n">E_initial_c_o_separate_d3</span> <span class="o">=</span> <span class="n">E_c_d3</span> <span class="o">+</span> <span class="n">E_o_d3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2b. Separate C* and O* Energies:
    Calculating energies in separate unit cells to avoid interactions
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   Generating C* configurations...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     Config 1: E_total = -495.62 eV (RPBE: -458.84, D3: -36.78)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     Config 2: E_total = -493.23 eV (RPBE: -456.42, D3: -36.82)

   → Best C* (Config 1):
      RPBE:  -458.84 eV
      D3:    -36.78 eV
      Total: -495.62 eV

   Visualizing best C* structure...

   Generating O* configurations...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     Config 1: E_total = -494.61 eV (RPBE: -457.93, D3: -36.68)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     Config 2: E_total = -494.66 eV (RPBE: -457.97, D3: -36.69)

   → Best O* (Config 2):
      RPBE:  -457.97 eV
      D3:    -36.69 eV
      Total: -494.66 eV

   Visualizing best O* structure...
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Combined C* + O* (separate calculations):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;      RPBE:  </span><span class="si">{</span><span class="n">E_initial_c_o_separate_ml</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;      D3:    </span><span class="si">{</span><span class="n">E_initial_c_o_separate_d3</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;      Total: </span><span class="si">{</span><span class="n">E_initial_c_o_separate</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Comparison:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;      C*+O* (same cell):  </span><span class="si">{</span><span class="n">E_initial_c_o</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">E_clean</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;      C* + O* (separate): </span><span class="si">{</span><span class="n">E_initial_c_o_separate</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">E_clean</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;      Difference:         </span><span class="si">{</span><span class="p">(</span><span class="n">E_initial_c_o</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">E_clean</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="n">E_initial_c_o_separate</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">E_clean</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   ✓ Separate C* and O* energies calculated&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   Combined C* + O* (separate calculations):
      RPBE:  -916.81 eV
      D3:    -73.46 eV
      Total: -990.28 eV

   Comparison:
      C*+O* (same cell):  -15.37 eV
      C* + O* (separate): -15.36 eV
      Difference:         -0.01 eV
   ✓ Separate C* and O* energies calculated
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-4-calculate-reaction-energy-with-zpe">
<h3>Step 4: Calculate Reaction Energy with ZPE<a class="headerlink" href="#step-4-calculate-reaction-energy-with-zpe" title="Link to this heading">#</a></h3>
<p>Compute the thermochemistry for C* + O* → CO* with ZPE corrections:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">3. Reaction Energy (C* + O* → CO*):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   &quot;</span> <span class="o">+</span> <span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>

<span class="c1"># Electronic energies</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Electronic Energies:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;   Initial (C*+O*): RPBE = </span><span class="si">{</span><span class="n">E_initial_c_o_ml</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV, D3 = </span><span class="si">{</span><span class="n">E_initial_c_o_d3</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV, Total = </span><span class="si">{</span><span class="n">E_initial_c_o</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;   Final (CO*):     RPBE = </span><span class="si">{</span><span class="n">E_final_co_ml</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV, D3 = </span><span class="si">{</span><span class="n">E_final_co_d3</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV, Total = </span><span class="si">{</span><span class="n">E_final_co</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span>
<span class="p">)</span>

<span class="c1"># Reaction energies without ZPE</span>
<span class="n">delta_E_rpbe</span> <span class="o">=</span> <span class="n">E_final_co_ml</span> <span class="o">-</span> <span class="n">E_initial_c_o_ml</span>
<span class="n">delta_E_d3_contrib</span> <span class="o">=</span> <span class="n">E_final_co_d3</span> <span class="o">-</span> <span class="n">E_initial_c_o_d3</span>
<span class="n">delta_E_elec</span> <span class="o">=</span> <span class="n">E_final_co</span> <span class="o">-</span> <span class="n">E_initial_c_o</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Reaction Energies (without ZPE):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   ΔE(RPBE only):     </span><span class="si">{</span><span class="n">delta_E_rpbe</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV = </span><span class="si">{</span><span class="n">delta_E_rpbe</span><span class="o">*</span><span class="mf">96.485</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> kJ/mol&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;   ΔE(D3 contrib):    </span><span class="si">{</span><span class="n">delta_E_d3_contrib</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV = </span><span class="si">{</span><span class="n">delta_E_d3_contrib</span><span class="o">*</span><span class="mf">96.485</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> kJ/mol&quot;</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   ΔE(RPBE+D3):       </span><span class="si">{</span><span class="n">delta_E_elec</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV = </span><span class="si">{</span><span class="n">delta_E_elec</span><span class="o">*</span><span class="mf">96.485</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> kJ/mol&quot;</span><span class="p">)</span>

<span class="c1"># Calculate ZPE for CO* (final state)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Computing ZPE for CO*...&quot;</span><span class="p">)</span>
<span class="n">final_co</span><span class="o">.</span><span class="n">calc</span> <span class="o">=</span> <span class="n">base_calc</span>

<span class="n">co_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">final_co</span><span class="o">.</span><span class="n">get_tags</span><span class="p">()</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">vib_co</span> <span class="o">=</span> <span class="n">Vibrations</span><span class="p">(</span><span class="n">final_co</span><span class="p">,</span> <span class="n">indices</span><span class="o">=</span><span class="n">co_indices</span><span class="p">,</span> <span class="n">delta</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;vib_co&quot;</span><span class="p">)</span>
<span class="n">vib_co</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">vib_energies_co</span> <span class="o">=</span> <span class="n">vib_co</span><span class="o">.</span><span class="n">get_energies</span><span class="p">()</span>
<span class="n">zpe_co</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">vib_energies_co</span><span class="p">[</span><span class="n">vib_energies_co</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="mf">2.0</span>
<span class="n">vib_co</span><span class="o">.</span><span class="n">clean</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   ZPE(CO*): </span><span class="si">{</span><span class="n">zpe_co</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV (</span><span class="si">{</span><span class="n">zpe_co</span><span class="o">*</span><span class="mi">1000</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> meV)&quot;</span><span class="p">)</span>


<span class="c1"># Calculate ZPE for C* and O* (initial state)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Computing ZPE for C* and O*...&quot;</span><span class="p">)</span>
<span class="n">initial_c_o</span><span class="o">.</span><span class="n">calc</span> <span class="o">=</span> <span class="n">base_calc</span>
<span class="n">c_o_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">initial_c_o</span><span class="o">.</span><span class="n">get_tags</span><span class="p">()</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">vib_c_o</span> <span class="o">=</span> <span class="n">Vibrations</span><span class="p">(</span><span class="n">initial_c_o</span><span class="p">,</span> <span class="n">indices</span><span class="o">=</span><span class="n">c_o_indices</span><span class="p">,</span> <span class="n">delta</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;vib_c_o&quot;</span><span class="p">)</span>
<span class="n">vib_c_o</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">vib_energies_c_o</span> <span class="o">=</span> <span class="n">vib_c_o</span><span class="o">.</span><span class="n">get_energies</span><span class="p">()</span>
<span class="n">zpe_c_o</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">vib_energies_c_o</span><span class="p">[</span><span class="n">vib_energies_c_o</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="mf">2.0</span>
<span class="n">vib_c_o</span><span class="o">.</span><span class="n">clean</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   ZPE(C*+O*): </span><span class="si">{</span><span class="n">zpe_c_o</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV (</span><span class="si">{</span><span class="n">zpe_c_o</span><span class="o">*</span><span class="mi">1000</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> meV)&quot;</span><span class="p">)</span>


<span class="c1"># Total reaction energy with ZPE</span>
<span class="n">delta_zpe</span> <span class="o">=</span> <span class="n">zpe_co</span> <span class="o">-</span> <span class="n">zpe_c_o</span>
<span class="n">delta_E_zpe</span> <span class="o">=</span> <span class="n">delta_E_elec</span> <span class="o">+</span> <span class="n">delta_zpe</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Reaction Energy (with ZPE):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   ΔE(electronic):    </span><span class="si">{</span><span class="n">delta_E_elec</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV = </span><span class="si">{</span><span class="n">delta_E_elec</span><span class="o">*</span><span class="mf">96.485</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> kJ/mol&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;   ΔZPE:              </span><span class="si">{</span><span class="n">delta_zpe</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV = </span><span class="si">{</span><span class="n">delta_zpe</span><span class="o">*</span><span class="mf">96.485</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> kJ/mol (</span><span class="si">{</span><span class="n">delta_zpe</span><span class="o">*</span><span class="mi">1000</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> meV)&quot;</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   ΔE(total):         </span><span class="si">{</span><span class="n">delta_E_zpe</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV = </span><span class="si">{</span><span class="n">delta_E_zpe</span><span class="o">*</span><span class="mf">96.485</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> kJ/mol&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Summary:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;   Without D3, without ZPE: </span><span class="si">{</span><span class="n">delta_E_rpbe</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV = </span><span class="si">{</span><span class="n">delta_E_rpbe</span><span class="o">*</span><span class="mf">96.485</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> kJ/mol&quot;</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;   With D3, without ZPE:    </span><span class="si">{</span><span class="n">delta_E_elec</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV = </span><span class="si">{</span><span class="n">delta_E_elec</span><span class="o">*</span><span class="mf">96.485</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> kJ/mol&quot;</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;   With D3, with ZPE:       </span><span class="si">{</span><span class="n">delta_E_zpe</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV = </span><span class="si">{</span><span class="n">delta_E_zpe</span><span class="o">*</span><span class="mf">96.485</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> kJ/mol&quot;</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   &quot;</span> <span class="o">+</span> <span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Comparison with Paper (Table 5):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   Paper (DFT-D3): -142.7 kJ/mol = -1.48 eV&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   This work:      </span><span class="si">{</span><span class="n">delta_E_zpe</span><span class="o">*</span><span class="mf">96.485</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> kJ/mol = </span><span class="si">{</span><span class="n">delta_E_zpe</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   Difference:     </span><span class="si">{</span><span class="nb">abs</span><span class="p">(</span><span class="n">delta_E_zpe</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="o">-</span><span class="mf">1.48</span><span class="p">))</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>

<span class="k">if</span> <span class="n">delta_E_zpe</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   ✓ Reaction is exothermic (C+O recombination favorable)&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   ⚠ Reaction is endothermic (dissociation favorable)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3. Reaction Energy (C* + O* → CO*):
   ============================================================

   Electronic Energies:
   Initial (C*+O*): RPBE = -465.93 eV, D3 = -36.90 eV, Total = -502.83 eV
   Final (CO*):     RPBE = -466.74 eV, D3 = -36.87 eV, Total = -503.61 eV

   Reaction Energies (without ZPE):
   ΔE(RPBE only):     -0.81 eV = -78.3 kJ/mol
   ΔE(D3 contrib):    0.04 eV = 3.6 kJ/mol
   ΔE(RPBE+D3):       -0.77 eV = -74.8 kJ/mol

   Computing ZPE for CO*...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   ZPE(CO*): 0.18+0.01j eV (179.9+7.4j meV)

   Computing ZPE for C* and O*...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   ZPE(C*+O*): 0.18+0.00j eV (179.9+0.0j meV)

   Reaction Energy (with ZPE):
   ΔE(electronic):    -0.77 eV = -74.8 kJ/mol
   ΔZPE:              -0.00+0.01j eV = -0.0+0.7j kJ/mol (-0.1+7.4j meV)
   ΔE(total):         -0.77+0.01j eV = -74.8+0.7j kJ/mol

   Summary:
   Without D3, without ZPE: -0.81 eV = -78.3 kJ/mol
   With D3, without ZPE:    -0.77 eV = -74.8 kJ/mol
   With D3, with ZPE:       -0.77+0.01j eV = -74.8+0.7j kJ/mol

   ============================================================

   Comparison with Paper (Table 5):
   Paper (DFT-D3): -142.7 kJ/mol = -1.48 eV
   This work:      -74.8+0.7j kJ/mol = -0.77+0.01j eV
   Difference:     0.71 eV

   ✓ Reaction is exothermic (C+O recombination favorable)
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-5-calculate-co-adsorption-energy-bonus">
<h3>Step 5: Calculate CO Adsorption Energy (Bonus)<a class="headerlink" href="#step-5-calculate-co-adsorption-energy-bonus" title="Link to this heading">#</a></h3>
<p>Calculate how strongly CO binds to the surface:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">4. CO Adsorption Energy ( CO(g) + * → CO*):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   This helps us understand CO binding strength&quot;</span><span class="p">)</span>

<span class="c1"># CO(g)</span>
<span class="n">co_gas</span> <span class="o">=</span> <span class="n">Atoms</span><span class="p">(</span><span class="s2">&quot;CO&quot;</span><span class="p">,</span> <span class="n">positions</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1.15</span><span class="p">]])</span>
<span class="n">co_gas</span><span class="o">.</span><span class="n">center</span><span class="p">(</span><span class="n">vacuum</span><span class="o">=</span><span class="mf">10.0</span><span class="p">)</span>
<span class="n">co_gas</span><span class="o">.</span><span class="n">set_pbc</span><span class="p">([</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">])</span>
<span class="n">co_gas</span><span class="o">.</span><span class="n">calc</span> <span class="o">=</span> <span class="n">base_calc</span>
<span class="n">opt</span> <span class="o">=</span> <span class="n">LBFGS</span><span class="p">(</span><span class="n">co_gas</span><span class="p">,</span> <span class="n">logfile</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">opt</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">fmax</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="n">relaxation_steps</span><span class="p">)</span>

<span class="n">E_co_gas_ml</span> <span class="o">=</span> <span class="n">co_gas</span><span class="o">.</span><span class="n">get_potential_energy</span><span class="p">()</span>
<span class="n">co_gas</span><span class="o">.</span><span class="n">calc</span> <span class="o">=</span> <span class="n">d3_calc</span>
<span class="n">E_co_gas_d3</span> <span class="o">=</span> <span class="n">co_gas</span><span class="o">.</span><span class="n">get_potential_energy</span><span class="p">()</span>
<span class="n">E_co_gas</span> <span class="o">=</span> <span class="n">E_co_gas_ml</span> <span class="o">+</span> <span class="n">E_co_gas_d3</span>

<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;   CO(g):       E_total = </span><span class="si">{</span><span class="n">E_co_gas</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV (RPBE: </span><span class="si">{</span><span class="n">E_co_gas_ml</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, D3: </span><span class="si">{</span><span class="n">E_co_gas_d3</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">)&quot;</span>
<span class="p">)</span>

<span class="c1"># Calculate ZPE for CO(g)</span>
<span class="n">co_gas</span><span class="o">.</span><span class="n">calc</span> <span class="o">=</span> <span class="n">base_calc</span>
<span class="n">vib_co_gas</span> <span class="o">=</span> <span class="n">Vibrations</span><span class="p">(</span><span class="n">co_gas</span><span class="p">,</span> <span class="n">indices</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">delta</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">nfree</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">vib_co_gas</span><span class="o">.</span><span class="n">clean</span><span class="p">()</span>
<span class="n">vib_co_gas</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">vib_energies_co_gas</span> <span class="o">=</span> <span class="n">vib_co_gas</span><span class="o">.</span><span class="n">get_energies</span><span class="p">()</span>
<span class="n">zpe_co_gas</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">vib_energies_co_gas</span><span class="p">[</span><span class="n">vib_energies_co_gas</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">vib_co_gas</span><span class="o">.</span><span class="n">clean</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   ZPE(CO(g)):  </span><span class="si">{</span><span class="n">zpe_co_gas</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   ZPE(CO*):    </span><span class="si">{</span><span class="n">zpe_co</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV (from Step 4 calculation)&quot;</span><span class="p">)</span>

<span class="c1"># Electronic adsorption energy</span>
<span class="n">E_ads_co_elec</span> <span class="o">=</span> <span class="n">E_final_co</span> <span class="o">-</span> <span class="n">E_clean</span> <span class="o">-</span> <span class="n">E_co_gas</span>

<span class="c1"># ZPE contribution to adsorption energy</span>
<span class="n">delta_zpe_ads</span> <span class="o">=</span> <span class="n">zpe_co</span> <span class="o">-</span> <span class="n">zpe_co_gas</span>

<span class="c1"># Total adsorption energy with ZPE</span>
<span class="n">E_ads_co_total</span> <span class="o">=</span> <span class="n">E_ads_co_elec</span> <span class="o">+</span> <span class="n">delta_zpe_ads</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Electronic Energy Breakdown:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   ΔE(RPBE only) = </span><span class="si">{</span><span class="p">(</span><span class="n">E_final_co_ml</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">E_clean_ml</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">E_co_gas_ml</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   ΔE(D3 contrib) = </span><span class="si">{</span><span class="p">((</span><span class="n">E_final_co_d3</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">E_clean_d3</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">E_co_gas_d3</span><span class="p">))</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   ΔE(RPBE+D3) = </span><span class="si">{</span><span class="n">E_ads_co_elec</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   ZPE Contribution:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   ΔZPE = </span><span class="si">{</span><span class="n">delta_zpe_ads</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Total Adsorption Energy:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   ΔE(total) = </span><span class="si">{</span><span class="n">E_ads_co_total</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV = </span><span class="si">{</span><span class="n">E_ads_co_total</span><span class="o">*</span><span class="mf">96.485</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> kJ/mol&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Summary:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;   E_ads(CO) without ZPE = </span><span class="si">{</span><span class="o">-</span><span class="n">E_ads_co_elec</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV = </span><span class="si">{</span><span class="o">-</span><span class="n">E_ads_co_elec</span><span class="o">*</span><span class="mf">96.485</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> kJ/mol&quot;</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;   E_ads(CO) with ZPE    = </span><span class="si">{</span><span class="o">-</span><span class="n">E_ads_co_total</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV = </span><span class="si">{</span><span class="o">-</span><span class="n">E_ads_co_total</span><span class="o">*</span><span class="mf">96.485</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> kJ/mol&quot;</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;   → CO binds </span><span class="si">{</span><span class="nb">abs</span><span class="p">(</span><span class="n">E_ads_co_total</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV stronger than H (</span><span class="si">{</span><span class="nb">abs</span><span class="p">(</span><span class="n">E_ads_co_total</span><span class="p">)</span><span class="o">/</span><span class="mf">0.60</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">x)&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>4. CO Adsorption Energy ( CO(g) + * → CO*):
   This helps us understand CO binding strength
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   CO(g):       E_total = -14.43 eV (RPBE: -14.42, D3: -0.01)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   ZPE(CO(g)):  0.13+0.00j eV
   ZPE(CO*):    0.18+0.01j eV (from Step 4 calculation)

   Electronic Energy Breakdown:
   ΔE(RPBE only) = -1.43 eV
   ΔE(D3 contrib) = -0.28 eV
   ΔE(RPBE+D3) = -1.72 eV

   ZPE Contribution:
   ΔZPE = 0.05+0.01j eV

   Total Adsorption Energy:
   ΔE(total) = -1.67+0.01j eV = -160.9+0.7j kJ/mol

   Summary:
   E_ads(CO) without ZPE = 1.72 eV = 165.6 kJ/mol
   E_ads(CO) with ZPE    = 1.67-0.01j eV = 160.9-0.7j kJ/mol
   → CO binds 1.67 eV stronger than H (2.8x)
</pre></div>
</div>
</div>
</div>
<div class="tip admonition">
<p class="admonition-title">Comparison with Paper Results</p>
<p>The paper reports a CO adsorption energy of <strong>1.82 eV (175.6 kJ/mol)</strong> in Table 4, calculated using DFT (RPBE functional).</p>
<p>These results show:</p>
<ul class="simple">
<li><p><strong>Without ZPE</strong>: The electronic binding energy matches well with DFT predictions</p></li>
<li><p><strong>With ZPE</strong>: The zero-point energy correction reduces the binding strength slightly</p></li>
<li><p><strong>D3 Dispersion</strong>: Contributes to stronger binding due to van der Waals interactions</p></li>
</ul>
</div>
</section>
<section id="step-6-find-guesses-for-nearby-initial-and-final-states-for-the-reaction">
<h3>Step 6: Find guesses for nearby initial and final states for the reaction<a class="headerlink" href="#step-6-find-guesses-for-nearby-initial-and-final-states-for-the-reaction" title="Link to this heading">#</a></h3>
<p>Now that we have an estimate on the reaction energy from the best possible initial and final states, we want to find a transition state (barrier) for this reaction. There are MANY possible ways that we could do this. In this case, we’ll start with the *CO final state and then try and find a nearby local minimal of *C and *O, by fixing the C-O bond distance and finding a nearby local minima. Note that this approach required some insight into what the transition state might look like, and could be considerably more complicated for a reaction that did not involve breaking a single bond.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Finding Transition State Initial and Final States&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   Creating initial guess with stretched C-O bond...&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   Starting from CO* and stretching the C-O bond...&quot;</span><span class="p">)</span>

<span class="c1"># Create a guess structure with stretched CO bond (start from CO*)</span>
<span class="n">initial_guess</span> <span class="o">=</span> <span class="n">final_co</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1"># Set up a constraint to fix the bond length to ~2 Angstroms, which should be far enough that we&#39;ll be closer to *C+*O than *CO</span>
<span class="n">co_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">initial_guess</span><span class="o">.</span><span class="n">get_tags</span><span class="p">()</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># Rotate the atoms a bit just to break the symmetry and prevent the O from going straight up to satisfy the constraint</span>
<span class="n">initial_slab</span> <span class="o">=</span> <span class="n">initial_guess</span><span class="p">[</span><span class="n">initial_guess</span><span class="o">.</span><span class="n">get_tags</span><span class="p">()</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">initial_co</span> <span class="o">=</span> <span class="n">initial_guess</span><span class="p">[</span><span class="n">initial_guess</span><span class="o">.</span><span class="n">get_tags</span><span class="p">()</span> <span class="o">==</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">initial_co</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="n">initial_co</span><span class="o">.</span><span class="n">positions</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">initial_guess</span> <span class="o">=</span> <span class="n">initial_slab</span> <span class="o">+</span> <span class="n">initial_co</span>

<span class="n">initial_guess</span><span class="o">.</span><span class="n">calc</span> <span class="o">=</span> <span class="n">FAIRChemCalculator</span><span class="p">(</span><span class="n">predictor</span><span class="p">,</span> <span class="n">task_name</span><span class="o">=</span><span class="s2">&quot;oc20&quot;</span><span class="p">)</span>

<span class="c1"># Add constraints to keep the CO bond length extended</span>
<span class="n">initial_guess</span><span class="o">.</span><span class="n">constraints</span> <span class="o">+=</span> <span class="p">[</span>
    <span class="n">FixBondLengths</span><span class="p">([</span><span class="n">co_indices</span><span class="p">],</span> <span class="n">tolerance</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">,</span> <span class="n">iterations</span><span class="o">=</span><span class="mi">5000</span><span class="p">,</span> <span class="n">bondlengths</span><span class="o">=</span><span class="p">[</span><span class="mf">2.0</span><span class="p">])</span>
<span class="p">]</span>


<span class="k">try</span><span class="p">:</span>
    <span class="n">opt</span> <span class="o">=</span> <span class="n">LBFGS</span><span class="p">(</span>
        <span class="n">initial_guess</span><span class="p">,</span>
        <span class="n">trajectory</span><span class="o">=</span><span class="n">output_dir</span> <span class="o">/</span> <span class="n">part_dirs</span><span class="p">[</span><span class="s2">&quot;part6&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="s2">&quot;initial_guess_with_constraint.traj&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">opt</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">fmax</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">RuntimeError</span><span class="p">:</span>
    <span class="c1"># The FixBondLength constraint is sometimes a little finicky,</span>
    <span class="c1"># but it&#39;s ok if it doesn&#39;t finish as it&#39;s just an initial guess</span>
    <span class="c1"># for the next step</span>
    <span class="k">pass</span>

<span class="c1"># Now that we have a guess, re-relax without the constraints</span>
<span class="n">initial_guess</span><span class="o">.</span><span class="n">constraints</span> <span class="o">=</span> <span class="n">initial_guess</span><span class="o">.</span><span class="n">constraints</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">opt</span> <span class="o">=</span> <span class="n">LBFGS</span><span class="p">(</span>
    <span class="n">initial_guess</span><span class="p">,</span>
    <span class="n">trajectory</span><span class="o">=</span><span class="n">output_dir</span>
    <span class="o">/</span> <span class="n">part_dirs</span><span class="p">[</span><span class="s2">&quot;part6&quot;</span><span class="p">]</span>
    <span class="o">/</span> <span class="s2">&quot;initial_guess_without_constraint.traj&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">opt</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">fmax</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finding Transition State Initial and Final States
   Creating initial guess with stretched C-O bond...
   Starting from CO* and stretching the C-O bond...
       Step     Time          Energy          fmax
LBFGS:    0 01:08:37     -466.457410        1.235362
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:    1 01:08:37     -457.886728       21.070261
LBFGS:    2 01:08:37     -457.897762       21.003347
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:    3 01:08:37     -458.020584       20.271877
LBFGS:    4 01:08:38     -458.123785       19.657719
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:    5 01:08:38     -458.201822       19.202162
LBFGS:    6 01:08:38     -458.258360       18.886269
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:    7 01:08:38     -458.297691       18.682741
LBFGS:    8 01:08:38     -458.323620       18.564884
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:    9 01:08:38     -458.339723       18.507841
LBFGS:   10 01:08:39     -458.348703       18.492603
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   11 01:08:39     -458.353134       18.502142
LBFGS:   12 01:08:39     -458.355158       18.522882
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   13 01:08:39     -458.356260       18.545191
LBFGS:   14 01:08:39     -458.356836       18.566225
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   15 01:08:40     -458.357216       18.584185
LBFGS:   16 01:08:40     -458.357445       18.599298
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   17 01:08:40     -458.357574       18.611725
LBFGS:   18 01:08:40     -458.357652       18.621908
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   19 01:08:40     -458.357740       18.629816
LBFGS:   20 01:08:41     -458.357773       18.636322
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   21 01:08:41     -458.357771       18.641640
LBFGS:   22 01:08:41     -458.357799       18.645687
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   23 01:08:41     -458.357780       18.649015
LBFGS:   24 01:08:41     -458.357815       18.651449
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   25 01:08:41     -458.357834       18.653364
LBFGS:   26 01:08:42     -458.357834       18.655024
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   27 01:08:42     -458.357824       18.656330
LBFGS:   28 01:08:42     -458.357834       18.657238
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   29 01:08:42     -458.357828       18.658123
LBFGS:   30 01:08:42     -458.357828       18.658701
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   31 01:08:43     -458.357836       18.659140
LBFGS:   32 01:08:43     -458.357803       18.659678
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   33 01:08:43     -458.357832       18.659830
LBFGS:   34 01:08:43     -458.357803       18.660297
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   35 01:08:43     -458.357803       18.660398
LBFGS:   36 01:08:43     -458.357761       18.661489
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   37 01:08:44     -458.357721       18.663038
LBFGS:   38 01:08:44     -458.357647       18.665115
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   39 01:08:44     -458.357654       18.666462
LBFGS:   40 01:08:44     -458.357654       18.667057
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   41 01:08:44     -458.357616       18.666897
LBFGS:   42 01:08:45     -458.357378       18.666552
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   43 01:08:45     -458.356912       18.666330
LBFGS:   44 01:08:45     -458.356449       18.665442
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   45 01:08:45     -458.356218       18.663364
LBFGS:   46 01:08:45     -458.356314       18.661036
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   47 01:08:46     -458.356123       18.663223
LBFGS:   48 01:08:46     -458.354122       18.681311
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   49 01:08:46     -458.350057       18.715979
LBFGS:   50 01:08:46     -458.347175       18.742588
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   51 01:08:46     -458.347917       18.742123
LBFGS:   52 01:08:46     -458.345676       18.752886
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   53 01:08:47     -458.335646       18.806097
LBFGS:   54 01:08:47     -458.323135       18.871250
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   55 01:08:47     -458.318827       18.887232
LBFGS:   56 01:08:47     -458.321518       18.866394
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   57 01:08:47     -458.287163       19.105822
LBFGS:   58 01:08:48     -458.183897       19.808889
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   59 01:08:48     -458.264753       19.281881
LBFGS:   60 01:08:48     -458.332107       18.855043
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   61 01:08:48     -458.445015       18.137457
LBFGS:   62 01:08:48     -458.515524       17.665823
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   63 01:08:48     -459.175859       12.294524
LBFGS:   64 01:08:49     -459.623339        8.460474
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   65 01:08:49     -459.975193        6.099518
LBFGS:   66 01:08:49     -460.047516        5.301149
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   67 01:08:49     -460.140179        4.202792
LBFGS:   68 01:08:49     -460.203441        3.371725
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   69 01:08:50     -460.243044        2.803480
LBFGS:   70 01:08:50     -460.268400        2.416131
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   71 01:08:50     -460.285404        2.151353
LBFGS:   72 01:08:50     -460.298450        1.965558
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   73 01:08:50     -460.316290        1.802362
LBFGS:   74 01:08:51     -460.341898        1.754352
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   75 01:08:51     -460.450704        1.563850
LBFGS:   76 01:08:51     -460.529840        1.614408
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   77 01:08:51     -460.614183        1.677660
LBFGS:   78 01:08:51     -460.693180        1.751536
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   79 01:08:51     -460.768724        1.836837
LBFGS:   80 01:08:52     -460.849407        1.934351
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>       Step     Time          Energy          fmax
LBFGS:    0 01:08:52     -460.945364        4.899061
LBFGS:    1 01:08:52     -461.572538        5.676132
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:    2 01:08:52     -460.044832        3.444048
LBFGS:    3 01:08:52     -459.370519        1.960394
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:    4 01:08:53     -459.395263        2.155663
LBFGS:    5 01:08:53     -459.395954        2.010671
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:    6 01:08:53     -459.402597        2.084010
LBFGS:    7 01:08:53     -459.397047        2.016138
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:    8 01:08:53     -459.398054        2.021356
LBFGS:    9 01:08:54     -459.381155        1.967549
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   10 01:08:54     -459.355116        1.936168
LBFGS:   11 01:08:54     -459.263500        2.219321
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   12 01:08:54     -459.046415        2.644918
LBFGS:   13 01:08:54     -458.574852        2.909438
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   14 01:08:54     -458.016598        2.737810
LBFGS:   15 01:08:55     -458.825088        4.656148
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   16 01:08:55     -458.428703        4.594637
LBFGS:   17 01:08:55     -457.951835        2.836390
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   18 01:08:55     -457.690931        2.041894
LBFGS:   19 01:08:55     -457.486690        1.706881
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   20 01:08:56     -457.651201        1.763432
LBFGS:   21 01:08:56     -457.759661        1.652885
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   22 01:08:56     -457.876331        1.553453
LBFGS:   23 01:08:56     -457.288242        2.675728
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   24 01:08:56     -457.578867        2.493493
LBFGS:   25 01:08:56     -457.865614        2.530370
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   26 01:08:57     -457.683565        2.119993
LBFGS:   27 01:08:57     -457.547054        1.805481
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   28 01:08:57     -457.333925        2.004536
LBFGS:   29 01:08:57     -457.607511        1.478717
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   30 01:08:57     -457.811682        1.435729
LBFGS:   31 01:08:58     -457.686811        1.330572
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   32 01:08:58     -457.768493        1.677454
LBFGS:   33 01:08:58     -457.598091        1.566423
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   34 01:08:58     -457.466043        1.521230
LBFGS:   35 01:08:58     -457.624464        1.402520
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   36 01:08:59     -457.793529        1.518148
LBFGS:   37 01:08:59     -457.647611        1.254274
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   38 01:08:59     -457.518875        1.217375
LBFGS:   39 01:08:59     -457.650514        1.232129
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   40 01:08:59     -457.797214        1.472183
LBFGS:   41 01:08:59     -457.655704        1.217924
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   42 01:09:00     -457.532804        1.151052
LBFGS:   43 01:09:00     -457.393955        1.731137
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   44 01:09:00     -457.545627        1.088464
LBFGS:   45 01:09:00     -457.685182        1.161843
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   46 01:09:00     -457.594930        2.023331
LBFGS:   47 01:09:01     -457.703340        1.189931
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   48 01:09:01     -457.740747        1.836606
LBFGS:   49 01:09:01     -457.796310        2.048100
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   50 01:09:01     -457.663956        1.487003
LBFGS:   51 01:09:01     -457.544836        1.359854
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   52 01:09:01     -457.418131        1.695464
LBFGS:   53 01:09:02     -457.559702        1.256403
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   54 01:09:02     -457.705004        1.235076
LBFGS:   55 01:09:02     -457.581877        1.044431
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   56 01:09:02     -457.469114        1.314311
LBFGS:   57 01:09:02     -457.585460        1.021282
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   58 01:09:03     -457.709339        1.202780
LBFGS:   59 01:09:03     -457.591760        0.997705
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   60 01:09:03     -457.486465        1.245340
LBFGS:   61 01:09:03     -457.591873        0.992829
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   62 01:09:03     -457.707302        1.231476
LBFGS:   63 01:09:04     -457.593557        1.011696
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   64 01:09:04     -457.492971        1.297383
LBFGS:   65 01:09:04     -457.592949        1.034232
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   66 01:09:04     -457.704338        1.260941
LBFGS:   67 01:09:04     -457.593248        1.071917
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   68 01:09:04     -457.495785        1.388927
LBFGS:   69 01:09:05     -457.592794        1.087037
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   70 01:09:05     -457.702110        1.263374
LBFGS:   71 01:09:05     -457.592853        1.129045
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   72 01:09:05     -457.497083        1.501847
LBFGS:   73 01:09:05     -457.592762        1.133394
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   74 01:09:06     -457.700786        1.239385
LBFGS:   75 01:09:06     -457.593185        1.166436
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   76 01:09:06     -457.499042        1.595945
LBFGS:   77 01:09:06     -457.593073        1.169934
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   78 01:09:06     -457.699385        1.219314
LBFGS:   79 01:09:06     -457.593576        1.199250
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   80 01:09:07     -457.501251        1.675446
LBFGS:   81 01:09:07     -457.593450        1.203800
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   82 01:09:07     -457.697828        1.208654
LBFGS:   83 01:09:07     -457.594160        1.226859
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   84 01:09:07     -457.504162        1.733077
LBFGS:   85 01:09:08     -457.593967        1.233095
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   86 01:09:08     -457.695835        1.209862
LBFGS:   87 01:09:08     -457.594929        1.249046
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   88 01:09:08     -457.507847        1.768699
LBFGS:   89 01:09:08     -457.594675        1.256359
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   90 01:09:09     -457.693397        1.219382
LBFGS:   91 01:09:09     -457.595827        1.266652
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   92 01:09:09     -457.512077        1.788217
LBFGS:   93 01:09:09     -457.595764        1.268338
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   94 01:09:09     -457.691252        1.220468
LBFGS:   95 01:09:09     -457.597154        1.272688
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   96 01:09:10     -457.516790        1.796522
LBFGS:   97 01:09:10     -457.420627        2.596159
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   98 01:09:10     -457.529428        1.619582
LBFGS:   99 01:09:10     -457.628143        0.986295
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  100 01:09:10     -457.741257        1.208372
LBFGS:  101 01:09:11     -457.632889        0.998090
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  102 01:09:11     -457.551557        1.326869
LBFGS:  103 01:09:11     -457.460281        2.244387
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  104 01:09:11     -457.555557        1.306460
LBFGS:  105 01:09:11     -457.642135        0.991197
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  106 01:09:12     -457.560139        1.213756
LBFGS:  107 01:09:12     -457.470705        2.070580
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  108 01:09:12     -457.564443        1.184698
LBFGS:  109 01:09:12     -457.651993        0.991061
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  110 01:09:12     -457.568777        1.106252
LBFGS:  111 01:09:12     -457.479809        1.929669
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  112 01:09:13     -457.573850        1.054430
LBFGS:  113 01:09:13     -457.667921        1.047514
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  114 01:09:13     -457.581199        0.895050
LBFGS:  115 01:09:13     -457.495212        1.679696
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  116 01:09:14     -457.593832        0.961906
LBFGS:  117 01:09:14     -457.716888        1.375443
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  118 01:09:14     -457.630152        1.238159
LBFGS:  119 01:09:14     -457.699827        2.000355
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  120 01:09:14     -457.608129        1.830063
LBFGS:  121 01:09:15     -457.498903        2.628019
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  122 01:09:15     -457.620039        1.041748
LBFGS:  123 01:09:15     -457.742714        1.480712
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  124 01:09:15     -457.603418        0.924050
LBFGS:  125 01:09:15     -457.500927        1.951494
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  126 01:09:15     -457.606445        0.903667
LBFGS:  127 01:09:16     -457.705478        1.111755
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  128 01:09:16     -457.614532        0.930492
LBFGS:  129 01:09:16     -457.524654        1.617213
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  130 01:09:16     -457.615661        0.907363
LBFGS:  131 01:09:16     -457.701097        1.012375
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  132 01:09:17     -457.618351        0.894033
LBFGS:  133 01:09:17     -457.529226        1.644174
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  134 01:09:17     -457.620939        0.883509
LBFGS:  135 01:09:17     -457.710266        1.004226
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  136 01:09:17     -457.620371        0.930891
LBFGS:  137 01:09:17     -457.522314        1.819847
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  138 01:09:18     -457.625305        0.923518
LBFGS:  139 01:09:18     -457.727505        1.034092
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  140 01:09:18     -457.627882        0.955468
LBFGS:  141 01:09:18     -457.522062        1.918818
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  142 01:09:18     -457.636192        0.907911
LBFGS:  143 01:09:19     -457.751091        1.083741
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  144 01:09:19     -457.641167        0.890929
LBFGS:  145 01:09:19     -457.527693        1.926089
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  146 01:09:19     -457.648977        0.865280
LBFGS:  147 01:09:19     -457.772264        1.130477
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  148 01:09:20     -457.655922        0.876116
LBFGS:  149 01:09:20     -457.540586        1.837206
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  150 01:09:20     -457.663019        0.883935
LBFGS:  151 01:09:20     -457.789976        1.152086
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  152 01:09:20     -457.672355        0.900106
LBFGS:  153 01:09:20     -457.559910        1.697738
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  154 01:09:21     -457.677360        0.900045
LBFGS:  155 01:09:21     -457.798845        1.143740
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  156 01:09:21     -457.683218        0.902778
LBFGS:  157 01:09:21     -457.571411        1.688690
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  158 01:09:21     -457.688349        0.903313
LBFGS:  159 01:09:22     -457.810156        1.146501
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  160 01:09:22     -457.694052        0.904105
LBFGS:  161 01:09:22     -457.582531        1.700743
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  162 01:09:22     -457.699877        0.906797
LBFGS:  163 01:09:22     -457.823625        1.157674
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  164 01:09:23     -457.706568        0.909463
LBFGS:  165 01:09:23     -457.596372        1.697536
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  166 01:09:23     -457.713020        0.913770
LBFGS:  167 01:09:23     -457.837910        1.171788
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  168 01:09:23     -457.720924        0.918525
LBFGS:  169 01:09:23     -457.613911        1.677880
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  170 01:09:24     -457.727264        0.920564
LBFGS:  171 01:09:24     -457.849697        1.174827
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  172 01:09:24     -457.734976        0.920779
LBFGS:  173 01:09:24     -457.631841        1.707296
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  174 01:09:24     -457.733263        1.038080
LBFGS:  175 01:09:25     -457.858179        1.155097
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  176 01:09:25     -457.751779        0.983471
LBFGS:  177 01:09:25     -457.671833        2.320556
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  178 01:09:25     -457.755338        0.962749
LBFGS:  179 01:09:25     -457.741865        0.919900
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  180 01:09:26     -457.783798        1.082586
LBFGS:  181 01:09:26     -457.850742        1.349906
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  182 01:09:26     -457.765062        1.689911
LBFGS:  183 01:09:26     -457.886242        1.497678
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  184 01:09:26     -457.965843        2.312178
LBFGS:  185 01:09:26     -458.045118        2.129845
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  186 01:09:27     -458.075701        2.563945
LBFGS:  187 01:09:27     -458.188368        3.666040
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  188 01:09:27     -458.082329        2.531886
LBFGS:  189 01:09:27     -457.693964        2.422490
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  190 01:09:27     -458.026663        2.539800
LBFGS:  191 01:09:28     -458.356468        2.974961
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  192 01:09:28     -458.715837        3.367845
LBFGS:  193 01:09:28     -459.079954        3.630912
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  194 01:09:28     -459.528797        4.679524
LBFGS:  195 01:09:28     -459.781713        4.704908
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  196 01:09:29     -460.127712        4.662345
LBFGS:  197 01:09:29     -459.452440        5.073463
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  198 01:09:29     -458.889046        5.902257
LBFGS:  199 01:09:29     -459.952841        4.295217
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  200 01:09:29     -460.731726        4.093549
LBFGS:  201 01:09:29     -460.964817        4.779810
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  202 01:09:30     -461.109184        5.342700
LBFGS:  203 01:09:30     -461.201589        5.699441
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  204 01:09:30     -461.065637        5.691577
LBFGS:  205 01:09:30     -461.222790        5.704697
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  206 01:09:30     -461.272240        5.573318
LBFGS:  207 01:09:31     -461.358723        5.399243
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  208 01:09:31     -461.610172        5.025172
LBFGS:  209 01:09:31     -461.758917        4.872730
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  210 01:09:31     -461.733167        5.155903
LBFGS:  211 01:09:31     -461.752470        4.900412
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  212 01:09:32     -461.745790        4.937763
LBFGS:  213 01:09:32     -461.762073        4.797685
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  214 01:09:32     -461.774076        4.743517
LBFGS:  215 01:09:32     -461.858541        4.573487
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  216 01:09:32     -461.793314        4.692974
LBFGS:  217 01:09:32     -461.758278        5.070798
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  218 01:09:33     -461.807636        4.669194
LBFGS:  219 01:09:33     -461.858293        4.562495
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  220 01:09:33     -461.808878        4.741568
LBFGS:  221 01:09:33     -461.818550        4.913167
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  222 01:09:33     -461.794552        5.080938
LBFGS:  223 01:09:34     -461.854788        4.842637
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  224 01:09:34     -461.921324        4.610044
LBFGS:  225 01:09:34     -462.139211        3.974101
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  226 01:09:34     -462.358238        3.558806
LBFGS:  227 01:09:34     -462.461027        3.605600
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  228 01:09:35     -462.577299        3.673139
LBFGS:  229 01:09:35     -462.655918        3.721697
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  230 01:09:35     -462.647713        3.718748
LBFGS:  231 01:09:35     -462.659145        3.710040
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  232 01:09:35     -462.662182        3.700500
LBFGS:  233 01:09:35     -462.677296        3.629063
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  234 01:09:36     -462.730388        3.551309
LBFGS:  235 01:09:36     -462.856808        3.690082
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  236 01:09:36     -462.977504        3.832412
LBFGS:  237 01:09:36     -463.096948        4.320032
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  238 01:09:36     -463.059604        4.644385
LBFGS:  239 01:09:37     -463.084110        4.385116
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  240 01:09:37     -463.074635        4.462598
LBFGS:  241 01:09:37     -463.110658        4.286007
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  242 01:09:37     -463.084139        4.689034
LBFGS:  243 01:09:37     -463.119641        4.055234
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  244 01:09:38     -463.087396        3.185429
LBFGS:  245 01:09:38     -463.171597        3.881901
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  246 01:09:38     -463.233298        3.762484
LBFGS:  247 01:09:38     -463.614038        3.261270
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  248 01:09:38     -463.939916        2.951233
LBFGS:  249 01:09:39     -463.871715        4.069519
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  250 01:09:39     -464.408711        2.096166
LBFGS:  251 01:09:39     -464.539278        2.233810
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  252 01:09:39     -464.715787        2.417780
LBFGS:  253 01:09:39     -464.916271        2.898124
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  254 01:09:39     -465.042558        1.125449
LBFGS:  255 01:09:40     -465.099426        1.217232
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  256 01:09:40     -465.148181        1.128841
LBFGS:  257 01:09:40     -465.184031        1.217430
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  258 01:09:40     -465.230069        1.367149
LBFGS:  259 01:09:40     -465.265683        1.397457
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  260 01:09:41     -465.311479        1.337995
LBFGS:  261 01:09:41     -465.369775        1.451440
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  262 01:09:41     -465.438866        1.513549
LBFGS:  263 01:09:41     -465.507423        1.500378
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  264 01:09:41     -465.579380        1.346442
LBFGS:  265 01:09:42     -465.664405        1.285532
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  266 01:09:42     -465.772298        1.379226
LBFGS:  267 01:09:42     -465.860261        1.471876
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  268 01:09:42     -465.945973        1.392578
LBFGS:  269 01:09:42     -466.025864        1.057792
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  270 01:09:42     -466.168814        1.034469
LBFGS:  271 01:09:43     -466.247900        1.547969
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  272 01:09:43     -466.285819        1.162820
LBFGS:  273 01:09:43     -466.339558        1.147084
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  274 01:09:43     -466.403871        1.315849
LBFGS:  275 01:09:43     -466.439537        1.187579
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  276 01:09:44     -466.474009        1.121478
LBFGS:  277 01:09:44     -466.499890        0.986549
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  278 01:09:44     -466.528248        1.024867
LBFGS:  279 01:09:44     -466.555650        1.033549
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  280 01:09:44     -466.577336        1.017292
LBFGS:  281 01:09:45     -466.601369        1.232683
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  282 01:09:45     -466.632864        1.231372
LBFGS:  283 01:09:45     -466.666497        0.945914
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  284 01:09:45     -466.692590        0.944195
LBFGS:  285 01:09:45     -466.735411        1.097471
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  286 01:09:45     -466.765054        1.167578
LBFGS:  287 01:09:46     -466.791867        1.149137
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  288 01:09:46     -466.824892        1.063403
LBFGS:  289 01:09:46     -466.846491        1.155409
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  290 01:09:46     -466.870878        0.848406
LBFGS:  291 01:09:46     -466.912457        0.820108
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  292 01:09:47     -466.971798        0.816857
LBFGS:  293 01:09:47     -466.994901        0.893506
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  294 01:09:47     -467.021638        0.800547
LBFGS:  295 01:09:47     -467.043687        0.543972
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  296 01:09:47     -467.066224        0.376146
LBFGS:  297 01:09:48     -467.076298        0.393983
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  298 01:09:48     -467.081152        0.364375
LBFGS:  299 01:09:48     -467.085183        0.427570
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  300 01:09:48     -467.087489        0.446484
LBFGS:  301 01:09:48     -467.088252        0.457772
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  302 01:09:48     -467.088407        0.458316
LBFGS:  303 01:09:49     -467.088579        0.458919
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  304 01:09:49     -467.088765        0.465140
LBFGS:  305 01:09:49     -467.089057        0.465423
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  306 01:09:49     -467.090010        0.454065
LBFGS:  307 01:09:49     -467.090485        0.446543
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  308 01:09:50     -467.091994        0.431084
LBFGS:  309 01:09:50     -467.096439        0.380421
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  310 01:09:50     -467.099373        0.349944
LBFGS:  311 01:09:50     -467.103390        0.314945
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  312 01:09:50     -467.106983        0.287627
LBFGS:  313 01:09:51     -467.110999        0.263022
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  314 01:09:51     -467.114948        0.248702
LBFGS:  315 01:09:51     -467.118826        0.234862
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  316 01:09:51     -467.122096        0.205766
LBFGS:  317 01:09:51     -467.124830        0.159294
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  318 01:09:51     -467.127523        0.122808
LBFGS:  319 01:09:52     -467.130164        0.109452
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  320 01:09:52     -467.132180        0.077809
LBFGS:  321 01:09:52     -467.133475        0.071740
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  322 01:09:52     -467.134579        0.065719
LBFGS:  323 01:09:52     -467.135804        0.056066
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  324 01:09:53     -467.137047        0.064671
LBFGS:  325 01:09:53     -467.137977        0.064195
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  326 01:09:53     -467.138560        0.072674
LBFGS:  327 01:09:53     -467.139073        0.067835
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  328 01:09:53     -467.139684        0.052994
LBFGS:  329 01:09:54     -467.140302        0.042983
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  330 01:09:54     -467.140659        0.033525
LBFGS:  331 01:09:54     -467.140849        0.023891
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  332 01:09:54     -467.141002        0.023031
LBFGS:  333 01:09:54     -467.141176        0.022740
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  334 01:09:54     -467.141315        0.021019
LBFGS:  335 01:09:55     -467.141371        0.015861
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  336 01:09:55     -467.141397        0.011485
LBFGS:  337 01:09:55     -467.141416        0.008309
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>np.True_
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-7-run-neb-to-find-activation-barrier">
<h3>Step 7: Run NEB to Find Activation Barrier<a class="headerlink" href="#step-7-run-neb-to-find-activation-barrier" title="Link to this heading">#</a></h3>
<p>Use the nudged elastic band method to find the minimum energy path:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">7. NEB Barrier Calculation (C* + O* → CO*)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   Setting up 7-image NEB chain with TS guess in middle...&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   Reaction: C* + O* (initial) → TS → CO* (final)&quot;</span><span class="p">)</span>

<span class="n">initial</span> <span class="o">=</span> <span class="n">initial_guess</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">initial</span><span class="o">.</span><span class="n">calc</span> <span class="o">=</span> <span class="n">FAIRChemCalculator</span><span class="p">(</span><span class="n">predictor</span><span class="p">,</span> <span class="n">task_name</span><span class="o">=</span><span class="s2">&quot;oc20&quot;</span><span class="p">)</span>
<span class="n">images</span> <span class="o">=</span> <span class="p">[</span><span class="n">initial</span><span class="p">]</span>  <span class="c1"># Start with C* + O*</span>

<span class="n">n_images</span> <span class="o">=</span> <span class="mi">10</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_images</span><span class="p">):</span>
    <span class="n">image</span> <span class="o">=</span> <span class="n">initial</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">image</span><span class="o">.</span><span class="n">calc</span> <span class="o">=</span> <span class="n">FAIRChemCalculator</span><span class="p">(</span><span class="n">predictor</span><span class="p">,</span> <span class="n">task_name</span><span class="o">=</span><span class="s2">&quot;oc20&quot;</span><span class="p">)</span>
    <span class="n">images</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>

<span class="n">final</span> <span class="o">=</span> <span class="n">final_co</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">final</span><span class="o">.</span><span class="n">calc</span> <span class="o">=</span> <span class="n">FAIRChemCalculator</span><span class="p">(</span><span class="n">predictor</span><span class="p">,</span> <span class="n">task_name</span><span class="o">=</span><span class="s2">&quot;oc20&quot;</span><span class="p">)</span>
<span class="n">images</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">final</span><span class="p">)</span>  <span class="c1"># End with CO*</span>

<span class="c1"># Interpolate with better initial guess</span>
<span class="n">dyneb</span> <span class="o">=</span> <span class="n">DyNEB</span><span class="p">(</span><span class="n">images</span><span class="p">,</span> <span class="n">climb</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>

<span class="c1"># Interpolate first half (C*+O* → TS)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Interpolating images...&quot;</span><span class="p">)</span>
<span class="n">dyneb</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="s2">&quot;idpp&quot;</span><span class="p">,</span> <span class="n">mic</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Optimize</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   Optimizing NEB path (this may take a while)...&quot;</span><span class="p">)</span>
<span class="n">opt</span> <span class="o">=</span> <span class="n">FIRE</span><span class="p">(</span>
    <span class="n">dyneb</span><span class="p">,</span>
    <span class="n">trajectory</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">output_dir</span> <span class="o">/</span> <span class="n">part_dirs</span><span class="p">[</span><span class="s2">&quot;part6&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="s2">&quot;neb.traj&quot;</span><span class="p">),</span>
    <span class="n">logfile</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">output_dir</span> <span class="o">/</span> <span class="n">part_dirs</span><span class="p">[</span><span class="s2">&quot;part6&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="s2">&quot;neb.log&quot;</span><span class="p">),</span>
<span class="p">)</span>
<span class="n">opt</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">fmax</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="n">relaxation_steps</span><span class="p">)</span>

<span class="c1"># Extract barrier (from C*+O* to TS)</span>
<span class="n">energies</span> <span class="o">=</span> <span class="p">[</span><span class="n">img</span><span class="o">.</span><span class="n">get_potential_energy</span><span class="p">()</span> <span class="k">for</span> <span class="n">img</span> <span class="ow">in</span> <span class="n">images</span><span class="p">]</span>
<span class="n">energies_rel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">energies</span><span class="p">)</span> <span class="o">-</span> <span class="n">energies</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">E_barrier</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">energies_rel</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   ✓ NEB converged!&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Forward barrier (C*+O* → CO*): </span><span class="si">{</span><span class="n">E_barrier</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV = </span><span class="si">{</span><span class="n">E_barrier</span><span class="o">*</span><span class="mf">96.485</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> kJ/mol&quot;</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;   Reverse barrier (CO* → C*+O*): </span><span class="si">{</span><span class="n">E_barrier</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">energies_rel</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV = </span><span class="si">{</span><span class="p">(</span><span class="n">E_barrier</span><span class="o">-</span><span class="w"> </span><span class="n">energies_rel</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="mf">96.485</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> kJ/mol&quot;</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Paper (Table 5): 153 kJ/mol = 1.59 eV &quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   Difference: </span><span class="si">{</span><span class="nb">abs</span><span class="p">(</span><span class="n">E_barrier</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">1.59</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>7. NEB Barrier Calculation (C* + O* → CO*)
   Setting up 7-image NEB chain with TS guess in middle...
   Reaction: C* + O* (initial) → TS → CO* (final)

   Interpolating images...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   Optimizing NEB path (this may take a while)...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   ✓ NEB converged!

   Forward barrier (C*+O* → CO*): 0.42 eV = 40.4 kJ/mol
   Reverse barrier (CO* → C*+O*): 0.02 eV = 1.7 kJ/mol

   Paper (Table 5): 153 kJ/mol = 1.59 eV 
   Difference: 1.17 eV
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-8-visualize-neb-path-and-key-structures">
<h3>Step 8: Visualize NEB Path and Key Structures<a class="headerlink" href="#step-8-visualize-neb-path-and-key-structures" title="Link to this heading">#</a></h3>
<p>Create plots showing the reaction pathway:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Creating NEB visualization...&quot;</span><span class="p">)</span>

<span class="c1"># Plot NEB path</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">energies_rel</span><span class="p">)),</span>
    <span class="n">energies_rel</span><span class="p">,</span>
    <span class="s2">&quot;o-&quot;</span><span class="p">,</span>
    <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;steelblue&quot;</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;NEB Path&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Initial: C*+O*&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">delta_E_zpe</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Final: CO*&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span>
    <span class="n">E_barrier</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;orange&quot;</span><span class="p">,</span>
    <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;:&quot;</span><span class="p">,</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
    <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Forward Barrier = </span><span class="si">{</span><span class="n">E_barrier</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Annotate transition state</span>
<span class="n">ts_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">energies_rel</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;TS</span><span class="se">\n</span><span class="si">{</span><span class="n">energies_rel</span><span class="p">[</span><span class="n">ts_idx</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">,</span>
    <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">ts_idx</span><span class="p">,</span> <span class="n">energies_rel</span><span class="p">[</span><span class="n">ts_idx</span><span class="p">]),</span>
    <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="n">ts_idx</span><span class="p">,</span> <span class="n">energies_rel</span><span class="p">[</span><span class="n">ts_idx</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.3</span><span class="p">),</span>
    <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
    <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span>
    <span class="n">fontweight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">,</span>
    <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s2">&quot;-&gt;&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">),</span>
<span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Image Number&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Relative Energy (eV)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span>
    <span class="s2">&quot;CO Formation on Ni(111): C* + O* → CO* - NEB Path&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper left&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span>
    <span class="nb">str</span><span class="p">(</span><span class="n">output_dir</span> <span class="o">/</span> <span class="n">part_dirs</span><span class="p">[</span><span class="s2">&quot;part6&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="s2">&quot;neb_path.png&quot;</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Create animation of NEB path</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Creating NEB path animation...&quot;</span><span class="p">)</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ase.io</span><span class="w"> </span><span class="kn">import</span> <span class="n">write</span> <span class="k">as</span> <span class="n">ase_write</span>

<span class="n">ase</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
    <span class="nb">str</span><span class="p">(</span><span class="n">output_dir</span> <span class="o">/</span> <span class="n">part_dirs</span><span class="p">[</span><span class="s2">&quot;part6&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="s2">&quot;neb_path.gif&quot;</span><span class="p">),</span> <span class="n">images</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;gif&quot;</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   → Saved as neb_path.gif&quot;</span><span class="p">)</span>

<span class="c1"># Visualize key structures</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Visualizing initial state (C* + O*)...&quot;</span><span class="p">)</span>
<span class="n">view</span><span class="p">(</span><span class="n">initial_c_o</span><span class="p">,</span> <span class="n">viewer</span><span class="o">=</span><span class="s1">&#39;x3d&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Visualizing transition state...&quot;</span><span class="p">)</span>
<span class="n">view</span><span class="p">(</span><span class="n">images</span><span class="p">[</span><span class="n">ts_idx</span><span class="p">],</span> <span class="n">viewer</span><span class="o">=</span><span class="s1">&#39;x3d&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Visualizing final state (CO*)...&quot;</span><span class="p">)</span>
<span class="n">view</span><span class="p">(</span><span class="n">final_co</span><span class="p">,</span> <span class="n">viewer</span><span class="o">=</span><span class="s1">&#39;x3d&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">✓ NEB analysis complete!&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   Creating NEB visualization...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/runner/work/_tool/Python/3.12.12/x64/lib/python3.12/site-packages/matplotlib/cbook.py:1355: ComplexWarning: Casting complex values to real discards the imaginary part
  return np.asarray(x, float)
</pre></div>
</div>
<img alt="../_images/850542a03adde3acaf4af6edbe963913d941dfb0008a2c67bc26cf2b88613a1e.png" src="../_images/850542a03adde3acaf4af6edbe963913d941dfb0008a2c67bc26cf2b88613a1e.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   Creating NEB path animation...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   → Saved as neb_path.gif

   Visualizing initial state (C* + O*)...

   Visualizing transition state...

   Visualizing final state (CO*)...

✓ NEB analysis complete!
</pre></div>
</div>
<img alt="../_images/01a3927790291ddad37190ba7ef2b7c4548ecfa6889ece359f679cbe5a8ccef5.png" src="../_images/01a3927790291ddad37190ba7ef2b7c4548ecfa6889ece359f679cbe5a8ccef5.png" />
</div>
</div>
<div class="dropdown tip admonition">
<p class="admonition-title">Missing UMA access?</p>
<p>Don’t have access to UMA yet? You can still explore this calculation!</p>
<p><a class="reference internal" href="#example_configs/co_on_ni111.xyz"><span class="xref myst">Download example CO on Ni(111) structure</span></a> and <a class="reference internal" href="#example_configs/c_o_on_ni111.xyz"><span class="xref myst">Download C+O on Ni(111) structure</span></a> to test in the <a class="reference external" href="https://facebook-fairchem-uma-demo.hf.space/">UMA demo (no login required)</a> and explore the reaction pathway.</p>
</div>
<div class="note admonition">
<p class="admonition-title">Comparison with Paper (Tables 4 &amp; 5)</p>
<p><strong>Expected Results from Paper:</strong></p>
<ul class="simple">
<li><p><em><em>Reaction Energy (C</em> + O</em> → CO*)**: <strong>-142.7 kJ/mol = -1.48 eV</strong> (exothermic, DFT-D3)</p></li>
<li><p><em><em>Activation Barrier (C</em> + O</em> → CO*)**: <strong>153 kJ/mol = 1.59 eV</strong> (reverse/dissociation, DFT-D3)</p></li>
<li><p><strong>CO Adsorption Energy</strong>: <strong>1.82 eV = 175.6 kJ/mol</strong> (DFT-D3)</p></li>
</ul>
<p><strong>Reaction Direction:</strong></p>
<ul class="simple">
<li><p>Paper reports CO dissociation barrier (CO* → C* + O*), which is the <strong>reverse</strong> of the recombination we calculate</p></li>
<li><p>Forward (C* + O* → CO*): barrier = reverse_barrier - |ΔE| ≈ 1.59 - 1.48 ≈ 0.11 eV (very fast)</p></li>
<li><p>Reverse (CO* → C* + O*): barrier = 1.59 eV (very slow, kinetic bottleneck)</p></li>
</ul>
<p><strong>What to Check:</strong></p>
<ul class="simple">
<li><p>Reaction energy (C*+O* → CO*) should be strongly exothermic (~-1.5 eV)</p></li>
<li><p>Reverse barrier (CO dissociation) should be substantial (~1.6 eV)</p></li>
<li><p>Forward barrier (recombination) should be very small (~0.1 eV)</p></li>
<li><p>CO binds much more strongly than H (1.82 eV vs 0.60 eV)</p></li>
</ul>
<p><strong>Typical Variations:</strong></p>
<ul class="simple">
<li><p>Reaction energies typically accurate within 0.1-0.2 eV</p></li>
<li><p>Barriers more sensitive: expect ±0.2-0.3 eV variation</p></li>
<li><p>ZPE corrections typically add 0.05-0.15 eV to reaction energies</p></li>
<li><p>NEB convergence affects barrier more than reaction energy</p></li>
</ul>
<p><strong>Physical Insight:</strong></p>
<ul class="simple">
<li><p>Large reverse barrier (1.59 eV) makes CO dissociation very slow at low T</p></li>
<li><p>Small forward barrier (0.11 eV) means C+O rapidly recombine to CO</p></li>
<li><p>This explains why Ni produces CO in Fischer-Tropsch rather than keeping C and O separate</p></li>
<li><p>High temperatures needed to overcome the dissociation barrier for further C-C coupling</p></li>
</ul>
</div>
<div class="note admonition">
<p class="admonition-title">NEB Method Explained</p>
<p>The <strong>Nudged Elastic Band (NEB)</strong> method finds the minimum energy path between reactants and products:</p>
<ol class="arabic simple">
<li><p><strong>Interpolate</strong> between initial and final states (5-9 images typical)</p></li>
<li><p><strong>Add spring forces</strong> along the chain to maintain spacing</p></li>
<li><p><strong>Project out</strong> spring components perpendicular to the path</p></li>
<li><p><strong>Climbing image</strong> variant: highest energy image climbs to saddle point</p></li>
</ol>
<p>Advantages:</p>
<ul class="simple">
<li><p>No prior knowledge of transition state needed</p></li>
<li><p>Finds entire reaction coordinate</p></li>
<li><p>Robust for complex reactions</p></li>
</ul>
<p>Limitations:</p>
<ul class="simple">
<li><p>Computationally expensive (optimize N images)</p></li>
<li><p>May find wrong path if initial interpolation is poor</p></li>
</ul>
</div>
</section>
<section id="id15">
<h3>Explore on Your Own<a class="headerlink" href="#id15" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p><strong>Image convergence</strong>: Run with 7 or 9 images. Does the barrier change?</p></li>
<li><p><strong>Spring constant</strong>: Modify the NEB spring constant. How does this affect convergence?</p></li>
<li><p><strong>Alternative paths</strong>: Try different initial CO/final C+O configurations. Are there multiple pathways?</p></li>
<li><p><strong>Reverse barrier</strong>: Calculate E_a(reverse) = E_a(forward) - ΔE. Check Brønsted-Evans-Polanyi relationship.</p></li>
<li><p><strong>Diffusion barriers</strong>: Compute NEB for C or O diffusion on the surface. How do they compare?</p></li>
</ol>
</section>
</section>
<hr class="docutils" />
<section id="summary-and-best-practices">
<h2>Summary and Best Practices<a class="headerlink" href="#summary-and-best-practices" title="Link to this heading">#</a></h2>
<section id="key-takeaways">
<h3>Key Takeaways<a class="headerlink" href="#key-takeaways" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p><strong>ML Potentials</strong>: UMa-S-1P1 provides ~1000× speedup over DFT with reasonable accuracy</p></li>
<li><p><strong>Bulk optimization</strong>: Always use the ML-optimized lattice constant for consistency</p></li>
<li><p><strong>Surface energies</strong>: Linear extrapolation eliminates finite-size effects</p></li>
<li><p><strong>Adsorption</strong>: Test multiple sites; lowest energy may not be intuitive</p></li>
<li><p><strong>Coverage</strong>: Lateral interactions become significant above ~0.3 ML</p></li>
<li><p><strong>Barriers</strong>: NEB requires careful setup but yields full reaction pathway</p></li>
</ol>
</section>
<section id="recommended-workflow-for-new-systems">
<h3>Recommended Workflow for New Systems<a class="headerlink" href="#recommended-workflow-for-new-systems" title="Link to this heading">#</a></h3>
<pre  class="mermaid">
        graph TD
    A[Optimize Bulk] --&gt; B[Calculate Surface Energies]
    B --&gt; C[Wulff Construction]
    C --&gt; D[Low-Coverage Adsorption]
    D --&gt; E{Coverage Important?}
    E --&gt;|Yes| F[Coverage Study]
    E --&gt;|No| G[Reaction Barriers]
    F --&gt; G
    G --&gt; H[Microkinetic Modeling]
    </pre></section>
<section id="accuracy-considerations">
<h3>Accuracy Considerations<a class="headerlink" href="#accuracy-considerations" title="Link to this heading">#</a></h3>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Property</p></th>
<th class="head"><p>Typical Error</p></th>
<th class="head"><p>When Critical</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Lattice constants</p></td>
<td><p>1-2%</p></td>
<td><p>Strain effects, alloys</p></td>
</tr>
<tr class="row-odd"><td><p>Surface energies</p></td>
<td><p>10-20%</p></td>
<td><p>Nanoparticle shapes</p></td>
</tr>
<tr class="row-even"><td><p>Adsorption energies</p></td>
<td><p>0.1-0.3 eV</p></td>
<td><p>Thermochemistry</p></td>
</tr>
<tr class="row-odd"><td><p>Barriers</p></td>
<td><p>0.2-0.5 eV</p></td>
<td><p>Kinetics, selectivity</p></td>
</tr>
</tbody>
</table>
</div>
<p><strong>Rule of thumb</strong>: Use ML for screening → DFT for validation → Experiment for verification</p>
</section>
<section id="further-reading">
<h3>Further Reading<a class="headerlink" href="#further-reading" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>UMA Paper</strong>: <a class="reference external" href="https://arxiv.org/abs/2506.23971">Wood et al. 2025</a></p></li>
<li><p><strong>OMat24 Paper</strong>: <a class="reference external" href="https://arxiv.org/abs/2410.12771">Barroso-Luque et al., 2024</a></p></li>
<li><p><strong>OC20 Dataset</strong>: <a class="reference external" href="https://pubs.acs.org/doi/full/10.1021/acscatal.0c04525">Chanussot et al., ACS Catalysis, 2021</a></p></li>
<li><p><strong>ASE Tutorial</strong>: <a class="reference external" href="https://wiki.fysik.dtu.dk/ase/">https://wiki.fysik.dtu.dk/ase/</a></p></li>
</ul>
</section>
</section>
<hr class="docutils" />
<section id="appendix-troubleshooting">
<h2>Appendix: Troubleshooting<a class="headerlink" href="#appendix-troubleshooting" title="Link to this heading">#</a></h2>
<section id="common-issues">
<h3>Common Issues<a class="headerlink" href="#common-issues" title="Link to this heading">#</a></h3>
<p><strong>Problem</strong>: Convergence failures</p>
<ul class="simple">
<li><p><strong>Solution</strong>: Reduce <code class="docutils literal notranslate"><span class="pre">fmax</span></code> to 0.1 initially, tighten later</p></li>
<li><p>Check if system is metastable (try different starting geometry)</p></li>
</ul>
<p><strong>Problem</strong>: NEB fails to find transition state</p>
<ul class="simple">
<li><p><strong>Solution</strong>: Use more images (9-11) or better initial guess</p></li>
<li><p>Try fixed-end NEB first, then climbing image</p></li>
</ul>
<p><strong>Problem</strong>: Unexpected adsorption energies</p>
<ul class="simple">
<li><p><strong>Solution</strong>: Visualize structures - check for distortions</p></li>
<li><p>Compare with multiple sites</p></li>
<li><p>Add D3 corrections</p></li>
</ul>
<p><strong>Problem</strong>: Out of memory</p>
<ul class="simple">
<li><p><strong>Solution</strong>: Reduce system size (smaller supercells)</p></li>
<li><p>Use fewer NEB images</p></li>
<li><p>Run on HPC with more RAM</p></li>
</ul>
</section>
<section id="performance-tips">
<h3>Performance Tips<a class="headerlink" href="#performance-tips" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p><strong>Use batching</strong>: Relax multiple configurations in parallel</p></li>
<li><p><strong>Start with DEBUG_MAX_STEPS=50</strong>: Get quick results, refine later</p></li>
<li><p><strong>Cache bulk energies</strong>: Don’t recalculate reference systems</p></li>
<li><p><strong>Trajectory analysis</strong>: Monitor optimization progress with ASE GUI</p></li>
</ol>
</section>
</section>
<hr class="docutils" />
<section id="caveats-and-pitfalls">
<h2>Caveats and Pitfalls<a class="headerlink" href="#caveats-and-pitfalls" title="Link to this heading">#</a></h2>
<div class="warning admonition">
<p class="admonition-title">Important Considerations</p>
<p>When using ML potentials for surface catalysis, be aware of these critical issues!</p>
</div>
<section id="task-selection-omat-vs-oc20">
<h3>1. Task Selection: OMAT vs OC20<a class="headerlink" href="#task-selection-omat-vs-oc20" title="Link to this heading">#</a></h3>
<p><strong>Critical choice</strong>: Which task_name to use?</p>
<ul class="simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">task_name=&quot;omat&quot;</span></code></strong>: Optimized for bulk and clean surface calculations</p>
<ul>
<li><p>Use for: Part 1 (bulk), Part 2 (surface energies), Part 3 (Wulff)</p></li>
<li><p>Better for structural relaxations without adsorbates</p></li>
</ul>
</li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">task_name=&quot;oc20&quot;</span></code></strong>: Optimized for surface chemistry with adsorbates</p>
<ul>
<li><p>Use for: Part 4-6 (all adsorbate calculations)</p></li>
<li><p>Trained on Open Catalyst data with adsorbate-surface interactions</p></li>
</ul>
</li>
</ul>
<p><strong>Impact</strong>: Using wrong task can lead to 0.1-0.3 eV errors in adsorption energies!</p>
</section>
<section id="d3-dispersion-corrections">
<h3>2. D3 Dispersion Corrections<a class="headerlink" href="#d3-dispersion-corrections" title="Link to this heading">#</a></h3>
<p><strong>Multiple decisions required</strong>:</p>
<ol class="arabic simple">
<li><p><strong>Whether to use D3 at all?</strong></p>
<ul class="simple">
<li><p>Small adsorbates (H, O, N): D3 effect ~0.01-0.05 eV (often negligible)</p></li>
<li><p>Large molecules (CO, CO₂, aromatics): D3 effect ~0.1-0.3 eV (important!)</p></li>
<li><p>Physisorption: D3 critical (can change binding from repulsive to attractive)</p></li>
<li><p>RPBE was originally fit for chemisorption energies without D3 corrections, so adding D3 corrections may actually cause small adsorbates to overbind. However, it probably would be important for larger molecules. It’s relatively uncommon to see RPBE+D3 as a choice in the catalysis literature (compared to PBE+D3, or RPBE, or BEEF-vdW).</p></li>
</ul>
</li>
<li><p><strong>Which DFT functional for D3?</strong></p>
<ul class="simple">
<li><p>This tutorial uses <code class="docutils literal notranslate"><span class="pre">method=&quot;PBE&quot;</span></code> consistently for the D3 correction. This is often implied when papers say they use a D3 correction, but the results can be different if use the RPBE parameterizations.</p></li>
<li><p>Original paper used PBE for bulk/surfaces, RPBE for adsorption. It’s not specified what D3 parameterization they used, but it’s likely PBE.</p></li>
</ul>
</li>
<li><p><strong>When to apply D3?</strong></p>
<ul class="simple">
<li><p><strong>End-point correction</strong> (used here): Fast, run ML optimization then add D3 energy</p></li>
<li><p><strong>During optimization</strong>: Slower but more accurate geometries</p></li>
<li><p><strong>Impact</strong>: Usually &lt;0.05 eV difference, but can be larger for weak interactions</p></li>
</ul>
</li>
</ol>
</section>
<section id="coverage-dependence-challenges">
<h3>3. Coverage Dependence Challenges<a class="headerlink" href="#coverage-dependence-challenges" title="Link to this heading">#</a></h3>
<p><strong>Non-linearity at high coverage</strong>:</p>
<ul class="simple">
<li><p>This tutorial assumes linear E_ads(θ) = E₀ + βθ</p></li>
<li><p>Reality: Often non-linear, especially near θ = 1 ML. See the plots generated - there is a linear regime for relatively high coverage, and relatively low coverage, but it’s not uniformly linear everywhere. As long as you consistently in one regime or the other a linear assumption is probably ok, but you could get into problems if solving microkinetic models where the coverage of the species in question changes significantly from very low to high.</p></li>
<li><p><strong>Why</strong>: Phase transitions, adsorbate ordering, surface reconstruction</p></li>
<li><p><strong>Solution</strong>: Test polynomial fits, look for ordering in visualizations</p></li>
</ul>
<p><strong>Low coverage limit</strong>:</p>
<ul class="simple">
<li><p>At θ &lt; 0.1 ML, coverage effects are tiny (&lt;0.01 eV)</p></li>
<li><p>Hard to distinguish from numerical noise</p></li>
<li><p><strong>Best practice</strong>: Focus on 0.25-1.0 ML range for fitting</p></li>
</ul>
</section>
<section id="periodic-boundary-conditions">
<h3>4. Periodic Boundary Conditions<a class="headerlink" href="#periodic-boundary-conditions" title="Link to this heading">#</a></h3>
<p><strong>UMa requires PBC=True in all directions!</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">atoms</span><span class="o">.</span><span class="n">set_pbc</span><span class="p">([</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">])</span>  <span class="c1"># Always required</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Forgetting this causes crashes or wrong energies</p></li>
<li><p>Even for “gas phase” molecules in vacuum</p></li>
</ul>
</section>
<section id="gas-phase-reference-energies">
<h3>5. Gas Phase Reference Energies<a class="headerlink" href="#gas-phase-reference-energies" title="Link to this heading">#</a></h3>
<p><strong>Tricky cases</strong>:</p>
<ul class="simple">
<li><p><strong>H₂(g)</strong>: UMa handles well (used in this tutorial)</p></li>
<li><p><strong>H(g)</strong>: May not be reliable (use H₂/2 instead)</p></li>
<li><p><strong>CO(g)</strong>, <strong>O₂(g)</strong>: Usually okay, but check against DFT</p></li>
<li><p><strong>Radicals</strong>: Often problematic</p></li>
</ul>
<p><strong>Best practice</strong>: Always use stable molecules as references (H₂, not H; H₂O, not OH)</p>
</section>
<section id="spin-polarization">
<h3>6. Spin Polarization<a class="headerlink" href="#spin-polarization" title="Link to this heading">#</a></h3>
<p><strong>Key limitation</strong>: OC20/UMa does not include spin!</p>
<ul class="simple">
<li><p>Paper used spin-polarized DFT</p></li>
<li><p><strong>Impact</strong>: Usually small (0.05-0.1 eV)</p></li>
<li><p><strong>Larger</strong> for:</p>
<ul>
<li><p>Magnetic metals (Fe, Co, Ni)</p></li>
<li><p>Open-shell adsorbates (O*, OH*)</p></li>
<li><p>Reaction barriers with radicals</p></li>
</ul>
</li>
</ul>
</section>
<section id="constraint-philosophy">
<h3>7. Constraint Philosophy<a class="headerlink" href="#constraint-philosophy" title="Link to this heading">#</a></h3>
<p><strong>Clean slabs</strong> (Part 2): No constraints (both surfaces relax)</p>
<ul class="simple">
<li><p>Best for surface energy calculations</p></li>
<li><p>More physical for symmetric slabs</p></li>
</ul>
<p><strong>Adsorbate slabs</strong> (Part 4-6): Bottom layers fixed</p>
<ul class="simple">
<li><p>Faster convergence</p></li>
<li><p>Prevents adsorbate-induced reconstruction</p></li>
<li><p>Standard practice in surface chemistry</p></li>
</ul>
<p><strong>Fairchem helper functions</strong>: Automatically apply sensible constraints</p>
<ul class="simple">
<li><p>Trust their heuristics unless you have good reason not to</p></li>
<li><p>Check <code class="docutils literal notranslate"><span class="pre">atoms.constraints</span></code> to see what was applied</p></li>
</ul>
</section>
<section id="complex-surface-structures">
<h3>8. Complex Surface Structures<a class="headerlink" href="#complex-surface-structures" title="Link to this heading">#</a></h3>
<p><strong>This tutorial uses low-index facets</strong> (111, 100, 110, 211)</p>
<ul class="simple">
<li><p>Well-defined, symmetric</p></li>
<li><p>Easy to generate and analyze</p></li>
</ul>
<p><strong>Real catalysts</strong> have:</p>
<ul class="simple">
<li><p>Steps, kinks, grain boundaries</p></li>
<li><p>Support interfaces</p></li>
<li><p>Defects and vacancies</p></li>
<li><p><strong>Challenge</strong>: Harder to generate, more configurations to test</p></li>
</ul>
</section>
<section id="slab-thickness-and-vacuum">
<h3>9. Slab Thickness and Vacuum<a class="headerlink" href="#slab-thickness-and-vacuum" title="Link to this heading">#</a></h3>
<p><strong>Convergence tests critical</strong> but expensive:</p>
<ul class="simple">
<li><p>This tutorial uses “reasonable” values (4-8 layers, 10 Å vacuum)</p></li>
<li><p><strong>Always check</strong> convergence for new systems</p></li>
<li><p><strong>Especially important</strong> for:</p>
<ul>
<li><p>Metals with long electron screening (Au, Ag)</p></li>
<li><p>Charged adsorbates</p></li>
<li><p>Strong adsorbate-induced reconstruction</p></li>
</ul>
</li>
</ul>
</section>
<section id="neb-convergence">
<h3>10. NEB Convergence<a class="headerlink" href="#neb-convergence" title="Link to this heading">#</a></h3>
<p><strong>Most computationally expensive part</strong>:</p>
<ul class="simple">
<li><p>May need 7-11 images (not just 5)</p></li>
<li><p>Initial guess matters a lot</p></li>
<li><p>Can get stuck in local minima</p></li>
</ul>
<p><strong>Tricks</strong>:</p>
<ol class="arabic simple">
<li><p>Use dimer method to find better TS guess (as shown in Part 6)</p></li>
<li><p>Start with coarse convergence (fmax=0.2), refine later</p></li>
<li><p>Visualize the path - does it make chemical sense?</p></li>
<li><p>Try different spring constants (0.1-1.0 eV/Å)</p></li>
</ol>
</section>
<section id="lattice-constant-source">
<h3>11. Lattice Constant Source<a class="headerlink" href="#lattice-constant-source" title="Link to this heading">#</a></h3>
<p><strong>Consistency is key</strong>:</p>
<ul class="simple">
<li><p>Use ML-optimized lattice constant throughout (as done here)</p></li>
<li><p><strong>Don’t mix</strong>: ML lattice + DFT surface energies = inconsistent</p></li>
<li><p>Alternative: Use experimental lattice constant for everything</p></li>
</ul>
</section>
<section id="adsorbate-placement">
<h3>12. Adsorbate Placement<a class="headerlink" href="#adsorbate-placement" title="Link to this heading">#</a></h3>
<p><strong>Multiple local minima</strong>:</p>
<ul class="simple">
<li><p>Surface chemistry is <strong>not</strong> convex!</p></li>
<li><p>Always test multiple adsorption sites</p></li>
<li><p>Fairchem helpers generate ~5 configurations in this tutorial, but you may need more to search many modes. You can already try methods like minima hopping or other global optimization methods to sample more configurations.</p></li>
</ul>
<p><strong>For complex adsorbates</strong>:</p>
<ul class="simple">
<li><p>Test different orientations</p></li>
<li><p>May need 10-20 configurations</p></li>
<li><p>Consider genetic algorithms or basin hopping</p></li>
</ul>
<hr class="docutils" />
<div class="tip admonition">
<p class="admonition-title">Congratulations! 🎉</p>
<p>You’ve completed a comprehensive computational catalysis workflow using state-of-the-art ML potentials. You can now:</p>
<ul class="simple">
<li><p>Characterize catalyst surfaces computationally</p></li>
<li><p>Predict nanoparticle shapes</p></li>
<li><p>Calculate reaction thermodynamics and kinetics</p></li>
<li><p>Apply these methods to your own research questions</p></li>
</ul>
<p><strong>Next steps</strong>:</p>
<ul class="simple">
<li><p>Apply to your catalyst system of interest</p></li>
<li><p>Validate key results with DFT</p></li>
<li><p>Develop microkinetic models</p></li>
<li><p>Publish your findings!</p></li>
</ul>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./uma_tutorials"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="uma_tutorial.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">UMA Intro Tutorial</p>
      </div>
    </a>
    <a class="right-next"
       href="../core/generative_models.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Generative Models</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#installation-and-setup">Installation and Setup</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#huggingface-setups">Huggingface setups</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fair-chemistry-uma-installation">FAIR Chemistry (UMA) installation</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#package-imports">Package imports</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-1-bulk-crystal-optimization">Part 1: Bulk Crystal Optimization</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#theory">Theory</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-2-surface-energy-calculations">Part 2: Surface Energy Calculations</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Introduction</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Theory</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-1-setup-and-bulk-energy-reference">Step 1: Setup and Bulk Energy Reference</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-generate-and-relax-slabs">Step 2: Generate and Relax Slabs</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-3-visualize-linear-fits">Step 3: Visualize Linear Fits</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-4-compare-with-literature">Step 4: Compare with Literature</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#explore-on-your-own">Explore on Your Own</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-3-wulff-construction">Part 3: Wulff Construction</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Introduction</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">Theory</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-1-prepare-surface-energies">Step 1: Prepare Surface Energies</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-generate-wulff-construction">Step 2: Generate Wulff Construction</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-3-visualize-and-compare">Step 3: Visualize and Compare</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">Explore on Your Own</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-4-h-adsorption-energy-with-zpe-correction">Part 4: H Adsorption Energy with ZPE Correction</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">Introduction</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">Theory</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-1-setup-and-relax-clean-slab">Step 1: Setup and Relax Clean Slab</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-relax-clean-slab">Step 2: Relax Clean Slab</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-3-generate-h-adsorption-sites">Step 3: Generate H Adsorption Sites</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-4-relax-all-h-configurations">Step 4: Relax All H Configurations</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-5-calculate-h2-reference-energy">Step 5: Calculate H₂ Reference Energy</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-6-compute-adsorption-energy">Step 6: Compute Adsorption Energy</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-7-zero-point-energy-zpe-corrections">Step 7: Zero-Point Energy (ZPE) Corrections</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-8-visualize-and-compare-results">Step 8: Visualize and Compare Results</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">Explore on Your Own</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-5-coverage-dependent-h-adsorption">Part 5: Coverage-Dependent H Adsorption</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">Introduction</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">Theory</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-1-setup-slab-and-calculators">Step 1: Setup Slab and Calculators</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-calculate-reference-energies">Step 2: Calculate Reference Energies</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-3-set-up-coverage-study">Step 3: Set Up Coverage Study</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-4-generate-and-relax-configurations-at-each-coverage">Step 4: Generate and Relax Configurations at Each Coverage</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-5-perform-linear-fit">Step 5: Perform Linear Fit</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-6-visualize-coverage-dependence">Step 6: Visualize Coverage Dependence</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">Explore on Your Own</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-6-co-formation-dissociation-thermochemistry-and-barrier">Part 6: CO Formation/Dissociation Thermochemistry and Barrier</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">Introduction</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">Theory</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id14">Step 1: Setup Slab and Calculators</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-generate-and-relax-final-state-co">Step 2: Generate and Relax Final State (CO*)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-3-generate-and-relax-initial-state-c-o">Step 3: Generate and Relax Initial State (C* + O*)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-3b-calculate-c-and-o-energies-separately">Step 3b: Calculate C* and O* Energies Separately</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-4-calculate-reaction-energy-with-zpe">Step 4: Calculate Reaction Energy with ZPE</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-5-calculate-co-adsorption-energy-bonus">Step 5: Calculate CO Adsorption Energy (Bonus)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-6-find-guesses-for-nearby-initial-and-final-states-for-the-reaction">Step 6: Find guesses for nearby initial and final states for the reaction</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-7-run-neb-to-find-activation-barrier">Step 7: Run NEB to Find Activation Barrier</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-8-visualize-neb-path-and-key-structures">Step 8: Visualize NEB Path and Key Structures</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id15">Explore on Your Own</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary-and-best-practices">Summary and Best Practices</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-takeaways">Key Takeaways</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommended-workflow-for-new-systems">Recommended Workflow for New Systems</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#accuracy-considerations">Accuracy Considerations</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#further-reading">Further Reading</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#appendix-troubleshooting">Appendix: Troubleshooting</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#common-issues">Common Issues</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#performance-tips">Performance Tips</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#caveats-and-pitfalls">Caveats and Pitfalls</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#task-selection-omat-vs-oc20">1. Task Selection: OMAT vs OC20</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#d3-dispersion-corrections">2. D3 Dispersion Corrections</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#coverage-dependence-challenges">3. Coverage Dependence Challenges</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#periodic-boundary-conditions">4. Periodic Boundary Conditions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#gas-phase-reference-energies">5. Gas Phase Reference Energies</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#spin-polarization">6. Spin Polarization</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#constraint-philosophy">7. Constraint Philosophy</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#complex-surface-structures">8. Complex Surface Structures</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#slab-thickness-and-vacuum">9. Slab Thickness and Vacuum</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#neb-convergence">10. NEB Convergence</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lattice-constant-source">11. Lattice Constant Source</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#adsorbate-placement">12. Adsorbate Placement</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By FAIR Chemistry & Collaborators
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright Meta Platforms, Inc.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>