
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Tutorial: Catalyst Surface Analysis with Machine Learning Potentials &#8212; fairchem</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=fd3f3429" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script type="module" src="https://cdn.jsdelivr.net/npm/mermaid@11.12.1/dist/mermaid.esm.min.mjs"></script>
    <script type="module" src="https://cdn.jsdelivr.net/npm/@mermaid-js/layout-elk@0.2.0/dist/mermaid-layout-elk.esm.min.mjs"></script>
    <script type="module">import mermaid from "https://cdn.jsdelivr.net/npm/mermaid@11.12.1/dist/mermaid.esm.min.mjs";import elkLayouts from "https://cdn.jsdelivr.net/npm/@mermaid-js/layout-elk@0.2.0/dist/mermaid-layout-elk.esm.min.mjs";mermaid.registerLayoutLoaders(elkLayouts);mermaid.initialize({startOnLoad:false});</script>
    <script src="https://cdn.jsdelivr.net/npm/d3@7.9.0/dist/d3.min.js"></script>
    <script type="module">import mermaid from "https://cdn.jsdelivr.net/npm/mermaid@11.12.1/dist/mermaid.esm.min.mjs";

const defaultStyle = document.createElement('style');
defaultStyle.textContent = `pre.mermaid {
    /* Same as .mermaid-container > pre */
    display: block;
    width: 100%;
}

pre.mermaid > svg {
    /* Same as .mermaid-container > pre > svg */
    height: 500px;
    width: 100%;
    max-width: 100% !important;
}
`;
document.head.appendChild(defaultStyle);

const fullscreenStyle = document.createElement('style');
fullscreenStyle.textContent = `.mermaid-container {
    display: flex;
    flex-direction: row;
    width: 100%;
}

.mermaid-container > pre {
    display: block;
    width: 100%;
}

.mermaid-container > pre > svg {
    height: 500px;
    width: 100%;
    max-width: 100% !important;
}

.mermaid-fullscreen-btn {
    width: 28px;
    height: 28px;
    background: rgba(255, 255, 255, 0.95);
    border: 1px solid rgba(0, 0, 0, 0.3);
    border-radius: 4px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s;
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
    font-size: 14px;
    line-height: 1;
    padding: 0;
    color: #333;
}

.mermaid-fullscreen-btn:hover {
    opacity: 100% !important;
    background: rgba(255, 255, 255, 1);
    box-shadow: 0 3px 10px rgba(0, 0, 0, 0.3);
    transform: scale(1.1);
}

.mermaid-fullscreen-btn.dark-theme {
    background: rgba(50, 50, 50, 0.95);
    border: 1px solid rgba(255, 255, 255, 0.3);
    color: #e0e0e0;
}

.mermaid-fullscreen-btn.dark-theme:hover {
    background: rgba(60, 60, 60, 1);
    box-shadow: 0 3px 10px rgba(255, 255, 255, 0.2);
}

.mermaid-fullscreen-modal {
    display: none;
    position: fixed !important;
    top: 0 !important;
    left: 0 !important;
    width: 95vw;
    height: 100vh;
    background: rgba(255, 255, 255, 0.98);
    z-index: 9999;
    padding: 20px;
    overflow: auto;
}

.mermaid-fullscreen-modal.dark-theme {
    background: rgba(0, 0, 0, 0.98);
}

.mermaid-fullscreen-modal.active {
    display: flex;
    align-items: center;
    justify-content: center;
}

.mermaid-container-fullscreen {
    position: relative;
    width: 95vw;
    height: 90vh;
    max-width: 95vw;
    max-height: 90vh;
    background: white;
    border-radius: 8px;
    padding: 20px;
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
    overflow: auto;
    display: flex;
    align-items: center;
    justify-content: center;
}

.mermaid-container-fullscreen.dark-theme {
    background: #1a1a1a;
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.8);
}

.mermaid-container-fullscreen pre.mermaid {
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
}

.mermaid-container-fullscreen .mermaid svg {
    height: 100% !important;
    width: 100% !important;
    cursor: grab;
}

.mermaid-fullscreen-close {
    position: fixed !important;
    top: 20px !important;
    right: 20px !important;
    width: 40px;
    height: 40px;
    background: rgba(255, 255, 255, 0.95);
    border: 1px solid rgba(0, 0, 0, 0.2);
    border-radius: 50%;
    cursor: pointer;
    z-index: 10000;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
    transition: all 0.2s;
    font-size: 24px;
    line-height: 1;
    color: #333;
}

.mermaid-fullscreen-close:hover {
    background: white;
    box-shadow: 0 6px 16px rgba(0, 0, 0, 0.4);
    transform: scale(1.1);
}

.mermaid-fullscreen-close.dark-theme {
    background: rgba(50, 50, 50, 0.95);
    border: 1px solid rgba(255, 255, 255, 0.2);
    color: #e0e0e0;
}

.mermaid-fullscreen-close.dark-theme:hover {
    background: rgba(60, 60, 60, 1);
    box-shadow: 0 6px 16px rgba(255, 255, 255, 0.2);
}

.mermaid-fullscreen-modal .mermaid-fullscreen-btn {
    display: none !important;
}`;
document.head.appendChild(fullscreenStyle);

// Detect if page has dark background
const isDarkTheme = () => {
    const bgColor = window.getComputedStyle(document.body).backgroundColor;
    const match = bgColor.match(/rgb\((\d+),\s*(\d+),\s*(\d+)/);
    if (match) {
        const r = parseInt(match[1]);
        const g = parseInt(match[2]);
        const b = parseInt(match[3]);
        const brightness = (r * 299 + g * 587 + b * 114) / 1000;
        return brightness < 128;
    }
    return false;
};

const load = async () => {
    await mermaid.run();

    const all_mermaids = document.querySelectorAll(".mermaid");
    const mermaids_processed = document.querySelectorAll(".mermaid[data-processed='true']");

    if ("False" === "True") {
        const mermaids_to_add_zoom = -1 === -1 ? all_mermaids.length : -1;
        if(mermaids_to_add_zoom > 0) {
            var svgs = d3.selectAll("");
            if(all_mermaids.length !== mermaids_processed.length) {
                setTimeout(load, 200);
                return;
            } else if(svgs.size() !== mermaids_to_add_zoom) {
                setTimeout(load, 200);
                return;
            } else {
                svgs.each(function() {
                    var svg = d3.select(this);
                    svg.html("<g class='wrapper'>" + svg.html() + "</g>");
                    var inner = svg.select("g");
                    var zoom = d3.zoom().on("zoom", function(event) {
                        inner.attr("transform", event.transform);
                    });
                    svg.call(zoom);
                });
            }
        }
    } else if(all_mermaids.length !== mermaids_processed.length) {
        // Wait for mermaid to process all diagrams
        setTimeout(load, 200);
        return;
    }

    const darkTheme = isDarkTheme();

    // Stop here if not adding fullscreen capability
    if ("True" !== "True") return;

    const modal = document.createElement('div');
    modal.className = 'mermaid-fullscreen-modal' + (darkTheme ? ' dark-theme' : '');
    modal.setAttribute('role', 'dialog');
    modal.setAttribute('aria-modal', 'true');
    modal.setAttribute('aria-label', 'Fullscreen diagram viewer');
    modal.innerHTML = `
        <button class="mermaid-fullscreen-close${darkTheme ? ' dark-theme' : ''}" aria-label="Close fullscreen">✕</button>
        <div class="mermaid-container-fullscreen${darkTheme ? ' dark-theme' : ''}"></div>
    `;
    document.body.appendChild(modal);

    const modalContent = modal.querySelector('.mermaid-container-fullscreen');
    const closeBtn = modal.querySelector('.mermaid-fullscreen-close');

    let previousScrollOffset = [window.scrollX, window.scrollY];

    const closeModal = () => {
        modal.classList.remove('active');
        modalContent.innerHTML = '';
        document.body.style.overflow = ''
        window.scrollTo({left: previousScrollOffset[0], top: previousScrollOffset[1], behavior: 'instant'});
    };

    closeBtn.addEventListener('click', closeModal);
    modal.addEventListener('click', (e) => {
        if (e.target === modal) closeModal();
    });
    document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && modal.classList.contains('active')) {
            closeModal();
        }
    });

    const allButtons = [];

    document.querySelectorAll('.mermaid').forEach((mermaidDiv) => {
        if (mermaidDiv.parentNode.classList.contains('mermaid-container') ||
            mermaidDiv.closest('.mermaid-fullscreen-modal')) {
            return;
        }

        const container = document.createElement('div');
        container.className = 'mermaid-container';
        mermaidDiv.parentNode.insertBefore(container, mermaidDiv);
        container.appendChild(mermaidDiv);

        const fullscreenBtn = document.createElement('button');
        fullscreenBtn.className = 'mermaid-fullscreen-btn' + (darkTheme ? ' dark-theme' : '');
        fullscreenBtn.setAttribute('aria-label', 'View diagram in fullscreen');
        fullscreenBtn.textContent = '⛶';
        fullscreenBtn.style.opacity = '50%';

        // Calculate dynamic position based on diagram's margin and padding
        const diagramStyle = window.getComputedStyle(mermaidDiv);
        const marginTop = parseFloat(diagramStyle.marginTop) || 0;
        const marginRight = parseFloat(diagramStyle.marginRight) || 0;
        const paddingTop = parseFloat(diagramStyle.paddingTop) || 0;
        const paddingRight = parseFloat(diagramStyle.paddingRight) || 0;
        fullscreenBtn.style.top = `${marginTop + paddingTop + 4}px`;
        fullscreenBtn.style.right = `${marginRight + paddingRight + 4}px`;

        fullscreenBtn.addEventListener('click', () => {
            previousScrollOffset = [window.scroll, window.scrollY];
            const clone = mermaidDiv.cloneNode(true);
            modalContent.innerHTML = '';
            modalContent.appendChild(clone);

            const svg = clone.querySelector('svg');
            if (svg) {
                svg.removeAttribute('width');
                svg.removeAttribute('height');
                svg.style.width = '100%';
                svg.style.height = 'auto';
                svg.style.maxWidth = '100%';
                svg.style.sdisplay = 'block';

                if ("False" === "True") {
                    setTimeout(() => {
                        const g = svg.querySelector('g');
                        if (g) {
                            var svgD3 = d3.select(svg);
                            svgD3.html("<g class='wrapper'>" + svgD3.html() + "</g>");
                            var inner = svgD3.select("g");
                            var zoom = d3.zoom().on("zoom", function(event) {
                                inner.attr("transform", event.transform);
                            });
                            svgD3.call(zoom);
                        }
                    }, 100);
                }
            }

            modal.classList.add('active');
            document.body.style.overflow = 'hidden';
        });

        container.appendChild(fullscreenBtn);
        allButtons.push(fullscreenBtn);
    });

    // Update theme classes when theme changes
    const updateTheme = () => {
        const dark = isDarkTheme();
        allButtons.forEach(btn => {
            if (dark) {
                btn.classList.add('dark-theme');
            } else {
                btn.classList.remove('dark-theme');
            }
        });
        if (dark) {
            modal.classList.add('dark-theme');
            modalContent.classList.add('dark-theme');
            closeBtn.classList.add('dark-theme');
        } else {
            modal.classList.remove('dark-theme');
            modalContent.classList.remove('dark-theme');
            closeBtn.classList.remove('dark-theme');
        }
    };

    // Watch for theme changes
    const observer = new MutationObserver(updateTheme);
    observer.observe(document.documentElement, {
        attributes: true,
        attributeFilter: ['class', 'style', 'data-theme']
    });
    observer.observe(document.body, {
        attributes: true,
        attributeFilter: ['class', 'style']
    });
};

window.addEventListener("load", load);
</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'uma_tutorials/uma_catalysis_tutorial';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Generative Models" href="../core/generative_models.html" />
    <link rel="prev" title="UMA Intro Tutorial" href="uma_tutorial.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">fairchem</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    fairchem by FAIR Chemistry
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Quickstart</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../core/install.html">Installation &amp; License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core/quickstart.html">UMA Quick Start w/ ASE</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core/fairchemv1_v2.html"><code class="docutils literal notranslate"><span class="pre">fairchem&gt;=2.0</span></code></a></li>
<li class="toctree-l1"><a class="reference external" href="https://facebook-fairchem-uma-demo.hf.space/">UMA Demo</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">AI/ML Interatomic Potentials</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../core/intro.html">GNNs for Chemistry</a></li>


<li class="toctree-l1"><a class="reference internal" href="../core/uma.html">UMA Models</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../core/common_tasks/summary.html">Common tasks</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../core/common_tasks/ase_calculator.html">Inference using ASE and Predictor interface</a></li>




<li class="toctree-l2"><a class="reference internal" href="../core/common_tasks/lammps.html">LAMMPs Integration</a></li>



<li class="toctree-l2"><a class="reference internal" href="../core/common_tasks/batch_inference.html">Batch inference with UMA models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../core/common_tasks/ase_dataset_creation.html">FAIRChem &amp; custom datasets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../core/common_tasks/training.html">Training models from scratch</a></li>
<li class="toctree-l2"><a class="reference internal" href="../core/common_tasks/evaluation.html">Evaluating pretrained models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../core/common_tasks/fine_tuning.html">Fine-tuning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../core/common_tasks/workflows.html">Calculation workflows with FAIRChem models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../core/uma_faq.html">FAQ</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="summary.html">UMA tutorials</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="uma_tutorial.html">UMA Intro Tutorial</a></li>









<li class="toctree-l2 current active"><a class="current reference internal" href="#">Tutorial: Catalyst Surface Analysis with Machine Learning Potentials</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../core/generative_models.html">Generative Models</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Molecules &amp; Molecular Crystals</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../molecules/datasets/summary.html">Datasets</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../molecules/datasets/omol25.html">OMol25</a></li>
<li class="toctree-l2"><a class="reference internal" href="../molecules/datasets/omol25_elec.html">OMol25 Electronic Structures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../molecules/datasets/omc25.html">OMC25</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../molecules/models.html">Pretrained models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../molecules/leaderboard.html">OMol25 Leaderboard</a></li>
<li class="toctree-l1"><a class="reference internal" href="../molecules/FAQ.html">FAQ</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Heterogeneous Catalysis</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference external" href="https://opencatalystproject.org">OCP Leaderboard</a></li>
<li class="toctree-l1"><a class="reference external" href="https://open-catalyst.metademolab.com/">OCP Demo (no install required!)</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../catalysts/datasets/summary.html">Datasets</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../catalysts/datasets/oc20.html">Open Catalyst 2020 (OC20)</a></li>

<li class="toctree-l2"><a class="reference internal" href="../catalysts/datasets/oc20_mads.html">Open Catalyst 2020 Multi-Adsorbate (mAds) Dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="../catalysts/datasets/oc22.html">Open Catalyst 2022 (OC22)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../catalysts/datasets/oc20dense.html">Open Catalyst 2020 Dense (OC20Dense)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../catalysts/datasets/oc20neb.html">Open Catalyst 2020 Nudged Elastic Band (OC20NEB)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../catalysts/datasets/ocx24.html">Open Catalyst Experiments 2024 (OCx24): Bridging Experiments and Computational Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../catalysts/datasets/oc25.html">OC25</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../catalysts/models.html">Pretrained models</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../catalysts/examples_tutorials/summary.html">Examples &amp; Tutorials</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../catalysts/examples_tutorials/OCP-introduction.html">Intro to  adsorption energies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../catalysts/examples_tutorials/adsorption_energies/adsorption_energies.html">Expert adsorption energies</a></li>






<li class="toctree-l2"><a class="reference internal" href="../catalysts/examples_tutorials/adsorbml_walkthrough.html">AdsorbML tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="../catalysts/examples_tutorials/cattsunami_tutorial.html">Transition State Search (NEBs)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../catalysts/examples_tutorials/ocpapi.html">ocpapi</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../catalysts/FAQ.html">FAQ</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Inorganic Materials</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../inorganic_materials/datasets/summary.html">Datasets</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../inorganic_materials/datasets/omat24.html">OMat24</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../inorganic_materials/models.html">Pretrained models</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../inorganic_materials/examples_tutorials/summary.html">Examples &amp; Tutorials</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../inorganic_materials/examples_tutorials/formation_energy.html">Formation energies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../inorganic_materials/examples_tutorials/phonons.html">Phonons</a></li>
<li class="toctree-l2"><a class="reference internal" href="../inorganic_materials/examples_tutorials/elastic.html">Elastic Tensors</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../inorganic_materials/FAQ.html">FAQ</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">MOFs for Direct Air Capture</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../dac/datasets/summary.html">Datasets</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../dac/datasets/odac25.html">ODAC25</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dac/datasets/odac23.html">Open Direct Air Capture 2023 (ODAC23) [Deprecated]</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../dac/models.html">Pretrained models</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../dac/examples_tutorials/summary.html">Examples &amp; Tutorials</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../dac/examples_tutorials/adsorption_energy.html">Adsorption Energies</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Learn More</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../core/intro_series.html">Why model atoms for climate?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../videos/technical_talks.html">Technical presentations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core/papers_using_models.html">Studies leveraging FAIR-Chem</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">fairchem documentation</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../autoapi/index.html">API Reference</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../autoapi/core/index.html">core</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../autoapi/core/_cli/index.html">core._cli</a></li>
<li class="toctree-l3"><a class="reference internal" href="../autoapi/core/_config/index.html">core._config</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../autoapi/core/calculate/index.html">core.calculate</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/calculate/_batch/index.html">core.calculate._batch</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/calculate/ase_calculator/index.html">core.calculate.ase_calculator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/calculate/pretrained_mlip/index.html">core.calculate.pretrained_mlip</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../autoapi/core/common/index.html">core.common</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/common/data_parallel/index.html">core.common.data_parallel</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/common/distutils/index.html">core.common.distutils</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/common/gp_utils/index.html">core.common.gp_utils</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/common/logger/index.html">core.common.logger</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/common/profiler_utils/index.html">core.common.profiler_utils</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/common/registry/index.html">core.common.registry</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/common/test_utils/index.html">core.common.test_utils</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/common/typing/index.html">core.common.typing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/common/utils/index.html">core.common.utils</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../autoapi/core/datasets/index.html">core.datasets</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/datasets/_utils/index.html">core.datasets._utils</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/datasets/ase_datasets/index.html">core.datasets.ase_datasets</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/datasets/atomic_data/index.html">core.datasets.atomic_data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/datasets/atoms_sequence/index.html">core.datasets.atoms_sequence</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/datasets/base_dataset/index.html">core.datasets.base_dataset</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/datasets/common_structures/index.html">core.datasets.common_structures</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/datasets/embeddings/index.html">core.datasets.embeddings</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/datasets/mt_concat_dataset/index.html">core.datasets.mt_concat_dataset</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/datasets/target_metadata_guesser/index.html">core.datasets.target_metadata_guesser</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../autoapi/core/models/index.html">core.models</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/models/base/index.html">core.models.base</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/models/escaip/index.html">core.models.escaip</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/models/uma/index.html">core.models.uma</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/models/utils/index.html">core.models.utils</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../autoapi/core/modules/index.html">core.modules</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/modules/evaluator/index.html">core.modules.evaluator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/modules/exponential_moving_average/index.html">core.modules.exponential_moving_average</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/modules/loss/index.html">core.modules.loss</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/modules/normalization/index.html">core.modules.normalization</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/modules/scaling/index.html">core.modules.scaling</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/modules/scheduler/index.html">core.modules.scheduler</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/modules/transforms/index.html">core.modules.transforms</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../autoapi/core/scripts/index.html">core.scripts</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/scripts/convert_hydra_to_release/index.html">core.scripts.convert_hydra_to_release</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/scripts/create_finetune_dataset/index.html">core.scripts.create_finetune_dataset</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/scripts/create_uma_finetune_dataset/index.html">core.scripts.create_uma_finetune_dataset</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/scripts/diatomic_tests/index.html">core.scripts.diatomic_tests</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/scripts/download_data/index.html">core.scripts.download_data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/scripts/download_large_files/index.html">core.scripts.download_large_files</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/scripts/eqv2_to_hydra_eqv2/index.html">core.scripts.eqv2_to_hydra_eqv2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/scripts/fit_normalizers/index.html">core.scripts.fit_normalizers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/scripts/fit_references/index.html">core.scripts.fit_references</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/scripts/gif_maker_parallelized/index.html">core.scripts.gif_maker_parallelized</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/scripts/make_challenge_submission_file/index.html">core.scripts.make_challenge_submission_file</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/scripts/make_lmdb_sizes/index.html">core.scripts.make_lmdb_sizes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/scripts/make_submission_file/index.html">core.scripts.make_submission_file</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/scripts/migrate_checkpoint/index.html">core.scripts.migrate_checkpoint</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/scripts/migrate_imports/index.html">core.scripts.migrate_imports</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/scripts/preprocess_ef/index.html">core.scripts.preprocess_ef</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/scripts/preprocess_relaxed/index.html">core.scripts.preprocess_relaxed</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/scripts/uncompress/index.html">core.scripts.uncompress</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../autoapi/core/units/index.html">core.units</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/core/units/mlip_unit/index.html">core.units.mlip_unit</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../autoapi/data/index.html">data</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../autoapi/data/oc/index.html">data.oc</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/data/oc/core/index.html">data.oc.core</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/data/oc/databases/index.html">data.oc.databases</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/data/oc/structure_generator/index.html">data.oc.structure_generator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/data/oc/utils/index.html">data.oc.utils</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../autoapi/data/odac/index.html">data.odac</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/data/odac/setup_vasp/index.html">data.odac.setup_vasp</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../autoapi/data/omat/index.html">data.omat</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/data/omat/entries/index.html">data.omat.entries</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/data/omat/vasp/index.html">data.omat.vasp</a></li>
</ul>
</details></li>
<li class="toctree-l3"><a class="reference internal" href="../autoapi/data/omc/index.html">data.omc</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../autoapi/data/omol/index.html">data.omol</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/data/omol/orca/index.html">data.omol.orca</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../autoapi/ocpapi/index.html">ocpapi</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../autoapi/ocpapi/client/index.html">ocpapi.client</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/ocpapi/client/client/index.html">ocpapi.client.client</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/ocpapi/client/models/index.html">ocpapi.client.models</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/ocpapi/client/ui/index.html">ocpapi.client.ui</a></li>
</ul>
</details></li>
<li class="toctree-l3"><a class="reference internal" href="../autoapi/ocpapi/version/index.html">ocpapi.version</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../autoapi/ocpapi/workflows/index.html">ocpapi.workflows</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/ocpapi/workflows/adsorbates/index.html">ocpapi.workflows.adsorbates</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/ocpapi/workflows/context/index.html">ocpapi.workflows.context</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/ocpapi/workflows/filter/index.html">ocpapi.workflows.filter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/ocpapi/workflows/log/index.html">ocpapi.workflows.log</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/ocpapi/workflows/retry/index.html">ocpapi.workflows.retry</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../autoapi/cattsunami/index.html">cattsunami</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../autoapi/cattsunami/core/index.html">cattsunami.core</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/cattsunami/core/autoframe/index.html">cattsunami.core.autoframe</a></li>
<li class="toctree-l4"><a class="reference internal" href="../autoapi/cattsunami/core/reaction/index.html">cattsunami.core.reaction</a></li>
</ul>
</details></li>
<li class="toctree-l3"><a class="reference internal" href="../autoapi/cattsunami/databases/index.html">cattsunami.databases</a></li>
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Notebook execution times</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../execution_time.html">Notebook execution times</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/facebookresearch/fairchem/blob/main/docs/uma_tutorials/uma_catalysis_tutorial.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Colab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Colab logo" src="../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/facebookresearch/fairchem" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/facebookresearch/fairchem/issues/new?title=Issue%20on%20page%20%2Fuma_tutorials/uma_catalysis_tutorial.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/uma_tutorials/uma_catalysis_tutorial.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Tutorial: Catalyst Surface Analysis with Machine Learning Potentials</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#installation-and-setup">Installation and Setup</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#huggingface-setups">Huggingface setups</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fair-chemistry-uma-installation">FAIR Chemistry (UMA) installation</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#package-imports">Package imports</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-1-bulk-crystal-optimization">Part 1: Bulk Crystal Optimization</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#theory">Theory</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-2-surface-energy-calculations">Part 2: Surface Energy Calculations</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Introduction</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Theory</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-1-setup-and-bulk-energy-reference">Step 1: Setup and Bulk Energy Reference</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-generate-and-relax-slabs">Step 2: Generate and Relax Slabs</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-3-visualize-linear-fits">Step 3: Visualize Linear Fits</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-4-compare-with-literature">Step 4: Compare with Literature</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#explore-on-your-own">Explore on Your Own</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-3-wulff-construction">Part 3: Wulff Construction</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Introduction</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">Theory</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-1-prepare-surface-energies">Step 1: Prepare Surface Energies</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-generate-wulff-construction">Step 2: Generate Wulff Construction</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-3-visualize-and-compare">Step 3: Visualize and Compare</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">Explore on Your Own</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-4-h-adsorption-energy-with-zpe-correction">Part 4: H Adsorption Energy with ZPE Correction</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">Introduction</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">Theory</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-1-setup-and-relax-clean-slab">Step 1: Setup and Relax Clean Slab</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-relax-clean-slab">Step 2: Relax Clean Slab</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-3-generate-h-adsorption-sites">Step 3: Generate H Adsorption Sites</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-4-relax-all-h-configurations">Step 4: Relax All H Configurations</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-5-calculate-h2-reference-energy">Step 5: Calculate H₂ Reference Energy</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-6-compute-adsorption-energy">Step 6: Compute Adsorption Energy</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-7-zero-point-energy-zpe-corrections">Step 7: Zero-Point Energy (ZPE) Corrections</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-8-visualize-and-compare-results">Step 8: Visualize and Compare Results</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">Explore on Your Own</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-5-coverage-dependent-h-adsorption">Part 5: Coverage-Dependent H Adsorption</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">Introduction</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">Theory</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-1-setup-slab-and-calculators">Step 1: Setup Slab and Calculators</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-calculate-reference-energies">Step 2: Calculate Reference Energies</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-3-set-up-coverage-study">Step 3: Set Up Coverage Study</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-4-generate-and-relax-configurations-at-each-coverage">Step 4: Generate and Relax Configurations at Each Coverage</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-5-perform-linear-fit">Step 5: Perform Linear Fit</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-6-visualize-coverage-dependence">Step 6: Visualize Coverage Dependence</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">Explore on Your Own</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-6-co-formation-dissociation-thermochemistry-and-barrier">Part 6: CO Formation/Dissociation Thermochemistry and Barrier</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">Introduction</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">Theory</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id14">Step 1: Setup Slab and Calculators</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-generate-and-relax-final-state-co">Step 2: Generate and Relax Final State (CO*)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-3-generate-and-relax-initial-state-c-o">Step 3: Generate and Relax Initial State (C* + O*)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-3b-calculate-c-and-o-energies-separately">Step 3b: Calculate C* and O* Energies Separately</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-4-calculate-reaction-energy-with-zpe">Step 4: Calculate Reaction Energy with ZPE</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-5-calculate-co-adsorption-energy-bonus">Step 5: Calculate CO Adsorption Energy (Bonus)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-6-find-guesses-for-nearby-initial-and-final-states-for-the-reaction">Step 6: Find guesses for nearby initial and final states for the reaction</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-7-run-neb-to-find-activation-barrier">Step 7: Run NEB to Find Activation Barrier</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-8-visualize-neb-path-and-key-structures">Step 8: Visualize NEB Path and Key Structures</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id15">Explore on Your Own</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary-and-best-practices">Summary and Best Practices</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-takeaways">Key Takeaways</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommended-workflow-for-new-systems">Recommended Workflow for New Systems</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#accuracy-considerations">Accuracy Considerations</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#further-reading">Further Reading</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#appendix-troubleshooting">Appendix: Troubleshooting</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#common-issues">Common Issues</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#performance-tips">Performance Tips</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#caveats-and-pitfalls">Caveats and Pitfalls</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#task-selection-omat-vs-oc20">1. Task Selection: OMAT vs OC20</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#d3-dispersion-corrections">2. D3 Dispersion Corrections</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#coverage-dependence-challenges">3. Coverage Dependence Challenges</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#periodic-boundary-conditions">4. Periodic Boundary Conditions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#gas-phase-reference-energies">5. Gas Phase Reference Energies</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#spin-polarization">6. Spin Polarization</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#constraint-philosophy">7. Constraint Philosophy</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#complex-surface-structures">8. Complex Surface Structures</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#slab-thickness-and-vacuum">9. Slab Thickness and Vacuum</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#neb-convergence">10. NEB Convergence</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lattice-constant-source">11. Lattice Constant Source</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#adsorbate-placement">12. Adsorbate Placement</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="tutorial-catalyst-surface-analysis-with-machine-learning-potentials">
<h1>Tutorial: Catalyst Surface Analysis with Machine Learning Potentials<a class="headerlink" href="#tutorial-catalyst-surface-analysis-with-machine-learning-potentials" title="Link to this heading">#</a></h1>
<p>Author: Zack Ulissi (Meta, CMU), with help from AI coding agents / LLMs</p>
<p>Original paper: Bjarne Kreitz et al. JPCC (2021)</p>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading">#</a></h2>
<p>This tutorial demonstrates how to use the Universal Model for Atoms (UMA) machine learning potential to perform comprehensive catalyst surface analysis. We replicate key computational workflows from <a class="reference external" href="https://pubs.acs.org/doi/10.1021/acs.jpcc.0c09985">“Microkinetic Modeling of CO₂ Desorption from Supported Multifaceted Ni Catalysts”</a> by Bjarne Kreitz (now faculty at Georgia Tech!), showing how ML potentials can accelerate computational catalysis research.</p>
<div class="note admonition">
<p class="admonition-title">Learning Objectives</p>
<p>By the end of this tutorial, you will be able to:</p>
<ul class="simple">
<li><p>Optimize bulk crystal structures and extract lattice constants</p></li>
<li><p>Calculate surface energies using linear extrapolation methods</p></li>
<li><p>Construct Wulff shapes to predict nanoparticle morphologies</p></li>
<li><p>Compute adsorption energies with zero-point energy corrections</p></li>
<li><p>Study coverage-dependent binding phenomena</p></li>
<li><p>Calculate reaction barriers using the nudged elastic band (NEB) method</p></li>
<li><p>Apply D3 dispersion corrections to improve accuracy</p></li>
</ul>
</div>
<div class="tip admonition">
<p class="admonition-title">About UMA-S-1P1</p>
<p>The <strong>UMA-S-1P1</strong> model is a state-of-the-art universal machine learning potential trained on the OMat24, OC20, OMol25, ODAC23, and OMC25 datasets, covering diverse materials and surface chemistries. It provides ~1000× speedup over DFT while maintaining reasonable accuracy for screening studies. Here we’ll use the UMA-s-1p1 checkpoint which is the small (=faster) 1.1 version released in June. The UMA-s-1p1 checkpoint is open science with a lightweight license that users have to agree to through Huggingface.</p>
<p>You can read more about the UMA models here: https://arxiv.org/abs/2506.23971</p>
</div>
</section>
<section id="installation-and-setup">
<h2>Installation and Setup<a class="headerlink" href="#installation-and-setup" title="Link to this heading">#</a></h2>
<p>This tutorial uses a number of helpful open source packages:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ase</span></code> - Atomic Simulation Environment</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">fairchem</span></code> - FAIR Chemistry ML potentials (formerly OCP)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pymatgen</span></code> - Materials analysis</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> - Visualization</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">numpy</span></code> - Numerical computing</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">torch-dftd</span></code> - Dispersion corrections
among many others!</p></li>
</ul>
<section id="huggingface-setups">
<h3>Huggingface setups<a class="headerlink" href="#huggingface-setups" title="Link to this heading">#</a></h3>
<p>You need to get a HuggingFace account and request access to the UMA models.</p>
<p>You need a Huggingface account, request access to https://huggingface.co/facebook/UMA, and to create a Huggingface token at https://huggingface.co/settings/tokens/ with these permission:</p>
<p>Permissions: Read access to contents of all public gated repos you can access</p>
<p>Then, add the token as an environment variable (using <code class="docutils literal notranslate"><span class="pre">huggingface-cli</span> <span class="pre">login</span></code>:</p>
<div class="cell tag_skip-execution docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Enter token via huggingface-cli</span>
<span class="o">!</span><span class="w"> </span>huggingface-cli<span class="w"> </span>login
</pre></div>
</div>
</div>
</div>
<p>or you can set the token via HF_TOKEN variable:</p>
<div class="cell tag_skip-execution docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set token via env variable</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>

<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;HF_TOKEN&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;MYTOKEN&quot;</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="fair-chemistry-uma-installation">
<h3>FAIR Chemistry (UMA) installation<a class="headerlink" href="#fair-chemistry-uma-installation" title="Link to this heading">#</a></h3>
<p>It may be enough to use <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">fairchem-core</span></code>. This gets you the latest version on PyPi (https://pypi.org/project/fairchem-core/)</p>
<p>Here we install some sub-packages. This can take 2-5 minutes to run.</p>
<div class="cell tag_skip-execution docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span><span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>fairchem-core<span class="w"> </span>fairchem-data-oc<span class="w"> </span>fairchem-applications-cattsunami<span class="w"> </span>x3dase
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Check that packages are installed</span>
<span class="o">!</span>pip<span class="w"> </span>list<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>fairchem
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>fairchem-applications-cattsunami   1.1.2.dev123+ga70d5b04
fairchem-core                      2.13.1.dev1+ga70d5b04
fairchem-data-oc                   1.0.3.dev123+ga70d5b04
fairchem-data-omat                 0.2.1.dev28+ga70d5b04
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">fairchem.core</span>

<span class="n">fairchem</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">__version__</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;2.13.1.dev1+ga70d5b04&#39;
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="package-imports">
<h2>Package imports<a class="headerlink" href="#package-imports" title="Link to this heading">#</a></h2>
<p>First, let’s import all necessary libraries and initialize the UMA-S-1P1 predictor:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">ase.io</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ase</span><span class="w"> </span><span class="kn">import</span> <span class="n">Atoms</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ase.build</span><span class="w"> </span><span class="kn">import</span> <span class="n">bulk</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ase.constraints</span><span class="w"> </span><span class="kn">import</span> <span class="n">FixBondLengths</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ase.io</span><span class="w"> </span><span class="kn">import</span> <span class="n">write</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ase.mep</span><span class="w"> </span><span class="kn">import</span> <span class="n">interpolate</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ase.mep.dyneb</span><span class="w"> </span><span class="kn">import</span> <span class="n">DyNEB</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ase.optimize</span><span class="w"> </span><span class="kn">import</span> <span class="n">FIRE</span><span class="p">,</span> <span class="n">LBFGS</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ase.vibrations</span><span class="w"> </span><span class="kn">import</span> <span class="n">Vibrations</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ase.visualize.plot</span><span class="w"> </span><span class="kn">import</span> <span class="n">plot_atoms</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">fairchem.core</span><span class="w"> </span><span class="kn">import</span> <span class="n">FAIRChemCalculator</span><span class="p">,</span> <span class="n">pretrained_mlip</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">fairchem.data.oc.core</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">Adsorbate</span><span class="p">,</span>
    <span class="n">AdsorbateSlabConfig</span><span class="p">,</span>
    <span class="n">Bulk</span><span class="p">,</span>
    <span class="n">MultipleAdsorbateSlabConfig</span><span class="p">,</span>
    <span class="n">Slab</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pymatgen.analysis.wulff</span><span class="w"> </span><span class="kn">import</span> <span class="n">WulffShape</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pymatgen.core</span><span class="w"> </span><span class="kn">import</span> <span class="n">Lattice</span><span class="p">,</span> <span class="n">Structure</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pymatgen.core.surface</span><span class="w"> </span><span class="kn">import</span> <span class="n">SlabGenerator</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pymatgen.io.ase</span><span class="w"> </span><span class="kn">import</span> <span class="n">AseAtomsAdaptor</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">torch_dftd.torch_dftd3_calculator</span><span class="w"> </span><span class="kn">import</span> <span class="n">TorchDFTD3Calculator</span>

<span class="c1"># Set up output directory structure</span>
<span class="n">output_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;ni_tutorial_results&quot;</span><span class="p">)</span>
<span class="n">output_dir</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Create subdirectories for each part</span>
<span class="n">part_dirs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;part1&quot;</span><span class="p">:</span> <span class="s2">&quot;part1-bulk-optimization&quot;</span><span class="p">,</span>
    <span class="s2">&quot;part2&quot;</span><span class="p">:</span> <span class="s2">&quot;part2-surface-energies&quot;</span><span class="p">,</span>
    <span class="s2">&quot;part3&quot;</span><span class="p">:</span> <span class="s2">&quot;part3-wulff-construction&quot;</span><span class="p">,</span>
    <span class="s2">&quot;part4&quot;</span><span class="p">:</span> <span class="s2">&quot;part4-h-adsorption&quot;</span><span class="p">,</span>
    <span class="s2">&quot;part5&quot;</span><span class="p">:</span> <span class="s2">&quot;part5-coverage-dependence&quot;</span><span class="p">,</span>
    <span class="s2">&quot;part6&quot;</span><span class="p">:</span> <span class="s2">&quot;part6-co-dissociation&quot;</span><span class="p">,</span>
<span class="p">}</span>

<span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">dirname</span> <span class="ow">in</span> <span class="n">part_dirs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="p">(</span><span class="n">output_dir</span> <span class="o">/</span> <span class="n">dirname</span><span class="p">)</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Create subdirectories for different facets in part2</span>
<span class="k">for</span> <span class="n">facet</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;111&quot;</span><span class="p">,</span> <span class="s2">&quot;100&quot;</span><span class="p">,</span> <span class="s2">&quot;110&quot;</span><span class="p">,</span> <span class="s2">&quot;211&quot;</span><span class="p">]:</span>
    <span class="p">(</span><span class="n">output_dir</span> <span class="o">/</span> <span class="n">part_dirs</span><span class="p">[</span><span class="s2">&quot;part2&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;ni</span><span class="si">{</span><span class="n">facet</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Initialize the UMA-S-1P1 predictor</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Loading UMA-S-1P1 model...&quot;</span><span class="p">)</span>
<span class="n">predictor</span> <span class="o">=</span> <span class="n">pretrained_mlip</span><span class="o">.</span><span class="n">get_predict_unit</span><span class="p">(</span><span class="s2">&quot;uma-s-1p1&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;✓ Model loaded successfully!&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Loading UMA-S-1P1 model...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>WARNING:root:device was not explicitly set, using device=&#39;cuda&#39;.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>✓ Model loaded successfully!
</pre></div>
</div>
</div>
</div>
<p>It is somewhat time consuming to run this. We’re going to use a small number of bulks for the testing of this documentation, but otherwise run all of the results for the actual documentation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>

<span class="n">fast_docs</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;FAST_DOCS&quot;</span><span class="p">,</span> <span class="s2">&quot;false&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;true&quot;</span>
<span class="k">if</span> <span class="n">fast_docs</span><span class="p">:</span>
    <span class="n">num_sites</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">relaxation_steps</span> <span class="o">=</span> <span class="mi">20</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">num_sites</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="n">relaxation_steps</span> <span class="o">=</span> <span class="mi">300</span>
</pre></div>
</div>
</div>
</div>
</section>
<hr class="docutils" />
<section id="part-1-bulk-crystal-optimization">
<h2>Part 1: Bulk Crystal Optimization<a class="headerlink" href="#part-1-bulk-crystal-optimization" title="Link to this heading">#</a></h2>
<section id="introduction">
<h3>Introduction<a class="headerlink" href="#introduction" title="Link to this heading">#</a></h3>
<p>Before studying surfaces, we need to determine the equilibrium lattice constant of bulk Ni. This is crucial because surface energies and adsorbate binding depend strongly on the underlying lattice parameter.</p>
</section>
<section id="theory">
<h3>Theory<a class="headerlink" href="#theory" title="Link to this heading">#</a></h3>
<p>For FCC metals like Ni, the lattice constant <strong>a</strong> defines the unit cell size. The experimental value for Ni is <strong>a = 3.524 Å</strong> at room temperature. We’ll optimize both atomic positions and the cell volume to find the ML potential’s equilibrium structure.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create initial FCC Ni structure</span>
<span class="n">a_initial</span> <span class="o">=</span> <span class="mf">3.52</span>  <span class="c1"># Å, close to experimental</span>
<span class="n">ni_bulk</span> <span class="o">=</span> <span class="n">bulk</span><span class="p">(</span><span class="s2">&quot;Ni&quot;</span><span class="p">,</span> <span class="s2">&quot;fcc&quot;</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="n">a_initial</span><span class="p">,</span> <span class="n">cubic</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Initial lattice constant: </span><span class="si">{</span><span class="n">a_initial</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Å&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of atoms: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">ni_bulk</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Set up calculator for bulk optimization</span>
<span class="n">calc</span> <span class="o">=</span> <span class="n">FAIRChemCalculator</span><span class="p">(</span><span class="n">predictor</span><span class="p">,</span> <span class="n">task_name</span><span class="o">=</span><span class="s2">&quot;omat&quot;</span><span class="p">)</span>
<span class="n">ni_bulk</span><span class="o">.</span><span class="n">calc</span> <span class="o">=</span> <span class="n">calc</span>

<span class="c1"># Use ExpCellFilter to allow cell relaxation</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ase.filters</span><span class="w"> </span><span class="kn">import</span> <span class="n">ExpCellFilter</span>

<span class="n">ecf</span> <span class="o">=</span> <span class="n">ExpCellFilter</span><span class="p">(</span><span class="n">ni_bulk</span><span class="p">)</span>

<span class="c1"># Optimize with LBFGS</span>
<span class="n">opt</span> <span class="o">=</span> <span class="n">LBFGS</span><span class="p">(</span>
    <span class="n">ecf</span><span class="p">,</span>
    <span class="n">trajectory</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">output_dir</span> <span class="o">/</span> <span class="n">part_dirs</span><span class="p">[</span><span class="s2">&quot;part1&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="s2">&quot;ni_bulk_opt.traj&quot;</span><span class="p">),</span>
    <span class="n">logfile</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">output_dir</span> <span class="o">/</span> <span class="n">part_dirs</span><span class="p">[</span><span class="s2">&quot;part1&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="s2">&quot;ni_bulk_opt.log&quot;</span><span class="p">),</span>
<span class="p">)</span>
<span class="n">opt</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">fmax</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="n">relaxation_steps</span><span class="p">)</span>

<span class="c1"># Extract results</span>
<span class="n">cell</span> <span class="o">=</span> <span class="n">ni_bulk</span><span class="o">.</span><span class="n">get_cell</span><span class="p">()</span>
<span class="n">a_optimized</span> <span class="o">=</span> <span class="n">cell</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">a_exp</span> <span class="o">=</span> <span class="mf">3.524</span>  <span class="c1"># Experimental value</span>
<span class="n">error</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">a_optimized</span> <span class="o">-</span> <span class="n">a_exp</span><span class="p">)</span> <span class="o">/</span> <span class="n">a_exp</span> <span class="o">*</span> <span class="mi">100</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="s1">&#39;=&#39;</span><span class="o">*</span><span class="mi">50</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Experimental lattice constant: </span><span class="si">{</span><span class="n">a_exp</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Å&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Optimized lattice constant:    </span><span class="si">{</span><span class="n">a_optimized</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Å&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Relative error:                </span><span class="si">{</span><span class="n">error</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;=&#39;</span><span class="o">*</span><span class="mi">50</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">ase</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">output_dir</span> <span class="o">/</span> <span class="n">part_dirs</span><span class="p">[</span><span class="s2">&quot;part1&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="s2">&quot;ni_bulk_relaxed.cif&quot;</span><span class="p">),</span> <span class="n">ni_bulk</span><span class="p">)</span>

<span class="c1"># Store results for later use</span>
<span class="n">a_opt</span> <span class="o">=</span> <span class="n">a_optimized</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Initial lattice constant: 3.52 Å
Number of atoms: 4
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_8150/3959847705.py:15: DeprecationWarning: Use FrechetCellFilter for better convergence w.r.t. cell variables.
  ecf = ExpCellFilter(ni_bulk)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>==================================================
Experimental lattice constant: 3.52 Å
Optimized lattice constant:    3.52 Å
Relative error:                0.25%
==================================================
</pre></div>
</div>
</div>
</div>
<div class="tip admonition">
<p class="admonition-title">Understanding the Results</p>
<p>UMA-s-1p1 using the <code class="docutils literal notranslate"><span class="pre">omat</span></code> task name will predict lattice constants at the PBE level of DFT. For metals, PBE typically predicts lattice constants within 1-2% of experimental values.</p>
<p>Small discrepancies arise from:</p>
<ul class="simple">
<li><p>Training data biases (if your structure is far from OMAT24)</p></li>
<li><p>Temperature effects (0 K vs room temperature). You can do a quasi-harmonic analysis to include finite temperature effects if desired.</p></li>
<li><p>Quantum effects not captured by the underlying DFT/PBE simulations</p></li>
</ul>
<p>For surface calculations, using the ML-optimized lattice constant maintains internal consistency.</p>
</div>
<div class="note admonition">
<p class="admonition-title">Comparison with Paper</p>
<p><strong>Paper (Table 1):</strong> Ni lattice constant = 3.524 Å (experimental reference)</p>
<p>The UMA-S-1P1 model with OMAT provides excellent agreement with experiment, as would be expected for the PBE functional for simple BCC Ni. The underlying calculations for OMat24 and the original results cited in the paper should be very similar (both PBE), so the fact that the results are a little closer to experiment than the original results is within the numerical noise of the ML model.</p>
</div>
<div class="seealso admonition">
<p class="admonition-title">Further exploration</p>
<p>Try modifying the following parameters and observe the effects:</p>
<ol class="arabic simple">
<li><p><strong>Task name</strong>: The original paper re-relaxed the structures at the RPBE level of theory before continuing. Try that with the UMA-s-1p1 model (using the oc20 task name) and see if it matters here.</p></li>
<li><p><strong>Initial guess</strong>: Change <code class="docutils literal notranslate"><span class="pre">a_initial</span></code> to 3.0 or 4.0 Å. Does the optimizer still converge to the same value?</p></li>
<li><p><strong>Convergence criterion</strong>: Tighten <code class="docutils literal notranslate"><span class="pre">fmax</span></code> to 0.01 eV/Å. How many more steps are required?</p></li>
<li><p><strong>Different metals</strong>: Replace <code class="docutils literal notranslate"><span class="pre">&quot;Ni&quot;</span></code> with <code class="docutils literal notranslate"><span class="pre">&quot;Cu&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Pd&quot;</span></code>, or <code class="docutils literal notranslate"><span class="pre">&quot;Pt&quot;</span></code>. Compare predicted vs experimental lattice constants.</p></li>
<li><p><strong>Cell shape</strong>: Remove <code class="docutils literal notranslate"><span class="pre">cubic=True</span></code> and allow the cell to distort. Does FCC remain stable?</p></li>
</ol>
</div>
</section>
</section>
<hr class="docutils" />
<section id="part-2-surface-energy-calculations">
<h2>Part 2: Surface Energy Calculations<a class="headerlink" href="#part-2-surface-energy-calculations" title="Link to this heading">#</a></h2>
<section id="id1">
<h3>Introduction<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<p>Surface energy (γ) quantifies the thermodynamic cost of creating a surface. It determines surface stability, morphology, and catalytic activity. We’ll calculate γ for four low-index Ni facets: (111), (100), (110), and (211).</p>
</section>
<section id="id2">
<h3>Theory<a class="headerlink" href="#id2" title="Link to this heading">#</a></h3>
<p>The surface energy is defined as:</p>
<div class="math notranslate nohighlight">
\[
\gamma = \frac{E_{\text{slab}} - N \cdot E_{\text{bulk}}}{2A}
\]</div>
<p>where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(E_{\text{slab}}\)</span> = total energy of the slab</p></li>
<li><p><span class="math notranslate nohighlight">\(N\)</span> = number of atoms in the slab</p></li>
<li><p><span class="math notranslate nohighlight">\(E_{\text{bulk}}\)</span> = bulk energy per atom</p></li>
<li><p><span class="math notranslate nohighlight">\(A\)</span> = surface area</p></li>
<li><p>Factor of 2 accounts for two surfaces (top and bottom)</p></li>
</ul>
<p><strong>Challenge</strong>: Direct calculation suffers from quantum size effects, and if you were doing DFT calculations small numerical errors in the simulation or from the K-point grid sampling can lead to small (but significant) errors in the bulk lattice energy.</p>
<p><strong>Solution</strong>: It is fairly common when calculating surface energies to use the bulk energy from a bulk relaxation in the above equation. However, because DFT often has some small numerical noise in the predictions from k-point convergence, this might lead to the wrong surface energy. Instead, two more careful schemes are either:</p>
<ol class="arabic simple">
<li><p>Calculate the energy of a bulk structure oriented to each slab to maximize cancellation of small numerical errors or</p></li>
<li><p>Calculate the energy of multiple slabs at multiple thicknesses and extrapolate to zero thickness. The intercept will be the surface energy, and the slope will be a fitted bulk energy. A benefit of this approach is that it also forces us to check that we have a sufficiently thick slab for a well defined surface energy; if the fit is non-linear we need thicker slabs.</p></li>
</ol>
<p>We’ll use the linear extrapolation method here as it’s more likely to work in future DFT studies if you use this code!</p>
</section>
<section id="step-1-setup-and-bulk-energy-reference">
<h3>Step 1: Setup and Bulk Energy Reference<a class="headerlink" href="#step-1-setup-and-bulk-energy-reference" title="Link to this heading">#</a></h3>
<p>First, we’ll set up the calculation parameters and get the bulk energy reference:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate surface energies for all facets</span>
<span class="n">facets</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]</span>
<span class="n">surface_energies</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">surface_energies_SI</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">all_fit_data</span> <span class="o">=</span> <span class="p">{}</span>

<span class="c1"># Get bulk energy reference (only need to do this once)</span>
<span class="n">E_bulk_total</span> <span class="o">=</span> <span class="n">ni_bulk</span><span class="o">.</span><span class="n">get_potential_energy</span><span class="p">()</span>
<span class="n">N_bulk</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ni_bulk</span><span class="p">)</span>
<span class="n">E_bulk_per_atom</span> <span class="o">=</span> <span class="n">E_bulk_total</span> <span class="o">/</span> <span class="n">N_bulk</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Bulk energy reference:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Total energy: </span><span class="si">{</span><span class="n">E_bulk_total</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Number of atoms: </span><span class="si">{</span><span class="n">N_bulk</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Energy per atom: </span><span class="si">{</span><span class="n">E_bulk_per_atom</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2"> eV/atom&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Bulk energy reference:
  Total energy: -21.97 eV
  Number of atoms: 4
  Energy per atom: -5.491441 eV/atom
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-2-generate-and-relax-slabs">
<h3>Step 2: Generate and Relax Slabs<a class="headerlink" href="#step-2-generate-and-relax-slabs" title="Link to this heading">#</a></h3>
<p>Now we’ll loop through each facet, generating slabs at three different thicknesses:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Convert bulk to pymatgen structure for slab generation</span>
<span class="n">adaptor</span> <span class="o">=</span> <span class="n">AseAtomsAdaptor</span><span class="p">()</span>
<span class="n">ni_structure</span> <span class="o">=</span> <span class="n">adaptor</span><span class="o">.</span><span class="n">get_structure</span><span class="p">(</span><span class="n">ni_bulk</span><span class="p">)</span>

<span class="k">for</span> <span class="n">facet</span> <span class="ow">in</span> <span class="n">facets</span><span class="p">:</span>
    <span class="n">facet_str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">facet</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="s1">&#39;=&#39;</span><span class="o">*</span><span class="mi">60</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Calculating Ni(</span><span class="si">{</span><span class="n">facet_str</span><span class="si">}</span><span class="s2">) surface energy&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;=&#39;</span><span class="o">*</span><span class="mi">60</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Calculate for three thicknesses</span>
    <span class="n">thicknesses</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">]</span>  <span class="c1"># layers</span>
    <span class="n">n_atoms_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">energies_list</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">n_layers</span> <span class="ow">in</span> <span class="n">thicknesses</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">  Thickness: </span><span class="si">{</span><span class="n">n_layers</span><span class="si">}</span><span class="s2"> layers&quot;</span><span class="p">)</span>

        <span class="c1"># Generate slab</span>
        <span class="n">slabgen</span> <span class="o">=</span> <span class="n">SlabGenerator</span><span class="p">(</span>
            <span class="n">ni_structure</span><span class="p">,</span>
            <span class="n">facet</span><span class="p">,</span>
            <span class="n">min_slab_size</span><span class="o">=</span><span class="n">n_layers</span> <span class="o">*</span> <span class="n">a_opt</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">([</span><span class="n">h</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">facet</span><span class="p">])),</span>
            <span class="n">min_vacuum_size</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span>
            <span class="n">center_slab</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">pmg_slab</span> <span class="o">=</span> <span class="n">slabgen</span><span class="o">.</span><span class="n">get_slabs</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">slab</span> <span class="o">=</span> <span class="n">adaptor</span><span class="o">.</span><span class="n">get_atoms</span><span class="p">(</span><span class="n">pmg_slab</span><span class="p">)</span>
        <span class="n">slab</span><span class="o">.</span><span class="n">center</span><span class="p">(</span><span class="n">vacuum</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    Atoms: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">slab</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># Relax slab (no constraints - both surfaces free)</span>
        <span class="n">calc</span> <span class="o">=</span> <span class="n">FAIRChemCalculator</span><span class="p">(</span><span class="n">predictor</span><span class="p">,</span> <span class="n">task_name</span><span class="o">=</span><span class="s2">&quot;omat&quot;</span><span class="p">)</span>
        <span class="n">slab</span><span class="o">.</span><span class="n">calc</span> <span class="o">=</span> <span class="n">calc</span>
        <span class="n">opt</span> <span class="o">=</span> <span class="n">LBFGS</span><span class="p">(</span><span class="n">slab</span><span class="p">,</span> <span class="n">logfile</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
        <span class="n">opt</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">fmax</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="n">relaxation_steps</span><span class="p">)</span>

        <span class="n">E_slab</span> <span class="o">=</span> <span class="n">slab</span><span class="o">.</span><span class="n">get_potential_energy</span><span class="p">()</span>
        <span class="n">n_atoms_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">slab</span><span class="p">))</span>
        <span class="n">energies_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_slab</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    Energy: </span><span class="si">{</span><span class="n">E_slab</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>

    <span class="c1"># Linear regression: E_slab = slope * N + intercept</span>
    <span class="n">coeffs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">n_atoms_list</span><span class="p">,</span> <span class="n">energies_list</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">slope</span> <span class="o">=</span> <span class="n">coeffs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">intercept</span> <span class="o">=</span> <span class="n">coeffs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="c1"># Extract surface energy from intercept</span>
    <span class="n">cell</span> <span class="o">=</span> <span class="n">slab</span><span class="o">.</span><span class="n">get_cell</span><span class="p">()</span>
    <span class="n">area</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">cell</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cell</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
    <span class="n">gamma</span> <span class="o">=</span> <span class="n">intercept</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">area</span><span class="p">)</span>  <span class="c1"># eV/Å²</span>
    <span class="n">gamma_SI</span> <span class="o">=</span> <span class="n">gamma</span> <span class="o">*</span> <span class="mf">16.0218</span>  <span class="c1"># J/m²</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">  Linear fit:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    Slope:     </span><span class="si">{</span><span class="n">slope</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2"> eV/atom (cf. bulk </span><span class="si">{</span><span class="n">E_bulk_per_atom</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    Intercept: </span><span class="si">{</span><span class="n">intercept</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">  Surface energy:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    γ = </span><span class="si">{</span><span class="n">gamma</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2"> eV/Å² = </span><span class="si">{</span><span class="n">gamma_SI</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> J/m²&quot;</span><span class="p">)</span>

    <span class="c1"># Store results and fit data</span>
    <span class="n">surface_energies</span><span class="p">[</span><span class="n">facet</span><span class="p">]</span> <span class="o">=</span> <span class="n">gamma</span>
    <span class="n">surface_energies_SI</span><span class="p">[</span><span class="n">facet</span><span class="p">]</span> <span class="o">=</span> <span class="n">gamma_SI</span>
    <span class="n">all_fit_data</span><span class="p">[</span><span class="n">facet</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;n_atoms&quot;</span><span class="p">:</span> <span class="n">n_atoms_list</span><span class="p">,</span>
        <span class="s2">&quot;energies&quot;</span><span class="p">:</span> <span class="n">energies_list</span><span class="p">,</span>
        <span class="s2">&quot;slope&quot;</span><span class="p">:</span> <span class="n">slope</span><span class="p">,</span>
        <span class="s2">&quot;intercept&quot;</span><span class="p">:</span> <span class="n">intercept</span><span class="p">,</span>
    <span class="p">}</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>============================================================
Calculating Ni(111) surface energy
============================================================

  Thickness: 4 layers
    Atoms: 5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Energy: -26.18 eV

  Thickness: 6 layers
    Atoms: 7
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Energy: -37.17 eV

  Thickness: 8 layers
    Atoms: 9
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Energy: -48.15 eV

  Linear fit:
    Slope:     -5.493045 eV/atom (cf. bulk -5.491441)
    Intercept: 1.29 eV

  Surface energy:
    γ = 0.120198 eV/Å² = 1.93 J/m²

============================================================
Calculating Ni(100) surface energy
============================================================

  Thickness: 4 layers
    Atoms: 8
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Energy: -42.16 eV

  Thickness: 6 layers
    Atoms: 12
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Energy: -64.12 eV

  Thickness: 8 layers
    Atoms: 16
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Energy: -86.09 eV

  Linear fit:
    Slope:     -5.491520 eV/atom (cf. bulk -5.491441)
    Intercept: 1.78 eV

  Surface energy:
    γ = 0.143731 eV/Å² = 2.30 J/m²

============================================================
Calculating Ni(110) surface energy
============================================================

  Thickness: 4 layers
    Atoms: 10
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Energy: -52.35 eV

  Thickness: 6 layers
    Atoms: 14
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Energy: -74.32 eV

  Thickness: 8 layers
    Atoms: 18
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Energy: -96.29 eV

  Linear fit:
    Slope:     -5.491905 eV/atom (cf. bulk -5.491441)
    Intercept: 2.57 eV

  Surface energy:
    γ = 0.146934 eV/Å² = 2.35 J/m²

============================================================
Calculating Ni(211) surface energy
============================================================

  Thickness: 4 layers
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Atoms: 8
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Energy: -39.69 eV

  Thickness: 6 layers
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Atoms: 12
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Energy: -61.61 eV

  Thickness: 8 layers
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Atoms: 16
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Energy: -83.58 eV

  Linear fit:
    Slope:     -5.485733 eV/atom (cf. bulk -5.491441)
    Intercept: 4.20 eV

  Surface energy:
    γ = 0.138877 eV/Å² = 2.23 J/m²
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-3-visualize-linear-fits">
<h3>Step 3: Visualize Linear Fits<a class="headerlink" href="#step-3-visualize-linear-fits" title="Link to this heading">#</a></h3>
<p>Let’s visualize the linear extrapolation for all four facets:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Visualize linear fits for all facets</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">axes</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>

<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">facet</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">facets</span><span class="p">):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">all_fit_data</span><span class="p">[</span><span class="n">facet</span><span class="p">]</span>

    <span class="c1"># Plot data points</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
        <span class="n">data</span><span class="p">[</span><span class="s2">&quot;n_atoms&quot;</span><span class="p">],</span>
        <span class="n">data</span><span class="p">[</span><span class="s2">&quot;energies&quot;</span><span class="p">],</span>
        <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;steelblue&quot;</span><span class="p">,</span>
        <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
        <span class="n">zorder</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Calculated&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># Plot fit line</span>
    <span class="n">n_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;n_atoms&quot;</span><span class="p">])</span> <span class="o">-</span> <span class="mi">5</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;n_atoms&quot;</span><span class="p">])</span> <span class="o">+</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
    <span class="n">E_fit</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;slope&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">n_range</span> <span class="o">+</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;intercept&quot;</span><span class="p">]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">n_range</span><span class="p">,</span>
        <span class="n">E_fit</span><span class="p">,</span>
        <span class="s2">&quot;r--&quot;</span><span class="p">,</span>
        <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Fit: </span><span class="si">{</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;slope&quot;</span><span class="p">]</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">N + </span><span class="si">{</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;intercept&quot;</span><span class="p">]</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># Formatting</span>
    <span class="n">facet_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Ni(</span><span class="si">{</span><span class="n">facet</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}{</span><span class="n">facet</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}{</span><span class="n">facet</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">}</span><span class="s2">)&quot;</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Number of Atoms&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Slab Energy (eV)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">facet_str</span><span class="si">}</span><span class="s2">: γ = </span><span class="si">{</span><span class="n">surface_energies_SI</span><span class="p">[</span><span class="n">facet</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> J/m²&quot;</span><span class="p">,</span>
        <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
        <span class="n">fontweight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span>
    <span class="nb">str</span><span class="p">(</span><span class="n">output_dir</span> <span class="o">/</span> <span class="n">part_dirs</span><span class="p">[</span><span class="s2">&quot;part2&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="s2">&quot;surface_energy_fits.png&quot;</span><span class="p">),</span>
    <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span>
    <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ccad1c3128d4762a8532fe3e0c26cb07eec9c25ba199dd38c097ac22c76e85d5.png" src="../_images/ccad1c3128d4762a8532fe3e0c26cb07eec9c25ba199dd38c097ac22c76e85d5.png" />
</div>
</div>
</section>
<section id="step-4-compare-with-literature">
<h3>Step 4: Compare with Literature<a class="headerlink" href="#step-4-compare-with-literature" title="Link to this heading">#</a></h3>
<p>Finally, let’s compare our calculated surface energies with DFT literature values:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="s1">&#39;=&#39;</span><span class="o">*</span><span class="mi">70</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Comparison with DFT Literature (Tran et al., 2016)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;=&#39;</span><span class="o">*</span><span class="mi">70</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">lit_values</span> <span class="o">=</span> <span class="p">{</span>
    <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span> <span class="mf">1.92</span><span class="p">,</span>
    <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span> <span class="mf">2.21</span><span class="p">,</span>
    <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span> <span class="mf">2.29</span><span class="p">,</span>
    <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span> <span class="mf">2.24</span><span class="p">,</span>
<span class="p">}</span>  <span class="c1"># J/m²</span>

<span class="k">for</span> <span class="n">facet</span> <span class="ow">in</span> <span class="n">facets</span><span class="p">:</span>
    <span class="n">facet_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Ni(</span><span class="si">{</span><span class="n">facet</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}{</span><span class="n">facet</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}{</span><span class="n">facet</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">}</span><span class="s2">)&quot;</span>
    <span class="n">calc</span> <span class="o">=</span> <span class="n">surface_energies_SI</span><span class="p">[</span><span class="n">facet</span><span class="p">]</span>
    <span class="n">lit</span> <span class="o">=</span> <span class="n">lit_values</span><span class="p">[</span><span class="n">facet</span><span class="p">]</span>
    <span class="n">diff</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">calc</span> <span class="o">-</span> <span class="n">lit</span><span class="p">)</span> <span class="o">/</span> <span class="n">lit</span> <span class="o">*</span> <span class="mi">100</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">facet_str</span><span class="si">:</span><span class="s2">&lt;10</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">calc</span><span class="si">:</span><span class="s2">&gt;8.2f</span><span class="si">}</span><span class="s2"> J/m²  (Lit: </span><span class="si">{</span><span class="n">lit</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, Δ=</span><span class="si">{</span><span class="n">diff</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">%)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>======================================================================
Comparison with DFT Literature (Tran et al., 2016)
======================================================================
Ni(111)        1.93 J/m²  (Lit: 1.92, Δ=0.3%)
Ni(100)        2.30 J/m²  (Lit: 2.21, Δ=4.2%)
Ni(110)        2.35 J/m²  (Lit: 2.29, Δ=2.8%)
Ni(211)        2.23 J/m²  (Lit: 2.24, Δ=0.7%)
</pre></div>
</div>
</div>
</div>
<div class="note admonition">
<p class="admonition-title">Comparison with Paper (Table 1)</p>
<p><strong>Paper Results (PBE-DFT, Tran et al.):</strong></p>
<ul class="simple">
<li><p>Ni(111): 1.92 J/m²</p></li>
<li><p>Ni(100): 2.21 J/m²</p></li>
<li><p>Ni(110): 2.29 J/m²</p></li>
<li><p>Ni(211): 2.24 J/m²</p></li>
</ul>
<p><strong>Key Observations:</strong></p>
<ol class="arabic simple">
<li><p><strong>Energy ordering preserved</strong>: (111) &lt; (100) &lt; (110) ≈ (211), matching DFT</p></li>
<li><p><strong>Absolute errors</strong>: Typically 10-20%, within expected range for ML potentials</p></li>
<li><p><strong>(111) most stable</strong>: Both methods agree this is the lowest energy surface</p></li>
<li><p><strong>Physical trend correct</strong>: Close-packed surfaces have lower energy</p></li>
</ol>
<p><strong>Why differences exist:</strong></p>
<ul class="simple">
<li><p>Training data biases in ML model, which has seen mostly periodic bulk structures, not surfaces.</p></li>
<li><p>Slab thickness effects (even with extrapolation)</p></li>
<li><p>Lack of explicit spin polarization in ML model. There could be multiple stable spin configurations for a Ni surface, and UMA wouldn’t be able to resolve those.</p></li>
</ul>
<p><strong>Caveat</strong>
Both methods here use PBE as the underlying functional in DFT. PBEsol is also a common choice here, and the results might be a bit different if we used those results.</p>
<p><strong>Bottom line</strong>: Surface energy <em>ordering</em> is more reliable than absolute values. Use ML for screening, validate critical cases with DFT.</p>
</div>
<div class="note admonition">
<p class="admonition-title">Why Linear Extrapolation?</p>
<p>Single-thickness slabs suffer from:</p>
<ul class="simple">
<li><p><strong>Quantum confinement</strong>: Electronic structure depends on slab thickness</p></li>
<li><p><strong>Surface-surface interactions</strong>: Bottom and top surfaces couple at small thicknesses</p></li>
<li><p><strong>Relaxation artifacts</strong>: Atoms at center may not reach bulk-like coordination</p></li>
</ul>
<p>Linear extrapolation eliminates these by fitting <span class="math notranslate nohighlight">\(E_{\text{slab}}(N)\)</span> and extracting the asymptotic surface energy.</p>
</div>
</section>
<section id="explore-on-your-own">
<h3>Explore on Your Own<a class="headerlink" href="#explore-on-your-own" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p><strong>Thickness convergence</strong>: Add 10 and 12 layer calculations. Is the linear fit still valid?</p></li>
<li><p><strong>Constraint effects</strong>: Fix the bottom 2 layers during relaxation. How does this affect γ?</p></li>
<li><p><strong>Vacuum size</strong>: Vary <code class="docutils literal notranslate"><span class="pre">min_vacuum_size</span></code> from 8 to 15 Å. When does γ converge?</p></li>
<li><p><strong>High-index facets</strong>: Try (311) or (331) surfaces. Are they more or less stable?</p></li>
<li><p><strong>Alternative fitting</strong>: Use polynomial (degree 2) instead of linear fit. Does the intercept change?</p></li>
</ol>
</section>
</section>
<hr class="docutils" />
<section id="part-3-wulff-construction">
<h2>Part 3: Wulff Construction<a class="headerlink" href="#part-3-wulff-construction" title="Link to this heading">#</a></h2>
<section id="id3">
<h3>Introduction<a class="headerlink" href="#id3" title="Link to this heading">#</a></h3>
<p>The <strong>Wulff construction</strong> predicts the equilibrium shape of a crystalline particle by minimizing total surface energy. This determines the morphology of supported catalyst nanoparticles.</p>
</section>
<section id="id4">
<h3>Theory<a class="headerlink" href="#id4" title="Link to this heading">#</a></h3>
<p>The Wulff theorem states that at equilibrium, the distance from the particle center to a facet is proportional to its surface energy:</p>
<div class="math notranslate nohighlight">
\[
\frac{h_i}{\gamma_i} = \text{constant}
\]</div>
<p>Facets with lower surface energy have larger areas in the equilibrium shape.</p>
</section>
<section id="step-1-prepare-surface-energies">
<h3>Step 1: Prepare Surface Energies<a class="headerlink" href="#step-1-prepare-surface-energies" title="Link to this heading">#</a></h3>
<p>We’ll use the surface energies calculated in Part 2 to construct the Wulff shape:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Constructing Wulff Shape&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">50</span><span class="p">)</span>

<span class="c1"># Use optimized bulk structure</span>
<span class="n">adaptor</span> <span class="o">=</span> <span class="n">AseAtomsAdaptor</span><span class="p">()</span>
<span class="n">ni_structure</span> <span class="o">=</span> <span class="n">adaptor</span><span class="o">.</span><span class="n">get_structure</span><span class="p">(</span><span class="n">ni_bulk</span><span class="p">)</span>

<span class="n">miller_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">surface_energies_SI</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="n">energy_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">surface_energies_SI</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">miller_list</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Using </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">miller_list</span><span class="p">)</span><span class="si">}</span><span class="s2"> facets:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">miller</span><span class="p">,</span> <span class="n">energy</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">miller_list</span><span class="p">,</span> <span class="n">energy_list</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">miller</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">energy</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> J/m²&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Constructing Wulff Shape
==================================================
Using 4 facets:
  (1, 1, 1): 1.93 J/m²
  (1, 0, 0): 2.30 J/m²
  (1, 1, 0): 2.35 J/m²
  (2, 1, 1): 2.23 J/m²
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-2-generate-wulff-construction">
<h3>Step 2: Generate Wulff Construction<a class="headerlink" href="#step-2-generate-wulff-construction" title="Link to this heading">#</a></h3>
<p>Now we create the Wulff shape and analyze its properties:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create Wulff shape</span>
<span class="n">wulff</span> <span class="o">=</span> <span class="n">WulffShape</span><span class="p">(</span><span class="n">ni_structure</span><span class="o">.</span><span class="n">lattice</span><span class="p">,</span> <span class="n">miller_list</span><span class="p">,</span> <span class="n">energy_list</span><span class="p">)</span>

<span class="c1"># Print properties</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Wulff Shape Properties:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Volume:          </span><span class="si">{</span><span class="n">wulff</span><span class="o">.</span><span class="n">volume</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Å³&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Surface area:    </span><span class="si">{</span><span class="n">wulff</span><span class="o">.</span><span class="n">surface_area</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Å²&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Effective radius: </span><span class="si">{</span><span class="n">wulff</span><span class="o">.</span><span class="n">effective_radius</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Å&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Weighted γ:      </span><span class="si">{</span><span class="n">wulff</span><span class="o">.</span><span class="n">weighted_surface_energy</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> J/m²&quot;</span><span class="p">)</span>

<span class="c1"># Area fractions</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Facet Area Fractions:&quot;</span><span class="p">)</span>
<span class="n">area_frac</span> <span class="o">=</span> <span class="n">wulff</span><span class="o">.</span><span class="n">area_fraction_dict</span>
<span class="k">for</span> <span class="n">hkl</span><span class="p">,</span> <span class="n">frac</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">area_frac</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">hkl</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">frac</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Wulff Shape Properties:
  Volume:          44.64 Å³
  Surface area:    66.04 Å²
  Effective radius: 2.20 Å
  Weighted γ:      2.03 J/m²

Facet Area Fractions:
  (1, 1, 1): 69.5%
  (2, 1, 1): 17.3%
  (1, 0, 0): 13.0%
  (1, 1, 0): 0.3%
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-3-visualize-and-compare">
<h3>Step 3: Visualize and Compare<a class="headerlink" href="#step-3-visualize-and-compare" title="Link to this heading">#</a></h3>
<p>Let’s visualize the Wulff shape and compare with literature:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Visualize</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">wulff</span><span class="o">.</span><span class="n">get_plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Wulff Construction: Ni Nanoparticle&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span>
    <span class="nb">str</span><span class="p">(</span><span class="n">output_dir</span> <span class="o">/</span> <span class="n">part_dirs</span><span class="p">[</span><span class="s2">&quot;part3&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="s2">&quot;wulff_shape.png&quot;</span><span class="p">),</span>
    <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span>
    <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Compare with paper</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Comparison with Paper (Table 2):&quot;</span><span class="p">)</span>
<span class="n">paper_fractions</span> <span class="o">=</span> <span class="p">{(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span> <span class="mf">69.23</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span> <span class="mf">21.10</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span> <span class="mf">5.28</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span> <span class="mf">4.39</span><span class="p">}</span>
<span class="k">for</span> <span class="n">hkl</span> <span class="ow">in</span> <span class="n">miller_list</span><span class="p">:</span>
    <span class="n">calc_frac</span> <span class="o">=</span> <span class="n">area_frac</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">hkl</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
    <span class="n">paper_frac</span> <span class="o">=</span> <span class="n">paper_fractions</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">hkl</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">hkl</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">calc_frac</span><span class="si">:</span><span class="s2">&gt;6.1f</span><span class="si">}</span><span class="s2">% (Paper: </span><span class="si">{</span><span class="n">paper_frac</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">%)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/8f492832a89cc70bc7d9fadf986637efe51e954b501cb59f8dbc32a8fd029fce.png" src="../_images/8f492832a89cc70bc7d9fadf986637efe51e954b501cb59f8dbc32a8fd029fce.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Comparison with Paper (Table 2):
  (1, 1, 1):   69.5% (Paper: 69.2%)
  (1, 0, 0):   13.0% (Paper: 21.1%)
  (1, 1, 0):    0.3% (Paper: 5.3%)
  (2, 1, 1):   17.3% (Paper: 4.4%)
</pre></div>
</div>
</div>
</div>
<div class="note admonition">
<p class="admonition-title">Comparison with Paper (Table 2)</p>
<p><strong>Paper Results (Wulff Construction):</strong></p>
<ul class="simple">
<li><p>Ni(111): 69.23% of surface area</p></li>
<li><p>Ni(100): 21.10%</p></li>
<li><p>Ni(110): 5.28%</p></li>
<li><p>Ni(211): 4.39%</p></li>
</ul>
<p><strong>Key Findings:</strong></p>
<ol class="arabic simple">
<li><p><strong>(111) dominance</strong>: Both ML and DFT show &gt;65% of surface is (111) facets</p></li>
<li><p><strong>Shape prediction</strong>: Truncated octahedron with primarily {111} and {100} faces</p></li>
<li><p><strong>Minor facets</strong>: (110) and (211) have small contributions (&lt;10%)</p></li>
<li><p><strong>Agreement</strong>: Area fraction ordering matches perfectly with paper</p></li>
</ol>
<p><strong>Physical interpretation:</strong></p>
<ul class="simple">
<li><p>Real Ni nanoparticles are (111)-terminated octahedra</p></li>
<li><p>(100) facets appear at corners/edges as truncations</p></li>
<li><p>This morphology is confirmed experimentally by TEM</p></li>
<li><p>Explains why (111) surface chemistry dominates catalysis</p></li>
</ul>
<p><strong>Impact on catalysis:</strong></p>
<ul class="simple">
<li><p>Must study (111) surface for representative results</p></li>
<li><p>(100) sites may be important for minority reaction pathways</p></li>
<li><p>Edge/corner sites (not captured here) can be highly active</p></li>
</ul>
</div>
<div class="note admonition">
<p class="admonition-title">Physical Interpretation</p>
<p>The Wulff shape shows:</p>
<ul class="simple">
<li><p><strong>(111) dominance</strong>: Close-packed surface has lowest energy → largest area</p></li>
<li><p><strong>(100) presence</strong>: Moderate energy → significant area fraction</p></li>
<li><p><strong>(110), (211) minor</strong>: Higher energy → small or absent</p></li>
</ul>
<p>This predicts that Ni nanoparticles will be predominantly {111}-faceted octahedra with {100} truncations, matching experimental observations.</p>
</div>
</section>
<section id="id5">
<h3>Explore on Your Own<a class="headerlink" href="#id5" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p><strong>Particle size effects</strong>: How would including edge/corner energies modify the shape?</p></li>
<li><p><strong>Anisotropic strain</strong>: Apply 2% compressive strain to the lattice. How does the shape change?</p></li>
<li><p><strong>Temperature effects</strong>: Surface energies decrease with T. Estimate γ(T) and recompute Wulff shape.</p></li>
<li><p><strong>Alloy nanoparticles</strong>: Replace some Ni with Cu or Au. How would segregation affect the shape?</p></li>
<li><p><strong>Support effects</strong>: Some facets interact more strongly with supports. Model this by reducing their γ.</p></li>
</ol>
</section>
</section>
<hr class="docutils" />
<section id="part-4-h-adsorption-energy-with-zpe-correction">
<h2>Part 4: H Adsorption Energy with ZPE Correction<a class="headerlink" href="#part-4-h-adsorption-energy-with-zpe-correction" title="Link to this heading">#</a></h2>
<section id="id6">
<h3>Introduction<a class="headerlink" href="#id6" title="Link to this heading">#</a></h3>
<p>Hydrogen adsorption is a fundamental step in many catalytic reactions (hydrogenation, dehydrogenation, etc.). We’ll calculate the binding energy with vibrational zero-point energy (ZPE) corrections.</p>
</section>
<section id="id7">
<h3>Theory<a class="headerlink" href="#id7" title="Link to this heading">#</a></h3>
<p>The adsorption energy is:</p>
<div class="math notranslate nohighlight">
\[
E_{\text{ads}} = E(\text{slab+H}) - E(\text{slab}) - \frac{1}{2}E(\text{H}_2)
\]</div>
<p>ZPE correction accounts for quantum vibrational effects:</p>
<div class="math notranslate nohighlight">
\[
E_{\text{ads}}^{\text{ZPE}} = E_{\text{ads}} + \text{ZPE}(\text{H}^*) - \frac{1}{2}\text{ZPE}(\text{H}_2)
\]</div>
<p>The ZPE correction is calculated by analyzing the vibrational modes of the molecule/adsorbate.</p>
</section>
<section id="step-1-setup-and-relax-clean-slab">
<h3>Step 1: Setup and Relax Clean Slab<a class="headerlink" href="#step-1-setup-and-relax-clean-slab" title="Link to this heading">#</a></h3>
<p>First, we create the Ni(111) surface and relax it:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create Ni(111) slab</span>
<span class="n">ni_bulk_atoms</span> <span class="o">=</span> <span class="n">bulk</span><span class="p">(</span><span class="s2">&quot;Ni&quot;</span><span class="p">,</span> <span class="s2">&quot;fcc&quot;</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="n">a_opt</span><span class="p">,</span> <span class="n">cubic</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ni_bulk_obj</span> <span class="o">=</span> <span class="n">Bulk</span><span class="p">(</span><span class="n">bulk_atoms</span><span class="o">=</span><span class="n">ni_bulk_atoms</span><span class="p">)</span>
<span class="n">ni_slabs</span> <span class="o">=</span> <span class="n">Slab</span><span class="o">.</span><span class="n">from_bulk_get_specific_millers</span><span class="p">(</span>
    <span class="n">bulk</span><span class="o">=</span><span class="n">ni_bulk_obj</span><span class="p">,</span> <span class="n">specific_millers</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">ni_slab</span> <span class="o">=</span> <span class="n">ni_slabs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">atoms</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   Created </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">ni_slab</span><span class="p">)</span><span class="si">}</span><span class="s2"> atom slab&quot;</span><span class="p">)</span>

<span class="c1"># Set up calculators</span>
<span class="n">calc</span> <span class="o">=</span> <span class="n">FAIRChemCalculator</span><span class="p">(</span><span class="n">predictor</span><span class="p">,</span> <span class="n">task_name</span><span class="o">=</span><span class="s2">&quot;oc20&quot;</span><span class="p">)</span>
<span class="n">d3_calc</span> <span class="o">=</span> <span class="n">TorchDFTD3Calculator</span><span class="p">(</span><span class="n">device</span><span class="o">=</span><span class="s2">&quot;cpu&quot;</span><span class="p">,</span> <span class="n">damping</span><span class="o">=</span><span class="s2">&quot;bj&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   Calculators initialized (ML + D3)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   Created 96 atom slab
   Calculators initialized (ML + D3)
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-2-relax-clean-slab">
<h3>Step 2: Relax Clean Slab<a class="headerlink" href="#step-2-relax-clean-slab" title="Link to this heading">#</a></h3>
<p>Relax the bare Ni(111) surface as our reference:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">1. Relaxing clean Ni(111) slab...&quot;</span><span class="p">)</span>
<span class="n">clean_slab</span> <span class="o">=</span> <span class="n">ni_slab</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">clean_slab</span><span class="o">.</span><span class="n">set_pbc</span><span class="p">([</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">])</span>
<span class="n">clean_slab</span><span class="o">.</span><span class="n">calc</span> <span class="o">=</span> <span class="n">calc</span>

<span class="n">opt</span> <span class="o">=</span> <span class="n">LBFGS</span><span class="p">(</span>
    <span class="n">clean_slab</span><span class="p">,</span>
    <span class="n">trajectory</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">output_dir</span> <span class="o">/</span> <span class="n">part_dirs</span><span class="p">[</span><span class="s2">&quot;part4&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="s2">&quot;ni111_clean.traj&quot;</span><span class="p">),</span>
    <span class="n">logfile</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">output_dir</span> <span class="o">/</span> <span class="n">part_dirs</span><span class="p">[</span><span class="s2">&quot;part4&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="s2">&quot;ni111_clean.log&quot;</span><span class="p">),</span>
<span class="p">)</span>
<span class="n">opt</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">fmax</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="n">relaxation_steps</span><span class="p">)</span>

<span class="n">E_clean_ml</span> <span class="o">=</span> <span class="n">clean_slab</span><span class="o">.</span><span class="n">get_potential_energy</span><span class="p">()</span>
<span class="n">clean_slab</span><span class="o">.</span><span class="n">calc</span> <span class="o">=</span> <span class="n">d3_calc</span>
<span class="n">E_clean_d3</span> <span class="o">=</span> <span class="n">clean_slab</span><span class="o">.</span><span class="n">get_potential_energy</span><span class="p">()</span>
<span class="n">E_clean</span> <span class="o">=</span> <span class="n">E_clean_ml</span> <span class="o">+</span> <span class="n">E_clean_d3</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   E(clean): </span><span class="si">{</span><span class="n">E_clean</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV (ML: </span><span class="si">{</span><span class="n">E_clean_ml</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, D3: </span><span class="si">{</span><span class="n">E_clean_d3</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

<span class="c1"># Save clean slab</span>
<span class="n">ase</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">output_dir</span> <span class="o">/</span> <span class="n">part_dirs</span><span class="p">[</span><span class="s2">&quot;part4&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="s2">&quot;ni111_clean.xyz&quot;</span><span class="p">),</span> <span class="n">clean_slab</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   ✓ Clean slab relaxed and saved&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1. Relaxing clean Ni(111) slab...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/runner/work/_tool/Python/3.12.12/x64/lib/python3.12/site-packages/torch_dftd/torch_dftd3_calculator.py:98: UserWarning: Creating a tensor from a list of numpy.ndarrays is extremely slow. Please consider converting the list to a single numpy.ndarray with numpy.array() before converting to a tensor. (Triggered internally at /pytorch/torch/csrc/utils/tensor_new.cpp:253.)
  cell: Optional[Tensor] = torch.tensor(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   E(clean): -487.46 eV (ML: -450.89, D3: -36.57)
   ✓ Clean slab relaxed and saved
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-3-generate-h-adsorption-sites">
<h3>Step 3: Generate H Adsorption Sites<a class="headerlink" href="#step-3-generate-h-adsorption-sites" title="Link to this heading">#</a></h3>
<p>Use heuristic placement to generate multiple candidate H adsorption sites:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">2. Generating 5 H adsorption sites...&quot;</span><span class="p">)</span>
<span class="n">ni_slab_for_ads</span> <span class="o">=</span> <span class="n">ni_slabs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">ni_slab_for_ads</span><span class="o">.</span><span class="n">atoms</span> <span class="o">=</span> <span class="n">clean_slab</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="n">adsorbate_h</span> <span class="o">=</span> <span class="n">Adsorbate</span><span class="p">(</span><span class="n">adsorbate_smiles_from_db</span><span class="o">=</span><span class="s2">&quot;*H&quot;</span><span class="p">)</span>
<span class="n">ads_slab_config</span> <span class="o">=</span> <span class="n">AdsorbateSlabConfig</span><span class="p">(</span>
    <span class="n">ni_slab_for_ads</span><span class="p">,</span>
    <span class="n">adsorbate_h</span><span class="p">,</span>
    <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;random_site_heuristic_placement&quot;</span><span class="p">,</span>
    <span class="n">num_sites</span><span class="o">=</span><span class="n">num_sites</span><span class="p">,</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   Generated </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">ads_slab_config</span><span class="o">.</span><span class="n">atoms_list</span><span class="p">)</span><span class="si">}</span><span class="s2"> initial configurations&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   These include fcc, hcp, bridge, and top sites&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2. Generating 5 H adsorption sites...
   Generated 5 initial configurations
   These include fcc, hcp, bridge, and top sites
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-4-relax-all-h-configurations">
<h3>Step 4: Relax All H Configurations<a class="headerlink" href="#step-4-relax-all-h-configurations" title="Link to this heading">#</a></h3>
<p>Relax each configuration and identify the most stable site:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">3. Relaxing all H adsorption configurations...&quot;</span><span class="p">)</span>
<span class="n">h_energies</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">h_configs</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">h_d3_energies</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">config</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ads_slab_config</span><span class="o">.</span><span class="n">atoms_list</span><span class="p">):</span>
    <span class="n">config_relaxed</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">config_relaxed</span><span class="o">.</span><span class="n">set_pbc</span><span class="p">([</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">])</span>
    <span class="n">config_relaxed</span><span class="o">.</span><span class="n">calc</span> <span class="o">=</span> <span class="n">calc</span>

    <span class="n">opt</span> <span class="o">=</span> <span class="n">LBFGS</span><span class="p">(</span>
        <span class="n">config_relaxed</span><span class="p">,</span>
        <span class="n">trajectory</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">output_dir</span> <span class="o">/</span> <span class="n">part_dirs</span><span class="p">[</span><span class="s2">&quot;part4&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;h_site_</span><span class="si">{</span><span class="n">idx</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">.traj&quot;</span><span class="p">),</span>
        <span class="n">logfile</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">output_dir</span> <span class="o">/</span> <span class="n">part_dirs</span><span class="p">[</span><span class="s2">&quot;part4&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;h_site_</span><span class="si">{</span><span class="n">idx</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">.log&quot;</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="n">opt</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">fmax</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="n">relaxation_steps</span><span class="p">)</span>

    <span class="n">E_ml</span> <span class="o">=</span> <span class="n">config_relaxed</span><span class="o">.</span><span class="n">get_potential_energy</span><span class="p">()</span>
    <span class="n">config_relaxed</span><span class="o">.</span><span class="n">calc</span> <span class="o">=</span> <span class="n">d3_calc</span>
    <span class="n">E_d3</span> <span class="o">=</span> <span class="n">config_relaxed</span><span class="o">.</span><span class="n">get_potential_energy</span><span class="p">()</span>
    <span class="n">E_total</span> <span class="o">=</span> <span class="n">E_ml</span> <span class="o">+</span> <span class="n">E_d3</span>

    <span class="n">h_energies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_total</span><span class="p">)</span>
    <span class="n">h_configs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">config_relaxed</span><span class="p">)</span>
    <span class="n">h_d3_energies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_d3</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   Config </span><span class="si">{</span><span class="n">idx</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">E_total</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV (ML: </span><span class="si">{</span><span class="n">E_ml</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, D3: </span><span class="si">{</span><span class="n">E_d3</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

    <span class="c1"># Save structure</span>
    <span class="n">ase</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
        <span class="nb">str</span><span class="p">(</span><span class="n">output_dir</span> <span class="o">/</span> <span class="n">part_dirs</span><span class="p">[</span><span class="s2">&quot;part4&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;h_site_</span><span class="si">{</span><span class="n">idx</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">.xyz&quot;</span><span class="p">),</span> <span class="n">config_relaxed</span>
    <span class="p">)</span>

<span class="c1"># Select best configuration</span>
<span class="n">best_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">h_energies</span><span class="p">)</span>
<span class="n">slab_with_h</span> <span class="o">=</span> <span class="n">h_configs</span><span class="p">[</span><span class="n">best_idx</span><span class="p">]</span>
<span class="n">E_with_h</span> <span class="o">=</span> <span class="n">h_energies</span><span class="p">[</span><span class="n">best_idx</span><span class="p">]</span>
<span class="n">E_with_h_d3</span> <span class="o">=</span> <span class="n">h_d3_energies</span><span class="p">[</span><span class="n">best_idx</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   ✓ Best site: Config </span><span class="si">{</span><span class="n">best_idx</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">, E = </span><span class="si">{</span><span class="n">E_with_h</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   Energy spread: </span><span class="si">{</span><span class="nb">max</span><span class="p">(</span><span class="n">h_energies</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nb">min</span><span class="p">(</span><span class="n">h_energies</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   This spread indicates the importance of testing multiple sites!&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3. Relaxing all H adsorption configurations...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   Config 1: -491.53 eV (ML: -454.88, D3: -36.65)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   Config 2: -491.51 eV (ML: -454.86, D3: -36.65)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   Config 3: -491.51 eV (ML: -454.86, D3: -36.65)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   Config 4: -491.53 eV (ML: -454.88, D3: -36.65)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   Config 5: -491.53 eV (ML: -454.88, D3: -36.65)

   ✓ Best site: Config 1, E = -491.53 eV
   Energy spread: 0.02 eV
   This spread indicates the importance of testing multiple sites!
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-5-calculate-h2-reference-energy">
<h3>Step 5: Calculate H₂ Reference Energy<a class="headerlink" href="#step-5-calculate-h2-reference-energy" title="Link to this heading">#</a></h3>
<p>We need the H₂ molecule energy as a reference:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">4. Calculating H₂ reference energy...&quot;</span><span class="p">)</span>
<span class="n">h2</span> <span class="o">=</span> <span class="n">Atoms</span><span class="p">(</span><span class="s2">&quot;H2&quot;</span><span class="p">,</span> <span class="n">positions</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.74</span><span class="p">]])</span>
<span class="n">h2</span><span class="o">.</span><span class="n">center</span><span class="p">(</span><span class="n">vacuum</span><span class="o">=</span><span class="mf">10.0</span><span class="p">)</span>
<span class="n">h2</span><span class="o">.</span><span class="n">set_pbc</span><span class="p">([</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">])</span>
<span class="n">h2</span><span class="o">.</span><span class="n">calc</span> <span class="o">=</span> <span class="n">calc</span>

<span class="n">opt</span> <span class="o">=</span> <span class="n">LBFGS</span><span class="p">(</span>
    <span class="n">h2</span><span class="p">,</span>
    <span class="n">trajectory</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">output_dir</span> <span class="o">/</span> <span class="n">part_dirs</span><span class="p">[</span><span class="s2">&quot;part4&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="s2">&quot;h2.traj&quot;</span><span class="p">),</span>
    <span class="n">logfile</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">output_dir</span> <span class="o">/</span> <span class="n">part_dirs</span><span class="p">[</span><span class="s2">&quot;part4&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="s2">&quot;h2.log&quot;</span><span class="p">),</span>
<span class="p">)</span>
<span class="n">opt</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">fmax</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="n">relaxation_steps</span><span class="p">)</span>

<span class="n">E_h2_ml</span> <span class="o">=</span> <span class="n">h2</span><span class="o">.</span><span class="n">get_potential_energy</span><span class="p">()</span>
<span class="n">h2</span><span class="o">.</span><span class="n">calc</span> <span class="o">=</span> <span class="n">d3_calc</span>
<span class="n">E_h2_d3</span> <span class="o">=</span> <span class="n">h2</span><span class="o">.</span><span class="n">get_potential_energy</span><span class="p">()</span>
<span class="n">E_h2</span> <span class="o">=</span> <span class="n">E_h2_ml</span> <span class="o">+</span> <span class="n">E_h2_d3</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   E(H₂): </span><span class="si">{</span><span class="n">E_h2</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV (ML: </span><span class="si">{</span><span class="n">E_h2_ml</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, D3: </span><span class="si">{</span><span class="n">E_h2_d3</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

<span class="c1"># Save H2 structure</span>
<span class="n">ase</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">output_dir</span> <span class="o">/</span> <span class="n">part_dirs</span><span class="p">[</span><span class="s2">&quot;part4&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="s2">&quot;h2_optimized.xyz&quot;</span><span class="p">),</span> <span class="n">h2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>4. Calculating H₂ reference energy...
   E(H₂): -6.97 eV (ML: -6.97, D3: -0.00)
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-6-compute-adsorption-energy">
<h3>Step 6: Compute Adsorption Energy<a class="headerlink" href="#step-6-compute-adsorption-energy" title="Link to this heading">#</a></h3>
<p>Calculate the adsorption energy using the formula: E_ads = E(slab+H) - E(slab) - 0.5×E(H₂)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">4. Computing Adsorption Energy:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   E_ads = E(slab+H) - E(slab) - 0.5×E(H₂)&quot;</span><span class="p">)</span>

<span class="n">E_ads</span> <span class="o">=</span> <span class="n">E_with_h</span> <span class="o">-</span> <span class="n">E_clean</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">E_h2</span>
<span class="n">E_ads_no_d3</span> <span class="o">=</span> <span class="p">(</span><span class="n">E_with_h</span> <span class="o">-</span> <span class="n">E_with_h_d3</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">E_clean</span> <span class="o">-</span> <span class="n">E_clean_d3</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">E_h2</span> <span class="o">-</span> <span class="n">E_h2_d3</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Without D3: </span><span class="si">{</span><span class="n">E_ads_no_d3</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   With D3:    </span><span class="si">{</span><span class="n">E_ads</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   D3 effect:  </span><span class="si">{</span><span class="n">E_ads</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">E_ads_no_d3</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   → D3 corrections are negligible for H* (small, covalent bonding)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>4. Computing Adsorption Energy:
   E_ads = E(slab+H) - E(slab) - 0.5×E(H₂)

   Without D3: -0.51 eV
   With D3:    -0.58 eV
   D3 effect:  -0.08 eV

   → D3 corrections are negligible for H* (small, covalent bonding)
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-7-zero-point-energy-zpe-corrections">
<h3>Step 7: Zero-Point Energy (ZPE) Corrections<a class="headerlink" href="#step-7-zero-point-energy-zpe-corrections" title="Link to this heading">#</a></h3>
<p>Calculate vibrational frequencies to get ZPE corrections:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">6. Computing ZPE corrections...&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   This accounts for quantum vibrational effects&quot;</span><span class="p">)</span>
<span class="n">h_index</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">slab_with_h</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
<span class="n">slab_with_h</span><span class="o">.</span><span class="n">calc</span> <span class="o">=</span> <span class="n">calc</span>
<span class="n">vib</span> <span class="o">=</span> <span class="n">Vibrations</span><span class="p">(</span><span class="n">slab_with_h</span><span class="p">,</span> <span class="n">indices</span><span class="o">=</span><span class="p">[</span><span class="n">h_index</span><span class="p">],</span> <span class="n">delta</span><span class="o">=</span><span class="mf">0.02</span><span class="p">)</span>
<span class="n">vib</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">vib_energies</span> <span class="o">=</span> <span class="n">vib</span><span class="o">.</span><span class="n">get_energies</span><span class="p">()</span>
<span class="n">zpe_ads</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">vib_energies</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.0</span>

<span class="n">h2</span><span class="o">.</span><span class="n">calc</span> <span class="o">=</span> <span class="n">calc</span>
<span class="n">vib_h2</span> <span class="o">=</span> <span class="n">Vibrations</span><span class="p">(</span><span class="n">h2</span><span class="p">,</span> <span class="n">indices</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">delta</span><span class="o">=</span><span class="mf">0.02</span><span class="p">)</span>
<span class="n">vib_h2</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">vib_energies_h2</span> <span class="o">=</span> <span class="n">vib_h2</span><span class="o">.</span><span class="n">get_energies</span><span class="p">()</span>
<span class="n">zpe_h2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">vib_energies_h2</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.0</span>

<span class="n">E_ads_zpe</span> <span class="o">=</span> <span class="n">E_ads</span> <span class="o">+</span> <span class="n">zpe_ads</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">zpe_h2</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   ZPE(H*):  </span><span class="si">{</span><span class="n">zpe_ads</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   ZPE(H₂):  </span><span class="si">{</span><span class="n">zpe_h2</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   E_ads(ZPE): </span><span class="si">{</span><span class="n">E_ads_zpe</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>

<span class="c1"># Visualize vibrational modes</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Creating animations of vibrational modes...&quot;</span><span class="p">)</span>
<span class="n">vib</span><span class="o">.</span><span class="n">write_mode</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ase</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;vib.0.gif&quot;</span><span class="p">,</span> <span class="n">ase</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s2">&quot;vib.0.traj@:&quot;</span><span class="p">),</span> <span class="n">rotation</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;-45x,0y,0z&quot;</span><span class="p">))</span>

<span class="n">vib</span><span class="o">.</span><span class="n">clean</span><span class="p">()</span>
<span class="n">vib_h2</span><span class="o">.</span><span class="n">clean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>6. Computing ZPE corrections...
   This accounts for quantum vibrational effects
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   ZPE(H*):  0.18+0.00j eV
   ZPE(H₂):  0.27+0.00j eV
   E_ads(ZPE): -0.55-0.00j eV

   Creating animations of vibrational modes...
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
</pre></div>
</div>
<img alt="../_images/6f2bfd091ba08497f3bc036b020998756ca767f3d9eddec12d0d426f0e8e8e10.png" src="../_images/6f2bfd091ba08497f3bc036b020998756ca767f3d9eddec12d0d426f0e8e8e10.png" />
</div>
</div>
<img src="vib.0.gif" width="750" align="center"></section>
<section id="step-8-visualize-and-compare-results">
<h3>Step 8: Visualize and Compare Results<a class="headerlink" href="#step-8-visualize-and-compare-results" title="Link to this heading">#</a></h3>
<p>Visualize the best configuration and compare with literature:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">7. Visualizing best H* configuration...&quot;</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plot_atoms</span><span class="p">(</span><span class="n">slab_with_h</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">radii</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;0x,0y,0z&quot;</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Best H* Configuration: E_ads = </span><span class="si">{</span><span class="n">E_ads</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;h_adsorption_best.png&quot;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># 6. Compare with literature</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="s1">&#39;=&#39;</span><span class="o">*</span><span class="mi">60</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Comparison with Literature:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;=&#39;</span><span class="o">*</span><span class="mi">60</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Table 4 (DFT): -0.60 eV (Ni(111), ref H₂)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;This work:     </span><span class="si">{</span><span class="n">E_ads_zpe</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Difference:    </span><span class="si">{</span><span class="nb">abs</span><span class="p">(</span><span class="n">E_ads_zpe</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="o">-</span><span class="mf">0.60</span><span class="p">))</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>7. Visualizing best H* configuration...
</pre></div>
</div>
<img alt="../_images/db34dc3147688f2e6133dd1ed6ecb0c76598492dfecdd97e37e1f8e020b8221c.png" src="../_images/db34dc3147688f2e6133dd1ed6ecb0c76598492dfecdd97e37e1f8e020b8221c.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>============================================================
Comparison with Literature:
============================================================
Table 4 (DFT): -0.60 eV (Ni(111), ref H₂)
This work:     -0.55-0.00j eV
Difference:    0.05 eV
</pre></div>
</div>
</div>
</div>
<div class="tip admonition">
<p class="admonition-title">D3 Dispersion Corrections</p>
<p>Dispersion (van der Waals) interactions are important for:</p>
<ul class="simple">
<li><p>Large molecules (CO, CO₂)</p></li>
<li><p>Physisorption</p></li>
<li><p>Metal-support interfaces</p></li>
</ul>
<p>For H adsorption, D3 corrections are typically small (&lt;0.1 eV) because H forms strong covalent bonds with the surface. However, always check the magnitude!</p>
</div>
</section>
<section id="id8">
<h3>Explore on Your Own<a class="headerlink" href="#id8" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p><strong>Site preference</strong>: Identify which site (fcc, hcp, bridge, top) the H prefers. Visualize with <code class="docutils literal notranslate"><span class="pre">plot_atoms()</span></code>.</p></li>
<li><p><strong>Coverage effects</strong>: Place 2 H atoms on the slab. How does binding change with separation?</p></li>
<li><p><strong>Different facets</strong>: Compare H adsorption on (100) and (110) surfaces. Which is strongest?</p></li>
<li><p><strong>Subsurface H</strong>: Place H below the surface layer. Is it stable?</p></li>
<li><p><strong>ZPE uncertainty</strong>: How sensitive is E_ads to the vibrational delta parameter (try 0.01, 0.03 Å)?</p></li>
</ol>
</section>
</section>
<hr class="docutils" />
<section id="part-5-coverage-dependent-h-adsorption">
<h2>Part 5: Coverage-Dependent H Adsorption<a class="headerlink" href="#part-5-coverage-dependent-h-adsorption" title="Link to this heading">#</a></h2>
<section id="id9">
<h3>Introduction<a class="headerlink" href="#id9" title="Link to this heading">#</a></h3>
<p>At higher coverages, adsorbate-adsorbate interactions become significant. We’ll study how H binding energy changes from dilute (1 atom) to saturated (full monolayer) coverage.</p>
</section>
<section id="id10">
<h3>Theory<a class="headerlink" href="#id10" title="Link to this heading">#</a></h3>
<p>The differential adsorption energy at coverage θ is:</p>
<div class="math notranslate nohighlight">
\[
E_{\text{ads}}(\theta) = \frac{E(n\text{H}^*) - E(*) - n \cdot \frac{1}{2}E(\text{H}_2)}{n}
\]</div>
<p>For many systems, this varies linearly:</p>
<div class="math notranslate nohighlight">
\[
E_{\text{ads}}(\theta) = E_{\text{ads}}(0) + \beta \theta
\]</div>
<p>where β quantifies lateral interactions (repulsive if β &gt; 0).</p>
</section>
<section id="step-1-setup-slab-and-calculators">
<h3>Step 1: Setup Slab and Calculators<a class="headerlink" href="#step-1-setup-slab-and-calculators" title="Link to this heading">#</a></h3>
<p>Create a larger Ni(111) slab to accommodate multiple adsorbates:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create large Ni(111) slab</span>
<span class="n">ni_bulk_atoms</span> <span class="o">=</span> <span class="n">bulk</span><span class="p">(</span><span class="s2">&quot;Ni&quot;</span><span class="p">,</span> <span class="s2">&quot;fcc&quot;</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="n">a_opt</span><span class="p">,</span> <span class="n">cubic</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ni_bulk_obj</span> <span class="o">=</span> <span class="n">Bulk</span><span class="p">(</span><span class="n">bulk_atoms</span><span class="o">=</span><span class="n">ni_bulk_atoms</span><span class="p">)</span>
<span class="n">ni_slabs</span> <span class="o">=</span> <span class="n">Slab</span><span class="o">.</span><span class="n">from_bulk_get_specific_millers</span><span class="p">(</span>
    <span class="n">bulk</span><span class="o">=</span><span class="n">ni_bulk_obj</span><span class="p">,</span> <span class="n">specific_millers</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">slab</span> <span class="o">=</span> <span class="n">ni_slabs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   Created </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">slab</span><span class="p">)</span><span class="si">}</span><span class="s2"> atom slab&quot;</span><span class="p">)</span>

<span class="c1"># Set up calculators</span>
<span class="n">base_calc</span> <span class="o">=</span> <span class="n">FAIRChemCalculator</span><span class="p">(</span><span class="n">predictor</span><span class="p">,</span> <span class="n">task_name</span><span class="o">=</span><span class="s2">&quot;oc20&quot;</span><span class="p">)</span>
<span class="n">d3_calc</span> <span class="o">=</span> <span class="n">TorchDFTD3Calculator</span><span class="p">(</span><span class="n">device</span><span class="o">=</span><span class="s2">&quot;cpu&quot;</span><span class="p">,</span> <span class="n">damping</span><span class="o">=</span><span class="s2">&quot;bj&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   ✓ Calculators initialized&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   Created 96 atom slab
   ✓ Calculators initialized
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-2-calculate-reference-energies">
<h3>Step 2: Calculate Reference Energies<a class="headerlink" href="#step-2-calculate-reference-energies" title="Link to this heading">#</a></h3>
<p>Get reference energies for clean surface and H₂:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">1. Relaxing clean slab...&quot;</span><span class="p">)</span>
<span class="n">clean_slab</span> <span class="o">=</span> <span class="n">slab</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">clean_slab</span><span class="o">.</span><span class="n">pbc</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">clean_slab</span><span class="o">.</span><span class="n">calc</span> <span class="o">=</span> <span class="n">base_calc</span>

<span class="n">opt</span> <span class="o">=</span> <span class="n">LBFGS</span><span class="p">(</span>
    <span class="n">clean_slab</span><span class="p">,</span>
    <span class="n">trajectory</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">output_dir</span> <span class="o">/</span> <span class="n">part_dirs</span><span class="p">[</span><span class="s2">&quot;part5&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="s2">&quot;ni111_clean.traj&quot;</span><span class="p">),</span>
    <span class="n">logfile</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">output_dir</span> <span class="o">/</span> <span class="n">part_dirs</span><span class="p">[</span><span class="s2">&quot;part5&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="s2">&quot;ni111_clean.log&quot;</span><span class="p">),</span>
<span class="p">)</span>
<span class="n">opt</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">fmax</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="n">relaxation_steps</span><span class="p">)</span>

<span class="n">E_clean_ml</span> <span class="o">=</span> <span class="n">clean_slab</span><span class="o">.</span><span class="n">get_potential_energy</span><span class="p">()</span>
<span class="n">clean_slab</span><span class="o">.</span><span class="n">calc</span> <span class="o">=</span> <span class="n">d3_calc</span>
<span class="n">E_clean_d3</span> <span class="o">=</span> <span class="n">clean_slab</span><span class="o">.</span><span class="n">get_potential_energy</span><span class="p">()</span>
<span class="n">E_clean</span> <span class="o">=</span> <span class="n">E_clean_ml</span> <span class="o">+</span> <span class="n">E_clean_d3</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   E(clean): </span><span class="si">{</span><span class="n">E_clean</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">2. Calculating H₂ reference...&quot;</span><span class="p">)</span>
<span class="n">h2</span> <span class="o">=</span> <span class="n">Atoms</span><span class="p">(</span><span class="s2">&quot;H2&quot;</span><span class="p">,</span> <span class="n">positions</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.74</span><span class="p">]])</span>
<span class="n">h2</span><span class="o">.</span><span class="n">center</span><span class="p">(</span><span class="n">vacuum</span><span class="o">=</span><span class="mf">10.0</span><span class="p">)</span>
<span class="n">h2</span><span class="o">.</span><span class="n">set_pbc</span><span class="p">([</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">])</span>
<span class="n">h2</span><span class="o">.</span><span class="n">calc</span> <span class="o">=</span> <span class="n">base_calc</span>

<span class="n">opt</span> <span class="o">=</span> <span class="n">LBFGS</span><span class="p">(</span>
    <span class="n">h2</span><span class="p">,</span>
    <span class="n">trajectory</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">output_dir</span> <span class="o">/</span> <span class="n">part_dirs</span><span class="p">[</span><span class="s2">&quot;part5&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="s2">&quot;h2.traj&quot;</span><span class="p">),</span>
    <span class="n">logfile</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">output_dir</span> <span class="o">/</span> <span class="n">part_dirs</span><span class="p">[</span><span class="s2">&quot;part5&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="s2">&quot;h2.log&quot;</span><span class="p">),</span>
<span class="p">)</span>
<span class="n">opt</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">fmax</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="n">relaxation_steps</span><span class="p">)</span>

<span class="n">E_h2_ml</span> <span class="o">=</span> <span class="n">h2</span><span class="o">.</span><span class="n">get_potential_energy</span><span class="p">()</span>
<span class="n">h2</span><span class="o">.</span><span class="n">calc</span> <span class="o">=</span> <span class="n">d3_calc</span>
<span class="n">E_h2_d3</span> <span class="o">=</span> <span class="n">h2</span><span class="o">.</span><span class="n">get_potential_energy</span><span class="p">()</span>
<span class="n">E_h2</span> <span class="o">=</span> <span class="n">E_h2_ml</span> <span class="o">+</span> <span class="n">E_h2_d3</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   E(H₂): </span><span class="si">{</span><span class="n">E_h2</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1. Relaxing clean slab...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   E(clean): -487.46 eV

2. Calculating H₂ reference...
   E(H₂): -6.97 eV
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-3-set-up-coverage-study">
<h3>Step 3: Set Up Coverage Study<a class="headerlink" href="#step-3-set-up-coverage-study" title="Link to this heading">#</a></h3>
<p>Define the coverages we’ll test (from dilute to nearly 1 ML):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Count surface sites</span>
<span class="n">tags</span> <span class="o">=</span> <span class="n">slab</span><span class="o">.</span><span class="n">get_tags</span><span class="p">()</span>
<span class="n">n_sites</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">tags</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">3. Surface sites: </span><span class="si">{</span><span class="n">n_sites</span><span class="si">}</span><span class="s2"> (4×4 Ni(111))&quot;</span><span class="p">)</span>

<span class="c1"># Test coverages: 1 H, 0.25 ML, 0.5 ML, 0.75 ML, 1.0 ML</span>
<span class="n">coverages_to_test</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">16</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Will test coverages: </span><span class="si">{</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">n</span><span class="o">/</span><span class="n">n_sites</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> ML&#39;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">coverages_to_test</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   This spans from dilute to nearly full monolayer&quot;</span><span class="p">)</span>

<span class="n">coverages</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">adsorption_energies</span> <span class="o">=</span> <span class="p">[]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3. Surface sites: 16 (4×4 Ni(111))

   Will test coverages: [&#39;0.06 ML&#39;, &#39;0.25 ML&#39;, &#39;0.50 ML&#39;, &#39;0.75 ML&#39;, &#39;1.00 ML&#39;]
   This spans from dilute to nearly full monolayer
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-4-generate-and-relax-configurations-at-each-coverage">
<h3>Step 4: Generate and Relax Configurations at Each Coverage<a class="headerlink" href="#step-4-generate-and-relax-configurations-at-each-coverage" title="Link to this heading">#</a></h3>
<p>For each coverage, generate multiple configurations and find the lowest energy:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">n_h</span> <span class="ow">in</span> <span class="n">coverages_to_test</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">3. Coverage: </span><span class="si">{</span><span class="n">n_h</span><span class="si">}</span><span class="s2"> H (</span><span class="si">{</span><span class="n">n_h</span><span class="o">/</span><span class="n">n_sites</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> ML)&quot;</span><span class="p">)</span>

    <span class="c1"># Generate configurations</span>
    <span class="n">ni_bulk_obj_h</span> <span class="o">=</span> <span class="n">Bulk</span><span class="p">(</span><span class="n">bulk_atoms</span><span class="o">=</span><span class="n">ni_bulk_atoms</span><span class="p">)</span>
    <span class="n">ni_slabs_h</span> <span class="o">=</span> <span class="n">Slab</span><span class="o">.</span><span class="n">from_bulk_get_specific_millers</span><span class="p">(</span>
        <span class="n">bulk</span><span class="o">=</span><span class="n">ni_bulk_obj_h</span><span class="p">,</span> <span class="n">specific_millers</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="n">slab_for_ads</span> <span class="o">=</span> <span class="n">ni_slabs_h</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">slab_for_ads</span><span class="o">.</span><span class="n">atoms</span> <span class="o">=</span> <span class="n">clean_slab</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="n">adsorbates_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">Adsorbate</span><span class="p">(</span><span class="n">adsorbate_smiles_from_db</span><span class="o">=</span><span class="s2">&quot;*H&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_h</span><span class="p">)]</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">multi_ads_config</span> <span class="o">=</span> <span class="n">MultipleAdsorbateSlabConfig</span><span class="p">(</span>
            <span class="n">slab_for_ads</span><span class="p">,</span> <span class="n">adsorbates_list</span><span class="p">,</span> <span class="n">num_configurations</span><span class="o">=</span><span class="n">num_sites</span>
        <span class="p">)</span>
    <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   ⚠ Configuration generation failed: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">continue</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">multi_ads_config</span><span class="o">.</span><span class="n">atoms_list</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   ⚠ No configurations generated&quot;</span><span class="p">)</span>
        <span class="k">continue</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   Generated </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">multi_ads_config</span><span class="o">.</span><span class="n">atoms_list</span><span class="p">)</span><span class="si">}</span><span class="s2"> configurations&quot;</span><span class="p">)</span>

    <span class="c1"># Relax each and find best</span>
    <span class="n">config_energies</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">config</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">multi_ads_config</span><span class="o">.</span><span class="n">atoms_list</span><span class="p">):</span>
        <span class="n">config_relaxed</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">config_relaxed</span><span class="o">.</span><span class="n">set_pbc</span><span class="p">([</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">])</span>
        <span class="n">config_relaxed</span><span class="o">.</span><span class="n">calc</span> <span class="o">=</span> <span class="n">base_calc</span>

        <span class="n">opt</span> <span class="o">=</span> <span class="n">LBFGS</span><span class="p">(</span><span class="n">config_relaxed</span><span class="p">,</span> <span class="n">logfile</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
        <span class="n">opt</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">fmax</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="n">relaxation_steps</span><span class="p">)</span>

        <span class="n">E_ml</span> <span class="o">=</span> <span class="n">config_relaxed</span><span class="o">.</span><span class="n">get_potential_energy</span><span class="p">()</span>
        <span class="n">config_relaxed</span><span class="o">.</span><span class="n">calc</span> <span class="o">=</span> <span class="n">d3_calc</span>
        <span class="n">E_d3</span> <span class="o">=</span> <span class="n">config_relaxed</span><span class="o">.</span><span class="n">get_potential_energy</span><span class="p">()</span>
        <span class="n">E_total</span> <span class="o">=</span> <span class="n">E_ml</span> <span class="o">+</span> <span class="n">E_d3</span>

        <span class="n">config_energies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_total</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;     Config </span><span class="si">{</span><span class="n">idx</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">E_total</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>

    <span class="n">best_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">config_energies</span><span class="p">)</span>
    <span class="n">best_energy</span> <span class="o">=</span> <span class="n">config_energies</span><span class="p">[</span><span class="n">best_idx</span><span class="p">]</span>
    <span class="n">best_config</span> <span class="o">=</span> <span class="n">multi_ads_config</span><span class="o">.</span><span class="n">atoms_list</span><span class="p">[</span><span class="n">best_idx</span><span class="p">]</span>
    <span class="n">E_ads_per_h</span> <span class="o">=</span> <span class="p">(</span><span class="n">best_energy</span> <span class="o">-</span> <span class="n">E_clean</span> <span class="o">-</span> <span class="n">n_h</span> <span class="o">*</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">E_h2</span><span class="p">)</span> <span class="o">/</span> <span class="n">n_h</span>

    <span class="n">coverage</span> <span class="o">=</span> <span class="n">n_h</span> <span class="o">/</span> <span class="n">n_sites</span>
    <span class="n">coverages</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">coverage</span><span class="p">)</span>
    <span class="n">adsorption_energies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_ads_per_h</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   → E_ads/H: </span><span class="si">{</span><span class="n">E_ads_per_h</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>

    <span class="c1"># Visualize best configuration at this coverage</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
    <span class="n">plot_atoms</span><span class="p">(</span><span class="n">best_config</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">radii</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;10x,10y,0z&quot;</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">n_h</span><span class="si">}</span><span class="s2"> H atoms (θ = </span><span class="si">{</span><span class="n">coverage</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> ML)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span>
        <span class="nb">str</span><span class="p">(</span><span class="n">output_dir</span> <span class="o">/</span> <span class="n">part_dirs</span><span class="p">[</span><span class="s2">&quot;part5&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;coverage_</span><span class="si">{</span><span class="n">n_h</span><span class="si">}</span><span class="s2">H.png&quot;</span><span class="p">),</span>
        <span class="n">dpi</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
        <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">✓ Completed coverage study: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">coverages</span><span class="p">)</span><span class="si">}</span><span class="s2"> data points&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3. Coverage: 1 H (0.06 ML)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   Generated 5 configurations
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     Config 1: -491.51 eV
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     Config 2: -491.51 eV
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     Config 3: -491.53 eV
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     Config 4: -490.95 eV
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     Config 5: -491.53 eV
   → E_ads/H: -0.59 eV
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3. Coverage: 4 H (0.25 ML)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   Generated 5 configurations
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     Config 1: -503.69 eV
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     Config 2: -503.61 eV
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     Config 3: -503.71 eV
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     Config 4: -503.75 eV
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     Config 5: -503.73 eV
   → E_ads/H: -0.59 eV
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3. Coverage: 8 H (0.50 ML)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   Generated 5 configurations
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     Config 1: -519.94 eV
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     Config 2: -519.87 eV
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     Config 3: -519.59 eV
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     Config 4: -519.90 eV
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     Config 5: -518.70 eV
   → E_ads/H: -0.57 eV
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3. Coverage: 12 H (0.75 ML)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   Generated 5 configurations
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     Config 1: -535.13 eV
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     Config 2: -534.30 eV
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     Config 3: -535.42 eV
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     Config 4: -535.52 eV
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     Config 5: -534.39 eV
   → E_ads/H: -0.52 eV
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3. Coverage: 16 H (1.00 ML)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   Generated 5 configurations
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     Config 1: -549.47 eV
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     Config 2: -550.43 eV
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     Config 3: -550.42 eV
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     Config 4: -549.29 eV
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     Config 5: -548.70 eV
   → E_ads/H: -0.45 eV
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>✓ Completed coverage study: 5 data points
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-5-perform-linear-fit">
<h3>Step 5: Perform Linear Fit<a class="headerlink" href="#step-5-perform-linear-fit" title="Link to this heading">#</a></h3>
<p>Fit E_ads vs coverage to extract the slope (lateral interaction strength):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">4. Performing linear fit to coverage dependence...&quot;</span><span class="p">)</span>

<span class="c1"># Linear fit</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">numpy.polynomial</span><span class="w"> </span><span class="kn">import</span> <span class="n">Polynomial</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">Polynomial</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">coverages</span><span class="p">,</span> <span class="n">adsorption_energies</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">slope</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">coef</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">intercept</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">coef</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="s1">&#39;=&#39;</span><span class="o">*</span><span class="mi">60</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Linear Fit: E_ads = </span><span class="si">{</span><span class="n">intercept</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> + </span><span class="si">{</span><span class="n">slope</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">θ (eV)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Slope: </span><span class="si">{</span><span class="n">slope</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">96.485</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> kJ/mol per ML&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Paper: 8.7 kJ/mol per ML&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;=&#39;</span><span class="o">*</span><span class="mi">60</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>4. Performing linear fit to coverage dependence...

============================================================
Linear Fit: E_ads = -0.54 + 0.07θ (eV)
Slope: 6.6 kJ/mol per ML
Paper: 8.7 kJ/mol per ML
============================================================
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-6-visualize-coverage-dependence">
<h3>Step 6: Visualize Coverage Dependence<a class="headerlink" href="#step-6-visualize-coverage-dependence" title="Link to this heading">#</a></h3>
<p>Create a plot showing how adsorption energy changes with coverage:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">5. Plotting coverage dependence...&quot;</span><span class="p">)</span>

<span class="c1"># Plot</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
    <span class="n">coverages</span><span class="p">,</span>
    <span class="n">adsorption_energies</span><span class="p">,</span>
    <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
    <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Calculated&quot;</span><span class="p">,</span>
    <span class="n">zorder</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;steelblue&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">cov_fit</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">coverages</span><span class="p">),</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">ads_fit</span> <span class="o">=</span> <span class="n">p</span><span class="p">(</span><span class="n">cov_fit</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">cov_fit</span><span class="p">,</span> <span class="n">ads_fit</span><span class="p">,</span> <span class="s2">&quot;r--&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Fit: </span><span class="si">{</span><span class="n">intercept</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> + </span><span class="si">{</span><span class="n">slope</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">θ&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span>
<span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;H Coverage (ML)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Adsorption Energy (eV/H)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Coverage-Dependent H Adsorption on Ni(111)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">output_dir</span> <span class="o">/</span> <span class="n">part_dirs</span><span class="p">[</span><span class="s2">&quot;part5&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="s2">&quot;coverage_dependence.png&quot;</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">✓ Coverage dependence analysis complete!&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5. Plotting coverage dependence...
</pre></div>
</div>
<img alt="../_images/4a6ce608ec0311005ab6d1a76d79937a7128987e868f9fdba6a25ff9f3a2b52c.png" src="../_images/4a6ce608ec0311005ab6d1a76d79937a7128987e868f9fdba6a25ff9f3a2b52c.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>✓ Coverage dependence analysis complete!
</pre></div>
</div>
</div>
</div>
<div class="note admonition">
<p class="admonition-title">Comparison with Paper</p>
<p><strong>Expected Results from Paper:</strong></p>
<ul class="simple">
<li><p><strong>Slope</strong>: 8.7 kJ/mol per ML (indicating repulsive lateral H-H interactions)</p></li>
<li><p><strong>Physical interpretation</strong>: H atoms repel weakly due to electrostatic and Pauli effects</p></li>
</ul>
<p><strong>What to Check:</strong></p>
<ul class="simple">
<li><p>Your fitted slope should be close to 8.7 kJ/mol per ML</p></li>
<li><p>The relationship should be approximately linear for θ &lt; 1 ML</p></li>
<li><p>Intercept (E_ads at θ → 0) should match the single-H result from Part 4 (~-0.60 eV)</p></li>
</ul>
<p><strong>Typical Variations:</strong></p>
<ul class="simple">
<li><p>Slope can vary by ±2-3 kJ/mol depending on slab size and configuration sampling</p></li>
<li><p>Non-linearity may appear at very high coverage (θ &gt; 0.75 ML)</p></li>
<li><p>Model differences can affect lateral interactions more than adsorption energies</p></li>
</ul>
</div>
<div class="note admonition">
<p class="admonition-title">Physical Insights</p>
<p><strong>Positive slope</strong> (repulsive interactions):</p>
<ul class="simple">
<li><p>Electrostatic: H atoms accumulate negative charge from Ni</p></li>
<li><p>Pauli repulsion: Overlapping electron clouds</p></li>
<li><p>Strain: Lattice distortions propagate</p></li>
</ul>
<p><strong>Magnitude</strong>:</p>
<ul class="simple">
<li><p>Weak (~10 kJ/mol/ML) → isolated adsorbates</p></li>
<li><p>Strong (&gt;50 kJ/mol/ML) → clustering or phase separation likely</p></li>
</ul>
<p>The paper reports 8.7 kJ/mol/ML, indicating relatively weak lateral interactions for H on Ni(111).</p>
</div>
</section>
<section id="id11">
<h3>Explore on Your Own<a class="headerlink" href="#id11" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p><strong>Non-linear behavior</strong>: Use polynomial (degree 2) fit. Is there curvature at high coverage?</p></li>
<li><p><strong>Temperature effects</strong>: Estimate configurational entropy at each coverage. How does this affect free energy?</p></li>
<li><p><strong>Pattern formation</strong>: Visualize the lowest-energy configuration at 0.5 ML. Are H atoms ordered?</p></li>
<li><p><strong>Other adsorbates</strong>: Repeat for O or N. How do lateral interactions compare?</p></li>
<li><p><strong>Phase diagrams</strong>: At what coverage do you expect phase separation (islands vs uniform)?</p></li>
</ol>
</section>
</section>
<hr class="docutils" />
<section id="part-6-co-formation-dissociation-thermochemistry-and-barrier">
<h2>Part 6: CO Formation/Dissociation Thermochemistry and Barrier<a class="headerlink" href="#part-6-co-formation-dissociation-thermochemistry-and-barrier" title="Link to this heading">#</a></h2>
<section id="id12">
<h3>Introduction<a class="headerlink" href="#id12" title="Link to this heading">#</a></h3>
<p>CO dissociation (CO* → C* + O*) is the rate-limiting step in many catalytic processes (Fischer-Tropsch, CO oxidation, etc.). We’ll calculate the reaction energy for C* + O* → CO* and the activation barriers in both directions using the nudged elastic band (NEB) method.</p>
</section>
<section id="id13">
<h3>Theory<a class="headerlink" href="#id13" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Forward Reaction</strong>: C* + O* → CO* + * (recombination)</p></li>
<li><p><strong>Reverse Reaction</strong>: CO* + <em>→ C</em> + O* (dissociation)</p></li>
<li><p><strong>Thermochemistry</strong>: <span class="math notranslate nohighlight">\(\Delta E_{\text{rxn}} = E(\text{C}^* + \text{O}^*) - E(\text{CO}^*)\)</span></p></li>
<li><p><strong>Barrier</strong>: NEB finds the minimum energy path (MEP) and transition state: <span class="math notranslate nohighlight">\(E_a = E^{\ddagger} - E_{\text{initial}}\)</span></p></li>
</ul>
</section>
<section id="id14">
<h3>Step 1: Setup Slab and Calculators<a class="headerlink" href="#id14" title="Link to this heading">#</a></h3>
<p>Initialize the Ni(111) surface and calculators:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create slab</span>
<span class="n">ni_bulk_atoms</span> <span class="o">=</span> <span class="n">bulk</span><span class="p">(</span><span class="s2">&quot;Ni&quot;</span><span class="p">,</span> <span class="s2">&quot;fcc&quot;</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="n">a_opt</span><span class="p">,</span> <span class="n">cubic</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ni_bulk_obj</span> <span class="o">=</span> <span class="n">Bulk</span><span class="p">(</span><span class="n">bulk_atoms</span><span class="o">=</span><span class="n">ni_bulk_atoms</span><span class="p">)</span>
<span class="n">ni_slabs</span> <span class="o">=</span> <span class="n">Slab</span><span class="o">.</span><span class="n">from_bulk_get_specific_millers</span><span class="p">(</span>
    <span class="n">bulk</span><span class="o">=</span><span class="n">ni_bulk_obj</span><span class="p">,</span> <span class="n">specific_millers</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">slab</span> <span class="o">=</span> <span class="n">ni_slabs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">atoms</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   Created </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">slab</span><span class="p">)</span><span class="si">}</span><span class="s2"> atom slab&quot;</span><span class="p">)</span>

<span class="n">base_calc</span> <span class="o">=</span> <span class="n">FAIRChemCalculator</span><span class="p">(</span><span class="n">predictor</span><span class="p">,</span> <span class="n">task_name</span><span class="o">=</span><span class="s2">&quot;oc20&quot;</span><span class="p">)</span>
<span class="n">d3_calc</span> <span class="o">=</span> <span class="n">TorchDFTD3Calculator</span><span class="p">(</span><span class="n">device</span><span class="o">=</span><span class="s2">&quot;cpu&quot;</span><span class="p">,</span> <span class="n">damping</span><span class="o">=</span><span class="s2">&quot;bj&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   </span><span class="se">\u2713</span><span class="s2"> Calculators initialized&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   Created 96 atom slab
   ✓ Calculators initialized
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-2-generate-and-relax-final-state-co">
<h3>Step 2: Generate and Relax Final State (CO*)<a class="headerlink" href="#step-2-generate-and-relax-final-state-co" title="Link to this heading">#</a></h3>
<p>Find the most stable CO adsorption configuration (this is the product of C+O recombination):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">1. Final State: CO* on Ni(111)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   Generating CO adsorption configurations...&quot;</span><span class="p">)</span>

<span class="n">ni_bulk_obj_co</span> <span class="o">=</span> <span class="n">Bulk</span><span class="p">(</span><span class="n">bulk_atoms</span><span class="o">=</span><span class="n">ni_bulk_atoms</span><span class="p">)</span>
<span class="n">ni_slab_co</span> <span class="o">=</span> <span class="n">Slab</span><span class="o">.</span><span class="n">from_bulk_get_specific_millers</span><span class="p">(</span>
    <span class="n">bulk</span><span class="o">=</span><span class="n">ni_bulk_obj_co</span><span class="p">,</span> <span class="n">specific_millers</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">ni_slab_co</span><span class="o">.</span><span class="n">atoms</span> <span class="o">=</span> <span class="n">slab</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="n">adsorbate_co</span> <span class="o">=</span> <span class="n">Adsorbate</span><span class="p">(</span><span class="n">adsorbate_smiles_from_db</span><span class="o">=</span><span class="s2">&quot;*CO&quot;</span><span class="p">)</span>
<span class="n">multi_ads_config_co</span> <span class="o">=</span> <span class="n">MultipleAdsorbateSlabConfig</span><span class="p">(</span>
    <span class="n">ni_slab_co</span><span class="p">,</span> <span class="p">[</span><span class="n">adsorbate_co</span><span class="p">],</span> <span class="n">num_configurations</span><span class="o">=</span><span class="n">num_sites</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   Generated </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">multi_ads_config_co</span><span class="o">.</span><span class="n">atoms_list</span><span class="p">)</span><span class="si">}</span><span class="s2"> configurations&quot;</span><span class="p">)</span>

<span class="c1"># Relax and find best</span>
<span class="n">co_energies</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">co_energies_ml</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">co_energies_d3</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">co_configs</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">config</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">multi_ads_config_co</span><span class="o">.</span><span class="n">atoms_list</span><span class="p">):</span>
    <span class="n">config_relaxed</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">config_relaxed</span><span class="o">.</span><span class="n">set_pbc</span><span class="p">([</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">])</span>
    <span class="n">config_relaxed</span><span class="o">.</span><span class="n">calc</span> <span class="o">=</span> <span class="n">base_calc</span>
    <span class="n">opt</span> <span class="o">=</span> <span class="n">LBFGS</span><span class="p">(</span><span class="n">config_relaxed</span><span class="p">,</span> <span class="n">logfile</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">opt</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">fmax</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="n">relaxation_steps</span><span class="p">)</span>

    <span class="n">E_ml</span> <span class="o">=</span> <span class="n">config_relaxed</span><span class="o">.</span><span class="n">get_potential_energy</span><span class="p">()</span>
    <span class="n">config_relaxed</span><span class="o">.</span><span class="n">calc</span> <span class="o">=</span> <span class="n">d3_calc</span>
    <span class="n">E_d3</span> <span class="o">=</span> <span class="n">config_relaxed</span><span class="o">.</span><span class="n">get_potential_energy</span><span class="p">()</span>
    <span class="n">E_total</span> <span class="o">=</span> <span class="n">E_ml</span> <span class="o">+</span> <span class="n">E_d3</span>

    <span class="n">co_energies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_total</span><span class="p">)</span>
    <span class="n">co_energies_ml</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_ml</span><span class="p">)</span>
    <span class="n">co_energies_d3</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_d3</span><span class="p">)</span>
    <span class="n">co_configs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">config_relaxed</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;     Config </span><span class="si">{</span><span class="n">idx</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">: E_total = </span><span class="si">{</span><span class="n">E_total</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV (RPBE: </span><span class="si">{</span><span class="n">E_ml</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, D3: </span><span class="si">{</span><span class="n">E_d3</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">)&quot;</span>
    <span class="p">)</span>

<span class="n">best_co_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">co_energies</span><span class="p">)</span>
<span class="n">final_co</span> <span class="o">=</span> <span class="n">co_configs</span><span class="p">[</span><span class="n">best_co_idx</span><span class="p">]</span>
<span class="n">E_final_co</span> <span class="o">=</span> <span class="n">co_energies</span><span class="p">[</span><span class="n">best_co_idx</span><span class="p">]</span>
<span class="n">E_final_co_ml</span> <span class="o">=</span> <span class="n">co_energies_ml</span><span class="p">[</span><span class="n">best_co_idx</span><span class="p">]</span>
<span class="n">E_final_co_d3</span> <span class="o">=</span> <span class="n">co_energies_d3</span><span class="p">[</span><span class="n">best_co_idx</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   → Best CO* (Config </span><span class="si">{</span><span class="n">best_co_idx</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;      RPBE:  </span><span class="si">{</span><span class="n">E_final_co_ml</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;      D3:    </span><span class="si">{</span><span class="n">E_final_co_d3</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;      Total: </span><span class="si">{</span><span class="n">E_final_co</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>

<span class="c1"># Save best CO state</span>
<span class="n">ase</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">output_dir</span> <span class="o">/</span> <span class="n">part_dirs</span><span class="p">[</span><span class="s2">&quot;part6&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="s2">&quot;co_final_best.traj&quot;</span><span class="p">),</span> <span class="n">final_co</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   ✓ Best CO* structure saved&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1. Final State: CO* on Ni(111)
   Generating CO adsorption configurations...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   Generated 5 configurations
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     Config 1: E_total = -503.96 eV (RPBE: -467.14, D3: -36.82)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     Config 2: E_total = -503.97 eV (RPBE: -467.14, D3: -36.82)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     Config 3: E_total = -503.96 eV (RPBE: -467.14, D3: -36.82)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     Config 4: E_total = -503.86 eV (RPBE: -467.00, D3: -36.85)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     Config 5: E_total = -503.86 eV (RPBE: -467.01, D3: -36.86)

   → Best CO* (Config 2):
      RPBE:  -467.14 eV
      D3:    -36.82 eV
      Total: -503.97 eV
   ✓ Best CO* structure saved
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-3-generate-and-relax-initial-state-c-o">
<h3>Step 3: Generate and Relax Initial State (C* + O*)<a class="headerlink" href="#step-3-generate-and-relax-initial-state-c-o" title="Link to this heading">#</a></h3>
<p>Find the most stable configuration for dissociated C and O (reactants):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">2. Initial State: C* + O* on Ni(111)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   Generating C+O configurations...&quot;</span><span class="p">)</span>

<span class="n">ni_bulk_obj_c_o</span> <span class="o">=</span> <span class="n">Bulk</span><span class="p">(</span><span class="n">bulk_atoms</span><span class="o">=</span><span class="n">ni_bulk_atoms</span><span class="p">)</span>
<span class="n">ni_slab_c_o</span> <span class="o">=</span> <span class="n">Slab</span><span class="o">.</span><span class="n">from_bulk_get_specific_millers</span><span class="p">(</span>
    <span class="n">bulk</span><span class="o">=</span><span class="n">ni_bulk_obj_c_o</span><span class="p">,</span> <span class="n">specific_millers</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">adsorbate_c</span> <span class="o">=</span> <span class="n">Adsorbate</span><span class="p">(</span><span class="n">adsorbate_smiles_from_db</span><span class="o">=</span><span class="s2">&quot;*C&quot;</span><span class="p">)</span>
<span class="n">adsorbate_o</span> <span class="o">=</span> <span class="n">Adsorbate</span><span class="p">(</span><span class="n">adsorbate_smiles_from_db</span><span class="o">=</span><span class="s2">&quot;*O&quot;</span><span class="p">)</span>

<span class="n">multi_ads_config_c_o</span> <span class="o">=</span> <span class="n">MultipleAdsorbateSlabConfig</span><span class="p">(</span>
    <span class="n">ni_slab_c_o</span><span class="p">,</span> <span class="p">[</span><span class="n">adsorbate_c</span><span class="p">,</span> <span class="n">adsorbate_o</span><span class="p">],</span> <span class="n">num_configurations</span><span class="o">=</span><span class="n">num_sites</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   Generated </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">multi_ads_config_c_o</span><span class="o">.</span><span class="n">atoms_list</span><span class="p">)</span><span class="si">}</span><span class="s2"> configurations&quot;</span><span class="p">)</span>

<span class="n">c_o_energies</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">c_o_energies_ml</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">c_o_energies_d3</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">c_o_configs</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">config</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">multi_ads_config_c_o</span><span class="o">.</span><span class="n">atoms_list</span><span class="p">):</span>
    <span class="n">config_relaxed</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">config_relaxed</span><span class="o">.</span><span class="n">set_pbc</span><span class="p">([</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">])</span>
    <span class="n">config_relaxed</span><span class="o">.</span><span class="n">calc</span> <span class="o">=</span> <span class="n">base_calc</span>
    <span class="n">opt</span> <span class="o">=</span> <span class="n">LBFGS</span><span class="p">(</span><span class="n">config_relaxed</span><span class="p">,</span> <span class="n">logfile</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">opt</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">fmax</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="n">relaxation_steps</span><span class="p">)</span>

    <span class="c1"># Check C-O bond distance to ensure they haven&#39;t formed CO molecule</span>
    <span class="n">c_o_dist</span> <span class="o">=</span> <span class="n">config_relaxed</span><span class="p">[</span><span class="n">config_relaxed</span><span class="o">.</span><span class="n">get_tags</span><span class="p">()</span> <span class="o">==</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">get_distance</span><span class="p">(</span>
        <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">mic</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>

    <span class="c1"># CO bond length is ~1.15 Å, so if distance &lt; 1.5 Å, they&#39;ve formed a molecule</span>
    <span class="k">if</span> <span class="n">c_o_dist</span> <span class="o">&lt;</span> <span class="mf">1.5</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;     Config </span><span class="si">{</span><span class="n">idx</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">: ⚠ REJECTED - C and O formed CO molecule (d = </span><span class="si">{</span><span class="n">c_o_dist</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Å)&quot;</span>
        <span class="p">)</span>
        <span class="k">continue</span>

    <span class="n">E_ml</span> <span class="o">=</span> <span class="n">config_relaxed</span><span class="o">.</span><span class="n">get_potential_energy</span><span class="p">()</span>
    <span class="n">config_relaxed</span><span class="o">.</span><span class="n">calc</span> <span class="o">=</span> <span class="n">d3_calc</span>
    <span class="n">E_d3</span> <span class="o">=</span> <span class="n">config_relaxed</span><span class="o">.</span><span class="n">get_potential_energy</span><span class="p">()</span>
    <span class="n">E_total</span> <span class="o">=</span> <span class="n">E_ml</span> <span class="o">+</span> <span class="n">E_d3</span>

    <span class="n">c_o_energies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_total</span><span class="p">)</span>
    <span class="n">c_o_energies_ml</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_ml</span><span class="p">)</span>
    <span class="n">c_o_energies_d3</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_d3</span><span class="p">)</span>
    <span class="n">c_o_configs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">config_relaxed</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;     Config </span><span class="si">{</span><span class="n">idx</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">: E_total = </span><span class="si">{</span><span class="n">E_total</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV (RPBE: </span><span class="si">{</span><span class="n">E_ml</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, D3: </span><span class="si">{</span><span class="n">E_d3</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, C-O dist: </span><span class="si">{</span><span class="n">c_o_dist</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Å)&quot;</span>
    <span class="p">)</span>

<span class="n">best_c_o_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">c_o_energies</span><span class="p">)</span>
<span class="n">initial_c_o</span> <span class="o">=</span> <span class="n">c_o_configs</span><span class="p">[</span><span class="n">best_c_o_idx</span><span class="p">]</span>
<span class="n">E_initial_c_o</span> <span class="o">=</span> <span class="n">c_o_energies</span><span class="p">[</span><span class="n">best_c_o_idx</span><span class="p">]</span>
<span class="n">E_initial_c_o_ml</span> <span class="o">=</span> <span class="n">c_o_energies_ml</span><span class="p">[</span><span class="n">best_c_o_idx</span><span class="p">]</span>
<span class="n">E_initial_c_o_d3</span> <span class="o">=</span> <span class="n">c_o_energies_d3</span><span class="p">[</span><span class="n">best_c_o_idx</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   → Best C*+O* (Config </span><span class="si">{</span><span class="n">best_c_o_idx</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;      RPBE:  </span><span class="si">{</span><span class="n">E_initial_c_o_ml</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;      D3:    </span><span class="si">{</span><span class="n">E_initial_c_o_d3</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;      Total: </span><span class="si">{</span><span class="n">E_initial_c_o</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>

<span class="c1"># Save best C+O state</span>
<span class="n">ase</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">output_dir</span> <span class="o">/</span> <span class="n">part_dirs</span><span class="p">[</span><span class="s2">&quot;part6&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="s2">&quot;co_initial_best.traj&quot;</span><span class="p">),</span> <span class="n">initial_c_o</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   ✓ Best C*+O* structure saved&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2. Initial State: C* + O* on Ni(111)
   Generating C+O configurations...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   Generated 5 configurations
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     Config 1: ⚠ REJECTED - C and O formed CO molecule (d = 1.20 Å)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     Config 2: E_total = -502.79 eV (RPBE: -465.89, D3: -36.90, C-O dist: 4.33 Å)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     Config 3: E_total = -502.83 eV (RPBE: -465.94, D3: -36.89, C-O dist: 4.31 Å)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     Config 4: E_total = -502.88 eV (RPBE: -465.98, D3: -36.90, C-O dist: 3.83 Å)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     Config 5: E_total = -502.82 eV (RPBE: -465.93, D3: -36.89, C-O dist: 4.34 Å)

   → Best C*+O* (Config 3):
      RPBE:  -465.98 eV
      D3:    -36.90 eV
      Total: -502.88 eV
   ✓ Best C*+O* structure saved
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-3b-calculate-c-and-o-energies-separately">
<h3>Step 3b: Calculate C* and O* Energies Separately<a class="headerlink" href="#step-3b-calculate-c-and-o-energies-separately" title="Link to this heading">#</a></h3>
<p>Another strategy to calculate the initial energies for *C and *O at very low coverage (without interactions between the two reactants) is to do two separate relaxations.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Clean slab</span>
<span class="n">ni_bulk_obj</span> <span class="o">=</span> <span class="n">Bulk</span><span class="p">(</span><span class="n">bulk_atoms</span><span class="o">=</span><span class="n">ni_bulk_atoms</span><span class="p">)</span>
<span class="n">clean_slab</span> <span class="o">=</span> <span class="n">Slab</span><span class="o">.</span><span class="n">from_bulk_get_specific_millers</span><span class="p">(</span>
    <span class="n">bulk</span><span class="o">=</span><span class="n">ni_bulk_obj_c_o</span><span class="p">,</span> <span class="n">specific_millers</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">atoms</span>
<span class="n">clean_slab</span><span class="o">.</span><span class="n">set_pbc</span><span class="p">([</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">])</span>
<span class="n">clean_slab</span><span class="o">.</span><span class="n">calc</span> <span class="o">=</span> <span class="n">base_calc</span>
<span class="n">opt</span> <span class="o">=</span> <span class="n">LBFGS</span><span class="p">(</span><span class="n">clean_slab</span><span class="p">,</span> <span class="n">logfile</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">opt</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">fmax</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="n">relaxation_steps</span><span class="p">)</span>

<span class="n">E_clean_ml</span> <span class="o">=</span> <span class="n">clean_slab</span><span class="o">.</span><span class="n">get_potential_energy</span><span class="p">()</span>
<span class="n">clean_slab</span><span class="o">.</span><span class="n">calc</span> <span class="o">=</span> <span class="n">d3_calc</span>
<span class="n">E_clean_d3</span> <span class="o">=</span> <span class="n">clean_slab</span><span class="o">.</span><span class="n">get_potential_energy</span><span class="p">()</span>
<span class="n">E_clean</span> <span class="o">=</span> <span class="n">E_clean_ml</span> <span class="o">+</span> <span class="n">E_clean_d3</span>

<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Clean slab: E_total = </span><span class="si">{</span><span class="n">E_clean</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV (RPBE: </span><span class="si">{</span><span class="n">E_clean_ml</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, D3: </span><span class="si">{</span><span class="n">E_clean_d3</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">)&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   Clean slab: E_total = -487.46 eV (RPBE: -450.89, D3: -36.57)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">2b. Separate C* and O* Energies:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    Calculating energies in separate unit cells to avoid interactions&quot;</span><span class="p">)</span>

<span class="n">ni_bulk_obj_c_o</span> <span class="o">=</span> <span class="n">Bulk</span><span class="p">(</span><span class="n">bulk_atoms</span><span class="o">=</span><span class="n">ni_bulk_atoms</span><span class="p">)</span>
<span class="n">ni_slab_c_o</span> <span class="o">=</span> <span class="n">Slab</span><span class="o">.</span><span class="n">from_bulk_get_specific_millers</span><span class="p">(</span>
    <span class="n">bulk</span><span class="o">=</span><span class="n">ni_bulk_obj_c_o</span><span class="p">,</span> <span class="n">specific_millers</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Generating C* configurations...&quot;</span><span class="p">)</span>
<span class="n">multi_ads_config_c</span> <span class="o">=</span> <span class="n">MultipleAdsorbateSlabConfig</span><span class="p">(</span>
    <span class="n">ni_slab_c_o</span><span class="p">,</span>
    <span class="n">adsorbates</span><span class="o">=</span><span class="p">[</span><span class="n">Adsorbate</span><span class="p">(</span><span class="n">adsorbate_smiles_from_db</span><span class="o">=</span><span class="s2">&quot;*C&quot;</span><span class="p">)],</span>
    <span class="n">num_configurations</span><span class="o">=</span><span class="n">num_sites</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">c_energies</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">c_energies_ml</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">c_energies_d3</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">c_configs</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">config</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">multi_ads_config_c</span><span class="o">.</span><span class="n">atoms_list</span><span class="p">):</span>
    <span class="n">config_relaxed</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">config_relaxed</span><span class="o">.</span><span class="n">set_pbc</span><span class="p">([</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">])</span>
    <span class="n">config_relaxed</span><span class="o">.</span><span class="n">calc</span> <span class="o">=</span> <span class="n">base_calc</span>
    <span class="n">opt</span> <span class="o">=</span> <span class="n">LBFGS</span><span class="p">(</span><span class="n">config_relaxed</span><span class="p">,</span> <span class="n">logfile</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">opt</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">fmax</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="n">relaxation_steps</span><span class="p">)</span>

    <span class="n">E_ml</span> <span class="o">=</span> <span class="n">config_relaxed</span><span class="o">.</span><span class="n">get_potential_energy</span><span class="p">()</span>
    <span class="n">config_relaxed</span><span class="o">.</span><span class="n">calc</span> <span class="o">=</span> <span class="n">d3_calc</span>
    <span class="n">E_d3</span> <span class="o">=</span> <span class="n">config_relaxed</span><span class="o">.</span><span class="n">get_potential_energy</span><span class="p">()</span>
    <span class="n">E_total</span> <span class="o">=</span> <span class="n">E_ml</span> <span class="o">+</span> <span class="n">E_d3</span>

    <span class="n">c_energies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_total</span><span class="p">)</span>
    <span class="n">c_energies_ml</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_ml</span><span class="p">)</span>
    <span class="n">c_energies_d3</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_d3</span><span class="p">)</span>
    <span class="n">c_configs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">config_relaxed</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;     Config </span><span class="si">{</span><span class="n">idx</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">: E_total = </span><span class="si">{</span><span class="n">E_total</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV (RPBE: </span><span class="si">{</span><span class="n">E_ml</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, D3: </span><span class="si">{</span><span class="n">E_d3</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">)&quot;</span>
    <span class="p">)</span>

<span class="n">best_c_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">c_energies</span><span class="p">)</span>
<span class="n">c_ads</span> <span class="o">=</span> <span class="n">c_configs</span><span class="p">[</span><span class="n">best_c_idx</span><span class="p">]</span>
<span class="n">E_c</span> <span class="o">=</span> <span class="n">c_energies</span><span class="p">[</span><span class="n">best_c_idx</span><span class="p">]</span>
<span class="n">E_c_ml</span> <span class="o">=</span> <span class="n">c_energies_ml</span><span class="p">[</span><span class="n">best_c_idx</span><span class="p">]</span>
<span class="n">E_c_d3</span> <span class="o">=</span> <span class="n">c_energies_d3</span><span class="p">[</span><span class="n">best_c_idx</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   → Best C* (Config </span><span class="si">{</span><span class="n">best_c_idx</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;      RPBE:  </span><span class="si">{</span><span class="n">E_c_ml</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;      D3:    </span><span class="si">{</span><span class="n">E_c_d3</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;      Total: </span><span class="si">{</span><span class="n">E_c</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>

<span class="c1"># Save best C state</span>
<span class="n">ase</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">output_dir</span> <span class="o">/</span> <span class="n">part_dirs</span><span class="p">[</span><span class="s2">&quot;part6&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="s2">&quot;c_best.traj&quot;</span><span class="p">),</span> <span class="n">c_ads</span><span class="p">)</span>

<span class="c1"># Generate O* configuration</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Generating O* configurations...&quot;</span><span class="p">)</span>
<span class="n">multi_ads_config_o</span> <span class="o">=</span> <span class="n">MultipleAdsorbateSlabConfig</span><span class="p">(</span>
    <span class="n">ni_slab_c_o</span><span class="p">,</span>
    <span class="n">adsorbates</span><span class="o">=</span><span class="p">[</span><span class="n">Adsorbate</span><span class="p">(</span><span class="n">adsorbate_smiles_from_db</span><span class="o">=</span><span class="s2">&quot;*O&quot;</span><span class="p">)],</span>
    <span class="n">num_configurations</span><span class="o">=</span><span class="n">num_sites</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">o_energies</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">o_energies_ml</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">o_energies_d3</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">o_configs</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">config</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">multi_ads_config_o</span><span class="o">.</span><span class="n">atoms_list</span><span class="p">):</span>
    <span class="n">config_relaxed</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">config_relaxed</span><span class="o">.</span><span class="n">set_pbc</span><span class="p">([</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">])</span>
    <span class="n">config_relaxed</span><span class="o">.</span><span class="n">calc</span> <span class="o">=</span> <span class="n">base_calc</span>
    <span class="n">opt</span> <span class="o">=</span> <span class="n">LBFGS</span><span class="p">(</span><span class="n">config_relaxed</span><span class="p">,</span> <span class="n">logfile</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">opt</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">fmax</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="n">relaxation_steps</span><span class="p">)</span>

    <span class="n">E_ml</span> <span class="o">=</span> <span class="n">config_relaxed</span><span class="o">.</span><span class="n">get_potential_energy</span><span class="p">()</span>
    <span class="n">config_relaxed</span><span class="o">.</span><span class="n">calc</span> <span class="o">=</span> <span class="n">d3_calc</span>
    <span class="n">E_d3</span> <span class="o">=</span> <span class="n">config_relaxed</span><span class="o">.</span><span class="n">get_potential_energy</span><span class="p">()</span>
    <span class="n">E_total</span> <span class="o">=</span> <span class="n">E_ml</span> <span class="o">+</span> <span class="n">E_d3</span>

    <span class="n">o_energies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_total</span><span class="p">)</span>
    <span class="n">o_energies_ml</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_ml</span><span class="p">)</span>
    <span class="n">o_energies_d3</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_d3</span><span class="p">)</span>
    <span class="n">o_configs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">config_relaxed</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;     Config </span><span class="si">{</span><span class="n">idx</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">: E_total = </span><span class="si">{</span><span class="n">E_total</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV (RPBE: </span><span class="si">{</span><span class="n">E_ml</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, D3: </span><span class="si">{</span><span class="n">E_d3</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">)&quot;</span>
    <span class="p">)</span>

<span class="n">best_o_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">o_energies</span><span class="p">)</span>
<span class="n">o_ads</span> <span class="o">=</span> <span class="n">o_configs</span><span class="p">[</span><span class="n">best_o_idx</span><span class="p">]</span>
<span class="n">E_o</span> <span class="o">=</span> <span class="n">o_energies</span><span class="p">[</span><span class="n">best_o_idx</span><span class="p">]</span>
<span class="n">E_o_ml</span> <span class="o">=</span> <span class="n">o_energies_ml</span><span class="p">[</span><span class="n">best_o_idx</span><span class="p">]</span>
<span class="n">E_o_d3</span> <span class="o">=</span> <span class="n">o_energies_d3</span><span class="p">[</span><span class="n">best_o_idx</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   → Best O* (Config </span><span class="si">{</span><span class="n">best_o_idx</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;      RPBE:  </span><span class="si">{</span><span class="n">E_o_ml</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;      D3:    </span><span class="si">{</span><span class="n">E_o_d3</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;      Total: </span><span class="si">{</span><span class="n">E_o</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>

<span class="c1"># Save best O state</span>
<span class="n">ase</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">output_dir</span> <span class="o">/</span> <span class="n">part_dirs</span><span class="p">[</span><span class="s2">&quot;part6&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="s2">&quot;o_best.traj&quot;</span><span class="p">),</span> <span class="n">o_ads</span><span class="p">)</span>

<span class="c1"># Calculate combined energy for separate C* and O*</span>
<span class="n">E_initial_c_o_separate</span> <span class="o">=</span> <span class="n">E_c</span> <span class="o">+</span> <span class="n">E_o</span>
<span class="n">E_initial_c_o_separate_ml</span> <span class="o">=</span> <span class="n">E_c_ml</span> <span class="o">+</span> <span class="n">E_o_ml</span>
<span class="n">E_initial_c_o_separate_d3</span> <span class="o">=</span> <span class="n">E_c_d3</span> <span class="o">+</span> <span class="n">E_o_d3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2b. Separate C* and O* Energies:
    Calculating energies in separate unit cells to avoid interactions
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   Generating C* configurations...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     Config 1: E_total = -493.14 eV (RPBE: -456.36, D3: -36.79)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     Config 2: E_total = -495.73 eV (RPBE: -458.94, D3: -36.78)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     Config 3: E_total = -495.66 eV (RPBE: -458.89, D3: -36.77)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     Config 4: E_total = -495.72 eV (RPBE: -458.94, D3: -36.78)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     Config 5: E_total = -495.66 eV (RPBE: -458.89, D3: -36.77)

   → Best C* (Config 2):
      RPBE:  -458.94 eV
      D3:    -36.78 eV
      Total: -495.73 eV

   Generating O* configurations...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     Config 1: E_total = -494.66 eV (RPBE: -457.97, D3: -36.69)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     Config 2: E_total = -494.66 eV (RPBE: -457.97, D3: -36.68)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     Config 3: E_total = -494.66 eV (RPBE: -457.97, D3: -36.69)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     Config 4: E_total = -494.55 eV (RPBE: -457.87, D3: -36.68)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     Config 5: E_total = -494.55 eV (RPBE: -457.87, D3: -36.68)

   → Best O* (Config 1):
      RPBE:  -457.97 eV
      D3:    -36.69 eV
      Total: -494.66 eV
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Combined C* + O* (separate calculations):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;      RPBE:  </span><span class="si">{</span><span class="n">E_initial_c_o_separate_ml</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;      D3:    </span><span class="si">{</span><span class="n">E_initial_c_o_separate_d3</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;      Total: </span><span class="si">{</span><span class="n">E_initial_c_o_separate</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Comparison:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;      C*+O* (same cell):  </span><span class="si">{</span><span class="n">E_initial_c_o</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">E_clean</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;      C* + O* (separate): </span><span class="si">{</span><span class="n">E_initial_c_o_separate</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">E_clean</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;      Difference:         </span><span class="si">{</span><span class="p">(</span><span class="n">E_initial_c_o</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">E_clean</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="n">E_initial_c_o_separate</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">E_clean</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   ✓ Separate C* and O* energies calculated&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   Combined C* + O* (separate calculations):
      RPBE:  -916.91 eV
      D3:    -73.47 eV
      Total: -990.39 eV

   Comparison:
      C*+O* (same cell):  -15.42 eV
      C* + O* (separate): -15.47 eV
      Difference:         0.04 eV
   ✓ Separate C* and O* energies calculated
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-4-calculate-reaction-energy-with-zpe">
<h3>Step 4: Calculate Reaction Energy with ZPE<a class="headerlink" href="#step-4-calculate-reaction-energy-with-zpe" title="Link to this heading">#</a></h3>
<p>Compute the thermochemistry for C* + O* → CO* with ZPE corrections:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">3. Reaction Energy (C* + O* → CO*):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   &quot;</span> <span class="o">+</span> <span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>

<span class="c1"># Electronic energies</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Electronic Energies:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;   Initial (C*+O*): RPBE = </span><span class="si">{</span><span class="n">E_initial_c_o_ml</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV, D3 = </span><span class="si">{</span><span class="n">E_initial_c_o_d3</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV, Total = </span><span class="si">{</span><span class="n">E_initial_c_o</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;   Final (CO*):     RPBE = </span><span class="si">{</span><span class="n">E_final_co_ml</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV, D3 = </span><span class="si">{</span><span class="n">E_final_co_d3</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV, Total = </span><span class="si">{</span><span class="n">E_final_co</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span>
<span class="p">)</span>

<span class="c1"># Reaction energies without ZPE</span>
<span class="n">delta_E_rpbe</span> <span class="o">=</span> <span class="n">E_final_co_ml</span> <span class="o">-</span> <span class="n">E_initial_c_o_ml</span>
<span class="n">delta_E_d3_contrib</span> <span class="o">=</span> <span class="n">E_final_co_d3</span> <span class="o">-</span> <span class="n">E_initial_c_o_d3</span>
<span class="n">delta_E_elec</span> <span class="o">=</span> <span class="n">E_final_co</span> <span class="o">-</span> <span class="n">E_initial_c_o</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Reaction Energies (without ZPE):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   ΔE(RPBE only):     </span><span class="si">{</span><span class="n">delta_E_rpbe</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV = </span><span class="si">{</span><span class="n">delta_E_rpbe</span><span class="o">*</span><span class="mf">96.485</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> kJ/mol&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;   ΔE(D3 contrib):    </span><span class="si">{</span><span class="n">delta_E_d3_contrib</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV = </span><span class="si">{</span><span class="n">delta_E_d3_contrib</span><span class="o">*</span><span class="mf">96.485</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> kJ/mol&quot;</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   ΔE(RPBE+D3):       </span><span class="si">{</span><span class="n">delta_E_elec</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV = </span><span class="si">{</span><span class="n">delta_E_elec</span><span class="o">*</span><span class="mf">96.485</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> kJ/mol&quot;</span><span class="p">)</span>

<span class="c1"># Calculate ZPE for CO* (final state)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Computing ZPE for CO*...&quot;</span><span class="p">)</span>
<span class="n">final_co</span><span class="o">.</span><span class="n">calc</span> <span class="o">=</span> <span class="n">base_calc</span>

<span class="n">co_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">final_co</span><span class="o">.</span><span class="n">get_tags</span><span class="p">()</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">vib_co</span> <span class="o">=</span> <span class="n">Vibrations</span><span class="p">(</span><span class="n">final_co</span><span class="p">,</span> <span class="n">indices</span><span class="o">=</span><span class="n">co_indices</span><span class="p">,</span> <span class="n">delta</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;vib_co&quot;</span><span class="p">)</span>
<span class="n">vib_co</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">vib_energies_co</span> <span class="o">=</span> <span class="n">vib_co</span><span class="o">.</span><span class="n">get_energies</span><span class="p">()</span>
<span class="n">zpe_co</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">vib_energies_co</span><span class="p">[</span><span class="n">vib_energies_co</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="mf">2.0</span>
<span class="n">vib_co</span><span class="o">.</span><span class="n">clean</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   ZPE(CO*): </span><span class="si">{</span><span class="n">zpe_co</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV (</span><span class="si">{</span><span class="n">zpe_co</span><span class="o">*</span><span class="mi">1000</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> meV)&quot;</span><span class="p">)</span>


<span class="c1"># Calculate ZPE for C* and O* (initial state)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Computing ZPE for C* and O*...&quot;</span><span class="p">)</span>
<span class="n">initial_c_o</span><span class="o">.</span><span class="n">calc</span> <span class="o">=</span> <span class="n">base_calc</span>
<span class="n">c_o_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">initial_c_o</span><span class="o">.</span><span class="n">get_tags</span><span class="p">()</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">vib_c_o</span> <span class="o">=</span> <span class="n">Vibrations</span><span class="p">(</span><span class="n">initial_c_o</span><span class="p">,</span> <span class="n">indices</span><span class="o">=</span><span class="n">c_o_indices</span><span class="p">,</span> <span class="n">delta</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;vib_c_o&quot;</span><span class="p">)</span>
<span class="n">vib_c_o</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">vib_energies_c_o</span> <span class="o">=</span> <span class="n">vib_c_o</span><span class="o">.</span><span class="n">get_energies</span><span class="p">()</span>
<span class="n">zpe_c_o</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">vib_energies_c_o</span><span class="p">[</span><span class="n">vib_energies_c_o</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="mf">2.0</span>
<span class="n">vib_c_o</span><span class="o">.</span><span class="n">clean</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   ZPE(C*+O*): </span><span class="si">{</span><span class="n">zpe_c_o</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV (</span><span class="si">{</span><span class="n">zpe_c_o</span><span class="o">*</span><span class="mi">1000</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> meV)&quot;</span><span class="p">)</span>


<span class="c1"># Total reaction energy with ZPE</span>
<span class="n">delta_zpe</span> <span class="o">=</span> <span class="n">zpe_co</span> <span class="o">-</span> <span class="n">zpe_c_o</span>
<span class="n">delta_E_zpe</span> <span class="o">=</span> <span class="n">delta_E_elec</span> <span class="o">+</span> <span class="n">delta_zpe</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Reaction Energy (with ZPE):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   ΔE(electronic):    </span><span class="si">{</span><span class="n">delta_E_elec</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV = </span><span class="si">{</span><span class="n">delta_E_elec</span><span class="o">*</span><span class="mf">96.485</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> kJ/mol&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;   ΔZPE:              </span><span class="si">{</span><span class="n">delta_zpe</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV = </span><span class="si">{</span><span class="n">delta_zpe</span><span class="o">*</span><span class="mf">96.485</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> kJ/mol (</span><span class="si">{</span><span class="n">delta_zpe</span><span class="o">*</span><span class="mi">1000</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> meV)&quot;</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   ΔE(total):         </span><span class="si">{</span><span class="n">delta_E_zpe</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV = </span><span class="si">{</span><span class="n">delta_E_zpe</span><span class="o">*</span><span class="mf">96.485</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> kJ/mol&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Summary:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;   Without D3, without ZPE: </span><span class="si">{</span><span class="n">delta_E_rpbe</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV = </span><span class="si">{</span><span class="n">delta_E_rpbe</span><span class="o">*</span><span class="mf">96.485</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> kJ/mol&quot;</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;   With D3, without ZPE:    </span><span class="si">{</span><span class="n">delta_E_elec</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV = </span><span class="si">{</span><span class="n">delta_E_elec</span><span class="o">*</span><span class="mf">96.485</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> kJ/mol&quot;</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;   With D3, with ZPE:       </span><span class="si">{</span><span class="n">delta_E_zpe</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV = </span><span class="si">{</span><span class="n">delta_E_zpe</span><span class="o">*</span><span class="mf">96.485</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> kJ/mol&quot;</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   &quot;</span> <span class="o">+</span> <span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Comparison with Paper (Table 5):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   Paper (DFT-D3): -142.7 kJ/mol = -1.48 eV&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   This work:      </span><span class="si">{</span><span class="n">delta_E_zpe</span><span class="o">*</span><span class="mf">96.485</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> kJ/mol = </span><span class="si">{</span><span class="n">delta_E_zpe</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   Difference:     </span><span class="si">{</span><span class="nb">abs</span><span class="p">(</span><span class="n">delta_E_zpe</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="o">-</span><span class="mf">1.48</span><span class="p">))</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>

<span class="k">if</span> <span class="n">delta_E_zpe</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   ✓ Reaction is exothermic (C+O recombination favorable)&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   ⚠ Reaction is endothermic (dissociation favorable)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3. Reaction Energy (C* + O* → CO*):
   ============================================================

   Electronic Energies:
   Initial (C*+O*): RPBE = -465.98 eV, D3 = -36.90 eV, Total = -502.88 eV
   Final (CO*):     RPBE = -467.14 eV, D3 = -36.82 eV, Total = -503.97 eV

   Reaction Energies (without ZPE):
   ΔE(RPBE only):     -1.16 eV = -112.2 kJ/mol
   ΔE(D3 contrib):    0.08 eV = 7.4 kJ/mol
   ΔE(RPBE+D3):       -1.09 eV = -104.7 kJ/mol

   Computing ZPE for CO*...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   ZPE(CO*): 0.18+0.00j eV (182.6+0.0j meV)

   Computing ZPE for C* and O*...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   ZPE(C*+O*): 0.18+0.00j eV (176.3+0.0j meV)

   Reaction Energy (with ZPE):
   ΔE(electronic):    -1.09 eV = -104.7 kJ/mol
   ΔZPE:              0.01+0.00j eV = 0.6+0.0j kJ/mol (6.3+0.0j meV)
   ΔE(total):         -1.08+0.00j eV = -104.1+0.0j kJ/mol

   Summary:
   Without D3, without ZPE: -1.16 eV = -112.2 kJ/mol
   With D3, without ZPE:    -1.09 eV = -104.7 kJ/mol
   With D3, with ZPE:       -1.08+0.00j eV = -104.1+0.0j kJ/mol

   ============================================================

   Comparison with Paper (Table 5):
   Paper (DFT-D3): -142.7 kJ/mol = -1.48 eV
   This work:      -104.1+0.0j kJ/mol = -1.08+0.00j eV
   Difference:     0.40 eV

   ✓ Reaction is exothermic (C+O recombination favorable)
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-5-calculate-co-adsorption-energy-bonus">
<h3>Step 5: Calculate CO Adsorption Energy (Bonus)<a class="headerlink" href="#step-5-calculate-co-adsorption-energy-bonus" title="Link to this heading">#</a></h3>
<p>Calculate how strongly CO binds to the surface:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">4. CO Adsorption Energy ( CO(g) + * → CO*):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   This helps us understand CO binding strength&quot;</span><span class="p">)</span>

<span class="c1"># CO(g)</span>
<span class="n">co_gas</span> <span class="o">=</span> <span class="n">Atoms</span><span class="p">(</span><span class="s2">&quot;CO&quot;</span><span class="p">,</span> <span class="n">positions</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1.15</span><span class="p">]])</span>
<span class="n">co_gas</span><span class="o">.</span><span class="n">center</span><span class="p">(</span><span class="n">vacuum</span><span class="o">=</span><span class="mf">10.0</span><span class="p">)</span>
<span class="n">co_gas</span><span class="o">.</span><span class="n">set_pbc</span><span class="p">([</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">])</span>
<span class="n">co_gas</span><span class="o">.</span><span class="n">calc</span> <span class="o">=</span> <span class="n">base_calc</span>
<span class="n">opt</span> <span class="o">=</span> <span class="n">LBFGS</span><span class="p">(</span><span class="n">co_gas</span><span class="p">,</span> <span class="n">logfile</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">opt</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">fmax</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="n">relaxation_steps</span><span class="p">)</span>

<span class="n">E_co_gas_ml</span> <span class="o">=</span> <span class="n">co_gas</span><span class="o">.</span><span class="n">get_potential_energy</span><span class="p">()</span>
<span class="n">co_gas</span><span class="o">.</span><span class="n">calc</span> <span class="o">=</span> <span class="n">d3_calc</span>
<span class="n">E_co_gas_d3</span> <span class="o">=</span> <span class="n">co_gas</span><span class="o">.</span><span class="n">get_potential_energy</span><span class="p">()</span>
<span class="n">E_co_gas</span> <span class="o">=</span> <span class="n">E_co_gas_ml</span> <span class="o">+</span> <span class="n">E_co_gas_d3</span>

<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;   CO(g):       E_total = </span><span class="si">{</span><span class="n">E_co_gas</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV (RPBE: </span><span class="si">{</span><span class="n">E_co_gas_ml</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, D3: </span><span class="si">{</span><span class="n">E_co_gas_d3</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">)&quot;</span>
<span class="p">)</span>

<span class="c1"># Calculate ZPE for CO(g)</span>
<span class="n">co_gas</span><span class="o">.</span><span class="n">calc</span> <span class="o">=</span> <span class="n">base_calc</span>
<span class="n">vib_co_gas</span> <span class="o">=</span> <span class="n">Vibrations</span><span class="p">(</span><span class="n">co_gas</span><span class="p">,</span> <span class="n">indices</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">delta</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">nfree</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">vib_co_gas</span><span class="o">.</span><span class="n">clean</span><span class="p">()</span>
<span class="n">vib_co_gas</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">vib_energies_co_gas</span> <span class="o">=</span> <span class="n">vib_co_gas</span><span class="o">.</span><span class="n">get_energies</span><span class="p">()</span>
<span class="n">zpe_co_gas</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">vib_energies_co_gas</span><span class="p">[</span><span class="n">vib_energies_co_gas</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">vib_co_gas</span><span class="o">.</span><span class="n">clean</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   ZPE(CO(g)):  </span><span class="si">{</span><span class="n">zpe_co_gas</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   ZPE(CO*):    </span><span class="si">{</span><span class="n">zpe_co</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV (from Step 4 calculation)&quot;</span><span class="p">)</span>

<span class="c1"># Electronic adsorption energy</span>
<span class="n">E_ads_co_elec</span> <span class="o">=</span> <span class="n">E_final_co</span> <span class="o">-</span> <span class="n">E_clean</span> <span class="o">-</span> <span class="n">E_co_gas</span>

<span class="c1"># ZPE contribution to adsorption energy</span>
<span class="n">delta_zpe_ads</span> <span class="o">=</span> <span class="n">zpe_co</span> <span class="o">-</span> <span class="n">zpe_co_gas</span>

<span class="c1"># Total adsorption energy with ZPE</span>
<span class="n">E_ads_co_total</span> <span class="o">=</span> <span class="n">E_ads_co_elec</span> <span class="o">+</span> <span class="n">delta_zpe_ads</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Electronic Energy Breakdown:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   ΔE(RPBE only) = </span><span class="si">{</span><span class="p">(</span><span class="n">E_final_co_ml</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">E_clean_ml</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">E_co_gas_ml</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   ΔE(D3 contrib) = </span><span class="si">{</span><span class="p">((</span><span class="n">E_final_co_d3</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">E_clean_d3</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">E_co_gas_d3</span><span class="p">))</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   ΔE(RPBE+D3) = </span><span class="si">{</span><span class="n">E_ads_co_elec</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   ZPE Contribution:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   ΔZPE = </span><span class="si">{</span><span class="n">delta_zpe_ads</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Total Adsorption Energy:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   ΔE(total) = </span><span class="si">{</span><span class="n">E_ads_co_total</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV = </span><span class="si">{</span><span class="n">E_ads_co_total</span><span class="o">*</span><span class="mf">96.485</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> kJ/mol&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Summary:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;   E_ads(CO) without ZPE = </span><span class="si">{</span><span class="o">-</span><span class="n">E_ads_co_elec</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV = </span><span class="si">{</span><span class="o">-</span><span class="n">E_ads_co_elec</span><span class="o">*</span><span class="mf">96.485</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> kJ/mol&quot;</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;   E_ads(CO) with ZPE    = </span><span class="si">{</span><span class="o">-</span><span class="n">E_ads_co_total</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV = </span><span class="si">{</span><span class="o">-</span><span class="n">E_ads_co_total</span><span class="o">*</span><span class="mf">96.485</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> kJ/mol&quot;</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;   → CO binds </span><span class="si">{</span><span class="nb">abs</span><span class="p">(</span><span class="n">E_ads_co_total</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV stronger than H (</span><span class="si">{</span><span class="nb">abs</span><span class="p">(</span><span class="n">E_ads_co_total</span><span class="p">)</span><span class="o">/</span><span class="mf">0.60</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">x)&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>4. CO Adsorption Energy ( CO(g) + * → CO*):
   This helps us understand CO binding strength
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   CO(g):       E_total = -14.43 eV (RPBE: -14.42, D3: -0.01)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   ZPE(CO(g)):  0.13+0.00j eV
   ZPE(CO*):    0.18+0.00j eV (from Step 4 calculation)

   Electronic Energy Breakdown:
   ΔE(RPBE only) = -1.84 eV
   ΔE(D3 contrib) = -0.24 eV
   ΔE(RPBE+D3) = -2.08 eV

   ZPE Contribution:
   ΔZPE = 0.05-0.00j eV

   Total Adsorption Energy:
   ΔE(total) = -2.03-0.00j eV = -195.7-0.0j kJ/mol

   Summary:
   E_ads(CO) without ZPE = 2.08 eV = 200.6 kJ/mol
   E_ads(CO) with ZPE    = 2.03+0.00j eV = 195.7+0.0j kJ/mol
   → CO binds 2.03 eV stronger than H (3.4x)
</pre></div>
</div>
</div>
</div>
<div class="tip admonition">
<p class="admonition-title">Comparison with Paper Results</p>
<p>The paper reports a CO adsorption energy of <strong>1.82 eV (175.6 kJ/mol)</strong> in Table 4, calculated using DFT (RPBE functional).</p>
<p>These results show:</p>
<ul class="simple">
<li><p><strong>Without ZPE</strong>: The electronic binding energy matches well with DFT predictions</p></li>
<li><p><strong>With ZPE</strong>: The zero-point energy correction reduces the binding strength slightly</p></li>
<li><p><strong>D3 Dispersion</strong>: Contributes to stronger binding due to van der Waals interactions</p></li>
</ul>
</div>
</section>
<section id="step-6-find-guesses-for-nearby-initial-and-final-states-for-the-reaction">
<h3>Step 6: Find guesses for nearby initial and final states for the reaction<a class="headerlink" href="#step-6-find-guesses-for-nearby-initial-and-final-states-for-the-reaction" title="Link to this heading">#</a></h3>
<p>Now that we have an estimate on the reaction energy from the best possible initial and final states, we want to find a transition state (barrier) for this reaction. There are MANY possible ways that we could do this. In this case, we’ll start with the *CO final state and then try and find a nearby local minimal of *C and *O, by fixing the C-O bond distance and finding a nearby local minima. Note that this approach required some insight into what the transition state might look like, and could be considerably more complicated for a reaction that did not involve breaking a single bond.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Finding Transition State Initial and Final States&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   Creating initial guess with stretched C-O bond...&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   Starting from CO* and stretching the C-O bond...&quot;</span><span class="p">)</span>

<span class="c1"># Create a guess structure with stretched CO bond (start from CO*)</span>
<span class="n">initial_guess</span> <span class="o">=</span> <span class="n">final_co</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1"># Set up a constraint to fix the bond length to ~2 Angstroms, which should be far enough that we&#39;ll be closer to *C+*O than *CO</span>
<span class="n">co_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">initial_guess</span><span class="o">.</span><span class="n">get_tags</span><span class="p">()</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># Rotate the atoms a bit just to break the symmetry and prevent the O from going straight up to satisfy the constraint</span>
<span class="n">initial_slab</span> <span class="o">=</span> <span class="n">initial_guess</span><span class="p">[</span><span class="n">initial_guess</span><span class="o">.</span><span class="n">get_tags</span><span class="p">()</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">initial_co</span> <span class="o">=</span> <span class="n">initial_guess</span><span class="p">[</span><span class="n">initial_guess</span><span class="o">.</span><span class="n">get_tags</span><span class="p">()</span> <span class="o">==</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">initial_co</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="n">initial_co</span><span class="o">.</span><span class="n">positions</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">initial_guess</span> <span class="o">=</span> <span class="n">initial_slab</span> <span class="o">+</span> <span class="n">initial_co</span>

<span class="n">initial_guess</span><span class="o">.</span><span class="n">calc</span> <span class="o">=</span> <span class="n">FAIRChemCalculator</span><span class="p">(</span><span class="n">predictor</span><span class="p">,</span> <span class="n">task_name</span><span class="o">=</span><span class="s2">&quot;oc20&quot;</span><span class="p">)</span>

<span class="c1"># Add constraints to keep the CO bond length extended</span>
<span class="n">initial_guess</span><span class="o">.</span><span class="n">constraints</span> <span class="o">+=</span> <span class="p">[</span>
    <span class="n">FixBondLengths</span><span class="p">([</span><span class="n">co_indices</span><span class="p">],</span> <span class="n">tolerance</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">,</span> <span class="n">iterations</span><span class="o">=</span><span class="mi">5000</span><span class="p">,</span> <span class="n">bondlengths</span><span class="o">=</span><span class="p">[</span><span class="mf">2.0</span><span class="p">])</span>
<span class="p">]</span>


<span class="n">opt</span> <span class="o">=</span> <span class="n">LBFGS</span><span class="p">(</span>
    <span class="n">initial_guess</span><span class="p">,</span>
    <span class="n">trajectory</span><span class="o">=</span><span class="n">output_dir</span> <span class="o">/</span> <span class="n">part_dirs</span><span class="p">[</span><span class="s2">&quot;part6&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="s2">&quot;initial_guess_with_constraint.traj&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">opt</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">fmax</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>

<span class="c1"># Now that we have a guess, re-relax without the constraints</span>
<span class="n">initial_guess</span><span class="o">.</span><span class="n">constraints</span> <span class="o">=</span> <span class="n">initial_guess</span><span class="o">.</span><span class="n">constraints</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">opt</span> <span class="o">=</span> <span class="n">LBFGS</span><span class="p">(</span>
    <span class="n">initial_guess</span><span class="p">,</span>
    <span class="n">trajectory</span><span class="o">=</span><span class="n">output_dir</span>
    <span class="o">/</span> <span class="n">part_dirs</span><span class="p">[</span><span class="s2">&quot;part6&quot;</span><span class="p">]</span>
    <span class="o">/</span> <span class="s2">&quot;initial_guess_without_constraint.traj&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">opt</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">fmax</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finding Transition State Initial and Final States
   Creating initial guess with stretched C-O bond...
   Starting from CO* and stretching the C-O bond...
       Step     Time          Energy          fmax
LBFGS:    0 20:40:49     -466.828456        0.924906
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:    1 20:40:49     -461.461969        4.205855
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:    2 20:40:50     -461.528795        3.834735
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:    3 20:40:50     -461.858429        0.982042
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:    4 20:40:50     -461.928568        0.974327
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:    5 20:40:50     -461.953529        0.981629
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:    6 20:40:50     -461.943569        0.808603
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:    7 20:40:51     -462.001764        0.448797
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:    8 20:40:51     -461.963711        0.389110
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:    9 20:40:51     -462.020624        0.847128
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   10 20:40:51     -462.027096        0.397794
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   11 20:40:51     -462.041656        0.440472
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   12 20:40:52     -462.038013        0.717821
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   13 20:40:52     -462.169838        1.349131
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   14 20:40:52     -462.232130        2.316899
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   15 20:40:52     -462.283684        2.591798
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   16 20:40:52     -462.272295        2.075945
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   17 20:40:53     -462.270754        1.793324
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   18 20:40:53     -462.270248        1.636059
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   19 20:40:53     -462.270086        1.551101
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   20 20:40:53     -462.270056        1.500407
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   21 20:40:53     -462.270052        1.466797
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   22 20:40:54     -462.270058        1.442745
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   23 20:40:54     -462.270077        1.424858
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   24 20:40:54     -462.270073        1.411190
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   25 20:40:54     -462.270084        1.400562
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   26 20:40:54     -462.270090        1.392161
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   27 20:40:55     -462.270094        1.385522
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   28 20:40:55     -462.270088        1.380225
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   29 20:40:55     -462.270096        1.375918
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   30 20:40:55     -462.270096        1.372458
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   31 20:40:55     -462.270098        1.369642
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   32 20:40:56     -462.270103        1.367339
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   33 20:40:56     -462.270105        1.365491
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   34 20:40:56     -462.270096        1.363968
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   35 20:40:56     -462.270094        1.362681
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   36 20:40:56     -462.270096        1.361670
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   37 20:40:57     -462.270098        1.360856
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   38 20:40:57     -462.270099        1.359987
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   39 20:40:57     -462.270096        1.359471
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   40 20:40:57     -462.270096        1.358827
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   41 20:40:57     -462.270099        1.358636
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   42 20:40:58     -462.270101        1.356758
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   43 20:40:58     -462.270099        1.356344
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   44 20:40:58     -462.270105        1.354685
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   45 20:40:58     -462.270101        1.354653
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   46 20:40:58     -462.267404        1.311877
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   47 20:40:59     -462.261709        1.407613
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   48 20:40:59     -462.291488        1.581730
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   49 20:40:59     -462.242922        2.771852
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   50 20:40:59     -462.314604        2.827921
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   51 20:40:59     -462.311086        1.638555
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   52 20:41:00     -462.314867        1.696225
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   53 20:41:00     -462.318193        1.694156
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   54 20:41:00     -462.320291        1.717998
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   55 20:41:00     -462.317407        1.756198
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   56 20:41:00     -462.326261        1.678238
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   57 20:41:01     -462.345531        1.502775
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   58 20:41:01     -462.348038        1.602862
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   59 20:41:01     -462.304199        1.728908
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   60 20:41:01     -462.270515        2.466956
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   61 20:41:01     -462.316448        2.191411
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   62 20:41:02     -462.320064        2.636855
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   63 20:41:02     -462.344339        2.637042
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   64 20:41:02     -462.402309        2.517304
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   65 20:41:02     -462.485205        2.315066
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   66 20:41:02     -462.552746        2.045332
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   67 20:41:03     -462.605394        1.761522
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   68 20:41:03     -462.643263        1.628778
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   69 20:41:03     -462.670315        1.644868
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   70 20:41:03     -462.689846        1.652976
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   71 20:41:03     -462.704441        1.653946
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   72 20:41:04     -462.716600        1.646726
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   73 20:41:04     -462.732153        1.618531
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   74 20:41:04     -462.768276        1.501030
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   75 20:41:04     -462.781424        1.463357
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   76 20:41:04     -462.890019        1.086687
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   77 20:41:05     -462.900289        1.092134
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   78 20:41:05     -462.911054        1.046619
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   79 20:41:05     -462.941387        0.966550
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   80 20:41:05     -462.955663        0.918387
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   81 20:41:05     -462.973481        0.882357
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   82 20:41:06     -462.985689        0.843543
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   83 20:41:06     -463.004268        0.807082
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   84 20:41:06     -463.016297        0.766580
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   85 20:41:06     -463.031940        0.740477
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   86 20:41:06     -463.043161        0.701536
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   87 20:41:07     -463.057717        0.675211
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   88 20:41:07     -463.068291        0.637645
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   89 20:41:07     -463.081277        0.613486
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   90 20:41:07     -463.091107        0.576234
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   91 20:41:07     -463.102993        0.554373
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   92 20:41:08     -463.112123        0.516660
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   93 20:41:08     -463.122884        0.496728
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   94 20:41:08     -463.131306        0.459477
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   95 20:41:08     -463.141082        0.440296
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   96 20:41:08     -463.148806        0.403274
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   97 20:41:09     -463.157648        0.385458
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   98 20:41:09     -463.164695        0.347971
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   99 20:41:09     -463.172669        0.331604
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  100 20:41:09     -463.179060        0.294070
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  101 20:41:09     -463.186237        0.278422
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  102 20:41:10     -463.220849        0.419996
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  103 20:41:10     -463.227289        0.386212
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  104 20:41:10     -463.257356        0.434182
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  105 20:41:10     -463.267277        0.285720
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  106 20:41:10     -463.277366        0.346357
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  107 20:41:11     -463.286707        0.225322
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  108 20:41:11     -463.293734        0.223435
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  109 20:41:11     -463.304441        0.320072
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  110 20:41:11     -463.315628        0.646994
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  111 20:41:11     -463.358064        1.190119
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  112 20:41:12     -463.387018        1.759279
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  113 20:41:12     -463.409468        2.198531
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  114 20:41:12     -463.459498        1.827035
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  115 20:41:12     -463.511336        1.450581
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  116 20:41:12     -463.630736        1.300056
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  117 20:41:13     -463.858758        1.313545
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  118 20:41:13     -463.980477        1.206361
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  119 20:41:13     -464.098133        2.282594
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  120 20:41:13     -464.214846        0.679653
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  121 20:41:13     -464.245385        0.445831
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  122 20:41:14     -464.311027        0.409445
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  123 20:41:14     -464.296790        0.384834
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  124 20:41:14     -464.332898        0.334061
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  125 20:41:14     -464.324603        0.213326
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  126 20:41:14     -464.335365        0.150922
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  127 20:41:15     -464.343164        0.178195
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  128 20:41:15     -464.308180        0.145699
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  129 20:41:15     -464.334495        0.569909
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  130 20:41:15     -464.378459        0.211376
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  131 20:41:15     -464.354417        0.090735
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  132 20:41:16     -464.354358        0.094855
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  133 20:41:16     -464.329816        0.135739
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  134 20:41:16     -464.359081        0.074632
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  135 20:41:16     -464.359781        0.079920
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  136 20:41:16     -464.346149        0.099730
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  137 20:41:17     -464.351472        0.097404
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  138 20:41:17     -464.364633        0.089006
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  139 20:41:17     -464.377936        0.071520
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  140 20:41:17     -464.382579        0.076348
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  141 20:41:17     -464.375930        0.053523
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  142 20:41:18     -464.367406        0.040769
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  143 20:41:18     -464.363660        0.038803
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  144 20:41:18     -464.364736        0.025902
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  145 20:41:18     -464.367765        0.026509
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  146 20:41:18     -464.370236        0.025467
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  147 20:41:19     -464.370796        0.018025
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  148 20:41:19     -464.370075        0.013127
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  149 20:41:19     -464.369170        0.011216
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:  150 20:41:19     -464.368690        0.008885
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>       Step     Time          Energy          fmax
LBFGS:    0 20:41:19     -464.368690        1.731413
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:    1 20:41:19     -464.453204        1.755788
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:    2 20:41:20     -464.910612        2.028119
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:    3 20:41:20     -465.013658        2.021610
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:    4 20:41:20     -465.187319        1.897749
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:    5 20:41:20     -465.259675        1.700698
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:    6 20:41:20     -465.365039        1.202155
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:    7 20:41:21     -465.424366        0.864151
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:    8 20:41:21     -465.473745        0.774830
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:    9 20:41:21     -465.506536        0.556415
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   10 20:41:21     -465.530433        0.437271
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   11 20:41:21     -465.538840        0.232107
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   12 20:41:22     -465.542337        0.160906
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   13 20:41:22     -465.544247        0.154338
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   14 20:41:22     -465.546203        0.147274
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   15 20:41:22     -465.547806        0.107666
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   16 20:41:22     -465.548968        0.103725
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   17 20:41:23     -465.549796        0.088308
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   18 20:41:23     -465.550474        0.085817
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   19 20:41:23     -465.550967        0.062634
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   20 20:41:23     -465.551375        0.069253
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   21 20:41:23     -465.551785        0.062792
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   22 20:41:24     -465.552186        0.069246
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   23 20:41:24     -465.552484        0.049801
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   24 20:41:24     -465.552672        0.033666
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   25 20:41:24     -465.552806        0.040533
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   26 20:41:24     -465.552935        0.045193
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   27 20:41:25     -465.553044        0.032663
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   28 20:41:25     -465.553133        0.023060
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   29 20:41:25     -465.553204        0.024064
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   30 20:41:25     -465.553277        0.029476
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   31 20:41:25     -465.553348        0.027552
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   32 20:41:26     -465.553412        0.018124
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   33 20:41:26     -465.553457        0.017171
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   34 20:41:26     -465.553495        0.018543
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   35 20:41:26     -465.553525        0.014103
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   36 20:41:26     -465.553544        0.012950
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   37 20:41:27     -465.553570        0.015443
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   38 20:41:27     -465.553592        0.014447
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   39 20:41:27     -465.553615        0.015684
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   40 20:41:27     -465.553634        0.011303
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBFGS:   41 20:41:27     -465.553639        0.006608
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>np.True_
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-7-run-neb-to-find-activation-barrier">
<h3>Step 7: Run NEB to Find Activation Barrier<a class="headerlink" href="#step-7-run-neb-to-find-activation-barrier" title="Link to this heading">#</a></h3>
<p>Use the nudged elastic band method to find the minimum energy path:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">7. NEB Barrier Calculation (C* + O* → CO*)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   Setting up 7-image NEB chain with TS guess in middle...&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   Reaction: C* + O* (initial) → TS → CO* (final)&quot;</span><span class="p">)</span>

<span class="n">initial</span> <span class="o">=</span> <span class="n">initial_guess</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">initial</span><span class="o">.</span><span class="n">calc</span> <span class="o">=</span> <span class="n">FAIRChemCalculator</span><span class="p">(</span><span class="n">predictor</span><span class="p">,</span> <span class="n">task_name</span><span class="o">=</span><span class="s2">&quot;oc20&quot;</span><span class="p">)</span>
<span class="n">images</span> <span class="o">=</span> <span class="p">[</span><span class="n">initial</span><span class="p">]</span>  <span class="c1"># Start with C* + O*</span>

<span class="n">n_images</span> <span class="o">=</span> <span class="mi">10</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_images</span><span class="p">):</span>
    <span class="n">image</span> <span class="o">=</span> <span class="n">initial</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">image</span><span class="o">.</span><span class="n">calc</span> <span class="o">=</span> <span class="n">FAIRChemCalculator</span><span class="p">(</span><span class="n">predictor</span><span class="p">,</span> <span class="n">task_name</span><span class="o">=</span><span class="s2">&quot;oc20&quot;</span><span class="p">)</span>
    <span class="n">images</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>

<span class="n">final</span> <span class="o">=</span> <span class="n">final_co</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">final</span><span class="o">.</span><span class="n">calc</span> <span class="o">=</span> <span class="n">FAIRChemCalculator</span><span class="p">(</span><span class="n">predictor</span><span class="p">,</span> <span class="n">task_name</span><span class="o">=</span><span class="s2">&quot;oc20&quot;</span><span class="p">)</span>
<span class="n">images</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">final</span><span class="p">)</span>  <span class="c1"># End with CO*</span>

<span class="c1"># Interpolate with better initial guess</span>
<span class="n">dyneb</span> <span class="o">=</span> <span class="n">DyNEB</span><span class="p">(</span><span class="n">images</span><span class="p">,</span> <span class="n">climb</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>

<span class="c1"># Interpolate first half (C*+O* → TS)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Interpolating images...&quot;</span><span class="p">)</span>
<span class="n">dyneb</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="s2">&quot;idpp&quot;</span><span class="p">,</span> <span class="n">mic</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Optimize</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   Optimizing NEB path (this may take a while)...&quot;</span><span class="p">)</span>
<span class="n">opt</span> <span class="o">=</span> <span class="n">FIRE</span><span class="p">(</span>
    <span class="n">dyneb</span><span class="p">,</span>
    <span class="n">trajectory</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">output_dir</span> <span class="o">/</span> <span class="n">part_dirs</span><span class="p">[</span><span class="s2">&quot;part6&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="s2">&quot;neb.traj&quot;</span><span class="p">),</span>
    <span class="n">logfile</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">output_dir</span> <span class="o">/</span> <span class="n">part_dirs</span><span class="p">[</span><span class="s2">&quot;part6&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="s2">&quot;neb.log&quot;</span><span class="p">),</span>
<span class="p">)</span>
<span class="n">opt</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">fmax</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="n">relaxation_steps</span><span class="p">)</span>

<span class="c1"># Extract barrier (from C*+O* to TS)</span>
<span class="n">energies</span> <span class="o">=</span> <span class="p">[</span><span class="n">img</span><span class="o">.</span><span class="n">get_potential_energy</span><span class="p">()</span> <span class="k">for</span> <span class="n">img</span> <span class="ow">in</span> <span class="n">images</span><span class="p">]</span>
<span class="n">energies_rel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">energies</span><span class="p">)</span> <span class="o">-</span> <span class="n">energies</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">E_barrier</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">energies_rel</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   ✓ NEB converged!&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Forward barrier (C*+O* → CO*): </span><span class="si">{</span><span class="n">E_barrier</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV = </span><span class="si">{</span><span class="n">E_barrier</span><span class="o">*</span><span class="mf">96.485</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> kJ/mol&quot;</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;   Reverse barrier (CO* → C*+O*): </span><span class="si">{</span><span class="n">E_barrier</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">energies_rel</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV = </span><span class="si">{</span><span class="p">(</span><span class="n">E_barrier</span><span class="o">-</span><span class="w"> </span><span class="n">energies_rel</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="mf">96.485</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> kJ/mol&quot;</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Paper (Table 5): 153 kJ/mol = 1.59 eV &quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   Difference: </span><span class="si">{</span><span class="nb">abs</span><span class="p">(</span><span class="n">E_barrier</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">1.59</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>7. NEB Barrier Calculation (C* + O* → CO*)
   Setting up 7-image NEB chain with TS guess in middle...
   Reaction: C* + O* (initial) → TS → CO* (final)

   Interpolating images...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   Optimizing NEB path (this may take a while)...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   ✓ NEB converged!

   Forward barrier (C*+O* → CO*): 1.32 eV = 127.5 kJ/mol
   Reverse barrier (CO* → C*+O*): 2.91 eV = 280.9 kJ/mol

   Paper (Table 5): 153 kJ/mol = 1.59 eV 
   Difference: 0.27 eV
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-8-visualize-neb-path-and-key-structures">
<h3>Step 8: Visualize NEB Path and Key Structures<a class="headerlink" href="#step-8-visualize-neb-path-and-key-structures" title="Link to this heading">#</a></h3>
<p>Create plots showing the reaction pathway:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Creating NEB visualization...&quot;</span><span class="p">)</span>

<span class="c1"># Plot NEB path</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">energies_rel</span><span class="p">)),</span>
    <span class="n">energies_rel</span><span class="p">,</span>
    <span class="s2">&quot;o-&quot;</span><span class="p">,</span>
    <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;steelblue&quot;</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;NEB Path&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Initial: C*+O*&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">delta_E_zpe</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Final: CO*&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span>
    <span class="n">E_barrier</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;orange&quot;</span><span class="p">,</span>
    <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;:&quot;</span><span class="p">,</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
    <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Forward Barrier = </span><span class="si">{</span><span class="n">E_barrier</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Annotate transition state</span>
<span class="n">ts_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">energies_rel</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;TS</span><span class="se">\n</span><span class="si">{</span><span class="n">energies_rel</span><span class="p">[</span><span class="n">ts_idx</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> eV&quot;</span><span class="p">,</span>
    <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">ts_idx</span><span class="p">,</span> <span class="n">energies_rel</span><span class="p">[</span><span class="n">ts_idx</span><span class="p">]),</span>
    <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="n">ts_idx</span><span class="p">,</span> <span class="n">energies_rel</span><span class="p">[</span><span class="n">ts_idx</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.3</span><span class="p">),</span>
    <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
    <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span>
    <span class="n">fontweight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">,</span>
    <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s2">&quot;-&gt;&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">),</span>
<span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Image Number&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Relative Energy (eV)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span>
    <span class="s2">&quot;CO Formation on Ni(111): C* + O* → CO* - NEB Path&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper left&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span>
    <span class="nb">str</span><span class="p">(</span><span class="n">output_dir</span> <span class="o">/</span> <span class="n">part_dirs</span><span class="p">[</span><span class="s2">&quot;part6&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="s2">&quot;neb_path.png&quot;</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Create animation of NEB path</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Creating NEB path animation...&quot;</span><span class="p">)</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ase.io</span><span class="w"> </span><span class="kn">import</span> <span class="n">write</span> <span class="k">as</span> <span class="n">ase_write</span>

<span class="n">ase</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
    <span class="nb">str</span><span class="p">(</span><span class="n">output_dir</span> <span class="o">/</span> <span class="n">part_dirs</span><span class="p">[</span><span class="s2">&quot;part6&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="s2">&quot;neb_path.gif&quot;</span><span class="p">),</span> <span class="n">images</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;gif&quot;</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   → Saved as neb_path.gif&quot;</span><span class="p">)</span>

<span class="c1"># Visualize key structures</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">structures</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="n">initial_c_o</span><span class="p">,</span> <span class="s2">&quot;Initial: C* + O*&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
    <span class="p">(</span><span class="n">images</span><span class="p">[</span><span class="n">ts_idx</span><span class="p">],</span> <span class="sa">f</span><span class="s2">&quot;TS (Image </span><span class="si">{</span><span class="n">ts_idx</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="p">(</span><span class="n">final_co</span><span class="p">,</span> <span class="s2">&quot;Final: CO*&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
<span class="p">]</span>

<span class="k">for</span> <span class="n">atoms</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">structures</span><span class="p">:</span>
    <span class="n">plot_atoms</span><span class="p">(</span><span class="n">atoms</span><span class="p">,</span> <span class="n">axes</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="n">radii</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;10x,10y,0z&quot;</span><span class="p">))</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span>
    <span class="nb">str</span><span class="p">(</span><span class="n">output_dir</span> <span class="o">/</span> <span class="n">part_dirs</span><span class="p">[</span><span class="s2">&quot;part6&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="s2">&quot;neb_structures.png&quot;</span><span class="p">),</span>
    <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span>
    <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">✓ NEB analysis complete!&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   Creating NEB visualization...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/runner/work/_tool/Python/3.12.12/x64/lib/python3.12/site-packages/matplotlib/cbook.py:1355: ComplexWarning: Casting complex values to real discards the imaginary part
  return np.asarray(x, float)
</pre></div>
</div>
<img alt="../_images/288ed33324a3939ac622db19f99cbe2190d551da004fa560e84617dd850b24c4.png" src="../_images/288ed33324a3939ac622db19f99cbe2190d551da004fa560e84617dd850b24c4.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   Creating NEB path animation...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   → Saved as neb_path.gif
</pre></div>
</div>
<img alt="../_images/e12cdf0965dcb77c0925bec93790b3ba5ec6f5631fac2bcfe2caf1529af4ad4c.png" src="../_images/e12cdf0965dcb77c0925bec93790b3ba5ec6f5631fac2bcfe2caf1529af4ad4c.png" />
<img alt="../_images/cf42bdb96cb8fc1c67cc91c28a6e49a5635faa70b1bc9a4a0f25b9acba874a5d.png" src="../_images/cf42bdb96cb8fc1c67cc91c28a6e49a5635faa70b1bc9a4a0f25b9acba874a5d.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>✓ NEB analysis complete!
</pre></div>
</div>
</div>
</div>
<div class="note admonition">
<p class="admonition-title">Comparison with Paper (Tables 4 &amp; 5)</p>
<p><strong>Expected Results from Paper:</strong></p>
<ul class="simple">
<li><p><em><em>Reaction Energy (C</em> + O</em> → CO*)**: <strong>-142.7 kJ/mol = -1.48 eV</strong> (exothermic, DFT-D3)</p></li>
<li><p><em><em>Activation Barrier (C</em> + O</em> → CO*)**: <strong>153 kJ/mol = 1.59 eV</strong> (reverse/dissociation, DFT-D3)</p></li>
<li><p><strong>CO Adsorption Energy</strong>: <strong>1.82 eV = 175.6 kJ/mol</strong> (DFT-D3)</p></li>
</ul>
<p><strong>Reaction Direction:</strong></p>
<ul class="simple">
<li><p>Paper reports CO dissociation barrier (CO* → C* + O*), which is the <strong>reverse</strong> of the recombination we calculate</p></li>
<li><p>Forward (C* + O* → CO*): barrier = reverse_barrier - |ΔE| ≈ 1.59 - 1.48 ≈ 0.11 eV (very fast)</p></li>
<li><p>Reverse (CO* → C* + O*): barrier = 1.59 eV (very slow, kinetic bottleneck)</p></li>
</ul>
<p><strong>What to Check:</strong></p>
<ul class="simple">
<li><p>Reaction energy (C*+O* → CO*) should be strongly exothermic (~-1.5 eV)</p></li>
<li><p>Reverse barrier (CO dissociation) should be substantial (~1.6 eV)</p></li>
<li><p>Forward barrier (recombination) should be very small (~0.1 eV)</p></li>
<li><p>CO binds much more strongly than H (1.82 eV vs 0.60 eV)</p></li>
</ul>
<p><strong>Typical Variations:</strong></p>
<ul class="simple">
<li><p>Reaction energies typically accurate within 0.1-0.2 eV</p></li>
<li><p>Barriers more sensitive: expect ±0.2-0.3 eV variation</p></li>
<li><p>ZPE corrections typically add 0.05-0.15 eV to reaction energies</p></li>
<li><p>NEB convergence affects barrier more than reaction energy</p></li>
</ul>
<p><strong>Physical Insight:</strong></p>
<ul class="simple">
<li><p>Large reverse barrier (1.59 eV) makes CO dissociation very slow at low T</p></li>
<li><p>Small forward barrier (0.11 eV) means C+O rapidly recombine to CO</p></li>
<li><p>This explains why Ni produces CO in Fischer-Tropsch rather than keeping C and O separate</p></li>
<li><p>High temperatures needed to overcome the dissociation barrier for further C-C coupling</p></li>
</ul>
</div>
<div class="note admonition">
<p class="admonition-title">NEB Method Explained</p>
<p>The <strong>Nudged Elastic Band (NEB)</strong> method finds the minimum energy path between reactants and products:</p>
<ol class="arabic simple">
<li><p><strong>Interpolate</strong> between initial and final states (5-9 images typical)</p></li>
<li><p><strong>Add spring forces</strong> along the chain to maintain spacing</p></li>
<li><p><strong>Project out</strong> spring components perpendicular to the path</p></li>
<li><p><strong>Climbing image</strong> variant: highest energy image climbs to saddle point</p></li>
</ol>
<p>Advantages:</p>
<ul class="simple">
<li><p>No prior knowledge of transition state needed</p></li>
<li><p>Finds entire reaction coordinate</p></li>
<li><p>Robust for complex reactions</p></li>
</ul>
<p>Limitations:</p>
<ul class="simple">
<li><p>Computationally expensive (optimize N images)</p></li>
<li><p>May find wrong path if initial interpolation is poor</p></li>
</ul>
</div>
</section>
<section id="id15">
<h3>Explore on Your Own<a class="headerlink" href="#id15" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p><strong>Image convergence</strong>: Run with 7 or 9 images. Does the barrier change?</p></li>
<li><p><strong>Spring constant</strong>: Modify the NEB spring constant. How does this affect convergence?</p></li>
<li><p><strong>Alternative paths</strong>: Try different initial CO/final C+O configurations. Are there multiple pathways?</p></li>
<li><p><strong>Reverse barrier</strong>: Calculate E_a(reverse) = E_a(forward) - ΔE. Check Brønsted-Evans-Polanyi relationship.</p></li>
<li><p><strong>Diffusion barriers</strong>: Compute NEB for C or O diffusion on the surface. How do they compare?</p></li>
</ol>
</section>
</section>
<hr class="docutils" />
<section id="summary-and-best-practices">
<h2>Summary and Best Practices<a class="headerlink" href="#summary-and-best-practices" title="Link to this heading">#</a></h2>
<section id="key-takeaways">
<h3>Key Takeaways<a class="headerlink" href="#key-takeaways" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p><strong>ML Potentials</strong>: UMa-S-1P1 provides ~1000× speedup over DFT with reasonable accuracy</p></li>
<li><p><strong>Bulk optimization</strong>: Always use the ML-optimized lattice constant for consistency</p></li>
<li><p><strong>Surface energies</strong>: Linear extrapolation eliminates finite-size effects</p></li>
<li><p><strong>Adsorption</strong>: Test multiple sites; lowest energy may not be intuitive</p></li>
<li><p><strong>Coverage</strong>: Lateral interactions become significant above ~0.3 ML</p></li>
<li><p><strong>Barriers</strong>: NEB requires careful setup but yields full reaction pathway</p></li>
</ol>
</section>
<section id="recommended-workflow-for-new-systems">
<h3>Recommended Workflow for New Systems<a class="headerlink" href="#recommended-workflow-for-new-systems" title="Link to this heading">#</a></h3>
<pre  class="mermaid">
        graph TD
    A[Optimize Bulk] --&gt; B[Calculate Surface Energies]
    B --&gt; C[Wulff Construction]
    C --&gt; D[Low-Coverage Adsorption]
    D --&gt; E{Coverage Important?}
    E --&gt;|Yes| F[Coverage Study]
    E --&gt;|No| G[Reaction Barriers]
    F --&gt; G
    G --&gt; H[Microkinetic Modeling]
    </pre></section>
<section id="accuracy-considerations">
<h3>Accuracy Considerations<a class="headerlink" href="#accuracy-considerations" title="Link to this heading">#</a></h3>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Property</p></th>
<th class="head"><p>Typical Error</p></th>
<th class="head"><p>When Critical</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Lattice constants</p></td>
<td><p>1-2%</p></td>
<td><p>Strain effects, alloys</p></td>
</tr>
<tr class="row-odd"><td><p>Surface energies</p></td>
<td><p>10-20%</p></td>
<td><p>Nanoparticle shapes</p></td>
</tr>
<tr class="row-even"><td><p>Adsorption energies</p></td>
<td><p>0.1-0.3 eV</p></td>
<td><p>Thermochemistry</p></td>
</tr>
<tr class="row-odd"><td><p>Barriers</p></td>
<td><p>0.2-0.5 eV</p></td>
<td><p>Kinetics, selectivity</p></td>
</tr>
</tbody>
</table>
</div>
<p><strong>Rule of thumb</strong>: Use ML for screening → DFT for validation → Experiment for verification</p>
</section>
<section id="further-reading">
<h3>Further Reading<a class="headerlink" href="#further-reading" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>UMA Paper</strong>: <a class="reference external" href="https://arxiv.org/abs/2506.23971">Wood et al. 2025</a></p></li>
<li><p><strong>OMat24 Paper</strong>: <a class="reference external" href="https://arxiv.org/abs/2410.12771">Barroso-Luque et al., 2024</a></p></li>
<li><p><strong>OC20 Dataset</strong>: <a class="reference external" href="https://www.nature.com/articles/s41586-021-03828-1">Chanussot et al., Nature, 2021</a></p></li>
<li><p><strong>ASE Tutorial</strong>: <a class="reference external" href="https://wiki.fysik.dtu.dk/ase/">https://wiki.fysik.dtu.dk/ase/</a></p></li>
</ul>
</section>
</section>
<hr class="docutils" />
<section id="appendix-troubleshooting">
<h2>Appendix: Troubleshooting<a class="headerlink" href="#appendix-troubleshooting" title="Link to this heading">#</a></h2>
<section id="common-issues">
<h3>Common Issues<a class="headerlink" href="#common-issues" title="Link to this heading">#</a></h3>
<p><strong>Problem</strong>: Convergence failures</p>
<ul class="simple">
<li><p><strong>Solution</strong>: Reduce <code class="docutils literal notranslate"><span class="pre">fmax</span></code> to 0.1 initially, tighten later</p></li>
<li><p>Check if system is metastable (try different starting geometry)</p></li>
</ul>
<p><strong>Problem</strong>: NEB fails to find transition state</p>
<ul class="simple">
<li><p><strong>Solution</strong>: Use more images (9-11) or better initial guess</p></li>
<li><p>Try fixed-end NEB first, then climbing image</p></li>
</ul>
<p><strong>Problem</strong>: Unexpected adsorption energies</p>
<ul class="simple">
<li><p><strong>Solution</strong>: Visualize structures - check for distortions</p></li>
<li><p>Compare with multiple sites</p></li>
<li><p>Add D3 corrections</p></li>
</ul>
<p><strong>Problem</strong>: Out of memory</p>
<ul class="simple">
<li><p><strong>Solution</strong>: Reduce system size (smaller supercells)</p></li>
<li><p>Use fewer NEB images</p></li>
<li><p>Run on HPC with more RAM</p></li>
</ul>
</section>
<section id="performance-tips">
<h3>Performance Tips<a class="headerlink" href="#performance-tips" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p><strong>Use batching</strong>: Relax multiple configurations in parallel</p></li>
<li><p><strong>Start with DEBUG_MAX_STEPS=50</strong>: Get quick results, refine later</p></li>
<li><p><strong>Cache bulk energies</strong>: Don’t recalculate reference systems</p></li>
<li><p><strong>Trajectory analysis</strong>: Monitor optimization progress with ASE GUI</p></li>
</ol>
</section>
</section>
<hr class="docutils" />
<section id="caveats-and-pitfalls">
<h2>Caveats and Pitfalls<a class="headerlink" href="#caveats-and-pitfalls" title="Link to this heading">#</a></h2>
<div class="warning admonition">
<p class="admonition-title">Important Considerations</p>
<p>When using ML potentials for surface catalysis, be aware of these critical issues!</p>
</div>
<section id="task-selection-omat-vs-oc20">
<h3>1. Task Selection: OMAT vs OC20<a class="headerlink" href="#task-selection-omat-vs-oc20" title="Link to this heading">#</a></h3>
<p><strong>Critical choice</strong>: Which task_name to use?</p>
<ul class="simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">task_name=&quot;omat&quot;</span></code></strong>: Optimized for bulk and clean surface calculations</p>
<ul>
<li><p>Use for: Part 1 (bulk), Part 2 (surface energies), Part 3 (Wulff)</p></li>
<li><p>Better for structural relaxations without adsorbates</p></li>
</ul>
</li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">task_name=&quot;oc20&quot;</span></code></strong>: Optimized for surface chemistry with adsorbates</p>
<ul>
<li><p>Use for: Part 4-6 (all adsorbate calculations)</p></li>
<li><p>Trained on Open Catalyst data with adsorbate-surface interactions</p></li>
</ul>
</li>
</ul>
<p><strong>Impact</strong>: Using wrong task can lead to 0.1-0.3 eV errors in adsorption energies!</p>
</section>
<section id="d3-dispersion-corrections">
<h3>2. D3 Dispersion Corrections<a class="headerlink" href="#d3-dispersion-corrections" title="Link to this heading">#</a></h3>
<p><strong>Multiple decisions required</strong>:</p>
<ol class="arabic simple">
<li><p><strong>Whether to use D3 at all?</strong></p>
<ul class="simple">
<li><p>Small adsorbates (H, O, N): D3 effect ~0.01-0.05 eV (often negligible)</p></li>
<li><p>Large molecules (CO, CO₂, aromatics): D3 effect ~0.1-0.3 eV (important!)</p></li>
<li><p>Physisorption: D3 critical (can change binding from repulsive to attractive)</p></li>
<li><p>RPBE was originally fit for chemisorption energies without D3 corrections, so adding D3 corrections may actually cause small adsorbates to overbind. However, it probably would be important for larger molecules. It’s relatively uncommon to see RPBE+D3 as a choice in the catalysis literature (compared to PBE+D3, or RPBE, or BEEF-vdW).</p></li>
</ul>
</li>
<li><p><strong>Which DFT functional for D3?</strong></p>
<ul class="simple">
<li><p>This tutorial uses <code class="docutils literal notranslate"><span class="pre">method=&quot;PBE&quot;</span></code> consistently for the D3 correction. This is often implied when papers say they use a D3 correction, but the results can be different if use the RPBE parameterizations.</p></li>
<li><p>Original paper used PBE for bulk/surfaces, RPBE for adsorption. It’s not specified what D3 parameterization they used, but it’s likely PBE.</p></li>
</ul>
</li>
<li><p><strong>When to apply D3?</strong></p>
<ul class="simple">
<li><p><strong>End-point correction</strong> (used here): Fast, run ML optimization then add D3 energy</p></li>
<li><p><strong>During optimization</strong>: Slower but more accurate geometries</p></li>
<li><p><strong>Impact</strong>: Usually &lt;0.05 eV difference, but can be larger for weak interactions</p></li>
</ul>
</li>
</ol>
</section>
<section id="coverage-dependence-challenges">
<h3>3. Coverage Dependence Challenges<a class="headerlink" href="#coverage-dependence-challenges" title="Link to this heading">#</a></h3>
<p><strong>Non-linearity at high coverage</strong>:</p>
<ul class="simple">
<li><p>This tutorial assumes linear E_ads(θ) = E₀ + βθ</p></li>
<li><p>Reality: Often non-linear, especially near θ = 1 ML. See the plots generated - there is a linear regime for relatively high coverage, and relatively low coverage, but it’s not uniformly linear everywhere. As long as you consistently in one regime or the other a linear assumption is probably ok, but you could get into problems if solving microkinetic models where the coverage of the species in question changes significantly from very low to high.</p></li>
<li><p><strong>Why</strong>: Phase transitions, adsorbate ordering, surface reconstruction</p></li>
<li><p><strong>Solution</strong>: Test polynomial fits, look for ordering in visualizations</p></li>
</ul>
<p><strong>Low coverage limit</strong>:</p>
<ul class="simple">
<li><p>At θ &lt; 0.1 ML, coverage effects are tiny (&lt;0.01 eV)</p></li>
<li><p>Hard to distinguish from numerical noise</p></li>
<li><p><strong>Best practice</strong>: Focus on 0.25-1.0 ML range for fitting</p></li>
</ul>
</section>
<section id="periodic-boundary-conditions">
<h3>4. Periodic Boundary Conditions<a class="headerlink" href="#periodic-boundary-conditions" title="Link to this heading">#</a></h3>
<p><strong>UMa requires PBC=True in all directions!</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">atoms</span><span class="o">.</span><span class="n">set_pbc</span><span class="p">([</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">])</span>  <span class="c1"># Always required</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Forgetting this causes crashes or wrong energies</p></li>
<li><p>Even for “gas phase” molecules in vacuum</p></li>
</ul>
</section>
<section id="gas-phase-reference-energies">
<h3>5. Gas Phase Reference Energies<a class="headerlink" href="#gas-phase-reference-energies" title="Link to this heading">#</a></h3>
<p><strong>Tricky cases</strong>:</p>
<ul class="simple">
<li><p><strong>H₂(g)</strong>: UMa handles well (used in this tutorial)</p></li>
<li><p><strong>H(g)</strong>: May not be reliable (use H₂/2 instead)</p></li>
<li><p><strong>CO(g)</strong>, <strong>O₂(g)</strong>: Usually okay, but check against DFT</p></li>
<li><p><strong>Radicals</strong>: Often problematic</p></li>
</ul>
<p><strong>Best practice</strong>: Always use stable molecules as references (H₂, not H; H₂O, not OH)</p>
</section>
<section id="spin-polarization">
<h3>6. Spin Polarization<a class="headerlink" href="#spin-polarization" title="Link to this heading">#</a></h3>
<p><strong>Key limitation</strong>: OC20/UMa does not include spin!</p>
<ul class="simple">
<li><p>Paper used spin-polarized DFT</p></li>
<li><p><strong>Impact</strong>: Usually small (0.05-0.1 eV)</p></li>
<li><p><strong>Larger</strong> for:</p>
<ul>
<li><p>Magnetic metals (Fe, Co, Ni)</p></li>
<li><p>Open-shell adsorbates (O*, OH*)</p></li>
<li><p>Reaction barriers with radicals</p></li>
</ul>
</li>
</ul>
</section>
<section id="constraint-philosophy">
<h3>7. Constraint Philosophy<a class="headerlink" href="#constraint-philosophy" title="Link to this heading">#</a></h3>
<p><strong>Clean slabs</strong> (Part 2): No constraints (both surfaces relax)</p>
<ul class="simple">
<li><p>Best for surface energy calculations</p></li>
<li><p>More physical for symmetric slabs</p></li>
</ul>
<p><strong>Adsorbate slabs</strong> (Part 4-6): Bottom layers fixed</p>
<ul class="simple">
<li><p>Faster convergence</p></li>
<li><p>Prevents adsorbate-induced reconstruction</p></li>
<li><p>Standard practice in surface chemistry</p></li>
</ul>
<p><strong>Fairchem helper functions</strong>: Automatically apply sensible constraints</p>
<ul class="simple">
<li><p>Trust their heuristics unless you have good reason not to</p></li>
<li><p>Check <code class="docutils literal notranslate"><span class="pre">atoms.constraints</span></code> to see what was applied</p></li>
</ul>
</section>
<section id="complex-surface-structures">
<h3>8. Complex Surface Structures<a class="headerlink" href="#complex-surface-structures" title="Link to this heading">#</a></h3>
<p><strong>This tutorial uses low-index facets</strong> (111, 100, 110, 211)</p>
<ul class="simple">
<li><p>Well-defined, symmetric</p></li>
<li><p>Easy to generate and analyze</p></li>
</ul>
<p><strong>Real catalysts</strong> have:</p>
<ul class="simple">
<li><p>Steps, kinks, grain boundaries</p></li>
<li><p>Support interfaces</p></li>
<li><p>Defects and vacancies</p></li>
<li><p><strong>Challenge</strong>: Harder to generate, more configurations to test</p></li>
</ul>
</section>
<section id="slab-thickness-and-vacuum">
<h3>9. Slab Thickness and Vacuum<a class="headerlink" href="#slab-thickness-and-vacuum" title="Link to this heading">#</a></h3>
<p><strong>Convergence tests critical</strong> but expensive:</p>
<ul class="simple">
<li><p>This tutorial uses “reasonable” values (4-8 layers, 10 Å vacuum)</p></li>
<li><p><strong>Always check</strong> convergence for new systems</p></li>
<li><p><strong>Especially important</strong> for:</p>
<ul>
<li><p>Metals with long electron screening (Au, Ag)</p></li>
<li><p>Charged adsorbates</p></li>
<li><p>Strong adsorbate-induced reconstruction</p></li>
</ul>
</li>
</ul>
</section>
<section id="neb-convergence">
<h3>10. NEB Convergence<a class="headerlink" href="#neb-convergence" title="Link to this heading">#</a></h3>
<p><strong>Most computationally expensive part</strong>:</p>
<ul class="simple">
<li><p>May need 7-11 images (not just 5)</p></li>
<li><p>Initial guess matters a lot</p></li>
<li><p>Can get stuck in local minima</p></li>
</ul>
<p><strong>Tricks</strong>:</p>
<ol class="arabic simple">
<li><p>Use dimer method to find better TS guess (as shown in Part 6)</p></li>
<li><p>Start with coarse convergence (fmax=0.2), refine later</p></li>
<li><p>Visualize the path - does it make chemical sense?</p></li>
<li><p>Try different spring constants (0.1-1.0 eV/Å)</p></li>
</ol>
</section>
<section id="lattice-constant-source">
<h3>11. Lattice Constant Source<a class="headerlink" href="#lattice-constant-source" title="Link to this heading">#</a></h3>
<p><strong>Consistency is key</strong>:</p>
<ul class="simple">
<li><p>Use ML-optimized lattice constant throughout (as done here)</p></li>
<li><p><strong>Don’t mix</strong>: ML lattice + DFT surface energies = inconsistent</p></li>
<li><p>Alternative: Use experimental lattice constant for everything</p></li>
</ul>
</section>
<section id="adsorbate-placement">
<h3>12. Adsorbate Placement<a class="headerlink" href="#adsorbate-placement" title="Link to this heading">#</a></h3>
<p><strong>Multiple local minima</strong>:</p>
<ul class="simple">
<li><p>Surface chemistry is <strong>not</strong> convex!</p></li>
<li><p>Always test multiple adsorption sites</p></li>
<li><p>Fairchem helpers generate ~5 configurations in this tutorial, but you may need more to search many modes. You can already try methods like minima hopping or other global optimization methods to sample more configurations.</p></li>
</ul>
<p><strong>For complex adsorbates</strong>:</p>
<ul class="simple">
<li><p>Test different orientations</p></li>
<li><p>May need 10-20 configurations</p></li>
<li><p>Consider genetic algorithms or basin hopping</p></li>
</ul>
<hr class="docutils" />
<div class="tip admonition">
<p class="admonition-title">Congratulations! 🎉</p>
<p>You’ve completed a comprehensive computational catalysis workflow using state-of-the-art ML potentials. You can now:</p>
<ul class="simple">
<li><p>Characterize catalyst surfaces computationally</p></li>
<li><p>Predict nanoparticle shapes</p></li>
<li><p>Calculate reaction thermodynamics and kinetics</p></li>
<li><p>Apply these methods to your own research questions</p></li>
</ul>
<p><strong>Next steps</strong>:</p>
<ul class="simple">
<li><p>Apply to your catalyst system of interest</p></li>
<li><p>Validate key results with DFT</p></li>
<li><p>Develop microkinetic models</p></li>
<li><p>Publish your findings!</p></li>
</ul>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./uma_tutorials"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="uma_tutorial.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">UMA Intro Tutorial</p>
      </div>
    </a>
    <a class="right-next"
       href="../core/generative_models.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Generative Models</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#installation-and-setup">Installation and Setup</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#huggingface-setups">Huggingface setups</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fair-chemistry-uma-installation">FAIR Chemistry (UMA) installation</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#package-imports">Package imports</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-1-bulk-crystal-optimization">Part 1: Bulk Crystal Optimization</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#theory">Theory</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-2-surface-energy-calculations">Part 2: Surface Energy Calculations</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Introduction</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Theory</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-1-setup-and-bulk-energy-reference">Step 1: Setup and Bulk Energy Reference</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-generate-and-relax-slabs">Step 2: Generate and Relax Slabs</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-3-visualize-linear-fits">Step 3: Visualize Linear Fits</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-4-compare-with-literature">Step 4: Compare with Literature</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#explore-on-your-own">Explore on Your Own</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-3-wulff-construction">Part 3: Wulff Construction</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Introduction</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">Theory</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-1-prepare-surface-energies">Step 1: Prepare Surface Energies</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-generate-wulff-construction">Step 2: Generate Wulff Construction</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-3-visualize-and-compare">Step 3: Visualize and Compare</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">Explore on Your Own</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-4-h-adsorption-energy-with-zpe-correction">Part 4: H Adsorption Energy with ZPE Correction</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">Introduction</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">Theory</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-1-setup-and-relax-clean-slab">Step 1: Setup and Relax Clean Slab</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-relax-clean-slab">Step 2: Relax Clean Slab</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-3-generate-h-adsorption-sites">Step 3: Generate H Adsorption Sites</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-4-relax-all-h-configurations">Step 4: Relax All H Configurations</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-5-calculate-h2-reference-energy">Step 5: Calculate H₂ Reference Energy</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-6-compute-adsorption-energy">Step 6: Compute Adsorption Energy</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-7-zero-point-energy-zpe-corrections">Step 7: Zero-Point Energy (ZPE) Corrections</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-8-visualize-and-compare-results">Step 8: Visualize and Compare Results</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">Explore on Your Own</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-5-coverage-dependent-h-adsorption">Part 5: Coverage-Dependent H Adsorption</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">Introduction</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">Theory</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-1-setup-slab-and-calculators">Step 1: Setup Slab and Calculators</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-calculate-reference-energies">Step 2: Calculate Reference Energies</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-3-set-up-coverage-study">Step 3: Set Up Coverage Study</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-4-generate-and-relax-configurations-at-each-coverage">Step 4: Generate and Relax Configurations at Each Coverage</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-5-perform-linear-fit">Step 5: Perform Linear Fit</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-6-visualize-coverage-dependence">Step 6: Visualize Coverage Dependence</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">Explore on Your Own</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-6-co-formation-dissociation-thermochemistry-and-barrier">Part 6: CO Formation/Dissociation Thermochemistry and Barrier</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">Introduction</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">Theory</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id14">Step 1: Setup Slab and Calculators</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-generate-and-relax-final-state-co">Step 2: Generate and Relax Final State (CO*)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-3-generate-and-relax-initial-state-c-o">Step 3: Generate and Relax Initial State (C* + O*)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-3b-calculate-c-and-o-energies-separately">Step 3b: Calculate C* and O* Energies Separately</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-4-calculate-reaction-energy-with-zpe">Step 4: Calculate Reaction Energy with ZPE</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-5-calculate-co-adsorption-energy-bonus">Step 5: Calculate CO Adsorption Energy (Bonus)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-6-find-guesses-for-nearby-initial-and-final-states-for-the-reaction">Step 6: Find guesses for nearby initial and final states for the reaction</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-7-run-neb-to-find-activation-barrier">Step 7: Run NEB to Find Activation Barrier</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-8-visualize-neb-path-and-key-structures">Step 8: Visualize NEB Path and Key Structures</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id15">Explore on Your Own</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary-and-best-practices">Summary and Best Practices</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-takeaways">Key Takeaways</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommended-workflow-for-new-systems">Recommended Workflow for New Systems</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#accuracy-considerations">Accuracy Considerations</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#further-reading">Further Reading</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#appendix-troubleshooting">Appendix: Troubleshooting</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#common-issues">Common Issues</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#performance-tips">Performance Tips</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#caveats-and-pitfalls">Caveats and Pitfalls</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#task-selection-omat-vs-oc20">1. Task Selection: OMAT vs OC20</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#d3-dispersion-corrections">2. D3 Dispersion Corrections</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#coverage-dependence-challenges">3. Coverage Dependence Challenges</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#periodic-boundary-conditions">4. Periodic Boundary Conditions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#gas-phase-reference-energies">5. Gas Phase Reference Energies</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#spin-polarization">6. Spin Polarization</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#constraint-philosophy">7. Constraint Philosophy</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#complex-surface-structures">8. Complex Surface Structures</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#slab-thickness-and-vacuum">9. Slab Thickness and Vacuum</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#neb-convergence">10. NEB Convergence</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lattice-constant-source">11. Lattice Constant Source</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#adsorbate-placement">12. Adsorbate Placement</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By FAIR Chemistry & Collaborators
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright Meta Platforms, Inc.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>