{"version":3,"kind":"Notebook","sha256":"c74d4534c2d261d3b457cc172f3925a9d06f4b9abbc11220cab7eed35a1343ef","slug":"ocp-introduction","location":"/catalysts/examples_tutorials/OCP-introduction.md","dependencies":[],"frontmatter":{"title":"Intro to Adsorption Energies","kernelspec":{"name":"python3","display_name":"Python 3 (ipykernel)","language":"python"},"jupytext":{"formats":"md:myst,ipynb","text_representation":{"extension":".md","format_name":"myst","format_version":"0.13","jupytext_version":"1.17.1"}},"content_includes_title":false,"authors":[{"nameParsed":{"literal":"FAIR Chemistry & Collaborators","given":"FAIR Chemistry &","family":"Collaborators"},"name":"FAIR Chemistry & Collaborators","id":"contributors-myst-generated-uid-0"}],"github":"https://github.com/facebookresearch/fairchem","copyright":"Meta Platforms, Inc","numbering":{"title":{"offset":2}},"source_url":"https://github.com/facebookresearch/fairchem/blob/main/docs/catalysts/examples_tutorials/OCP-introduction.md","edit_url":"https://github.com/facebookresearch/fairchem/edit/main/docs/catalysts/examples_tutorials/OCP-introduction.md","exports":[{"format":"md","filename":"OCP-introduction.md","url":"/build/OCP-introduction-62ef8c32907f8dece531a6143ec042f6.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"card","children":[{"type":"cardTitle","children":[{"type":"text","value":"Tutorial Overview","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"yhKc2DpDuO"}],"key":"RVWt3blMle"},{"type":"table","position":{"start":{"line":19,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"tableRow","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"tableCell","header":true,"position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"Property","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"vuSLTyjwOa"}],"key":"JbjmomCMUT"},{"type":"tableCell","header":true,"position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"Value","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"x6SUDVDoCB"}],"key":"x8jLV8tKGN"}],"key":"jOPcblKbMu"},{"type":"tableRow","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"strong","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"Difficulty","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"WRY9yfmf2Y"}],"key":"Ft53IofkWH"}],"key":"MkRtLsfKOn"},{"type":"tableCell","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"Beginner","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"ijjMTVbfCh"}],"key":"k4kN4teDt9"}],"key":"Cci0d6EmUi"},{"type":"tableRow","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"strong","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"Time","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"cVGJIUwGpz"}],"key":"nl5moeB57P"}],"key":"Rq32m2wDz7"},{"type":"tableCell","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"15-30 minutes","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"eDeO1EjQzQ"}],"key":"nqhRWRqfN9"}],"key":"l5fepj0w9J"},{"type":"tableRow","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"strong","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"Prerequisites","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"oTnW4Wujy6"}],"key":"j8TRBnkJnj"}],"key":"v9eTwQ23sm"},{"type":"tableCell","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"Basic Python, familiarity with ASE","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"mHPV5QogdL"}],"key":"VLx9HH0DiU"}],"key":"PzMLDtvfmx"},{"type":"tableRow","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"strong","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"Goal","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"zZUE7vCOAm"}],"key":"ZQjOJLvvhH"}],"key":"nYxopaHzfz"},{"type":"tableCell","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"Calculate adsorption energies using UMA models","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"uNYxzFs8im"}],"key":"VrC3FA7Q3H"}],"key":"YBntyvDoDK"}],"key":"Y8D00PkVU9"}],"key":"Uw6i9uoXwW"},{"type":"paragraph","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"text","value":"To introduce OCP we start with using it to calculate adsorption energies for a simple, atomic adsorbate where we specify the site we want to the adsorption energy for. Conceptually, you do this like you would do it with density functional theory. You create a slab model for the surface, place an adsorbate on it as an initial guess, run a relaxation to get the lowest energy geometry, and then compute the adsorption energy using reference states for the adsorbate.","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"F3qMsOEh6l"}],"key":"oAqvUxL9RH"},{"type":"admonition","kind":"important","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Important","key":"IkZ027GHVv"}],"key":"NYkeiI7BMO"},{"type":"paragraph","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"text","value":"Some OCP model/checkpoint combinations return a total energy like density functional theory would, but some return an “adsorption energy” directly. You have to know which one you are using. In this example, the model we use returns an “adsorption energy”.","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"trdTLFEd68"}],"key":"nPPzu9peIr"}],"key":"N9dRgDlcmM"}],"key":"D1079YgiCq"},{"type":"block","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"text","value":"Intro to Adsorption energies","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"m0sukrSn5f"}],"label":"intro-to-adsorption-energies","identifier":"intro-to-adsorption-energies","html_id":"intro-to-adsorption-energies","key":"jzK0hiuxWH"},{"type":"paragraph","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"children":[{"type":"text","value":"Adsorption energies are always a reaction energy (an adsorbed species relative to some implied combination of reactants). There are many common schemes in the catalysis literature.","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"key":"jUhVwoB03j"}],"key":"nyExWyMNrO"},{"type":"paragraph","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"children":[{"type":"text","value":"For example, you may want the adsorption energy of oxygen, and you might compute that from this reaction:","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"CCjOlYlTjS"}],"key":"Fb9z52Q82r"},{"type":"code","lang":"","value":"1/2 O2 + slab -> slab-O","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"key":"UejIAfTiGK"},{"type":"paragraph","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"children":[{"type":"text","value":"DFT has known errors with the energy of a gas-phase O2 molecule, so it’s more common to compute this energy relative to a linear combination of H2O and H2. The suggested reference scheme for consistency with OC20 is a reaction","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"key":"f5C8N1644f"}],"key":"r7DZQZV6Yy"},{"type":"code","lang":"","value":"x CO + (x + y/2 - z) H2 + (z-x) H2O + w/2 N2 + * -> CxHyOzNw*","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"key":"ltT68VzEHw"},{"type":"paragraph","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"children":[{"type":"text","value":"Here, x=y=w=0, z=1, so the reaction ends up as","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"ER464tHnEa"}],"key":"Pjl6JXgSAc"},{"type":"code","lang":"","value":"-H2 + H2O + * -> O*","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"TAfAYQHlEL"},{"type":"paragraph","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"children":[{"type":"text","value":"or alternatively,","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"key":"nDsDcCHJs5"}],"key":"g7alr1V2BD"},{"type":"code","lang":"","value":"H2O + * -> O* + H2","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"key":"xo0B4YRNbR"},{"type":"paragraph","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"children":[{"type":"text","value":"It is possible through thermodynamic cycles to compute other reactions. If we can look up rH1 below and compute rH2","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"QQKiasC4yi"}],"key":"dicUySHsSk"},{"type":"code","lang":"","value":"H2 + 1/2 O2 -> H2O  re1 = -3.03 eV, from exp\nH2O + * -> O* + H2  re2  # Get from UMA","position":{"start":{"line":58,"column":1},"end":{"line":59,"column":1}},"key":"zpEcmVw2Ja"},{"type":"paragraph","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"children":[{"type":"text","value":"Then, the adsorption energy for","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"WuLPXY5y6W"}],"key":"QXPmpVUVRF"},{"type":"code","lang":"","value":"1/2O2 + * -> O*","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"key":"SgRUNfNz7N"},{"type":"paragraph","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"children":[{"type":"text","value":"is just re1 + re2.","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"cElV5rA6YU"}],"key":"wdJ2MJWzEu"},{"type":"paragraph","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"children":[{"type":"text","value":"Based on ","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"Tpsdtd0NE9"},{"type":"link","url":"https://atct.anl.gov/Thermochemical%20Data/version%201.118/species/?species_number=986","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"children":[{"type":"text","value":"https://atct.anl.gov/Thermochemical Data/version 1.118/species/?species_number=986","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"hRHGAv4OgZ"}],"urlSource":"https://atct.anl.gov/Thermochemical%20Data/version%201.118/species/?species_number=986","key":"KhNurFa2Rj"},{"type":"text","value":", the formation energy of water is about -3.03 eV at standard state experimentally. You could also compute this using DFT, but you would probably get the wrong answer for this.","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"FLBJhioFNT"}],"key":"Mxn3Ok58d3"},{"type":"paragraph","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"children":[{"type":"text","value":"The first step is getting a checkpoint for the model we want to use. UMA is currently the state-of-the-art model and will provide total energy estimates at the RPBE level of theory if you use the “OC20” task.","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"key":"UzRxWCunm1"}],"key":"q8zr5CrFFQ"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Need to install fairchem-core or get UMA access or getting permissions/401 errors?","position":{"start":{"line":72,"column":1},"end":{"line":72,"column":1}},"key":"ysZBngeZ47"}],"key":"sgophwaFkj"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Install the necessary packages using pip, uv etc","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"key":"j9kmYK5I7R"}],"key":"QIvYwYwMXf"}],"key":"USq3WbyBT0"}],"key":"dkbUGQnXrd"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"! pip install fairchem-core fairchem-data-oc fairchem-applications-cattsunami","visibility":"show","key":"juReV85Elc"},{"type":"outputs","id":"kfV8VwlZvRVpxZHOgDjrp","children":[],"visibility":"show","key":"Y9O06D6aBm"}],"data":{"tags":["skip-execution"]},"visibility":"show","key":"vgFRNrXOeT"},{"type":"list","ordered":true,"start":2,"spread":false,"position":{"start":{"line":83,"column":1},"end":{"line":88,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":83,"column":1},"end":{"line":88,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Get access to any necessary huggingface gated models","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"key":"n4MI40gIA9"}],"key":"M5iS9iT7bG"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":84,"column":1},"end":{"line":88,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Get and login to your Huggingface account","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"key":"hboW3TM7GK"}],"key":"bDxrV0vZvt"}],"key":"zYippbwcgL"},{"type":"listItem","spread":true,"position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Request access to ","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"key":"j9Zqq3aNa8"},{"type":"link","url":"https://huggingface.co/facebook/UMA","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"children":[{"type":"text","value":"https://​huggingface​.co​/facebook​/UMA","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"key":"TdxS97nb6S"}],"urlSource":"https://huggingface.co/facebook/UMA","key":"WVWz28f5vd"}],"key":"mrj9jpDPmB"}],"key":"q0FOgLOKNj"},{"type":"listItem","spread":true,"position":{"start":{"line":86,"column":1},"end":{"line":86,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Create a Huggingface token at ","position":{"start":{"line":86,"column":1},"end":{"line":86,"column":1}},"key":"N39zi4kzzf"},{"type":"link","url":"https://huggingface.co/settings/tokens/","position":{"start":{"line":86,"column":1},"end":{"line":86,"column":1}},"children":[{"type":"text","value":"https://​huggingface​.co​/settings​/tokens/","position":{"start":{"line":86,"column":1},"end":{"line":86,"column":1}},"key":"HUKMMgZQGJ"}],"urlSource":"https://huggingface.co/settings/tokens/","key":"t0V1kVDdDA"},{"type":"text","value":" with the permission “Permissions: Read access to contents of all public gated repos you can access”","position":{"start":{"line":86,"column":1},"end":{"line":86,"column":1}},"key":"RXjF03SVCH"}],"key":"w5fLlpMVaX"}],"key":"eOPgUCGycx"},{"type":"listItem","spread":true,"position":{"start":{"line":87,"column":1},"end":{"line":88,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Add the token as an environment variable using ","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"cJqUuwn3Ro"},{"type":"inlineCode","value":"huggingface-cli login","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"w92QJCETGF"},{"type":"text","value":" or by setting the HF_TOKEN environment variable.","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"PnbOFbVg7N"}],"key":"CTRc2yimzf"}],"key":"CBfSPnG7zB"}],"key":"VG4jJCEIzI"}],"key":"mrYg4LSo9l"}],"key":"B3Zcvm3UaW"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Login using the huggingface-cli utility\n! huggingface-cli login\n\n# alternatively,\nimport os\nos.environ['HF_TOKEN'] = 'MY_TOKEN'","visibility":"show","key":"tfDYlT4zYc"},{"type":"outputs","id":"GwVYIwtB-mrTMTGD6DBEm","children":[],"visibility":"show","key":"NTVL44apFu"}],"data":{"tags":["skip-execution"]},"visibility":"show","key":"zGuWaAoeLT"}],"class":"dropdown","key":"D1RFORbPJ5"},{"type":"paragraph","position":{"start":{"line":102,"column":1},"end":{"line":102,"column":1}},"children":[{"type":"text","value":"If you find your kernel is crashing, it probably means you have exceeded the allowed amount of memory. This checkpoint works fine in this example, but it may crash your kernel if you use it in the NRR example.","position":{"start":{"line":102,"column":1},"end":{"line":102,"column":1}},"key":"iLJmkv6wtb"}],"key":"q1Ez8ZOGZd"},{"type":"paragraph","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"children":[{"type":"text","value":"This next cell will automatically download the checkpoint from huggingface and load it.","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"key":"rR4lTGYmCJ"}],"key":"jA3TK0xxuE"}],"key":"PXo7M4aDh5"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from __future__ import annotations\n\nfrom fairchem.core import FAIRChemCalculator, pretrained_mlip\n\npredictor = pretrained_mlip.get_predict_unit(\"uma-s-1p1\")\ncalc = FAIRChemCalculator(predictor, task_name=\"oc20\")","key":"YLFthk2iGN"},{"type":"outputs","id":"glSgwzHutIEV1EQwbbFGJ","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"WARNING:root:device was not explicitly set, using device='cuda'.\n"},"key":"heGKO9Ji6J"}],"key":"QcJ5t1R4l8"}],"key":"Ti24JJAH8Q"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"children":[{"type":"text","value":"Next we can build a slab with an adsorbate on it. Here we use the ASE module to build a Pt slab. We use the experimental lattice constant that is the default. This can introduce some small errors with DFT since the lattice constant can differ by a few percent, and it is common to use DFT lattice constants. In this example, we do not constrain any layers.","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"key":"nrwuovWnt2"}],"key":"XQSBTe1FIy"}],"key":"YY4nMElutT"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from ase.build import add_adsorbate, fcc111\nfrom ase.optimize import BFGS","key":"D2nqiKgl6Y"},{"type":"outputs","id":"dIMTcQHyKIKA9htrm9erB","children":[],"key":"o1pEh1QDho"}],"key":"y9jIjJAHbC"},{"type":"block","children":[],"key":"KdNvsp8gaw"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# reference energies from a linear combination of H2O/N2/CO/H2!\natomic_reference_energies = {\n    \"H\": -3.477,\n    \"N\": -8.083,\n    \"O\": -7.204,\n    \"C\": -7.282,\n}\n\nre1 = -3.03\n\nslab = fcc111(\"Pt\", size=(2, 2, 5), vacuum=20.0)\nslab.pbc = True\n\nadslab = slab.copy()\nadd_adsorbate(adslab, \"O\", height=1.2, position=\"fcc\")\n\nslab.set_calculator(calc)\nopt = BFGS(slab)\nopt.run(fmax=0.05, steps=100)\nslab_e = slab.get_potential_energy()\n\nadslab.set_calculator(calc)\nopt = BFGS(adslab)\nopt.run(fmax=0.05, steps=100)\nadslab_e = adslab.get_potential_energy()\n\n# Energy for ((H2O-H2) + * -> *O) + (H2 + 1/2O2 -> H2) leads to 1/2O2 + * -> *O!\nadslab_e - slab_e - atomic_reference_energies[\"O\"] + re1","key":"Fi1V2dtne2"},{"type":"outputs","id":"1kkCjZb3ATHbpQS5_HhqL","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"/tmp/ipykernel_9883/3752951811.py:17: FutureWarning: Please use atoms.calc = calc\n  slab.set_calculator(calc)\n"},"key":"ztY6iIJYkd"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"      Step     Time          Energy          fmax\nBFGS:    0 21:00:36     -104.695193        0.709590\nBFGS:    1 21:00:36     -104.753186        0.607748\n"},"key":"Gw0siAlwqu"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    2 21:00:36     -104.906056        0.369388\nBFGS:    3 21:00:36     -104.938754        0.439755\n"},"key":"u9034hjbJY"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    4 21:00:36     -105.016143        0.464013\n"},"key":"hhRvF2Tu96"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    5 21:00:37     -105.076559        0.356067\nBFGS:    6 21:00:37     -105.112621        0.189416\n"},"key":"dqOfPwphX4"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    7 21:00:37     -105.126759        0.045359\n"},"key":"upCz1wfiLC"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"/tmp/ipykernel_9883/3752951811.py:22: FutureWarning: Please use atoms.calc = calc\n  adslab.set_calculator(calc)\n"},"key":"WMRwPP5lzU"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"      Step     Time          Energy          fmax\nBFGS:    0 21:00:37     -110.048786        1.757515\nBFGS:    1 21:00:38     -110.230720        0.986273\n"},"key":"MMSrtHH7r4"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    2 21:00:38     -110.379352        0.731503\n"},"key":"xNaRK0UibS"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    3 21:00:38     -110.430289        0.807334\nBFGS:    4 21:00:38     -110.543668        0.692010\n"},"key":"vAlXSv9lwQ"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    5 21:00:38     -110.617473        0.492774\n"},"key":"izwgNnSVq4"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    6 21:00:39     -110.673457        0.666978\n"},"key":"roSg4Sj5dZ"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    7 21:00:39     -110.721678        0.710519\n"},"key":"CdepuZPKlK"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    8 21:00:39     -110.756904        0.443871\n"},"key":"vtCuJ26mmO"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    9 21:00:40     -110.769294        0.214552\n"},"key":"BYaikDhxGS"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:   10 21:00:40     -110.772450        0.091746\n"},"key":"PTaXaHCsmP"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:   11 21:00:40     -110.772964        0.062469\n"},"key":"DlAqCAraON"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:   12 21:00:40     -110.773257        0.046195\n"},"key":"AQ9YU5nDPV"},{"type":"output","children":[],"jupyter_data":{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"text/plain":{"content":"-1.4724986750909532","content_type":"text/plain"}}},"key":"OMTOQJjst8"}],"key":"m19R2hBZ2f"}],"key":"HeZn9xMgd6"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":153,"column":1},"end":{"line":153,"column":1}},"children":[{"type":"text","value":"It is good practice to look at your geometries to make sure they are what you expect.","position":{"start":{"line":153,"column":1},"end":{"line":153,"column":1}},"key":"Uoi2PZGg7p"}],"key":"E2CEs0CyQ9"}],"key":"vXEThXNt0f"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import matplotlib.pyplot as plt\nfrom ase.visualize.plot import plot_atoms\n\nfig, axs = plt.subplots(1, 2)\nplot_atoms(slab, axs[0])\nplot_atoms(slab, axs[1], rotation=(\"-90x\"))\naxs[0].set_axis_off()\naxs[1].set_axis_off()","key":"AHnvJ1pZL0"},{"type":"outputs","id":"eaUqq-8lWGt5k-kL-yv10","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 640x480 with 2 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"aab3b5d365eddde71ca8ac154f5f9bac","path":"/build/aab3b5d365eddde71ca8ac154f5f9bac.png"}}},"key":"WwzO5uDGWK"}],"key":"dFNIF0sdEh"}],"key":"JIg8rfXrVV"},{"type":"block","children":[],"key":"KHoyC3Lop7"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import matplotlib.pyplot as plt\nfrom ase.visualize.plot import plot_atoms\n\nfig, axs = plt.subplots(1, 2)\nplot_atoms(adslab, axs[0])\nplot_atoms(adslab, axs[1], rotation=(\"-90x\"))\naxs[0].set_axis_off()\naxs[1].set_axis_off()","key":"AkE4bAHML4"},{"type":"outputs","id":"apn8WDgk6VfZvKqcPyHZ7","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 640x480 with 2 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"f7b51c709af60fa4f5a96e6f35b718df","path":"/build/f7b51c709af60fa4f5a96e6f35b718df.png"}}},"key":"NZOrbXETWU"}],"key":"P762OnTgGZ"}],"key":"t7lQoxswsm"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":177,"column":1},"end":{"line":177,"column":1}},"children":[{"type":"text","value":"How did we do? We need a reference point. In the paper below, there is an atomic adsorption energy for O on Pt(111) of about -4.264 eV. This is for the reaction O + * -> O*. To convert this to the dissociative adsorption energy, we have to add the reaction:","position":{"start":{"line":177,"column":1},"end":{"line":177,"column":1}},"key":"soWBqCN0Xt"}],"key":"kBcLXnQRWJ"},{"type":"code","lang":"","value":"1/2 O2 -> O   D = 2.58 eV (expt)","position":{"start":{"line":179,"column":1},"end":{"line":179,"column":1}},"key":"ViXh2qlfPI"},{"type":"paragraph","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"children":[{"type":"text","value":"to get a comparable energy of about -1.68 eV. There is about ~0.2 eV difference (we predicted -1.47 eV above, and the reference comparison is -1.68 eV) to account for. The biggest difference is likely due to the differences in exchange-correlation functional. The reference data used the PBE functional, and eSCN was trained on ","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"ZphvNmVZlZ"},{"type":"emphasis","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"children":[{"type":"text","value":"RPBE","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"AJrlU8r4vo"}],"key":"KPy1fvkroE"},{"type":"text","value":" data. To additional places where there are differences include:","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"JtTYSJuSZK"}],"key":"E7uZAByoL6"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":183,"column":1},"end":{"line":186,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Difference in lattice constant","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"key":"suim162r2P"}],"key":"GdCXAbPzxf"}],"key":"gZAZL69F5v"},{"type":"listItem","spread":true,"position":{"start":{"line":184,"column":1},"end":{"line":184,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"The reference energy used for the experiment references. These can differ by up to 0.5 eV from comparable DFT calculations.","position":{"start":{"line":184,"column":1},"end":{"line":184,"column":1}},"key":"SpYFo47gDd"}],"key":"mhtjBUpgn7"}],"key":"AG3xRXpR8k"},{"type":"listItem","spread":true,"position":{"start":{"line":185,"column":1},"end":{"line":186,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"How many layers are relaxed in the calculation","position":{"start":{"line":185,"column":1},"end":{"line":185,"column":1}},"key":"d595B3Gnq9"}],"key":"Tex0B7Mhg5"}],"key":"iJlTGsj8w2"}],"key":"rXjmNEIGky"},{"type":"paragraph","position":{"start":{"line":187,"column":1},"end":{"line":187,"column":1}},"children":[{"type":"text","value":"Some of these differences tend to be systematic, and you can calibrate and correct these, especially if you can augment these with your own DFT calculations.","position":{"start":{"line":187,"column":1},"end":{"line":187,"column":1}},"key":"xTV5NydFkw"}],"key":"ZaF6npTroC"},{"type":"paragraph","position":{"start":{"line":189,"column":1},"end":{"line":189,"column":1}},"children":[{"type":"text","value":"See ","position":{"start":{"line":189,"column":1},"end":{"line":189,"column":1}},"key":"BFU8x9tC3Y"},{"type":"crossReference","position":{"start":{"line":189,"column":1},"end":{"line":189,"column":1}},"children":[{"type":"text","value":"convergence study","position":{"start":{"line":189,"column":1},"end":{"line":189,"column":1}},"key":"NejfP8MinU"}],"identifier":"convergence-study","label":"convergence-study","kind":"heading","template":"{name}","resolved":true,"html_id":"convergence-study","key":"xBdWK9T7Ja"},{"type":"text","value":" for some additional studies of factors that influence this number.","position":{"start":{"line":189,"column":1},"end":{"line":189,"column":1}},"key":"rTzP8UKuiW"}],"key":"nSdLLVu9h2"}],"key":"j2eXCJYwak"},{"type":"block","position":{"start":{"line":191,"column":1},"end":{"line":191,"column":1}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":193,"column":1},"end":{"line":193,"column":1}},"children":[{"type":"text","value":"Exercises","position":{"start":{"line":193,"column":1},"end":{"line":193,"column":1}},"key":"q3wS9sLcea"}],"identifier":"exercises","label":"Exercises","html_id":"exercises","implicit":true,"key":"j0CLAYXLtz"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":195,"column":1},"end":{"line":197,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":195,"column":1},"end":{"line":195,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Explore the effect of the lattice constant on the adsorption energy.","position":{"start":{"line":195,"column":1},"end":{"line":195,"column":1}},"key":"YtCYxUUs9c"}],"key":"tk1A0ejeDQ"}],"key":"nX1gepJOcR"},{"type":"listItem","spread":true,"position":{"start":{"line":196,"column":1},"end":{"line":197,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Try different sites, including the bridge and top sites. Compare the energies, and inspect the resulting geometries.","position":{"start":{"line":196,"column":1},"end":{"line":196,"column":1}},"key":"Ib2Jnwucvq"}],"key":"uEN8FiprEI"}],"key":"nVPufQmdAs"}],"key":"xh2Irzipum"}],"key":"ru5C5D0Gbw"},{"type":"block","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"children":[{"type":"text","value":"Trends in adsorption energies across metals.","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"t5V4FDp3vJ"}],"identifier":"trends-in-adsorption-energies-across-metals","label":"Trends in adsorption energies across metals.","html_id":"trends-in-adsorption-energies-across-metals","implicit":true,"key":"YgQnz9PKww"},{"type":"paragraph","position":{"start":{"line":202,"column":1},"end":{"line":202,"column":1}},"children":[{"type":"text","value":"Xu, Z., & Kitchin, J. R. (2014). Probing the coverage dependence of site and adsorbate configurational correlations on (111) surfaces of late transition metals. J. Phys. Chem. C, 118(44), 25597–25602. ","position":{"start":{"line":202,"column":1},"end":{"line":202,"column":1}},"key":"xzWxyr4F9k"},{"type":"cite","url":"http://dx.doi.org/10.1021/jp508805h","position":{"start":{"line":202,"column":1},"end":{"line":202,"column":1}},"children":[{"type":"text","value":"Xu & Kitchin (2014)","key":"cd8WMvPPEJ"}],"kind":"narrative","label":"Xu_2014","identifier":"http://dx.doi.org/10.1021/jp508805h","enumerator":"1","key":"HqZeSH1odx"}],"key":"jarJEFYcXU"},{"type":"paragraph","position":{"start":{"line":204,"column":1},"end":{"line":204,"column":1}},"children":[{"type":"cite","url":"https://pubs.acs.org/doi/suppl/10.1021/jp508805h/suppl_file/jp508805h_si_001.pdf","position":{"start":{"line":204,"column":1},"end":{"line":204,"column":1}},"children":[{"type":"text","value":"Supporting information","position":{"start":{"line":204,"column":1},"end":{"line":204,"column":1}},"key":"asM2mDVtx5"}],"kind":"narrative","label":"Xu_2014","identifier":"https://pubs.acs.org/doi/suppl/10.1021/jp508805h/suppl_file/jp508805h_si_001.pdf","enumerator":"1","key":"timpeVaAZK"},{"type":"text","value":".","position":{"start":{"line":204,"column":1},"end":{"line":204,"column":1}},"key":"uNgk8qnJbG"}],"key":"o7wI9mY7Kw"},{"type":"paragraph","position":{"start":{"line":206,"column":1},"end":{"line":206,"column":1}},"children":[{"type":"text","value":"These are atomic adsorption energies:","position":{"start":{"line":206,"column":1},"end":{"line":206,"column":1}},"key":"CVfUSe3win"}],"key":"giXTlfxAYi"},{"type":"code","lang":"","value":"O + * -> O*","position":{"start":{"line":208,"column":1},"end":{"line":208,"column":1}},"key":"QZY8xsjU97"},{"type":"paragraph","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"children":[{"type":"text","value":"We have to do some work to get comparable numbers from OCP","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"key":"VwfatMAQXC"}],"key":"UzPhr1uDIh"},{"type":"code","lang":"","value":"H2 + 1/2 O2 -> H2O  re1 = -3.03 eV\nH2O + * -> O* + H2  re2   # Get from UMA\nO -> 1/2 O2         re3 = -2.58 eV","position":{"start":{"line":212,"column":1},"end":{"line":214,"column":1}},"key":"GgACRrx4Ta"},{"type":"paragraph","position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"children":[{"type":"text","value":"Then, the adsorption energy for","position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"key":"LydgSzr1YN"}],"key":"r6YxOBBFs6"},{"type":"code","lang":"","value":"O + * -> O*","position":{"start":{"line":218,"column":1},"end":{"line":218,"column":1}},"key":"gQAHLefAWQ"},{"type":"paragraph","position":{"start":{"line":220,"column":1},"end":{"line":220,"column":1}},"children":[{"type":"text","value":"is just re1 + re2 + re3.","position":{"start":{"line":220,"column":1},"end":{"line":220,"column":1}},"key":"Rv0emMkh4m"}],"key":"fVKJKkR4U7"},{"type":"paragraph","position":{"start":{"line":222,"column":1},"end":{"line":222,"column":1}},"children":[{"type":"text","value":"Here we just look at the fcc site on Pt. First, we get the data stored in the paper.","position":{"start":{"line":222,"column":1},"end":{"line":222,"column":1}},"key":"l3nN9Gl30F"}],"key":"si6uAkNSTd"},{"type":"paragraph","position":{"start":{"line":224,"column":1},"end":{"line":224,"column":1}},"children":[{"type":"text","value":"Next we get the structures and compute their energies. Some subtle points are that we have to account for stoichiometry, and normalize the adsorption energy by the number of oxygens.","position":{"start":{"line":224,"column":1},"end":{"line":224,"column":1}},"key":"Jd7G50DgZV"}],"key":"XAUTKl4nAS"}],"key":"lcIbsrj3e1"},{"type":"block","position":{"start":{"line":226,"column":1},"end":{"line":226,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":228,"column":1},"end":{"line":228,"column":1}},"children":[{"type":"text","value":"First we get a reference energy from the paper (PBE, 0.25 ML O on Pt(111)).","position":{"start":{"line":228,"column":1},"end":{"line":228,"column":1}},"key":"brRVu6l6lg"}],"key":"kcY8b6srjF"}],"key":"F7MWiODAf0"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import json\n\nwith open(\"energies.json\") as f:\n    edata = json.load(f)\n\nwith open(\"structures.json\") as f:\n    sdata = json.load(f)\n\nedata[\"Pt\"][\"O\"][\"fcc\"][\"0.25\"]","key":"M2CfkFTu9v"},{"type":"outputs","id":"huaZolBzNmCAZf7ZWfeFP","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"text/plain":{"content":"-4.263842000000002","content_type":"text/plain"}}},"key":"cKU8CAYr2t"}],"key":"s6NSkxnWXt"}],"key":"gL8hUD7Irq"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":242,"column":1},"end":{"line":242,"column":1}},"children":[{"type":"text","value":"Next, we load data from the SI to get the geometry to start from.","position":{"start":{"line":242,"column":1},"end":{"line":242,"column":1}},"key":"P3MZIznB84"}],"key":"eXmX5GLYOM"}],"key":"jC7e8K9vjV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"with open(\"structures.json\") as f:\n    s = json.load(f)\n\nsfcc = s[\"Pt\"][\"O\"][\"fcc\"][\"0.25\"]","key":"gO1A4vJayy"},{"type":"outputs","id":"ynceBf3sYm0EOVyj37zEC","children":[],"key":"nphw9hmSlH"}],"key":"vU16iGiy9o"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":251,"column":1},"end":{"line":251,"column":1}},"children":[{"type":"text","value":"Next, we construct the atomic geometry, run the geometry optimization, and compute the energy.","position":{"start":{"line":251,"column":1},"end":{"line":251,"column":1}},"key":"ErYIZMBAee"}],"key":"p68JHxNahk"}],"key":"YE0P0QAmiC"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"re3 = -2.58  # O -> 1/2 O2         re3 = -2.58 eV\n\nfrom ase import Atoms\n\nadslab = Atoms(sfcc[\"symbols\"], positions=sfcc[\"pos\"], cell=sfcc[\"cell\"], pbc=True)\n\n# Grab just the metal surface atoms\nslab = adslab[adslab.arrays[\"numbers\"] == adslab.arrays[\"numbers\"][0]]\nadsorbates = adslab[~(adslab.arrays[\"numbers\"] == adslab.arrays[\"numbers\"][0])]\nslab.set_calculator(calc)\nopt = BFGS(slab)\nopt.run(fmax=0.05, steps=100)\n\nadslab.set_calculator(calc)\nopt = BFGS(adslab)\n\nopt.run(fmax=0.05, steps=100)\nre2 = (\n    adslab.get_potential_energy()\n    - slab.get_potential_energy()\n    - sum([atomic_reference_energies[x] for x in adsorbates.get_chemical_symbols()])\n)\n\nnO = 0\nfor atom in adslab:\n    if atom.symbol == \"O\":\n        nO += 1\n        re2 += re1 + re3\n\nprint(re2 / nO)","key":"wJ5huysm5G"},{"type":"outputs","id":"U6JmvKdN7LHrsmdpt2r9T","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"/tmp/ipykernel_9883/647904475.py:10: FutureWarning: Please use atoms.calc = calc\n  slab.set_calculator(calc)\n"},"key":"QZsqrvXjo9"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"      Step     Time          Energy          fmax\nBFGS:    0 21:00:43      -82.862062        1.000262\n"},"key":"ErAH2Ix1q9"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    1 21:00:43      -82.918114        0.752920\n"},"key":"D9SWXj98ES"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    2 21:00:43      -83.011694        0.335860\n"},"key":"K6wd4ntJ0r"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    3 21:00:44      -83.016496        0.303120\n"},"key":"Q3Y12sCK2c"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    4 21:00:44      -83.024496        0.224963\nBFGS:    5 21:00:44      -83.030035        0.152567\n"},"key":"XoU4b4qkR9"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    6 21:00:45      -83.033360        0.088624\nBFGS:    7 21:00:45      -83.034469        0.065747\n"},"key":"tvYSMLChd3"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    8 21:00:45      -83.035207        0.068691\nBFGS:    9 21:00:45      -83.035564        0.046755\n"},"key":"u1MfHacUv9"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"/tmp/ipykernel_9883/647904475.py:14: FutureWarning: Please use atoms.calc = calc\n  adslab.set_calculator(calc)\n"},"key":"eWdfVhIEfG"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"      Step     Time          Energy          fmax\nBFGS:    0 21:00:46      -88.770343        0.312348\n"},"key":"mD8LtqAknr"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    1 21:00:46      -88.773631        0.271702\nBFGS:    2 21:00:46      -88.784474        0.104050\n"},"key":"VHH961OVcZ"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    3 21:00:46      -88.786013        0.101458\nBFGS:    4 21:00:46      -88.788552        0.106393\n"},"key":"dDC81WJmr0"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    5 21:00:46      -88.790501        0.089090\nBFGS:    6 21:00:47      -88.791972        0.096438\n"},"key":"HCdEMfbKDE"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    7 21:00:47      -88.792659        0.099421\nBFGS:    8 21:00:47      -88.793181        0.077367\n"},"key":"vyUwtMrfid"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    9 21:00:47      -88.793679        0.036097\n"},"key":"ImX3dgLgBe"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"-4.164115763408824\n"},"key":"mM0exzAqQ1"}],"key":"HckB9rSzJh"}],"key":"IYhJqtZWhU"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":286,"column":1},"end":{"line":286,"column":1}},"children":[{"type":"text","value":"Site correlations","position":{"start":{"line":286,"column":1},"end":{"line":286,"column":1}},"key":"Vzmc6LU6tB"}],"identifier":"site-correlations","label":"Site correlations","html_id":"site-correlations","implicit":true,"key":"bFyxrfrseC"},{"type":"paragraph","position":{"start":{"line":288,"column":1},"end":{"line":288,"column":1}},"children":[{"type":"text","value":"This cell reproduces a portion of a figure in the paper. We compare oxygen adsorption energies in the fcc and hcp sites across metals and coverages. These adsorption energies are highly correlated with each other because the adsorption sites are so similar.","position":{"start":{"line":288,"column":1},"end":{"line":288,"column":1}},"key":"EzcHwyEU14"}],"key":"jysiUtkMOb"},{"type":"paragraph","position":{"start":{"line":290,"column":1},"end":{"line":290,"column":1}},"children":[{"type":"text","value":"At higher coverages, the agreement is not as good. This is likely because the model is extrapolating and needs to be fine-tuned.","position":{"start":{"line":290,"column":1},"end":{"line":290,"column":1}},"key":"cDuWXwVcZo"}],"key":"P9fTZJykWh"}],"key":"r2yPpNChR1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import time\n\nfrom tqdm import tqdm\n\nt0 = time.time()\n\ndata = {\"fcc\": [], \"hcp\": []}\n\nrefdata = {\"fcc\": [], \"hcp\": []}\n\n\nfor metal in [\"Cu\", \"Ag\", \"Pd\", \"Pt\", \"Rh\", \"Ir\"]:\n    print(metal)\n    for site in [\"fcc\", \"hcp\"]:\n        for adsorbate in [\"O\"]:\n            for coverage in tqdm([\"0.25\"]):\n\n                entry = s[metal][adsorbate][site][coverage]\n\n                adslab = Atoms(\n                    entry[\"symbols\"],\n                    positions=entry[\"pos\"],\n                    cell=entry[\"cell\"],\n                    pbc=True,\n                )\n\n                # Grab just the metal surface atoms\n                adsorbates = adslab[\n                    ~(adslab.arrays[\"numbers\"] == adslab.arrays[\"numbers\"][0])\n                ]\n\n                slab = adslab[adslab.arrays[\"numbers\"] == adslab.arrays[\"numbers\"][0]]\n                slab.set_calculator(calc)\n                opt = BFGS(slab)\n                opt.run(fmax=0.05, steps=100)\n\n                adslab.set_calculator(calc)\n                opt = BFGS(adslab)\n                opt.run(fmax=0.05, steps=100)\n\n                re2 = (\n                    adslab.get_potential_energy()\n                    - slab.get_potential_energy()\n                    - sum(\n                        [\n                            atomic_reference_energies[x]\n                            for x in adsorbates.get_chemical_symbols()\n                        ]\n                    )\n                )\n\n                nO = 0\n                for atom in adslab:\n                    if atom.symbol == \"O\":\n                        nO += 1\n                        re2 += re1 + re3\n\n                data[site] += [re2 / nO]\n                refdata[site] += [edata[metal][adsorbate][site][coverage]]\n\nf\"Elapsed time = {time.time() - t0} seconds\"","key":"D67h9T7uC6"},{"type":"outputs","id":"nIp8KuLfu2TW8sV3EuxYk","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Cu\n"},"key":"QftOurakae"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r  0%|          | 0/1 [00:00<?, ?it/s]"},"key":"hbBZMIm0B1"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"/tmp/ipykernel_9883/1356342052.py:33: FutureWarning: Please use atoms.calc = calc\n  slab.set_calculator(calc)\n"},"key":"rFzHDclZHJ"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"      Step     Time          Energy          fmax\nBFGS:    0 21:00:48      -48.910948        0.646351\n"},"key":"UPlvaH6mGq"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    1 21:00:48      -48.934031        0.539303\nBFGS:    2 21:00:48      -49.000044        0.280104\n"},"key":"IVyTBQHQSr"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    3 21:00:48      -49.002374        0.251320\nBFGS:    4 21:00:48      -49.008809        0.158913\n"},"key":"p20n3OdrVv"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    5 21:00:49      -49.013985        0.134407\n"},"key":"s3P85QMfTj"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    6 21:00:49      -49.016868        0.071534\n"},"key":"z5uiuZwcEx"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    7 21:00:49      -49.017634        0.051269\nBFGS:    8 21:00:49      -49.018012        0.047563\n"},"key":"N4R2uo3MUg"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"/tmp/ipykernel_9883/1356342052.py:37: FutureWarning: Please use atoms.calc = calc\n  adslab.set_calculator(calc)\n"},"key":"zYFhCh2SvS"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"      Step     Time          Energy          fmax\nBFGS:    0 21:00:50      -55.204221        0.339047\n"},"key":"bk5kbypquU"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    1 21:00:50      -55.206662        0.267938\n"},"key":"zWhgjfvOyA"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    2 21:00:50      -55.213711        0.160041\n"},"key":"GIwPFVV7TR"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    3 21:00:50      -55.215874        0.166182\n"},"key":"pvs6efxcGG"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    4 21:00:51      -55.219675        0.116685\n"},"key":"rpjh6n8CpJ"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    5 21:00:51      -55.221814        0.079418\n"},"key":"FxWWoUwrIe"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    6 21:00:51      -55.223359        0.075349\n"},"key":"rw34HuxYpO"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    7 21:00:51      -55.224364        0.090285\n"},"key":"SrDq4ZLG5D"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    8 21:00:52      -55.225516        0.098899\n"},"key":"x4fw8c0wcr"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    9 21:00:52      -55.226528        0.068560\n"},"key":"S5LGu0tP1R"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:   10 21:00:52      -55.226977        0.043000\n"},"key":"W7X9KG0v02"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r100%|██████████| 1/1 [00:05<00:00,  5.17s/it]"},"key":"l4awLh2uLP"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r100%|██████████| 1/1 [00:05<00:00,  5.17s/it]"},"key":"jhHk10vJ3F"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\n"},"key":"sL6XHpZurv"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r  0%|          | 0/1 [00:00<?, ?it/s]"},"key":"yDqbqADDcW"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"      Step     Time          Energy          fmax\nBFGS:    0 21:00:53      -48.936503        0.552695\n"},"key":"Ot9HA94MbB"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    1 21:00:53      -48.954084        0.470533\n"},"key":"NnXgrtDMbh"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    2 21:00:53      -49.008577        0.210998\n"},"key":"qljazelgzK"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    3 21:00:54      -49.009768        0.197685\n"},"key":"VMDiUUGozO"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    4 21:00:54      -49.017745        0.041126\n"},"key":"ne4iABDUb9"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"      Step     Time          Energy          fmax\nBFGS:    0 21:00:54      -55.119069        0.305598\n"},"key":"xEuLt4Sv1b"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    1 21:00:54      -55.120918        0.239019\n"},"key":"i465SMcW6a"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    2 21:00:55      -55.125706        0.129148\n"},"key":"FhOfv9QOmR"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    3 21:00:55      -55.127340        0.147607\nBFGS:    4 21:00:55      -55.130398        0.128614\n"},"key":"O7RQNrsAkG"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    5 21:00:55      -55.132307        0.103141\n"},"key":"siwOsILEw3"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    6 21:00:56      -55.133382        0.051683\n"},"key":"pQcRnTfE9p"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    7 21:00:56      -55.133851        0.056053\n"},"key":"op4adENrNC"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    8 21:00:56      -55.134358        0.071228\n"},"key":"nAIoALXLvB"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    9 21:00:56      -55.135043        0.069434\nBFGS:   10 21:00:56      -55.135575        0.039917\n"},"key":"A9LvkWkDRR"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r100%|██████████| 1/1 [00:04<00:00,  4.36s/it]"},"key":"pa0MYb8caC"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r100%|██████████| 1/1 [00:04<00:00,  4.36s/it]"},"key":"bM95DlAHyA"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\n"},"key":"AqAQOume1v"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Ag\n"},"key":"Qru68AuYVT"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r  0%|          | 0/1 [00:00<?, ?it/s]"},"key":"bEcpj1GMLy"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"      Step     Time          Energy          fmax\nBFGS:    0 21:00:57      -33.034314        0.634820\n"},"key":"dKwdZVlRsI"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    1 21:00:57      -33.053470        0.551048\n"},"key":"KAmeyPO9OH"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    2 21:00:58      -33.120905        0.172022\n"},"key":"sI5UfDA44S"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    3 21:00:58      -33.122778        0.157330\n"},"key":"IeNoW45NDN"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    4 21:00:58      -33.124181        0.143386\n"},"key":"xXoDeDVnMc"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    5 21:00:58      -33.126943        0.112458\nBFGS:    6 21:00:59      -33.130772        0.110654\n"},"key":"Og1kGG2rUC"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    7 21:00:59      -33.133994        0.067525\n"},"key":"bt4b5kDoe7"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    8 21:00:59      -33.134832        0.034888\n      Step     Time          Energy          fmax\nBFGS:    0 21:00:59      -38.173509        0.098015\n"},"key":"BuIEKiqb5q"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    1 21:01:00      -38.174435        0.094365\n"},"key":"RTci8pmS4N"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    2 21:01:00      -38.184908        0.084033\nBFGS:    3 21:01:00      -38.185732        0.085433\n"},"key":"xespZ9WmYl"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    4 21:01:00      -38.189035        0.086085\n"},"key":"qBjFAJRCwC"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    5 21:01:01      -38.190951        0.068842\n"},"key":"r7BdqbBUiC"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    6 21:01:01      -38.192256        0.087464\n"},"key":"tu4uBNcwDX"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    7 21:01:01      -38.193188        0.076896\n"},"key":"VJQWfn3WC9"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    8 21:01:01      -38.193673        0.042567\n"},"key":"uEYceqrcOy"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r100%|██████████| 1/1 [00:04<00:00,  4.94s/it]"},"key":"LhS3otXTy3"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r100%|██████████| 1/1 [00:04<00:00,  4.95s/it]"},"key":"bDeNJil6c2"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\n"},"key":"vbFZkd730c"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r  0%|          | 0/1 [00:00<?, ?it/s]"},"key":"U06mDuFe4Z"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"      Step     Time          Energy          fmax\nBFGS:    0 21:01:02      -33.056750        0.557366\n"},"key":"Vu1epzgR3F"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    1 21:01:02      -33.071228        0.489412\nBFGS:    2 21:01:03      -33.126395        0.123825\n"},"key":"LcWk4nkBS6"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    3 21:01:03      -33.127308        0.112960\nBFGS:    4 21:01:03      -33.128515        0.097373\n"},"key":"e6K0dL0e58"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    5 21:01:03      -33.130260        0.079537\n"},"key":"h2gSlxkW6F"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    6 21:01:03      -33.133158        0.076350\n"},"key":"PiEbYHbBIM"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    7 21:01:04      -33.134741        0.040732\n"},"key":"TPVwjRokh0"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"      Step     Time          Energy          fmax\nBFGS:    0 21:01:04      -38.102025        0.092717\n"},"key":"CujNqa4el6"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    1 21:01:04      -38.102856        0.088836\n"},"key":"wRFEOJ7YZY"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    2 21:01:04      -38.111087        0.134659\n"},"key":"VkNtNys2hO"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    3 21:01:05      -38.112012        0.120324\nBFGS:    4 21:01:05      -38.115290        0.063998\n"},"key":"EsE0DpY6EE"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    5 21:01:05      -38.116157        0.056396\n"},"key":"jjwKkziGVo"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    6 21:01:06      -38.116710        0.058201\n"},"key":"RX5QpLdJaS"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    7 21:01:06      -38.117581        0.073154\n"},"key":"cKfZiRWgpt"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    8 21:01:06      -38.118451        0.057885\n"},"key":"QlhadvBGeZ"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    9 21:01:06      -38.118834        0.026047\n"},"key":"GRxsTNgMWp"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r100%|██████████| 1/1 [00:04<00:00,  4.96s/it]"},"key":"UZGfE64UEO"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r100%|██████████| 1/1 [00:04<00:00,  4.96s/it]"},"key":"nsKHw1OUG8"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\n"},"key":"yN3JwmJ1HZ"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Pd\n"},"key":"dqqyVOIYTF"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r  0%|          | 0/1 [00:00<?, ?it/s]"},"key":"yEIQgchJEV"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"      Step     Time          Energy          fmax\nBFGS:    0 21:01:07      -70.165062        0.631446\n"},"key":"yqSHkTx59t"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    1 21:01:07      -70.189910        0.508128\nBFGS:    2 21:01:07      -70.241648        0.191934\n"},"key":"CelVCwTcN1"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    3 21:01:08      -70.243347        0.182565\n"},"key":"RjyCwBw00I"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    4 21:01:08      -70.248576        0.144558\n"},"key":"ALTRodK4aD"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    5 21:01:08      -70.251930        0.115933\n"},"key":"dPS1HMQcu9"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    6 21:01:09      -70.254308        0.074837\n"},"key":"XwHTckho9g"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    7 21:01:09      -70.255205        0.059446\n"},"key":"C3uBTcJhgZ"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    8 21:01:09      -70.255944        0.041108\n"},"key":"Yqh6YMBuN9"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"      Step     Time          Energy          fmax\nBFGS:    0 21:01:09      -76.130241        0.213656\nBFGS:    1 21:01:10      -76.133242        0.190305\n"},"key":"iJS9ZNXSh2"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    2 21:01:10      -76.148718        0.169639\n"},"key":"jcsMPunNgd"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    3 21:01:10      -76.150812        0.152255\n"},"key":"UNbDufAcCw"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    4 21:01:10      -76.154311        0.130504\nBFGS:    5 21:01:11      -76.157057        0.106143\n"},"key":"XwUjs0MkyP"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    6 21:01:11      -76.159303        0.088117\n"},"key":"WXk4b1OUcM"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    7 21:01:11      -76.160430        0.080503\nBFGS:    8 21:01:11      -76.161130        0.064487\n"},"key":"lt9KrZ8jx9"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r100%|██████████| 1/1 [00:04<00:00,  4.83s/it]"},"key":"hu8swmGPWh"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r100%|██████████| 1/1 [00:04<00:00,  4.83s/it]"},"key":"cWZUtuCqBJ"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\n"},"key":"LnjXeC5pMw"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    9 21:01:11      -76.161614        0.042995\n"},"key":"hqhC5LPZS1"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r  0%|          | 0/1 [00:00<?, ?it/s]"},"key":"HSJiRKxV7A"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"      Step     Time          Energy          fmax\nBFGS:    0 21:01:12      -70.197712        0.454636\nBFGS:    1 21:01:12      -70.211776        0.373893\n"},"key":"uZUVpw8zIi"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    2 21:01:12      -70.245977        0.178178\n"},"key":"NnzIVYHSDf"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    3 21:01:12      -70.247162        0.164572\n"},"key":"XHRTDaYneu"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    4 21:01:13      -70.253348        0.078707\nBFGS:    5 21:01:13      -70.254511        0.075507\n"},"key":"JOf9D4ayb7"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    6 21:01:13      -70.255272        0.058127\n"},"key":"iHR0WGHnNR"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    7 21:01:13      -70.255844        0.036952\n"},"key":"MSM6grvOmg"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"      Step     Time          Energy          fmax\nBFGS:    0 21:01:14      -75.892387        0.169440\n"},"key":"dGd3UFfpl8"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    1 21:01:14      -75.895235        0.150799\n"},"key":"nzjkj9MYLw"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    2 21:01:14      -75.906632        0.144106\nBFGS:    3 21:01:14      -75.908424        0.135675\n"},"key":"El6AQJI58H"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    4 21:01:15      -75.912427        0.129023\n"},"key":"EJNjqHS4mx"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    5 21:01:15      -75.915496        0.108687\nBFGS:    6 21:01:15      -75.917929        0.075294\n"},"key":"LWzfe3Gb1Y"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    7 21:01:15      -75.918955        0.067273\n"},"key":"sI9ARHG73w"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r100%|██████████| 1/1 [00:04<00:00,  4.11s/it]"},"key":"gtSBwwpKlv"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r100%|██████████| 1/1 [00:04<00:00,  4.11s/it]"},"key":"YhZJB4GEkz"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\n"},"key":"jYqea7bTK9"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    8 21:01:16      -75.919478        0.044572\nPt\n"},"key":"QqhPB3UIgs"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r  0%|          | 0/1 [00:00<?, ?it/s]"},"key":"jL0R42xkqB"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"      Step     Time          Energy          fmax\nBFGS:    0 21:01:16      -82.862062        1.000262\n"},"key":"Ro0YcvZgVJ"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    1 21:01:16      -82.918113        0.752920\n"},"key":"Km06MrvuM0"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    2 21:01:16      -83.011694        0.335860\n"},"key":"uqrSLESYpm"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    3 21:01:17      -83.016496        0.303120\n"},"key":"KrWWaXZHFD"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    4 21:01:17      -83.024496        0.224963\nBFGS:    5 21:01:17      -83.030036        0.152566\nBFGS:    6 21:01:17      -83.033361        0.088626\n"},"key":"QOIUyQdvHn"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    7 21:01:17      -83.034468        0.065746\nBFGS:    8 21:01:17      -83.035208        0.068690\nBFGS:    9 21:01:17      -83.035564        0.046755\n"},"key":"S7EYv7POZU"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"      Step     Time          Energy          fmax\nBFGS:    0 21:01:18      -88.770343        0.312349\n"},"key":"LwxI3Ocwyo"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    1 21:01:18      -88.773630        0.271703\nBFGS:    2 21:01:18      -88.784473        0.104050\n"},"key":"FFNbsezuIf"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    3 21:01:18      -88.786013        0.101458\nBFGS:    4 21:01:18      -88.788553        0.106391\nBFGS:    5 21:01:18      -88.790503        0.089088\n"},"key":"AE8uWZflM1"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    6 21:01:18      -88.791972        0.096443\nBFGS:    7 21:01:19      -88.792659        0.099421\n"},"key":"SVcatsrAS8"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    8 21:01:19      -88.793179        0.077363\n"},"key":"kESx2Nb7Zt"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r100%|██████████| 1/1 [00:03<00:00,  3.45s/it]"},"key":"JpSdQa6eHU"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r100%|██████████| 1/1 [00:03<00:00,  3.45s/it]"},"key":"USblzKyJX0"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\n"},"key":"nZsBBiJsCl"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    9 21:01:19      -88.793677        0.036093\n"},"key":"ntXKbBCCiW"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r  0%|          | 0/1 [00:00<?, ?it/s]"},"key":"Gu4JreBuct"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"      Step     Time          Energy          fmax\nBFGS:    0 21:01:19      -82.946997        0.675644\n"},"key":"q0dBIO1gTL"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    1 21:01:20      -82.973149        0.546704\n"},"key":"vZoCTamjsM"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    2 21:01:20      -83.026506        0.203005\n"},"key":"zHaiqDLXfn"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    3 21:01:20      -83.028070        0.183991\n"},"key":"vBzjMqhxt7"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    4 21:01:20      -83.033699        0.083394\n"},"key":"aBAgDwLDj3"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    5 21:01:21      -83.034397        0.061070\n"},"key":"vU4B16ESuh"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    6 21:01:21      -83.035121        0.048395\n      Step     Time          Energy          fmax\nBFGS:    0 21:01:21      -88.350562        0.234982\n"},"key":"E19u6r9O0T"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    1 21:01:21      -88.353606        0.203898\n"},"key":"ROOaoWpd6o"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    2 21:01:22      -88.362978        0.117098\n"},"key":"WsYI0zXQVq"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    3 21:01:22      -88.364341        0.121252\n"},"key":"t3YkFPkEPA"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    4 21:01:22      -88.368499        0.090133\nBFGS:    5 21:01:22      -88.370482        0.073281\n"},"key":"RgcwTNY8rU"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    6 21:01:22      -88.371786        0.075210\n"},"key":"cIrGUFyqP6"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    7 21:01:23      -88.372317        0.079581\n"},"key":"LmUA8k5n75"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    8 21:01:23      -88.372730        0.061432\n"},"key":"tJk27CYQwL"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r100%|██████████| 1/1 [00:04<00:00,  4.14s/it]"},"key":"s3o1zLhSzU"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r100%|██████████| 1/1 [00:04<00:00,  4.14s/it]"},"key":"J8ZxrnZZzH"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\n"},"key":"OTRIm615mw"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    9 21:01:23      -88.373020        0.027202\nRh\n"},"key":"AzP2MTgLMJ"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r  0%|          | 0/1 [00:00<?, ?it/s]"},"key":"HO50InIJcP"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"      Step     Time          Energy          fmax\nBFGS:    0 21:01:24     -100.192566        0.688933\n"},"key":"X11XR8yvMj"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    1 21:01:24     -100.218240        0.600213\n"},"key":"YrMM5UHIQi"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    2 21:01:24     -100.286834        0.174739\nBFGS:    3 21:01:24     -100.289767        0.129382\n"},"key":"MJqgM60C3q"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    4 21:01:24     -100.298130        0.066639\nBFGS:    5 21:01:24     -100.299264        0.053478\nBFGS:    6 21:01:25     -100.299778        0.045082\n"},"key":"Sma1kUByM0"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"      Step     Time          Energy          fmax\nBFGS:    0 21:01:25     -106.921794        0.203149\n"},"key":"vsd7OvpskJ"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    1 21:01:25     -106.924541        0.168907\nBFGS:    2 21:01:25     -106.930976        0.052441\n"},"key":"QJJH9JIl4Q"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    3 21:01:25     -106.931584        0.045559\n"},"key":"X1r60u9e26"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r100%|██████████| 1/1 [00:02<00:00,  2.39s/it]"},"key":"v05VGvd5Kz"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r100%|██████████| 1/1 [00:02<00:00,  2.39s/it]"},"key":"alCrqpYN73"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\n"},"key":"YKmq8FMaIM"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r  0%|          | 0/1 [00:00<?, ?it/s]"},"key":"usIVI66g9Y"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"      Step     Time          Energy          fmax\nBFGS:    0 21:01:26     -100.171741        0.714774\n"},"key":"XemyhHfJ3L"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    1 21:01:26     -100.203866        0.626030\n"},"key":"BD23cf74jh"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    2 21:01:26     -100.287845        0.263191\n"},"key":"hjldQMJiLJ"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    3 21:01:27     -100.290543        0.195991\n"},"key":"awTVWH4zpJ"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    4 21:01:27     -100.297165        0.080377\n"},"key":"WhlHKF52pu"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    5 21:01:27     -100.299033        0.056460\nBFGS:    6 21:01:27     -100.299772        0.043871\n"},"key":"xvYlVRjWZ7"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"      Step     Time          Energy          fmax\nBFGS:    0 21:01:28     -106.876840        0.168839\n"},"key":"Jt7spD2HmU"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    1 21:01:28     -106.879420        0.139489\n"},"key":"Nd53Je0fRm"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    2 21:01:28     -106.885549        0.071255\n"},"key":"qNjTpX7nVA"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    3 21:01:28     -106.886238        0.064285\nBFGS:    4 21:01:28     -106.886580        0.054981\n"},"key":"JuMHE3IGfm"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    5 21:01:29     -106.886842        0.043052\n"},"key":"NujyVymUBI"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r100%|██████████| 1/1 [00:03<00:00,  3.28s/it]"},"key":"O6lWizLUnt"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r100%|██████████| 1/1 [00:03<00:00,  3.29s/it]"},"key":"KFplbV5f1P"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\n"},"key":"dOPGOEllAF"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Ir\n"},"key":"miUhGWJvdI"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r  0%|          | 0/1 [00:00<?, ?it/s]"},"key":"lki2DZJo4g"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"      Step     Time          Energy          fmax\nBFGS:    0 21:01:29     -124.235610        1.189926\n"},"key":"kfS6YytqIe"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    1 21:01:29     -124.310841        0.937184\n"},"key":"LsvHpwRWae"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    2 21:01:30     -124.422189        0.140826\nBFGS:    3 21:01:30     -124.425270        0.133780\n"},"key":"TaDaym0Mr8"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    4 21:01:30     -124.429598        0.060640\n"},"key":"R3NIpwzl3d"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    5 21:01:30     -124.430258        0.038670\n"},"key":"BwySMCLQDR"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"      Step     Time          Energy          fmax\nBFGS:    0 21:01:31     -130.605623        0.371645\n"},"key":"eBr0RbhIlO"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    1 21:01:31     -130.616146        0.265890\n"},"key":"NBDBMxznrC"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    2 21:01:31     -130.630316        0.110763\nBFGS:    3 21:01:31     -130.633616        0.094356\n"},"key":"xTorEEhnxg"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    4 21:01:31     -130.634276        0.075693\nBFGS:    5 21:01:31     -130.634990        0.065693\n"},"key":"NRZ6jBuH6D"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    6 21:01:32     -130.636199        0.083039\n"},"key":"RSUmUZsvGP"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    7 21:01:32     -130.636656        0.075131\n"},"key":"cEQkEcJ9nd"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r100%|██████████| 1/1 [00:03<00:00,  3.33s/it]"},"key":"nuuQ325kVI"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r100%|██████████| 1/1 [00:03<00:00,  3.33s/it]"},"key":"keunbPSZ6j"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\n"},"key":"kXclHAYrEQ"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    8 21:01:32     -130.637047        0.047434\n"},"key":"MJ1vWQEmnw"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r  0%|          | 0/1 [00:00<?, ?it/s]"},"key":"iApN9GcLcD"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"      Step     Time          Energy          fmax\nBFGS:    0 21:01:32     -124.227592        1.165685\nBFGS:    1 21:01:32     -124.311475        0.915619\nBFGS:    2 21:01:33     -124.422556        0.165138\n"},"key":"iLA71wqpph"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    3 21:01:33     -124.425478        0.200268\nBFGS:    4 21:01:33     -124.428763        0.168862\n"},"key":"UzNHU7bH25"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    5 21:01:33     -124.430254        0.088400\nBFGS:    6 21:01:33     -124.430559        0.041799\n"},"key":"vXJLOXpDes"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"      Step     Time          Energy          fmax\nBFGS:    0 21:01:33     -130.496158        0.405482\n"},"key":"IRoffaQBs9"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    1 21:01:34     -130.507202        0.266991\n"},"key":"TPFTdm99wa"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    2 21:01:34     -130.518615        0.126414\n"},"key":"f0kRGRiDSR"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    3 21:01:34     -130.522315        0.080268\nBFGS:    4 21:01:34     -130.523181        0.066554\n"},"key":"nQIeS1FI8V"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    5 21:01:35     -130.523452        0.056611\n"},"key":"mgtirI6Nxe"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    6 21:01:35     -130.524510        0.055659\nBFGS:    7 21:01:35     -130.524677        0.042694\n"},"key":"hET2RhiPou"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r100%|██████████| 1/1 [00:03<00:00,  3.05s/it]"},"key":"XkH1R1Hver"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r100%|██████████| 1/1 [00:03<00:00,  3.06s/it]"},"key":"wRxov5MdR6"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\n"},"key":"rA5GO7QcLm"},{"type":"output","children":[],"jupyter_data":{"output_type":"execute_result","execution_count":9,"metadata":{},"data":{"text/plain":{"content":"'Elapsed time = 48.09131479263306 seconds'","content_type":"text/plain"}}},"key":"HKEyRynlCP"}],"key":"Ngica16AA8"}],"key":"ARK5rrzSIB"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":356,"column":1},"end":{"line":356,"column":1}},"children":[{"type":"text","value":"First, we compare the computed data and reference data. There is a systematic difference of about 0.5 eV due to the difference between RPBE and PBE functionals, and other subtle differences like lattice constant differences and reference energy differences. This is pretty typical, and an expected deviation.","position":{"start":{"line":356,"column":1},"end":{"line":356,"column":1}},"key":"zwKgKeq9Om"}],"key":"SY0ouljlpL"}],"key":"A29UZQxZjo"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot(refdata[\"fcc\"], data[\"fcc\"], \"r.\", label=\"fcc\")\nplt.plot(refdata[\"hcp\"], data[\"hcp\"], \"b.\", label=\"hcp\")\nplt.plot([-5.5, -3.5], [-5.5, -3.5], \"k-\")\nplt.xlabel(\"Ref. data (DFT)\")\nplt.ylabel(\"UMA-OC20 prediction\");","key":"P41oXZeoJq"},{"type":"outputs","id":"zcylxvSDQgnI4jWBc0yAy","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"36d850a7ac41e9bd3477161594f52931","path":"/build/36d850a7ac41e9bd3477161594f52931.png"}}},"key":"es4oxvzVvI"}],"key":"clkJDuzNPF"}],"key":"ugiWUZdvmp"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":366,"column":1},"end":{"line":366,"column":1}},"children":[{"type":"text","value":"Next we compare the correlation between the hcp and fcc sites. Here we see the same trends. The data falls below the parity line because the hcp sites tend to be a little weaker binding than the fcc sites.","position":{"start":{"line":366,"column":1},"end":{"line":366,"column":1}},"key":"Df1Vu1RDTD"}],"key":"OuQbf3ztrf"}],"key":"TdDlkj19E1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot(refdata[\"hcp\"], refdata[\"fcc\"], \"r.\")\nplt.plot(data[\"hcp\"], data[\"fcc\"], \".\")\nplt.plot([-6, -1], [-6, -1], \"k-\")\nplt.xlabel(\"$H_{ads, hcp}$\")\nplt.ylabel(\"$H_{ads, fcc}$\")\nplt.legend([\"DFT (PBE)\", \"UMA-OC20\"]);","key":"XndQUZSRUj"},{"type":"outputs","id":"GC4wAiwmlYRWh5a40wJtp","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"0e744ac205735b9263d9c884dbf78d3b","path":"/build/0e744ac205735b9263d9c884dbf78d3b.png"}}},"key":"VlyWLaehnx"}],"key":"R1Woor7wQt"}],"key":"UVn5G9iKse"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":377,"column":1},"end":{"line":377,"column":1}},"children":[{"type":"text","value":"Exercises","position":{"start":{"line":377,"column":1},"end":{"line":377,"column":1}},"key":"WvU9WL5ysw"}],"identifier":"exercises","label":"Exercises","html_id":"exercises-1","implicit":true,"key":"SOx7ArbyEd"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":379,"column":1},"end":{"line":381,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":379,"column":1},"end":{"line":379,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"You can also explore a few other adsorbates: C, H, N.","position":{"start":{"line":379,"column":1},"end":{"line":379,"column":1}},"key":"och1Ak4gf0"}],"key":"eMFntejS3k"}],"key":"V0HXubUqO6"},{"type":"listItem","spread":true,"position":{"start":{"line":380,"column":1},"end":{"line":381,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Explore the higher coverages. The deviations from the reference data are expected to be higher, but relative differences tend to be better. You probably need fine tuning to improve this performance. This data set doesn’t have forces though, so it isn’t practical to do it here.","position":{"start":{"line":380,"column":1},"end":{"line":380,"column":1}},"key":"JbvNFwuWUp"}],"key":"fuoCg7KPhN"}],"key":"gtjQo7MNYa"}],"key":"EsJ3WmJ5gN"}],"key":"XwoqS9whgn"},{"type":"block","position":{"start":{"line":382,"column":1},"end":{"line":382,"column":1}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":384,"column":1},"end":{"line":384,"column":1}},"children":[{"type":"text","value":"Next steps","position":{"start":{"line":384,"column":1},"end":{"line":384,"column":1}},"key":"mpzCY59uJL"}],"identifier":"next-steps","label":"Next steps","html_id":"next-steps","implicit":true,"key":"GTbGGWbSYl"},{"type":"paragraph","position":{"start":{"line":386,"column":1},"end":{"line":386,"column":1}},"children":[{"type":"text","value":"In the next step, we consider some more complex adsorbates in nitrogen reduction, and how we can leverage OCP to automate the search for the most stable adsorbate geometry. See ","position":{"start":{"line":386,"column":1},"end":{"line":386,"column":1}},"key":"YIBJGsYnFH"},{"type":"link","url":"./NRR/NRR_example-gemnet","position":{"start":{"line":386,"column":1},"end":{"line":386,"column":1}},"children":[{"type":"text","value":"the next step","position":{"start":{"line":386,"column":1},"end":{"line":386,"column":1}},"key":"mCI9AmhiTQ"}],"urlSource":"./NRR/NRR_example-gemnet","key":"eikPkz2v1K"},{"type":"text","value":".","position":{"start":{"line":386,"column":1},"end":{"line":386,"column":1}},"key":"Fq2BjQRq7G"}],"key":"uLLLBAC8yE"}],"key":"rKu5WnLkvs"},{"type":"block","position":{"start":{"line":388,"column":1},"end":{"line":388,"column":1}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":391,"column":1},"end":{"line":391,"column":1}},"children":[{"type":"text","value":"Convergence study","position":{"start":{"line":391,"column":1},"end":{"line":391,"column":1}},"key":"DnkPrtOYkQ"}],"label":"convergence-study","identifier":"convergence-study","html_id":"convergence-study","key":"sz9QxdrQNu"},{"type":"paragraph","position":{"start":{"line":393,"column":1},"end":{"line":393,"column":1}},"children":[{"type":"text","value":"In ","position":{"start":{"line":393,"column":1},"end":{"line":393,"column":1}},"key":"Oib7FYirxQ"},{"type":"crossReference","position":{"start":{"line":393,"column":1},"end":{"line":393,"column":1}},"children":[{"type":"text","value":"the adsorption energies section","position":{"start":{"line":393,"column":1},"end":{"line":393,"column":1}},"key":"EgyKXUoQDy"}],"identifier":"intro-to-adsorption-energies","label":"intro-to-adsorption-energies","kind":"heading","template":"{name}","resolved":true,"html_id":"intro-to-adsorption-energies","key":"BtWNwTS5SU"},{"type":"text","value":" we discussed some possible reasons we might see a discrepancy. Here we investigate some factors that impact the computed energies.","position":{"start":{"line":393,"column":1},"end":{"line":393,"column":1}},"key":"YM4nwON01U"}],"key":"MnYW95JNBv"},{"type":"paragraph","position":{"start":{"line":395,"column":1},"end":{"line":395,"column":1}},"children":[{"type":"text","value":"In this section, the energies refer to the reaction 1/2 O2 -> O*.","position":{"start":{"line":395,"column":1},"end":{"line":395,"column":1}},"key":"twSBSooB7O"}],"key":"idzElC2s5a"}],"key":"attLV123da"},{"type":"block","position":{"start":{"line":397,"column":1},"end":{"line":397,"column":1}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":399,"column":1},"end":{"line":399,"column":1}},"children":[{"type":"text","value":"Effects of number of layers","position":{"start":{"line":399,"column":1},"end":{"line":399,"column":1}},"key":"JUWRDdUSET"}],"identifier":"effects-of-number-of-layers","label":"Effects of number of layers","html_id":"effects-of-number-of-layers","implicit":true,"key":"i5yqeDH6bO"},{"type":"paragraph","position":{"start":{"line":401,"column":1},"end":{"line":401,"column":1}},"children":[{"type":"text","value":"Slab thickness could be a factor. Here we relax the whole slab, and see by about 4 layers the energy is converged to ~0.02 eV.","position":{"start":{"line":401,"column":1},"end":{"line":401,"column":1}},"key":"qCw5lQfNCl"}],"key":"SgWdqMIN87"}],"key":"LourEx44Oe"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"for nlayers in [3, 4, 5, 6, 7, 8]:\n    slab = fcc111(\"Pt\", size=(2, 2, nlayers), vacuum=10.0)\n\n    slab.pbc = True\n    slab.set_calculator(calc)\n    opt_slab = BFGS(slab, logfile=None)\n    opt_slab.run(fmax=0.05, steps=100)\n    slab_e = slab.get_potential_energy()\n\n    adslab = slab.copy()\n    add_adsorbate(adslab, \"O\", height=1.2, position=\"fcc\")\n\n    adslab.pbc = True\n    adslab.set_calculator(calc)\n    opt_adslab = BFGS(adslab, logfile=None)\n    opt_adslab.run(fmax=0.05, steps=100)\n    adslab_e = adslab.get_potential_energy()\n\n    print(\n        f\"nlayers = {nlayers}: {adslab_e - slab_e - atomic_reference_energies['O'] + re1:1.2f} eV\"\n    )","key":"jtHquFIzH0"},{"type":"outputs","id":"yzRsPlAQnUNfpJHxD7VhI","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"/tmp/ipykernel_9883/338101817.py:5: FutureWarning: Please use atoms.calc = calc\n  slab.set_calculator(calc)\n"},"key":"kcWekWdGWb"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"/tmp/ipykernel_9883/338101817.py:14: FutureWarning: Please use atoms.calc = calc\n  adslab.set_calculator(calc)\n"},"key":"dPVUGO2163"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"nlayers = 3: -1.58 eV\n"},"key":"s1y5bmckM0"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"nlayers = 4: -1.47 eV\n"},"key":"mQ4okRnMkB"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"nlayers = 5: -1.47 eV\n"},"key":"MuyNfM06fy"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"nlayers = 6: -1.46 eV\n"},"key":"q6M6wdICRy"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"nlayers = 7: -1.47 eV\n"},"key":"THXEpUiIKu"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"nlayers = 8: -1.47 eV\n"},"key":"CBZlfuByKh"}],"key":"vGry8zNZQp"}],"key":"OQaDNZ8Ts2"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":427,"column":1},"end":{"line":427,"column":1}},"children":[{"type":"text","value":"Effects of relaxation","position":{"start":{"line":427,"column":1},"end":{"line":427,"column":1}},"key":"L7MQakTFSO"}],"identifier":"effects-of-relaxation","label":"Effects of relaxation","html_id":"effects-of-relaxation","implicit":true,"key":"FxWSpNYrUZ"},{"type":"paragraph","position":{"start":{"line":429,"column":1},"end":{"line":429,"column":1}},"children":[{"type":"text","value":"It is common to only relax a few layers, and constrain lower layers to bulk coordinates. We do that here. We only relax the adsorbate and the top layer.","position":{"start":{"line":429,"column":1},"end":{"line":429,"column":1}},"key":"cTgC5qmU5y"}],"key":"SlOIwVfZOp"},{"type":"paragraph","position":{"start":{"line":431,"column":1},"end":{"line":431,"column":1}},"children":[{"type":"text","value":"This has a small effect (0.1 eV).","position":{"start":{"line":431,"column":1},"end":{"line":431,"column":1}},"key":"FhSIbn6hLR"}],"key":"zHqQtJJ41s"}],"key":"Z9F3bayMNx"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from ase.constraints import FixAtoms\n\nfor nlayers in [3, 4, 5, 6, 7, 8]:\n    slab = fcc111(\"Pt\", size=(2, 2, nlayers), vacuum=10.0)\n\n    slab.set_constraint(FixAtoms(mask=[atom.tag > 1 for atom in slab]))\n    slab.pbc = True\n    slab.set_calculator(calc)\n    opt_slab = BFGS(slab, logfile=None)\n    opt_slab.run(fmax=0.05, steps=100)\n    slab_e = slab.get_potential_energy()\n\n    adslab = slab.copy()\n    add_adsorbate(adslab, \"O\", height=1.2, position=\"fcc\")\n\n    adslab.set_constraint(FixAtoms(mask=[atom.tag > 1 for atom in adslab]))\n    adslab.pbc = True\n    adslab.set_calculator(calc)\n    opt_adslab = BFGS(adslab, logfile=None)\n    opt_adslab.run(fmax=0.05, steps=100)\n    adslab_e = adslab.get_potential_energy()\n\n    print(\n        f\"nlayers = {nlayers}: {adslab_e - slab_e - atomic_reference_energies['O'] + re1:1.2f} eV\"\n    )","key":"t1wSp642l3"},{"type":"outputs","id":"oHiNia8SxQT1PFrBJ9i15","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"/tmp/ipykernel_9883/1426773950.py:8: FutureWarning: Please use atoms.calc = calc\n  slab.set_calculator(calc)\n"},"key":"God9eerHJB"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"/tmp/ipykernel_9883/1426773950.py:18: FutureWarning: Please use atoms.calc = calc\n  adslab.set_calculator(calc)\n"},"key":"nlxUbOf5R2"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"nlayers = 3: -1.47 eV\n"},"key":"ExfMSOOFpJ"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"nlayers = 4: -1.35 eV\n"},"key":"AR5OLFChVM"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"nlayers = 5: -1.35 eV\n"},"key":"ZUTHPDVnnG"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"nlayers = 6: -1.34 eV\n"},"key":"JFeccYit7r"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"nlayers = 7: -1.35 eV\n"},"key":"MyQcCM54ap"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"nlayers = 8: -1.35 eV\n"},"key":"VIUML9TVcd"}],"key":"i2JDblH7Hg"}],"key":"YmysthVIkC"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":461,"column":1},"end":{"line":461,"column":1}},"children":[{"type":"text","value":"Unit cell size","position":{"start":{"line":461,"column":1},"end":{"line":461,"column":1}},"key":"rFnIMbSY5X"}],"identifier":"unit-cell-size","label":"Unit cell size","html_id":"unit-cell-size","implicit":true,"key":"sdNRxmqgbD"},{"type":"paragraph","position":{"start":{"line":463,"column":1},"end":{"line":463,"column":1}},"children":[{"type":"text","value":"Coverage effects are quite noticeable with oxygen. Here we consider larger unit cells. This effect is large, and the results don’t look right, usually adsorption energies get more favorable at lower coverage, not less. This suggests fine-tuning could be important even at low coverages.","position":{"start":{"line":463,"column":1},"end":{"line":463,"column":1}},"key":"FHhgGqa7lw"}],"key":"A0WtgbHTBD"}],"key":"SPnkJ2tMwf"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"for size in [1, 2, 3, 4, 5]:\n\n    slab = fcc111(\"Pt\", size=(size, size, 5), vacuum=10.0)\n\n    slab.set_constraint(FixAtoms(mask=[atom.tag > 1 for atom in slab]))\n    slab.pbc = True\n    slab.set_calculator(calc)\n    opt_slab = BFGS(slab, logfile=None)\n    opt_slab.run(fmax=0.05, steps=100)\n    slab_e = slab.get_potential_energy()\n\n    adslab = slab.copy()\n    add_adsorbate(adslab, \"O\", height=1.2, position=\"fcc\")\n\n    adslab.set_constraint(FixAtoms(mask=[atom.tag > 1 for atom in adslab]))\n    adslab.pbc = True\n    adslab.set_calculator(calc)\n    opt_adslab = BFGS(adslab, logfile=None)\n    opt_adslab.run(fmax=0.05, steps=100)\n    adslab_e = adslab.get_potential_energy()\n\n    print(\n        f\"({size}x{size}): {adslab_e - slab_e - atomic_reference_energies['O'] + re1:1.2f} eV\"\n    )","key":"OIPcRCiAMU"},{"type":"outputs","id":"UQMH7DNjJaLwHuO8oXWEo","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"/tmp/ipykernel_9883/3371624330.py:7: FutureWarning: Please use atoms.calc = calc\n  slab.set_calculator(calc)\n"},"key":"vDiXmXaRTb"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"/tmp/ipykernel_9883/3371624330.py:17: FutureWarning: Please use atoms.calc = calc\n  adslab.set_calculator(calc)\n"},"key":"KhsuifVhB9"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"(1x1): -0.12 eV\n"},"key":"L4zN0qwITW"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"(2x2): -1.35 eV\n"},"key":"wQCG2TsjQU"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"(3x3): -1.38 eV\n"},"key":"DQolSooga2"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"(4x4): -1.41 eV\n"},"key":"HeG8zbv8Ny"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"(5x5): -1.42 eV\n"},"key":"X1ZTWiVV7F"}],"key":"rvcmCotF0G"}],"key":"z4Xs7Amr5z"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":492,"column":1},"end":{"line":492,"column":1}},"children":[{"type":"text","value":"Summary","position":{"start":{"line":492,"column":1},"end":{"line":492,"column":1}},"key":"hXIUyBJV5h"}],"identifier":"summary","label":"Summary","html_id":"summary","implicit":true,"key":"Q1GS8upd5E"},{"type":"paragraph","position":{"start":{"line":494,"column":1},"end":{"line":494,"column":1}},"children":[{"type":"text","value":"As with DFT, you should take care to see how these kinds of decisions affect your results, and determine if they would change any interpretations or not.","position":{"start":{"line":494,"column":1},"end":{"line":494,"column":1}},"key":"l6RsQeNGzl"}],"key":"RTzJvX1W9D"}],"key":"yZjRxKO1hL"}],"key":"eQ7PsuoO00"},"references":{"cite":{"order":["Xu_2014"],"data":{"Xu_2014":{"label":"Xu_2014","enumerator":"1","doi":"10.1021/jp508805h","html":"Xu, Z., & Kitchin, J. R. (2014). Probing the Coverage Dependence of Site and Adsorbate Configurational Correlations on (111) Surfaces of Late Transition Metals. <i>The Journal of Physical Chemistry C</i>, <i>118</i>(44), 25597–25602. <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.1021/jp508805h\">10.1021/jp508805h</a>","url":"https://doi.org/10.1021/jp508805h"}}}},"footer":{"navigation":{"prev":{"title":"Examples & Tutorials","url":"/summary-4","group":"Heterogeneous Catalysis"},"next":{"title":"Expert Adsorption Energies","url":"/adsorption-energies","group":"Heterogeneous Catalysis"}}},"domain":"http://localhost:3000"}