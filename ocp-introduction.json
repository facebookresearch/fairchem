{"version":3,"kind":"Notebook","sha256":"c74d4534c2d261d3b457cc172f3925a9d06f4b9abbc11220cab7eed35a1343ef","slug":"ocp-introduction","location":"/catalysts/examples_tutorials/OCP-introduction.md","dependencies":[],"frontmatter":{"title":"Intro to Adsorption Energies","kernelspec":{"name":"python3","display_name":"Python 3 (ipykernel)","language":"python"},"jupytext":{"formats":"md:myst,ipynb","text_representation":{"extension":".md","format_name":"myst","format_version":"0.13","jupytext_version":"1.17.1"}},"content_includes_title":false,"authors":[{"nameParsed":{"literal":"FAIR Chemistry & Collaborators","given":"FAIR Chemistry &","family":"Collaborators"},"name":"FAIR Chemistry & Collaborators","id":"contributors-myst-generated-uid-0"}],"github":"https://github.com/facebookresearch/fairchem","copyright":"Meta Platforms, Inc","numbering":{"title":{"offset":2}},"source_url":"https://github.com/facebookresearch/fairchem/blob/main/docs/catalysts/examples_tutorials/OCP-introduction.md","edit_url":"https://github.com/facebookresearch/fairchem/edit/main/docs/catalysts/examples_tutorials/OCP-introduction.md","exports":[{"format":"md","filename":"OCP-introduction.md","url":"/build/OCP-introduction-e8d0c283f2e873c9edaadee49b1ae584.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"card","children":[{"type":"cardTitle","children":[{"type":"text","value":"Tutorial Overview","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"yMlLYiyw4P"}],"key":"MCCpXiKu4J"},{"type":"table","position":{"start":{"line":19,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"tableRow","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"tableCell","header":true,"position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"Property","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"lAdm2sndZk"}],"key":"oscGpQAFOR"},{"type":"tableCell","header":true,"position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"Value","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"CR9dlBgo5I"}],"key":"asCGlFiDVE"}],"key":"mV7QMsYQVf"},{"type":"tableRow","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"strong","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"Difficulty","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"Gpu4f7VqVC"}],"key":"zUFNcaE7ZC"}],"key":"zM8tKq8Noe"},{"type":"tableCell","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"Beginner","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"tHthEB4CIJ"}],"key":"UFtsxYM3sW"}],"key":"R07moPrOud"},{"type":"tableRow","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"strong","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"Time","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"J3hY8Lr1ld"}],"key":"FKKVGu2Mu7"}],"key":"s6So2D8zDg"},{"type":"tableCell","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"15-30 minutes","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"tCoqhMt28X"}],"key":"jiDLDussgw"}],"key":"cgU6OX4aXs"},{"type":"tableRow","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"strong","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"Prerequisites","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"PNj3b6WLwx"}],"key":"fAExt5Q1LG"}],"key":"f0u06btZHW"},{"type":"tableCell","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"Basic Python, familiarity with ASE","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"zw1juxLpsD"}],"key":"KEjChWLF0H"}],"key":"eoYUDocTqz"},{"type":"tableRow","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"strong","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"Goal","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"U8iNAJAqtv"}],"key":"RN2VNnhDJP"}],"key":"WJfYoarVBG"},{"type":"tableCell","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"Calculate adsorption energies using UMA models","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"LpBOKMDvOS"}],"key":"etTIob2bgD"}],"key":"gE3lDVoy4a"}],"key":"ikx7wWXQ7x"}],"key":"cyOHNxbXR9"},{"type":"paragraph","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"text","value":"To introduce OCP we start with using it to calculate adsorption energies for a simple, atomic adsorbate where we specify the site we want to the adsorption energy for. Conceptually, you do this like you would do it with density functional theory. You create a slab model for the surface, place an adsorbate on it as an initial guess, run a relaxation to get the lowest energy geometry, and then compute the adsorption energy using reference states for the adsorbate.","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"XQ6TCJqTU5"}],"key":"ciolP4Bobv"},{"type":"admonition","kind":"important","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Important","key":"zqfe3duweF"}],"key":"QSb1Q5yXoK"},{"type":"paragraph","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"text","value":"Some OCP model/checkpoint combinations return a total energy like density functional theory would, but some return an “adsorption energy” directly. You have to know which one you are using. In this example, the model we use returns an “adsorption energy”.","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"pGnyf4qIpV"}],"key":"nrqkrhvkJi"}],"key":"DVr6mpwoVN"}],"key":"U2CnNfAVzD"},{"type":"block","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"text","value":"Intro to Adsorption energies","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"xKfB8PeGjN"}],"label":"intro-to-adsorption-energies","identifier":"intro-to-adsorption-energies","html_id":"intro-to-adsorption-energies","key":"eVwS3b4XD5"},{"type":"paragraph","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"children":[{"type":"text","value":"Adsorption energies are always a reaction energy (an adsorbed species relative to some implied combination of reactants). There are many common schemes in the catalysis literature.","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"key":"Nrp9HAsCOw"}],"key":"nFpXSUP4nQ"},{"type":"paragraph","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"children":[{"type":"text","value":"For example, you may want the adsorption energy of oxygen, and you might compute that from this reaction:","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"aXENTeinNj"}],"key":"XPPYjdhw8U"},{"type":"code","lang":"","value":"1/2 O2 + slab -> slab-O","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"key":"jcd2J9xzzZ"},{"type":"paragraph","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"children":[{"type":"text","value":"DFT has known errors with the energy of a gas-phase O2 molecule, so it’s more common to compute this energy relative to a linear combination of H2O and H2. The suggested reference scheme for consistency with OC20 is a reaction","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"key":"Q0dufu0d3t"}],"key":"WJTGjdYoxg"},{"type":"code","lang":"","value":"x CO + (x + y/2 - z) H2 + (z-x) H2O + w/2 N2 + * -> CxHyOzNw*","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"key":"uXBJvbTwys"},{"type":"paragraph","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"children":[{"type":"text","value":"Here, x=y=w=0, z=1, so the reaction ends up as","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"PH0gxLzCTJ"}],"key":"osLvFJiLnk"},{"type":"code","lang":"","value":"-H2 + H2O + * -> O*","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"vHYH3OZhd5"},{"type":"paragraph","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"children":[{"type":"text","value":"or alternatively,","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"key":"fmYdATIpQr"}],"key":"iDEKTiUlpN"},{"type":"code","lang":"","value":"H2O + * -> O* + H2","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"key":"ZrlX22x2sR"},{"type":"paragraph","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"children":[{"type":"text","value":"It is possible through thermodynamic cycles to compute other reactions. If we can look up rH1 below and compute rH2","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"jcWK4S5MqN"}],"key":"rnR3Bcou5V"},{"type":"code","lang":"","value":"H2 + 1/2 O2 -> H2O  re1 = -3.03 eV, from exp\nH2O + * -> O* + H2  re2  # Get from UMA","position":{"start":{"line":58,"column":1},"end":{"line":59,"column":1}},"key":"LlD66PZ7U2"},{"type":"paragraph","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"children":[{"type":"text","value":"Then, the adsorption energy for","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"q10wAPnM8C"}],"key":"IiJ6knAWcA"},{"type":"code","lang":"","value":"1/2O2 + * -> O*","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"key":"YqPAgGsD1u"},{"type":"paragraph","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"children":[{"type":"text","value":"is just re1 + re2.","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"rpw7grN5FG"}],"key":"uWVSsaMvq5"},{"type":"paragraph","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"children":[{"type":"text","value":"Based on ","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"eendYbwJjt"},{"type":"link","url":"https://atct.anl.gov/Thermochemical%20Data/version%201.118/species/?species_number=986","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"children":[{"type":"text","value":"https://atct.anl.gov/Thermochemical Data/version 1.118/species/?species_number=986","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"pRug4bGLUI"}],"urlSource":"https://atct.anl.gov/Thermochemical%20Data/version%201.118/species/?species_number=986","key":"V6rMAmxWjk"},{"type":"text","value":", the formation energy of water is about -3.03 eV at standard state experimentally. You could also compute this using DFT, but you would probably get the wrong answer for this.","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"w8SqxUgYOH"}],"key":"DH74AuhdL3"},{"type":"paragraph","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"children":[{"type":"text","value":"The first step is getting a checkpoint for the model we want to use. UMA is currently the state-of-the-art model and will provide total energy estimates at the RPBE level of theory if you use the “OC20” task.","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"key":"aLP23JQoJg"}],"key":"Yev0BHvW1i"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Need to install fairchem-core or get UMA access or getting permissions/401 errors?","position":{"start":{"line":72,"column":1},"end":{"line":72,"column":1}},"key":"tq6HF0Xoty"}],"key":"GMTzaEVKxm"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Install the necessary packages using pip, uv etc","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"key":"QBbO19QKh5"}],"key":"MDrKwgNpQU"}],"key":"SbvZr7dtnk"}],"key":"tdnzwlpw4n"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"! pip install fairchem-core fairchem-data-oc fairchem-applications-cattsunami","visibility":"show","key":"TqofmMbK3Z"},{"type":"outputs","id":"Aw72F9Ul12KvEUcJdh6aS","children":[],"visibility":"show","key":"Yc5D5Ga0sB"}],"data":{"tags":["skip-execution"]},"visibility":"show","key":"pkob5gKg8Z"},{"type":"list","ordered":true,"start":2,"spread":false,"position":{"start":{"line":83,"column":1},"end":{"line":88,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":83,"column":1},"end":{"line":88,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Get access to any necessary huggingface gated models","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"key":"trt4MImGMI"}],"key":"VPUOqom1Ug"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":84,"column":1},"end":{"line":88,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Get and login to your Huggingface account","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"key":"Lk1OXBd5vW"}],"key":"pgneBGjJZk"}],"key":"rYyEBO1DbH"},{"type":"listItem","spread":true,"position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Request access to ","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"key":"QIBjIFZSG0"},{"type":"link","url":"https://huggingface.co/facebook/UMA","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"children":[{"type":"text","value":"https://​huggingface​.co​/facebook​/UMA","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"key":"JeewTIEy6x"}],"urlSource":"https://huggingface.co/facebook/UMA","key":"Gr8Cu2Z99h"}],"key":"RdrwtCu343"}],"key":"bO3FT2k2ym"},{"type":"listItem","spread":true,"position":{"start":{"line":86,"column":1},"end":{"line":86,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Create a Huggingface token at ","position":{"start":{"line":86,"column":1},"end":{"line":86,"column":1}},"key":"J1jGywnFbe"},{"type":"link","url":"https://huggingface.co/settings/tokens/","position":{"start":{"line":86,"column":1},"end":{"line":86,"column":1}},"children":[{"type":"text","value":"https://​huggingface​.co​/settings​/tokens/","position":{"start":{"line":86,"column":1},"end":{"line":86,"column":1}},"key":"MxOqLjJHhw"}],"urlSource":"https://huggingface.co/settings/tokens/","key":"HQjWBR1kcz"},{"type":"text","value":" with the permission “Permissions: Read access to contents of all public gated repos you can access”","position":{"start":{"line":86,"column":1},"end":{"line":86,"column":1}},"key":"igQinKquI1"}],"key":"ayuocfi9rU"}],"key":"CoITlEwtr8"},{"type":"listItem","spread":true,"position":{"start":{"line":87,"column":1},"end":{"line":88,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Add the token as an environment variable using ","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"TExdNm3pbV"},{"type":"inlineCode","value":"huggingface-cli login","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"JuLKx0IR09"},{"type":"text","value":" or by setting the HF_TOKEN environment variable.","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"SdoWK5mEeo"}],"key":"tsyrxu5VIX"}],"key":"OondJBxcJB"}],"key":"upPlPSCDx1"}],"key":"sZf10Dmzi2"}],"key":"pWkZS7FPtn"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Login using the huggingface-cli utility\n! huggingface-cli login\n\n# alternatively,\nimport os\nos.environ['HF_TOKEN'] = 'MY_TOKEN'","visibility":"show","key":"WFKv5MDgSR"},{"type":"outputs","id":"7G8psfwJ2o7kLUkIb3XXI","children":[],"visibility":"show","key":"xt8MVVH4le"}],"data":{"tags":["skip-execution"]},"visibility":"show","key":"UTtF63WLH5"}],"class":"dropdown","key":"Z9cFUkLzTX"},{"type":"paragraph","position":{"start":{"line":102,"column":1},"end":{"line":102,"column":1}},"children":[{"type":"text","value":"If you find your kernel is crashing, it probably means you have exceeded the allowed amount of memory. This checkpoint works fine in this example, but it may crash your kernel if you use it in the NRR example.","position":{"start":{"line":102,"column":1},"end":{"line":102,"column":1}},"key":"mWvQvhn3jq"}],"key":"fLJgAOZ3fP"},{"type":"paragraph","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"children":[{"type":"text","value":"This next cell will automatically download the checkpoint from huggingface and load it.","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"key":"aIDTbuVqDr"}],"key":"NWG3iIwMT0"}],"key":"kDOmTCIrRT"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from __future__ import annotations\n\nfrom fairchem.core import FAIRChemCalculator, pretrained_mlip\n\npredictor = pretrained_mlip.get_predict_unit(\"uma-s-1p1\")\ncalc = FAIRChemCalculator(predictor, task_name=\"oc20\")","key":"LLwdWGEte3"},{"type":"outputs","id":"e3kk4kNSdSg6rykdoXC3B","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"WARNING:root:device was not explicitly set, using device='cuda'.\n"},"key":"ddPKWDwz7J"}],"key":"oNtKOAb8Nw"}],"key":"mPiXlP7ZPS"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"children":[{"type":"text","value":"Next we can build a slab with an adsorbate on it. Here we use the ASE module to build a Pt slab. We use the experimental lattice constant that is the default. This can introduce some small errors with DFT since the lattice constant can differ by a few percent, and it is common to use DFT lattice constants. In this example, we do not constrain any layers.","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"key":"rNExYnCmFb"}],"key":"HEqUe0oeRD"}],"key":"OU37eu9Kas"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from ase.build import add_adsorbate, fcc111\nfrom ase.optimize import BFGS","key":"ibb9kSJv0P"},{"type":"outputs","id":"DeynTUesH6p_Y3rFKHTTN","children":[],"key":"wYL3rCKtVo"}],"key":"zDmzKqNEkn"},{"type":"block","children":[],"key":"QSIfl24GtB"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# reference energies from a linear combination of H2O/N2/CO/H2!\natomic_reference_energies = {\n    \"H\": -3.477,\n    \"N\": -8.083,\n    \"O\": -7.204,\n    \"C\": -7.282,\n}\n\nre1 = -3.03\n\nslab = fcc111(\"Pt\", size=(2, 2, 5), vacuum=20.0)\nslab.pbc = True\n\nadslab = slab.copy()\nadd_adsorbate(adslab, \"O\", height=1.2, position=\"fcc\")\n\nslab.set_calculator(calc)\nopt = BFGS(slab)\nopt.run(fmax=0.05, steps=100)\nslab_e = slab.get_potential_energy()\n\nadslab.set_calculator(calc)\nopt = BFGS(adslab)\nopt.run(fmax=0.05, steps=100)\nadslab_e = adslab.get_potential_energy()\n\n# Energy for ((H2O-H2) + * -> *O) + (H2 + 1/2O2 -> H2) leads to 1/2O2 + * -> *O!\nadslab_e - slab_e - atomic_reference_energies[\"O\"] + re1","key":"unWCvrAqE4"},{"type":"outputs","id":"dpHNhUyLuxISikmUEi23g","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"/tmp/ipykernel_9849/3752951811.py:17: FutureWarning: Please use atoms.calc = calc\n  slab.set_calculator(calc)\n"},"key":"itKQeEUK5z"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"      Step     Time          Energy          fmax\nBFGS:    0 21:12:15     -104.695194        0.709590\n"},"key":"nVxLrTgbDJ"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    1 21:12:15     -104.753187        0.607748\nBFGS:    2 21:12:15     -104.906056        0.369388\n"},"key":"aqNP9IFkJK"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    3 21:12:16     -104.938754        0.439755\nBFGS:    4 21:12:16     -105.016142        0.464014\n"},"key":"mNhxIJFmki"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    5 21:12:16     -105.076559        0.356061\nBFGS:    6 21:12:16     -105.112621        0.189419\n"},"key":"vafNBQZCVx"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    7 21:12:16     -105.126759        0.045372\n"},"key":"cLs8tBj9i3"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"/tmp/ipykernel_9849/3752951811.py:22: FutureWarning: Please use atoms.calc = calc\n  adslab.set_calculator(calc)\n"},"key":"tyiNQBpqwz"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"      Step     Time          Energy          fmax\nBFGS:    0 21:12:16     -110.048789        1.757515\n"},"key":"BtXgekaTp1"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    1 21:12:17     -110.230721        0.986276\n"},"key":"lH8NPEzpUH"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    2 21:12:17     -110.379353        0.731503\n"},"key":"PHq5afmqK7"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    3 21:12:17     -110.430289        0.807337\n"},"key":"VGinQmKsp7"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    4 21:12:17     -110.543668        0.692010\n"},"key":"VOSkrXERdW"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    5 21:12:18     -110.617475        0.492774\nBFGS:    6 21:12:18     -110.673456        0.666984\n"},"key":"fcKlbErsjJ"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    7 21:12:18     -110.721680        0.710515\n"},"key":"xXHpuFmob7"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    8 21:12:18     -110.756899        0.443885\n"},"key":"O2aO63XttE"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    9 21:12:19     -110.769294        0.214544\nBFGS:   10 21:12:19     -110.772450        0.091737\n"},"key":"L26v0sHGmN"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:   11 21:12:19     -110.772963        0.062463\n"},"key":"ytBODTCgv9"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:   12 21:12:19     -110.773257        0.046207\n"},"key":"v7dAydGViW"},{"type":"output","children":[],"jupyter_data":{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"text/plain":{"content":"-1.4724986750909532","content_type":"text/plain"}}},"key":"YbFOU2DeKj"}],"key":"cXQoUHBLDM"}],"key":"fRLhrvUpTC"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":153,"column":1},"end":{"line":153,"column":1}},"children":[{"type":"text","value":"It is good practice to look at your geometries to make sure they are what you expect.","position":{"start":{"line":153,"column":1},"end":{"line":153,"column":1}},"key":"kYXaeo853C"}],"key":"URX8u2k8cr"}],"key":"h6b0XLlKr2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import matplotlib.pyplot as plt\nfrom ase.visualize.plot import plot_atoms\n\nfig, axs = plt.subplots(1, 2)\nplot_atoms(slab, axs[0])\nplot_atoms(slab, axs[1], rotation=(\"-90x\"))\naxs[0].set_axis_off()\naxs[1].set_axis_off()","key":"IEpGZYKQqI"},{"type":"outputs","id":"RVTCLfP9XtPkMqC70-o16","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 640x480 with 2 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"3c445517a3a357776672cacd9e9d68c5","path":"/build/3c445517a3a357776672cacd9e9d68c5.png"}}},"key":"xIeLd8FybI"}],"key":"JgXW9Zl8nA"}],"key":"kVsci9bEUM"},{"type":"block","children":[],"key":"wvno57kPP0"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import matplotlib.pyplot as plt\nfrom ase.visualize.plot import plot_atoms\n\nfig, axs = plt.subplots(1, 2)\nplot_atoms(adslab, axs[0])\nplot_atoms(adslab, axs[1], rotation=(\"-90x\"))\naxs[0].set_axis_off()\naxs[1].set_axis_off()","key":"SFKfjdjBsh"},{"type":"outputs","id":"FVh4vojsOLNBE6-XCQbKC","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 640x480 with 2 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"f7b51c709af60fa4f5a96e6f35b718df","path":"/build/f7b51c709af60fa4f5a96e6f35b718df.png"}}},"key":"M7KOhIvj97"}],"key":"H4ScbhYIrO"}],"key":"e5BYj8HBKB"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":177,"column":1},"end":{"line":177,"column":1}},"children":[{"type":"text","value":"How did we do? We need a reference point. In the paper below, there is an atomic adsorption energy for O on Pt(111) of about -4.264 eV. This is for the reaction O + * -> O*. To convert this to the dissociative adsorption energy, we have to add the reaction:","position":{"start":{"line":177,"column":1},"end":{"line":177,"column":1}},"key":"JX9pWjo7yk"}],"key":"YNBShHnjfe"},{"type":"code","lang":"","value":"1/2 O2 -> O   D = 2.58 eV (expt)","position":{"start":{"line":179,"column":1},"end":{"line":179,"column":1}},"key":"EXo3Afzzdd"},{"type":"paragraph","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"children":[{"type":"text","value":"to get a comparable energy of about -1.68 eV. There is about ~0.2 eV difference (we predicted -1.47 eV above, and the reference comparison is -1.68 eV) to account for. The biggest difference is likely due to the differences in exchange-correlation functional. The reference data used the PBE functional, and eSCN was trained on ","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"I1Y399Vh9j"},{"type":"emphasis","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"children":[{"type":"text","value":"RPBE","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"nMz2GHR9qw"}],"key":"yDPLoFVvbB"},{"type":"text","value":" data. To additional places where there are differences include:","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"SEwe0JeeeB"}],"key":"QdYlbJ1qHh"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":183,"column":1},"end":{"line":186,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Difference in lattice constant","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"key":"dd4IWH47uI"}],"key":"MNdRIexiyh"}],"key":"Ut8k0AAPmS"},{"type":"listItem","spread":true,"position":{"start":{"line":184,"column":1},"end":{"line":184,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"The reference energy used for the experiment references. These can differ by up to 0.5 eV from comparable DFT calculations.","position":{"start":{"line":184,"column":1},"end":{"line":184,"column":1}},"key":"eszvNC8V2A"}],"key":"F4VhvWSGTy"}],"key":"HMwXD8QJ2k"},{"type":"listItem","spread":true,"position":{"start":{"line":185,"column":1},"end":{"line":186,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"How many layers are relaxed in the calculation","position":{"start":{"line":185,"column":1},"end":{"line":185,"column":1}},"key":"dncOId1rhv"}],"key":"uM96wt3kiq"}],"key":"qBvVV9Xy1S"}],"key":"IstGjamA2N"},{"type":"paragraph","position":{"start":{"line":187,"column":1},"end":{"line":187,"column":1}},"children":[{"type":"text","value":"Some of these differences tend to be systematic, and you can calibrate and correct these, especially if you can augment these with your own DFT calculations.","position":{"start":{"line":187,"column":1},"end":{"line":187,"column":1}},"key":"ENUywbba5n"}],"key":"HLuxm11HRj"},{"type":"paragraph","position":{"start":{"line":189,"column":1},"end":{"line":189,"column":1}},"children":[{"type":"text","value":"See ","position":{"start":{"line":189,"column":1},"end":{"line":189,"column":1}},"key":"KNNnYy8sn3"},{"type":"crossReference","position":{"start":{"line":189,"column":1},"end":{"line":189,"column":1}},"children":[{"type":"text","value":"convergence study","position":{"start":{"line":189,"column":1},"end":{"line":189,"column":1}},"key":"OwYd5wKsHi"}],"identifier":"convergence-study","label":"convergence-study","kind":"heading","template":"{name}","resolved":true,"html_id":"convergence-study","key":"IAKAZKBpuw"},{"type":"text","value":" for some additional studies of factors that influence this number.","position":{"start":{"line":189,"column":1},"end":{"line":189,"column":1}},"key":"GshFnsp6s6"}],"key":"aZ7GjxqTOM"}],"key":"lol1FCIfoP"},{"type":"block","position":{"start":{"line":191,"column":1},"end":{"line":191,"column":1}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":193,"column":1},"end":{"line":193,"column":1}},"children":[{"type":"text","value":"Exercises","position":{"start":{"line":193,"column":1},"end":{"line":193,"column":1}},"key":"s1YFQ9Sj8J"}],"identifier":"exercises","label":"Exercises","html_id":"exercises","implicit":true,"key":"g6mlXoqdvn"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":195,"column":1},"end":{"line":197,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":195,"column":1},"end":{"line":195,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Explore the effect of the lattice constant on the adsorption energy.","position":{"start":{"line":195,"column":1},"end":{"line":195,"column":1}},"key":"AqORy06iEm"}],"key":"UlJgYM1KGu"}],"key":"kYK29vHkMw"},{"type":"listItem","spread":true,"position":{"start":{"line":196,"column":1},"end":{"line":197,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Try different sites, including the bridge and top sites. Compare the energies, and inspect the resulting geometries.","position":{"start":{"line":196,"column":1},"end":{"line":196,"column":1}},"key":"pqoTY6BhRb"}],"key":"WuDqao8eFO"}],"key":"yD0qiiPqVx"}],"key":"zjzJleGUjH"}],"key":"dW0Uq2w8ej"},{"type":"block","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"children":[{"type":"text","value":"Trends in adsorption energies across metals.","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"iY56aH9CWT"}],"identifier":"trends-in-adsorption-energies-across-metals","label":"Trends in adsorption energies across metals.","html_id":"trends-in-adsorption-energies-across-metals","implicit":true,"key":"e4ZfHKbKB5"},{"type":"paragraph","position":{"start":{"line":202,"column":1},"end":{"line":202,"column":1}},"children":[{"type":"text","value":"Xu, Z., & Kitchin, J. R. (2014). Probing the coverage dependence of site and adsorbate configurational correlations on (111) surfaces of late transition metals. J. Phys. Chem. C, 118(44), 25597–25602. ","position":{"start":{"line":202,"column":1},"end":{"line":202,"column":1}},"key":"JsePrXjvjn"},{"type":"cite","url":"http://dx.doi.org/10.1021/jp508805h","position":{"start":{"line":202,"column":1},"end":{"line":202,"column":1}},"children":[{"type":"text","value":"Xu & Kitchin (2014)","key":"R9fRCAtPEJ"}],"kind":"narrative","label":"Xu_2014","identifier":"http://dx.doi.org/10.1021/jp508805h","enumerator":"1","key":"EIt4Di1IQG"}],"key":"NlIJdB6atx"},{"type":"paragraph","position":{"start":{"line":204,"column":1},"end":{"line":204,"column":1}},"children":[{"type":"cite","url":"https://pubs.acs.org/doi/suppl/10.1021/jp508805h/suppl_file/jp508805h_si_001.pdf","position":{"start":{"line":204,"column":1},"end":{"line":204,"column":1}},"children":[{"type":"text","value":"Supporting information","position":{"start":{"line":204,"column":1},"end":{"line":204,"column":1}},"key":"yibocbBzYw"}],"kind":"narrative","label":"Xu_2014","identifier":"https://pubs.acs.org/doi/suppl/10.1021/jp508805h/suppl_file/jp508805h_si_001.pdf","enumerator":"1","key":"utztibiiDL"},{"type":"text","value":".","position":{"start":{"line":204,"column":1},"end":{"line":204,"column":1}},"key":"XY5Bl6sXeM"}],"key":"Dij3cbc5VC"},{"type":"paragraph","position":{"start":{"line":206,"column":1},"end":{"line":206,"column":1}},"children":[{"type":"text","value":"These are atomic adsorption energies:","position":{"start":{"line":206,"column":1},"end":{"line":206,"column":1}},"key":"uIX0OJADcm"}],"key":"gHxGdsN4dR"},{"type":"code","lang":"","value":"O + * -> O*","position":{"start":{"line":208,"column":1},"end":{"line":208,"column":1}},"key":"zaaKpCjksX"},{"type":"paragraph","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"children":[{"type":"text","value":"We have to do some work to get comparable numbers from OCP","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"key":"DQaFRsPOCp"}],"key":"ZM9vGq81zp"},{"type":"code","lang":"","value":"H2 + 1/2 O2 -> H2O  re1 = -3.03 eV\nH2O + * -> O* + H2  re2   # Get from UMA\nO -> 1/2 O2         re3 = -2.58 eV","position":{"start":{"line":212,"column":1},"end":{"line":214,"column":1}},"key":"uHGAdbL5RL"},{"type":"paragraph","position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"children":[{"type":"text","value":"Then, the adsorption energy for","position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"key":"ca7MAttuH7"}],"key":"jJeWrEG30B"},{"type":"code","lang":"","value":"O + * -> O*","position":{"start":{"line":218,"column":1},"end":{"line":218,"column":1}},"key":"M3t3vQjgos"},{"type":"paragraph","position":{"start":{"line":220,"column":1},"end":{"line":220,"column":1}},"children":[{"type":"text","value":"is just re1 + re2 + re3.","position":{"start":{"line":220,"column":1},"end":{"line":220,"column":1}},"key":"fyynwEKvm8"}],"key":"uGrrRkM6SF"},{"type":"paragraph","position":{"start":{"line":222,"column":1},"end":{"line":222,"column":1}},"children":[{"type":"text","value":"Here we just look at the fcc site on Pt. First, we get the data stored in the paper.","position":{"start":{"line":222,"column":1},"end":{"line":222,"column":1}},"key":"huW0NFezcV"}],"key":"AoLr1qoDs9"},{"type":"paragraph","position":{"start":{"line":224,"column":1},"end":{"line":224,"column":1}},"children":[{"type":"text","value":"Next we get the structures and compute their energies. Some subtle points are that we have to account for stoichiometry, and normalize the adsorption energy by the number of oxygens.","position":{"start":{"line":224,"column":1},"end":{"line":224,"column":1}},"key":"YkNJEEvtdE"}],"key":"hgifslzD0o"}],"key":"rTiER7RTI3"},{"type":"block","position":{"start":{"line":226,"column":1},"end":{"line":226,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":228,"column":1},"end":{"line":228,"column":1}},"children":[{"type":"text","value":"First we get a reference energy from the paper (PBE, 0.25 ML O on Pt(111)).","position":{"start":{"line":228,"column":1},"end":{"line":228,"column":1}},"key":"oe9dNHqpcN"}],"key":"sLY7sRqOjB"}],"key":"I5HcNVRAgi"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import json\n\nwith open(\"energies.json\") as f:\n    edata = json.load(f)\n\nwith open(\"structures.json\") as f:\n    sdata = json.load(f)\n\nedata[\"Pt\"][\"O\"][\"fcc\"][\"0.25\"]","key":"wS45tnkJJ2"},{"type":"outputs","id":"AcNQZzsR9OIW_6s-BFN-3","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"text/plain":{"content":"-4.263842000000002","content_type":"text/plain"}}},"key":"JmEyRp8UMe"}],"key":"Uiv6LNzEql"}],"key":"uSkwTY3GCD"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":242,"column":1},"end":{"line":242,"column":1}},"children":[{"type":"text","value":"Next, we load data from the SI to get the geometry to start from.","position":{"start":{"line":242,"column":1},"end":{"line":242,"column":1}},"key":"gs9p5GkX2G"}],"key":"AwgUhtqTTY"}],"key":"kx3mp8HyCd"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"with open(\"structures.json\") as f:\n    s = json.load(f)\n\nsfcc = s[\"Pt\"][\"O\"][\"fcc\"][\"0.25\"]","key":"D9X0ag1nxc"},{"type":"outputs","id":"72WLBcjS3OQU-bDaeGwdo","children":[],"key":"NZkp4rgyS1"}],"key":"WsRaa2qofd"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":251,"column":1},"end":{"line":251,"column":1}},"children":[{"type":"text","value":"Next, we construct the atomic geometry, run the geometry optimization, and compute the energy.","position":{"start":{"line":251,"column":1},"end":{"line":251,"column":1}},"key":"UquX6craEf"}],"key":"YqSN0OodC5"}],"key":"qQfCvFuk10"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"re3 = -2.58  # O -> 1/2 O2         re3 = -2.58 eV\n\nfrom ase import Atoms\n\nadslab = Atoms(sfcc[\"symbols\"], positions=sfcc[\"pos\"], cell=sfcc[\"cell\"], pbc=True)\n\n# Grab just the metal surface atoms\nslab = adslab[adslab.arrays[\"numbers\"] == adslab.arrays[\"numbers\"][0]]\nadsorbates = adslab[~(adslab.arrays[\"numbers\"] == adslab.arrays[\"numbers\"][0])]\nslab.set_calculator(calc)\nopt = BFGS(slab)\nopt.run(fmax=0.05, steps=100)\n\nadslab.set_calculator(calc)\nopt = BFGS(adslab)\n\nopt.run(fmax=0.05, steps=100)\nre2 = (\n    adslab.get_potential_energy()\n    - slab.get_potential_energy()\n    - sum([atomic_reference_energies[x] for x in adsorbates.get_chemical_symbols()])\n)\n\nnO = 0\nfor atom in adslab:\n    if atom.symbol == \"O\":\n        nO += 1\n        re2 += re1 + re3\n\nprint(re2 / nO)","key":"qBgRkWcXZB"},{"type":"outputs","id":"IHSVnUlpnNGIdRuZGD15q","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"/tmp/ipykernel_9849/647904475.py:10: FutureWarning: Please use atoms.calc = calc\n  slab.set_calculator(calc)\n"},"key":"zujBhInoHm"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"      Step     Time          Energy          fmax\nBFGS:    0 21:12:24      -82.862062        1.000262\n"},"key":"IFZUh5spJ5"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    1 21:12:24      -82.918113        0.752920\nBFGS:    2 21:12:24      -83.011695        0.335860\n"},"key":"R0DAnRt4H9"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    3 21:12:25      -83.016496        0.303120\n"},"key":"KzWPl1dAm4"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    4 21:12:25      -83.024495        0.224963\n"},"key":"N6k0hA99ej"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    5 21:12:25      -83.030036        0.152566\n"},"key":"KmYQ7UrZER"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    6 21:12:25      -83.033361        0.088624\n"},"key":"Q38vQXeLOQ"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    7 21:12:26      -83.034469        0.065748\n"},"key":"PxpWvnzNrt"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    8 21:12:26      -83.035207        0.068691\n"},"key":"W9eu11euHx"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    9 21:12:26      -83.035564        0.046755\n"},"key":"P66sNhEmBI"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"/tmp/ipykernel_9849/647904475.py:14: FutureWarning: Please use atoms.calc = calc\n  adslab.set_calculator(calc)\n"},"key":"Wi6TKTVJJd"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"      Step     Time          Energy          fmax\nBFGS:    0 21:12:27      -88.770343        0.312348\nBFGS:    1 21:12:27      -88.773631        0.271703\n"},"key":"u5qmKO0jvo"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    2 21:12:27      -88.784474        0.104052\nBFGS:    3 21:12:27      -88.786013        0.101456\n"},"key":"GfRjyI0v8v"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    4 21:12:28      -88.788553        0.106392\n"},"key":"TJ1LPfEvZJ"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    5 21:12:28      -88.790502        0.089092\n"},"key":"plHTYzo9a4"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    6 21:12:28      -88.791972        0.096448\nBFGS:    7 21:12:28      -88.792660        0.099427\n"},"key":"enzfI929SD"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    8 21:12:28      -88.793179        0.077380\nBFGS:    9 21:12:28      -88.793678        0.036103\n"},"key":"Fexy8NGbLw"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"-4.1641148097345075\n"},"key":"zQsBOJQr6T"}],"key":"OfFGptbFpb"}],"key":"ERjLbk6JEa"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":286,"column":1},"end":{"line":286,"column":1}},"children":[{"type":"text","value":"Site correlations","position":{"start":{"line":286,"column":1},"end":{"line":286,"column":1}},"key":"MaHvMVkl5g"}],"identifier":"site-correlations","label":"Site correlations","html_id":"site-correlations","implicit":true,"key":"UUJJeFCC9x"},{"type":"paragraph","position":{"start":{"line":288,"column":1},"end":{"line":288,"column":1}},"children":[{"type":"text","value":"This cell reproduces a portion of a figure in the paper. We compare oxygen adsorption energies in the fcc and hcp sites across metals and coverages. These adsorption energies are highly correlated with each other because the adsorption sites are so similar.","position":{"start":{"line":288,"column":1},"end":{"line":288,"column":1}},"key":"Tg2xrVvbps"}],"key":"M5v3RiRLaj"},{"type":"paragraph","position":{"start":{"line":290,"column":1},"end":{"line":290,"column":1}},"children":[{"type":"text","value":"At higher coverages, the agreement is not as good. This is likely because the model is extrapolating and needs to be fine-tuned.","position":{"start":{"line":290,"column":1},"end":{"line":290,"column":1}},"key":"KFHlYSy8Qu"}],"key":"ux7ZGBKFie"}],"key":"X4OR2BaWho"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import time\n\nfrom tqdm import tqdm\n\nt0 = time.time()\n\ndata = {\"fcc\": [], \"hcp\": []}\n\nrefdata = {\"fcc\": [], \"hcp\": []}\n\n\nfor metal in [\"Cu\", \"Ag\", \"Pd\", \"Pt\", \"Rh\", \"Ir\"]:\n    print(metal)\n    for site in [\"fcc\", \"hcp\"]:\n        for adsorbate in [\"O\"]:\n            for coverage in tqdm([\"0.25\"]):\n\n                entry = s[metal][adsorbate][site][coverage]\n\n                adslab = Atoms(\n                    entry[\"symbols\"],\n                    positions=entry[\"pos\"],\n                    cell=entry[\"cell\"],\n                    pbc=True,\n                )\n\n                # Grab just the metal surface atoms\n                adsorbates = adslab[\n                    ~(adslab.arrays[\"numbers\"] == adslab.arrays[\"numbers\"][0])\n                ]\n\n                slab = adslab[adslab.arrays[\"numbers\"] == adslab.arrays[\"numbers\"][0]]\n                slab.set_calculator(calc)\n                opt = BFGS(slab)\n                opt.run(fmax=0.05, steps=100)\n\n                adslab.set_calculator(calc)\n                opt = BFGS(adslab)\n                opt.run(fmax=0.05, steps=100)\n\n                re2 = (\n                    adslab.get_potential_energy()\n                    - slab.get_potential_energy()\n                    - sum(\n                        [\n                            atomic_reference_energies[x]\n                            for x in adsorbates.get_chemical_symbols()\n                        ]\n                    )\n                )\n\n                nO = 0\n                for atom in adslab:\n                    if atom.symbol == \"O\":\n                        nO += 1\n                        re2 += re1 + re3\n\n                data[site] += [re2 / nO]\n                refdata[site] += [edata[metal][adsorbate][site][coverage]]\n\nf\"Elapsed time = {time.time() - t0} seconds\"","key":"uj8cYfIrLx"},{"type":"outputs","id":"NHdQRuN6oby_a0Y3uCTyR","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Cu\n"},"key":"EF5fLXxhKH"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r  0%|          | 0/1 [00:00<?, ?it/s]"},"key":"olIt7qkRWY"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"/tmp/ipykernel_9849/1356342052.py:33: FutureWarning: Please use atoms.calc = calc\n  slab.set_calculator(calc)\n"},"key":"FmHUgm0vvg"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"      Step     Time          Energy          fmax\nBFGS:    0 21:12:29      -48.910948        0.646351\n"},"key":"T8rZthPXns"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    1 21:12:29      -48.934031        0.539303\n"},"key":"DEIIpftk4Y"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    2 21:12:30      -49.000043        0.280104\n"},"key":"JCGyL5rJKL"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    3 21:12:30      -49.002374        0.251320\n"},"key":"Z8yzdyl7zT"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    4 21:12:30      -49.008810        0.158913\n"},"key":"YdTDpZNK3O"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    5 21:12:30      -49.013985        0.134406\n"},"key":"ozjr0anVQg"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    6 21:12:31      -49.016868        0.071534\n"},"key":"WfLnoFwagY"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    7 21:12:31      -49.017633        0.051269\n"},"key":"ILqeEsBV9L"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    8 21:12:31      -49.018011        0.047562\n"},"key":"Ob4LH8WI7d"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"/tmp/ipykernel_9849/1356342052.py:37: FutureWarning: Please use atoms.calc = calc\n  adslab.set_calculator(calc)\n"},"key":"ED5V39BeEP"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"      Step     Time          Energy          fmax\nBFGS:    0 21:12:31      -55.204221        0.339047\nBFGS:    1 21:12:32      -55.206662        0.267938\n"},"key":"c9YIeKZZJg"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    2 21:12:32      -55.213711        0.160040\n"},"key":"TGoLTBsYib"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    3 21:12:32      -55.215874        0.166182\n"},"key":"o6dkorpyVu"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    4 21:12:33      -55.219675        0.116685\n"},"key":"GtGzETuEKF"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    5 21:12:33      -55.221814        0.079418\n"},"key":"pFCNYHsDac"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    6 21:12:33      -55.223360        0.075349\n"},"key":"rSJoPO0uZt"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    7 21:12:33      -55.224365        0.090285\n"},"key":"ce46yaUPyT"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    8 21:12:34      -55.225517        0.098899\n"},"key":"EdJoY1P8ho"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    9 21:12:34      -55.226530        0.068556\n"},"key":"jmqIaLyOfr"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:   10 21:12:34      -55.226977        0.042995\n"},"key":"oqrnaIFTB2"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r100%|██████████| 1/1 [00:05<00:00,  5.80s/it]"},"key":"PQNniMNtZP"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r100%|██████████| 1/1 [00:05<00:00,  5.80s/it]"},"key":"N7PhMiyFPv"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\n"},"key":"FJLs1lbHRM"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r  0%|          | 0/1 [00:00<?, ?it/s]"},"key":"yzw47eNLuO"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"      Step     Time          Energy          fmax\nBFGS:    0 21:12:35      -48.936503        0.552695\n"},"key":"LWT65VjN7K"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    1 21:12:35      -48.954084        0.470533\n"},"key":"byMKP06hpD"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    2 21:12:35      -49.008576        0.210998\nBFGS:    3 21:12:35      -49.009768        0.197685\n"},"key":"ljXcaFa6W6"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    4 21:12:36      -49.017746        0.041130\n"},"key":"yKE8CDIjTH"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"      Step     Time          Energy          fmax\nBFGS:    0 21:12:36      -55.119069        0.305598\n"},"key":"THUjGP3ceu"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    1 21:12:36      -55.120918        0.239019\n"},"key":"VwZ2ud5xOB"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    2 21:12:36      -55.125706        0.129148\n"},"key":"ObrbEjups8"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    3 21:12:37      -55.127340        0.147607\n"},"key":"x3grjXu9e7"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    4 21:12:37      -55.130398        0.128614\n"},"key":"OtIElcQDFF"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    5 21:12:37      -55.132308        0.103141\nBFGS:    6 21:12:38      -55.133381        0.051682\n"},"key":"LNSWEEH2by"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    7 21:12:38      -55.133851        0.056053\nBFGS:    8 21:12:38      -55.134358        0.071226\n"},"key":"KNdH0bj6pP"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    9 21:12:38      -55.135043        0.069434\n"},"key":"k5GBLAUZ7r"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:   10 21:12:38      -55.135575        0.039918\n"},"key":"hLbJObvpw2"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r100%|██████████| 1/1 [00:04<00:00,  4.29s/it]"},"key":"tROkb5qGmR"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r100%|██████████| 1/1 [00:04<00:00,  4.29s/it]"},"key":"G3CBcrQ2gF"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\n"},"key":"w1LEz4EPFl"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Ag\n"},"key":"IIKRLYfd3q"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r  0%|          | 0/1 [00:00<?, ?it/s]"},"key":"uJpYqtpEpY"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"      Step     Time          Energy          fmax\nBFGS:    0 21:12:39      -33.034314        0.634820\n"},"key":"YKEqueYHtG"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    1 21:12:39      -33.053470        0.551048\n"},"key":"Zrgx25A3P4"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    2 21:12:40      -33.120905        0.172022\n"},"key":"IKc8sDyl35"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    3 21:12:40      -33.122778        0.157330\n"},"key":"c9yWMl79ih"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    4 21:12:40      -33.124181        0.143386\nBFGS:    5 21:12:40      -33.126943        0.112458\n"},"key":"VE9L44203Q"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    6 21:12:41      -33.130772        0.110654\n"},"key":"nvkd8ikyyV"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    7 21:12:41      -33.133994        0.067525\nBFGS:    8 21:12:41      -33.134833        0.034889\n"},"key":"mXMDgHBRD7"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"      Step     Time          Energy          fmax\nBFGS:    0 21:12:41      -38.173509        0.098015\nBFGS:    1 21:12:41      -38.174435        0.094365\n"},"key":"kIh2RzoK0z"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    2 21:12:42      -38.184908        0.084035\nBFGS:    3 21:12:42      -38.185731        0.085435\n"},"key":"n2dRQvKbvq"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    4 21:12:42      -38.189036        0.086079\n"},"key":"bcmzdmoOyc"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    5 21:12:42      -38.190951        0.068830\n"},"key":"FXCaLRjUsy"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    6 21:12:43      -38.192257        0.087458\n"},"key":"UXWkv0aH7L"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    7 21:12:43      -38.193187        0.076913\n"},"key":"OeRVwKedb3"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r100%|██████████| 1/1 [00:04<00:00,  4.66s/it]"},"key":"Pvr63EH6c7"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r100%|██████████| 1/1 [00:04<00:00,  4.67s/it]"},"key":"ubQcyU9Cfk"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\n"},"key":"UF54xM9abX"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    8 21:12:43      -38.193673        0.042582\n"},"key":"lBfU76xfIl"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r  0%|          | 0/1 [00:00<?, ?it/s]"},"key":"r4qvMx6vFj"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"      Step     Time          Energy          fmax\nBFGS:    0 21:12:44      -33.056750        0.557366\n"},"key":"qeONEr4OXm"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    1 21:12:44      -33.071228        0.489412\nBFGS:    2 21:12:44      -33.126397        0.123825\n"},"key":"QnUWsJwHE8"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    3 21:12:44      -33.127309        0.112960\nBFGS:    4 21:12:45      -33.128516        0.097373\n"},"key":"TiczZkdD4Q"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    5 21:12:45      -33.130260        0.079535\n"},"key":"bmm2E3j7KS"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    6 21:12:45      -33.133160        0.076345\n"},"key":"r9VF39IovJ"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    7 21:12:45      -33.134742        0.040732\n"},"key":"Z65ySIZzh2"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"      Step     Time          Energy          fmax\nBFGS:    0 21:12:46      -38.102025        0.092717\n"},"key":"pMo70wjKQN"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    1 21:12:46      -38.102856        0.088836\n"},"key":"bG5vMgMXka"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    2 21:12:47      -38.111088        0.134659\n"},"key":"QF6RK6UTyx"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    3 21:12:47      -38.112012        0.120323\n"},"key":"e7tAkx87xi"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    4 21:12:47      -38.115290        0.063997\nBFGS:    5 21:12:47      -38.116156        0.056396\n"},"key":"gCTTkRdIF5"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    6 21:12:48      -38.116710        0.058188\n"},"key":"lJt271Vi63"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    7 21:12:48      -38.117581        0.073176\nBFGS:    8 21:12:48      -38.118451        0.057903\n"},"key":"lU1mYu4tZX"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    9 21:12:48      -38.118834        0.026051\n"},"key":"TFrTq8Aixn"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r100%|██████████| 1/1 [00:05<00:00,  5.10s/it]"},"key":"lp1OHARvJY"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r100%|██████████| 1/1 [00:05<00:00,  5.11s/it]"},"key":"noeDpFfNW5"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\n"},"key":"Bocsy01l1M"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Pd\n"},"key":"KKYCCQnuV2"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r  0%|          | 0/1 [00:00<?, ?it/s]"},"key":"LuLCy0Mi4m"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"      Step     Time          Energy          fmax\nBFGS:    0 21:12:49      -70.165062        0.631446\n"},"key":"EWyTo7Ixho"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    1 21:12:49      -70.189910        0.508128\n"},"key":"CGv3UclQP9"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    2 21:12:49      -70.241648        0.191934\n"},"key":"I59PRNqJRH"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    3 21:12:50      -70.243346        0.182565\nBFGS:    4 21:12:50      -70.248575        0.144558\n"},"key":"WJLG7N1KR5"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    5 21:12:50      -70.251930        0.115933\n"},"key":"Zu3NWB2T9C"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    6 21:12:50      -70.254308        0.074830\n"},"key":"eWYrmcj2rc"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    7 21:12:51      -70.255205        0.059446\n"},"key":"nv2yNNLG34"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    8 21:12:51      -70.255944        0.041107\n"},"key":"ZQ0BEzUd9f"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"      Step     Time          Energy          fmax\nBFGS:    0 21:12:51      -76.130241        0.213656\n"},"key":"jHat3bqX1c"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    1 21:12:51      -76.133242        0.190305\nBFGS:    2 21:12:51      -76.148717        0.169645\n"},"key":"ouSmQRC3s6"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    3 21:12:52      -76.150812        0.152254\n"},"key":"CVGhjwBvHf"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    4 21:12:52      -76.154312        0.130502\nBFGS:    5 21:12:52      -76.157058        0.106137\n"},"key":"NbyyzikjWA"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    6 21:12:52      -76.159302        0.088125\nBFGS:    7 21:12:53      -76.160431        0.080504\n"},"key":"DiXBoMc227"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    8 21:12:53      -76.161131        0.064490\n"},"key":"GhSYb3jpS0"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    9 21:12:53      -76.161614        0.042994\n"},"key":"RupuUDuwou"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r100%|██████████| 1/1 [00:04<00:00,  4.77s/it]"},"key":"lfwa93GuUm"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r100%|██████████| 1/1 [00:04<00:00,  4.78s/it]"},"key":"eLWiEMqtE0"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\n"},"key":"chSj6IeOGe"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r  0%|          | 0/1 [00:00<?, ?it/s]"},"key":"Jrd10cPbex"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"      Step     Time          Energy          fmax\nBFGS:    0 21:12:54      -70.197711        0.454636\n"},"key":"xE0jI4iUig"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    1 21:12:54      -70.211774        0.373893\n"},"key":"VmFESTlptV"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    2 21:12:54      -70.245977        0.178178\nBFGS:    3 21:12:54      -70.247162        0.164572\n"},"key":"x0yaLcoqrk"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    4 21:12:55      -70.253348        0.078706\n"},"key":"nCbiUtYOiD"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    5 21:12:55      -70.254511        0.075507\n"},"key":"J5BAJeji7H"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    6 21:12:55      -70.255271        0.058131\n"},"key":"Q7PLWc8Swe"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    7 21:12:55      -70.255844        0.036952\n"},"key":"QfydejF8uh"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"      Step     Time          Energy          fmax\nBFGS:    0 21:12:56      -75.892387        0.169439\n"},"key":"mYgPkhSFIS"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    1 21:12:56      -75.895234        0.150799\n"},"key":"rL9vI7XZsw"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    2 21:12:56      -75.906632        0.144107\n"},"key":"W5ANCKP022"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    3 21:12:56      -75.908423        0.135661\n"},"key":"RtgcUDO2nw"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    4 21:12:57      -75.912428        0.129011\n"},"key":"IHSfz06x2J"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    5 21:12:57      -75.915497        0.108688\n"},"key":"BRjUmUIBPJ"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    6 21:12:57      -75.917927        0.075295\nBFGS:    7 21:12:57      -75.918955        0.067271\n"},"key":"vHaLBqmqCC"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    8 21:12:58      -75.919478        0.044573\n"},"key":"xrIIMAvwqd"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r100%|██████████| 1/1 [00:04<00:00,  4.77s/it]"},"key":"UBr5riPKL7"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r100%|██████████| 1/1 [00:04<00:00,  4.77s/it]"},"key":"SbYWtQ3lfr"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\n"},"key":"MvfihGYC5T"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Pt\n"},"key":"rv0EDpFkHc"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r  0%|          | 0/1 [00:00<?, ?it/s]"},"key":"DbliT6WhVV"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"      Step     Time          Energy          fmax\nBFGS:    0 21:12:58      -82.862062        1.000262\n"},"key":"xiQ1rSJRYT"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    1 21:12:59      -82.918113        0.752920\nBFGS:    2 21:12:59      -83.011694        0.335860\n"},"key":"E4iW3IimBK"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    3 21:12:59      -83.016496        0.303120\nBFGS:    4 21:12:59      -83.024495        0.224963\n"},"key":"QTx78bILUU"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    5 21:12:59      -83.030036        0.152567\n"},"key":"XzCaYB0SZ2"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    6 21:13:00      -83.033361        0.088625\n"},"key":"Qswv22u1mj"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    7 21:13:00      -83.034469        0.065746\n"},"key":"O1dwQOu2ka"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    8 21:13:00      -83.035207        0.068690\n"},"key":"Y5fgh2mAdX"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    9 21:13:00      -83.035563        0.046754\n      Step     Time          Energy          fmax\nBFGS:    0 21:13:01      -88.770342        0.312349\n"},"key":"FzF0R929WO"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    1 21:13:01      -88.773630        0.271703\n"},"key":"D3zEtBryoW"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    2 21:13:01      -88.784473        0.104050\n"},"key":"HeEVZwe3ID"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    3 21:13:01      -88.786013        0.101458\n"},"key":"ifqWzaHd5t"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    4 21:13:02      -88.788553        0.106393\n"},"key":"waJzSz0JuA"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    5 21:13:02      -88.790502        0.089090\n"},"key":"JsO27aEZQ8"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    6 21:13:02      -88.791972        0.096440\n"},"key":"JEmX4Fw3tG"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    7 21:13:03      -88.792657        0.099419\n"},"key":"KBEdhVLYWU"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    8 21:13:03      -88.793180        0.077375\n"},"key":"dprbHxg4Rw"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r100%|██████████| 1/1 [00:05<00:00,  5.11s/it]"},"key":"fHC9OlIbYl"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r100%|██████████| 1/1 [00:05<00:00,  5.11s/it]"},"key":"x8NcdPOHVV"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\n"},"key":"wyTJx4b2cF"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    9 21:13:03      -88.793679        0.036102\n"},"key":"TLqMkQerSk"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r  0%|          | 0/1 [00:00<?, ?it/s]"},"key":"rwX4xKmdiL"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"      Step     Time          Energy          fmax\nBFGS:    0 21:13:03      -82.946996        0.675644\nBFGS:    1 21:13:04      -82.973149        0.546704\n"},"key":"W2sxHG7Tba"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    2 21:13:04      -83.026505        0.203005\n"},"key":"uUfLNVqm6Y"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    3 21:13:04      -83.028070        0.183991\n"},"key":"kKdQdZ11sB"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    4 21:13:04      -83.033699        0.083395\n"},"key":"asF0b346rc"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    5 21:13:05      -83.034397        0.061071\n"},"key":"BZIhvh3HwA"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    6 21:13:05      -83.035121        0.048395\n"},"key":"KVOZWDOSgZ"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"      Step     Time          Energy          fmax\nBFGS:    0 21:13:05      -88.350562        0.234982\n"},"key":"inMRbUrhYf"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    1 21:13:06      -88.353606        0.203898\n"},"key":"zxrbW7Nj3Z"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    2 21:13:06      -88.362977        0.117096\n"},"key":"DbRXORozsT"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    3 21:13:06      -88.364343        0.121250\n"},"key":"RwaZSgsojN"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    4 21:13:06      -88.368499        0.090132\n"},"key":"YXs6yHViGw"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    5 21:13:07      -88.370482        0.073281\n"},"key":"IerpO1hnnw"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    6 21:13:07      -88.371785        0.075210\n"},"key":"r3Ntd42egs"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    7 21:13:07      -88.372317        0.079583\n"},"key":"nlQp0KddaI"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    8 21:13:07      -88.372731        0.061435\n"},"key":"KBNyjaGQxb"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    9 21:13:08      -88.373020        0.027208\n"},"key":"IYFmUcwPNV"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r100%|██████████| 1/1 [00:04<00:00,  4.59s/it]"},"key":"xzb5yCdhtD"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r100%|██████████| 1/1 [00:04<00:00,  4.60s/it]"},"key":"Z5MLrcEVs0"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\n"},"key":"LyAcfOALxk"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Rh\n"},"key":"WYww8BTdGw"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r  0%|          | 0/1 [00:00<?, ?it/s]"},"key":"n023zFq8zV"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"      Step     Time          Energy          fmax\nBFGS:    0 21:13:08     -100.192566        0.688933\n"},"key":"wU5JNHE6FB"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    1 21:13:08     -100.218239        0.600213\n"},"key":"NGeq6VCMvz"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    2 21:13:09     -100.286835        0.174739\n"},"key":"F27LH05zO4"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    3 21:13:09     -100.289767        0.129382\n"},"key":"aGgYJ2XNbw"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    4 21:13:09     -100.298129        0.066639\nBFGS:    5 21:13:09     -100.299264        0.053478\n"},"key":"aMzFiJ8m9v"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    6 21:13:10     -100.299778        0.045082\n"},"key":"nuzZHuqz6X"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"      Step     Time          Energy          fmax\nBFGS:    0 21:13:10     -106.921794        0.203149\nBFGS:    1 21:13:10     -106.924541        0.168907\n"},"key":"psGcHRGFTl"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    2 21:13:10     -106.930976        0.052441\n"},"key":"O1gKhC13TZ"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    3 21:13:11     -106.931584        0.045559\n"},"key":"x4QFVCA4bH"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r100%|██████████| 1/1 [00:03<00:00,  3.16s/it]"},"key":"hbbYfYZpDm"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r100%|██████████| 1/1 [00:03<00:00,  3.17s/it]"},"key":"cQ5sY0P1X6"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\n"},"key":"R4PqK2kLbc"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r  0%|          | 0/1 [00:00<?, ?it/s]"},"key":"sYXNIXLXDQ"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"      Step     Time          Energy          fmax\nBFGS:    0 21:13:11     -100.171741        0.714774\n"},"key":"SEHnQxbKQY"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    1 21:13:12     -100.203866        0.626030\n"},"key":"ENPJp0V1hA"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    2 21:13:12     -100.287845        0.263192\nBFGS:    3 21:13:12     -100.290543        0.195973\n"},"key":"Iy68udsSiU"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    4 21:13:12     -100.297165        0.080364\nBFGS:    5 21:13:12     -100.299032        0.056455\n"},"key":"HMOtWz8vQg"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    6 21:13:13     -100.299773        0.043868\n      Step     Time          Energy          fmax\nBFGS:    0 21:13:13     -106.876839        0.168839\n"},"key":"MSH5tiLu02"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    1 21:13:13     -106.879420        0.139490\nBFGS:    2 21:13:13     -106.885549        0.071255\n"},"key":"RffeGt7kR4"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    3 21:13:13     -106.886238        0.064286\n"},"key":"NjfVsdNilb"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    4 21:13:14     -106.886580        0.054980\n"},"key":"EKJURujCie"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    5 21:13:14     -106.886842        0.043052\n"},"key":"bF5uBzqm8E"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r100%|██████████| 1/1 [00:03<00:00,  3.17s/it]"},"key":"TZuYFOANzL"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r100%|██████████| 1/1 [00:03<00:00,  3.18s/it]"},"key":"j5rwvHyEeg"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\n"},"key":"a7tW1tJMTb"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Ir\n"},"key":"pTGrjFWn50"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r  0%|          | 0/1 [00:00<?, ?it/s]"},"key":"E5WHWyQ27L"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"      Step     Time          Energy          fmax\nBFGS:    0 21:13:14     -124.235610        1.189926\n"},"key":"vqdlAjX1PZ"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    1 21:13:15     -124.310841        0.937184\n"},"key":"sGleYKwETo"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    2 21:13:15     -124.422189        0.140826\n"},"key":"fOWc8k4V6X"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    3 21:13:15     -124.425270        0.133780\n"},"key":"W6C5j91oNJ"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    4 21:13:16     -124.429598        0.060640\n"},"key":"MtXgxAO7HB"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    5 21:13:16     -124.430258        0.038669\n"},"key":"fFOVmTZRJl"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"      Step     Time          Energy          fmax\nBFGS:    0 21:13:16     -130.605624        0.371646\n"},"key":"R6FRkNtyXk"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    1 21:13:16     -130.616146        0.265890\n"},"key":"bbL4D3a5ri"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    2 21:13:17     -130.630316        0.110763\n"},"key":"Cdq46g0JvL"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    3 21:13:17     -130.633615        0.094356\n"},"key":"FZx69FDZPi"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    4 21:13:17     -130.634276        0.075693\n"},"key":"WlhiFcXCrT"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    5 21:13:17     -130.634990        0.065690\n"},"key":"OPg91UYd9r"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    6 21:13:18     -130.636199        0.083047\n"},"key":"dtBijcaVoj"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    7 21:13:18     -130.636656        0.075131\nBFGS:    8 21:13:18     -130.637047        0.047435\n"},"key":"ehSdxcm85r"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r100%|██████████| 1/1 [00:04<00:00,  4.29s/it]"},"key":"jWSLkU7piL"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r100%|██████████| 1/1 [00:04<00:00,  4.29s/it]"},"key":"MzKAim37RV"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\n"},"key":"JWP3xNiZis"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r  0%|          | 0/1 [00:00<?, ?it/s]"},"key":"L9pzxm4Pvw"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"      Step     Time          Energy          fmax\nBFGS:    0 21:13:19     -124.227592        1.165685\n"},"key":"lBm90mPgkl"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    1 21:13:19     -124.311475        0.915619\n"},"key":"mAaTePWuUD"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    2 21:13:19     -124.422557        0.165136\nBFGS:    3 21:13:20     -124.425477        0.200268\n"},"key":"TuHzLAI0su"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    4 21:13:20     -124.428763        0.168861\nBFGS:    5 21:13:20     -124.430255        0.088394\n"},"key":"lUvc0B1wRk"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    6 21:13:20     -124.430559        0.041798\n      Step     Time          Energy          fmax\nBFGS:    0 21:13:20     -130.496159        0.405482\n"},"key":"V5ZLeXlZgZ"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    1 21:13:20     -130.507202        0.266991\n"},"key":"Zd59du2x2x"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    2 21:13:21     -130.518616        0.126414\n"},"key":"gBpNoGLWcq"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    3 21:13:21     -130.522315        0.080268\n"},"key":"jubxklqKjQ"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    4 21:13:21     -130.523180        0.066554\n"},"key":"xp8HVSOfiv"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    5 21:13:22     -130.523452        0.056610\n"},"key":"PElehCEW9b"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    6 21:13:22     -130.524511        0.055650\n"},"key":"IAL3eZbdLz"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    7 21:13:22     -130.524677        0.042696\n"},"key":"BbslYPGONr"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r100%|██████████| 1/1 [00:04<00:00,  4.16s/it]"},"key":"Y40O0RFoIR"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r100%|██████████| 1/1 [00:04<00:00,  4.17s/it]"},"key":"tFfO0j9hin"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\n"},"key":"ff6iNUvdDM"},{"type":"output","children":[],"jupyter_data":{"output_type":"execute_result","execution_count":9,"metadata":{},"data":{"text/plain":{"content":"'Elapsed time = 53.990450859069824 seconds'","content_type":"text/plain"}}},"key":"oFR9fwCYsF"}],"key":"WSdbwWmpNs"}],"key":"KJYj5p0VqF"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":356,"column":1},"end":{"line":356,"column":1}},"children":[{"type":"text","value":"First, we compare the computed data and reference data. There is a systematic difference of about 0.5 eV due to the difference between RPBE and PBE functionals, and other subtle differences like lattice constant differences and reference energy differences. This is pretty typical, and an expected deviation.","position":{"start":{"line":356,"column":1},"end":{"line":356,"column":1}},"key":"CkgZMA2OcN"}],"key":"WElIWD8II7"}],"key":"IYtSev0mdL"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot(refdata[\"fcc\"], data[\"fcc\"], \"r.\", label=\"fcc\")\nplt.plot(refdata[\"hcp\"], data[\"hcp\"], \"b.\", label=\"hcp\")\nplt.plot([-5.5, -3.5], [-5.5, -3.5], \"k-\")\nplt.xlabel(\"Ref. data (DFT)\")\nplt.ylabel(\"UMA-OC20 prediction\");","key":"QfF101GfBR"},{"type":"outputs","id":"pjk6ivfpPU9BVSYo7a-Sy","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"36d850a7ac41e9bd3477161594f52931","path":"/build/36d850a7ac41e9bd3477161594f52931.png"}}},"key":"r0g7jH3gYc"}],"key":"gV2pNFEv7e"}],"key":"TZ854hIC7Y"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":366,"column":1},"end":{"line":366,"column":1}},"children":[{"type":"text","value":"Next we compare the correlation between the hcp and fcc sites. Here we see the same trends. The data falls below the parity line because the hcp sites tend to be a little weaker binding than the fcc sites.","position":{"start":{"line":366,"column":1},"end":{"line":366,"column":1}},"key":"VznhMciDuW"}],"key":"nsjIN38JX1"}],"key":"i68z97uSot"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot(refdata[\"hcp\"], refdata[\"fcc\"], \"r.\")\nplt.plot(data[\"hcp\"], data[\"fcc\"], \".\")\nplt.plot([-6, -1], [-6, -1], \"k-\")\nplt.xlabel(\"$H_{ads, hcp}$\")\nplt.ylabel(\"$H_{ads, fcc}$\")\nplt.legend([\"DFT (PBE)\", \"UMA-OC20\"]);","key":"lPG6KItftk"},{"type":"outputs","id":"RlAejdIsPH0KaD6naQaWv","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"0e744ac205735b9263d9c884dbf78d3b","path":"/build/0e744ac205735b9263d9c884dbf78d3b.png"}}},"key":"DItNU6pSXV"}],"key":"z6M8ZLtJj5"}],"key":"skTzfY4khn"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":377,"column":1},"end":{"line":377,"column":1}},"children":[{"type":"text","value":"Exercises","position":{"start":{"line":377,"column":1},"end":{"line":377,"column":1}},"key":"XrRlfYqhW7"}],"identifier":"exercises","label":"Exercises","html_id":"exercises-1","implicit":true,"key":"Vp1xgWz1Mr"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":379,"column":1},"end":{"line":381,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":379,"column":1},"end":{"line":379,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"You can also explore a few other adsorbates: C, H, N.","position":{"start":{"line":379,"column":1},"end":{"line":379,"column":1}},"key":"vDFAEacRd5"}],"key":"Tv1aQJvuhX"}],"key":"JXlHmrRxDE"},{"type":"listItem","spread":true,"position":{"start":{"line":380,"column":1},"end":{"line":381,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Explore the higher coverages. The deviations from the reference data are expected to be higher, but relative differences tend to be better. You probably need fine tuning to improve this performance. This data set doesn’t have forces though, so it isn’t practical to do it here.","position":{"start":{"line":380,"column":1},"end":{"line":380,"column":1}},"key":"eTWO88NtJf"}],"key":"xcNj7OZKhP"}],"key":"vq2SJXm0N1"}],"key":"FM3nGDLLk6"}],"key":"nuRmUrtC8Y"},{"type":"block","position":{"start":{"line":382,"column":1},"end":{"line":382,"column":1}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":384,"column":1},"end":{"line":384,"column":1}},"children":[{"type":"text","value":"Next steps","position":{"start":{"line":384,"column":1},"end":{"line":384,"column":1}},"key":"irJvuAXQAy"}],"identifier":"next-steps","label":"Next steps","html_id":"next-steps","implicit":true,"key":"oV3UitVQ4C"},{"type":"paragraph","position":{"start":{"line":386,"column":1},"end":{"line":386,"column":1}},"children":[{"type":"text","value":"In the next step, we consider some more complex adsorbates in nitrogen reduction, and how we can leverage OCP to automate the search for the most stable adsorbate geometry. See ","position":{"start":{"line":386,"column":1},"end":{"line":386,"column":1}},"key":"XG96iVtq68"},{"type":"link","url":"./NRR/NRR_example-gemnet","position":{"start":{"line":386,"column":1},"end":{"line":386,"column":1}},"children":[{"type":"text","value":"the next step","position":{"start":{"line":386,"column":1},"end":{"line":386,"column":1}},"key":"nBrLZ1VWy8"}],"urlSource":"./NRR/NRR_example-gemnet","key":"jFpBxmiS6e"},{"type":"text","value":".","position":{"start":{"line":386,"column":1},"end":{"line":386,"column":1}},"key":"hjZUGG14Yv"}],"key":"lKK8Vgu2gU"}],"key":"ZDSrAE2DoU"},{"type":"block","position":{"start":{"line":388,"column":1},"end":{"line":388,"column":1}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":391,"column":1},"end":{"line":391,"column":1}},"children":[{"type":"text","value":"Convergence study","position":{"start":{"line":391,"column":1},"end":{"line":391,"column":1}},"key":"c75ktQZSMf"}],"label":"convergence-study","identifier":"convergence-study","html_id":"convergence-study","key":"ki5df39CQK"},{"type":"paragraph","position":{"start":{"line":393,"column":1},"end":{"line":393,"column":1}},"children":[{"type":"text","value":"In ","position":{"start":{"line":393,"column":1},"end":{"line":393,"column":1}},"key":"MiXNgKC6nE"},{"type":"crossReference","position":{"start":{"line":393,"column":1},"end":{"line":393,"column":1}},"children":[{"type":"text","value":"the adsorption energies section","position":{"start":{"line":393,"column":1},"end":{"line":393,"column":1}},"key":"uNWleZgGQ3"}],"identifier":"intro-to-adsorption-energies","label":"intro-to-adsorption-energies","kind":"heading","template":"{name}","resolved":true,"html_id":"intro-to-adsorption-energies","key":"pZYTCTzDLA"},{"type":"text","value":" we discussed some possible reasons we might see a discrepancy. Here we investigate some factors that impact the computed energies.","position":{"start":{"line":393,"column":1},"end":{"line":393,"column":1}},"key":"uJAuPActpF"}],"key":"HAV4XMGxxz"},{"type":"paragraph","position":{"start":{"line":395,"column":1},"end":{"line":395,"column":1}},"children":[{"type":"text","value":"In this section, the energies refer to the reaction 1/2 O2 -> O*.","position":{"start":{"line":395,"column":1},"end":{"line":395,"column":1}},"key":"PMIL4eO0gE"}],"key":"IlMirvH2xW"}],"key":"PE81JSRu4N"},{"type":"block","position":{"start":{"line":397,"column":1},"end":{"line":397,"column":1}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":399,"column":1},"end":{"line":399,"column":1}},"children":[{"type":"text","value":"Effects of number of layers","position":{"start":{"line":399,"column":1},"end":{"line":399,"column":1}},"key":"mzjeIPHFKn"}],"identifier":"effects-of-number-of-layers","label":"Effects of number of layers","html_id":"effects-of-number-of-layers","implicit":true,"key":"bSMTrWHaPD"},{"type":"paragraph","position":{"start":{"line":401,"column":1},"end":{"line":401,"column":1}},"children":[{"type":"text","value":"Slab thickness could be a factor. Here we relax the whole slab, and see by about 4 layers the energy is converged to ~0.02 eV.","position":{"start":{"line":401,"column":1},"end":{"line":401,"column":1}},"key":"nYWhhMDGdN"}],"key":"q2mSUb6I2h"}],"key":"EsE2MfuK7u"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"for nlayers in [3, 4, 5, 6, 7, 8]:\n    slab = fcc111(\"Pt\", size=(2, 2, nlayers), vacuum=10.0)\n\n    slab.pbc = True\n    slab.set_calculator(calc)\n    opt_slab = BFGS(slab, logfile=None)\n    opt_slab.run(fmax=0.05, steps=100)\n    slab_e = slab.get_potential_energy()\n\n    adslab = slab.copy()\n    add_adsorbate(adslab, \"O\", height=1.2, position=\"fcc\")\n\n    adslab.pbc = True\n    adslab.set_calculator(calc)\n    opt_adslab = BFGS(adslab, logfile=None)\n    opt_adslab.run(fmax=0.05, steps=100)\n    adslab_e = adslab.get_potential_energy()\n\n    print(\n        f\"nlayers = {nlayers}: {adslab_e - slab_e - atomic_reference_energies['O'] + re1:1.2f} eV\"\n    )","key":"rhEc2Lu3Nf"},{"type":"outputs","id":"hhGoIDkOieoirq3GgqAEs","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"/tmp/ipykernel_9849/338101817.py:5: FutureWarning: Please use atoms.calc = calc\n  slab.set_calculator(calc)\n"},"key":"DDjTmvR6Nt"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"/tmp/ipykernel_9849/338101817.py:14: FutureWarning: Please use atoms.calc = calc\n  adslab.set_calculator(calc)\n"},"key":"Fzog5LFDtq"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"nlayers = 3: -1.58 eV\n"},"key":"btLzEjoyf9"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"nlayers = 4: -1.47 eV\n"},"key":"Tw7W3nUXr3"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"nlayers = 5: -1.47 eV\n"},"key":"ycEaH00ri9"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"nlayers = 6: -1.46 eV\n"},"key":"aocFYAko3h"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"nlayers = 7: -1.47 eV\n"},"key":"Kt7lW9WYQp"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"nlayers = 8: -1.47 eV\n"},"key":"fetCKnzf84"}],"key":"tWTHPLClrh"}],"key":"Ph4EW3T0xi"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":427,"column":1},"end":{"line":427,"column":1}},"children":[{"type":"text","value":"Effects of relaxation","position":{"start":{"line":427,"column":1},"end":{"line":427,"column":1}},"key":"yW0rvgzgCa"}],"identifier":"effects-of-relaxation","label":"Effects of relaxation","html_id":"effects-of-relaxation","implicit":true,"key":"nfqut7Wg9Y"},{"type":"paragraph","position":{"start":{"line":429,"column":1},"end":{"line":429,"column":1}},"children":[{"type":"text","value":"It is common to only relax a few layers, and constrain lower layers to bulk coordinates. We do that here. We only relax the adsorbate and the top layer.","position":{"start":{"line":429,"column":1},"end":{"line":429,"column":1}},"key":"oI3vlD3nKA"}],"key":"dXBIddiu8i"},{"type":"paragraph","position":{"start":{"line":431,"column":1},"end":{"line":431,"column":1}},"children":[{"type":"text","value":"This has a small effect (0.1 eV).","position":{"start":{"line":431,"column":1},"end":{"line":431,"column":1}},"key":"JvwQ5eXb7m"}],"key":"oop1vpgIUo"}],"key":"FYd4wSv1L4"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from ase.constraints import FixAtoms\n\nfor nlayers in [3, 4, 5, 6, 7, 8]:\n    slab = fcc111(\"Pt\", size=(2, 2, nlayers), vacuum=10.0)\n\n    slab.set_constraint(FixAtoms(mask=[atom.tag > 1 for atom in slab]))\n    slab.pbc = True\n    slab.set_calculator(calc)\n    opt_slab = BFGS(slab, logfile=None)\n    opt_slab.run(fmax=0.05, steps=100)\n    slab_e = slab.get_potential_energy()\n\n    adslab = slab.copy()\n    add_adsorbate(adslab, \"O\", height=1.2, position=\"fcc\")\n\n    adslab.set_constraint(FixAtoms(mask=[atom.tag > 1 for atom in adslab]))\n    adslab.pbc = True\n    adslab.set_calculator(calc)\n    opt_adslab = BFGS(adslab, logfile=None)\n    opt_adslab.run(fmax=0.05, steps=100)\n    adslab_e = adslab.get_potential_energy()\n\n    print(\n        f\"nlayers = {nlayers}: {adslab_e - slab_e - atomic_reference_energies['O'] + re1:1.2f} eV\"\n    )","key":"nZJAcwVd76"},{"type":"outputs","id":"sZ8UGnfZlSx-bcN45gs1u","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"/tmp/ipykernel_9849/1426773950.py:8: FutureWarning: Please use atoms.calc = calc\n  slab.set_calculator(calc)\n"},"key":"a92nXFLDqc"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"/tmp/ipykernel_9849/1426773950.py:18: FutureWarning: Please use atoms.calc = calc\n  adslab.set_calculator(calc)\n"},"key":"aAGagajFmu"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"nlayers = 3: -1.47 eV\n"},"key":"HIk3QR8dSF"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"nlayers = 4: -1.35 eV\n"},"key":"Vn12XyKgD7"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"nlayers = 5: -1.35 eV\n"},"key":"dIej15ziyJ"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"nlayers = 6: -1.34 eV\n"},"key":"J8jibWEhBs"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"nlayers = 7: -1.35 eV\n"},"key":"Q4bVm6daxG"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"nlayers = 8: -1.35 eV\n"},"key":"EzjJ555gHj"}],"key":"DIL3LCUt1a"}],"key":"YG4FpDJueS"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":461,"column":1},"end":{"line":461,"column":1}},"children":[{"type":"text","value":"Unit cell size","position":{"start":{"line":461,"column":1},"end":{"line":461,"column":1}},"key":"nsK0bZAI39"}],"identifier":"unit-cell-size","label":"Unit cell size","html_id":"unit-cell-size","implicit":true,"key":"mgc6nYXLJq"},{"type":"paragraph","position":{"start":{"line":463,"column":1},"end":{"line":463,"column":1}},"children":[{"type":"text","value":"Coverage effects are quite noticeable with oxygen. Here we consider larger unit cells. This effect is large, and the results don’t look right, usually adsorption energies get more favorable at lower coverage, not less. This suggests fine-tuning could be important even at low coverages.","position":{"start":{"line":463,"column":1},"end":{"line":463,"column":1}},"key":"VvMphWKIKw"}],"key":"yaA8nBDM1Q"}],"key":"aYFwh1StJx"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"for size in [1, 2, 3, 4, 5]:\n\n    slab = fcc111(\"Pt\", size=(size, size, 5), vacuum=10.0)\n\n    slab.set_constraint(FixAtoms(mask=[atom.tag > 1 for atom in slab]))\n    slab.pbc = True\n    slab.set_calculator(calc)\n    opt_slab = BFGS(slab, logfile=None)\n    opt_slab.run(fmax=0.05, steps=100)\n    slab_e = slab.get_potential_energy()\n\n    adslab = slab.copy()\n    add_adsorbate(adslab, \"O\", height=1.2, position=\"fcc\")\n\n    adslab.set_constraint(FixAtoms(mask=[atom.tag > 1 for atom in adslab]))\n    adslab.pbc = True\n    adslab.set_calculator(calc)\n    opt_adslab = BFGS(adslab, logfile=None)\n    opt_adslab.run(fmax=0.05, steps=100)\n    adslab_e = adslab.get_potential_energy()\n\n    print(\n        f\"({size}x{size}): {adslab_e - slab_e - atomic_reference_energies['O'] + re1:1.2f} eV\"\n    )","key":"lKWSXxQBjS"},{"type":"outputs","id":"lqMkt13qpTrlkMLm7gEjz","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"/tmp/ipykernel_9849/3371624330.py:7: FutureWarning: Please use atoms.calc = calc\n  slab.set_calculator(calc)\n"},"key":"lstupZMNGA"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"/tmp/ipykernel_9849/3371624330.py:17: FutureWarning: Please use atoms.calc = calc\n  adslab.set_calculator(calc)\n"},"key":"LXhS8MbyHl"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"(1x1): -0.12 eV\n"},"key":"wmq6jRKOmu"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"(2x2): -1.35 eV\n"},"key":"e04MU9K1jS"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"(3x3): -1.38 eV\n"},"key":"xftEvSz8O5"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"(4x4): -1.41 eV\n"},"key":"lwJ31PFdRE"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"(5x5): -1.42 eV\n"},"key":"inGhVw2w7V"}],"key":"ltaAaVXyA4"}],"key":"ZU1QFFNsmX"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":492,"column":1},"end":{"line":492,"column":1}},"children":[{"type":"text","value":"Summary","position":{"start":{"line":492,"column":1},"end":{"line":492,"column":1}},"key":"mxEs95TKP0"}],"identifier":"summary","label":"Summary","html_id":"summary","implicit":true,"key":"TVZmFvGSJ5"},{"type":"paragraph","position":{"start":{"line":494,"column":1},"end":{"line":494,"column":1}},"children":[{"type":"text","value":"As with DFT, you should take care to see how these kinds of decisions affect your results, and determine if they would change any interpretations or not.","position":{"start":{"line":494,"column":1},"end":{"line":494,"column":1}},"key":"yDzaBOOEEX"}],"key":"CUWy8TNobk"}],"key":"i3vP4EWZeS"}],"key":"D7Xa7yfWJm"},"references":{"cite":{"order":["Xu_2014"],"data":{"Xu_2014":{"label":"Xu_2014","enumerator":"1","doi":"10.1021/jp508805h","html":"Xu, Z., & Kitchin, J. R. (2014). Probing the Coverage Dependence of Site and Adsorbate Configurational Correlations on (111) Surfaces of Late Transition Metals. <i>The Journal of Physical Chemistry C</i>, <i>118</i>(44), 25597–25602. <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.1021/jp508805h\">10.1021/jp508805h</a>","url":"https://doi.org/10.1021/jp508805h"}}}},"footer":{"navigation":{"prev":{"title":"Examples & Tutorials","url":"/summary-4","group":"Heterogeneous Catalysis"},"next":{"title":"Expert Adsorption Energies","url":"/adsorption-energies","group":"Heterogeneous Catalysis"}}},"domain":"http://localhost:3000"}