{"version":3,"kind":"Notebook","sha256":"c74d4534c2d261d3b457cc172f3925a9d06f4b9abbc11220cab7eed35a1343ef","slug":"ocp-introduction","location":"/catalysts/examples_tutorials/OCP-introduction.md","dependencies":[],"frontmatter":{"title":"Intro to Adsorption Energies","kernelspec":{"name":"python3","display_name":"Python 3 (ipykernel)","language":"python"},"jupytext":{"formats":"md:myst,ipynb","text_representation":{"extension":".md","format_name":"myst","format_version":"0.13","jupytext_version":"1.17.1"}},"content_includes_title":false,"authors":[{"nameParsed":{"literal":"FAIR Chemistry & Collaborators","given":"FAIR Chemistry &","family":"Collaborators"},"name":"FAIR Chemistry & Collaborators","id":"contributors-myst-generated-uid-0"}],"github":"https://github.com/facebookresearch/fairchem","copyright":"Meta Platforms, Inc","numbering":{"title":{"offset":2}},"source_url":"https://github.com/facebookresearch/fairchem/blob/main/docs/catalysts/examples_tutorials/OCP-introduction.md","edit_url":"https://github.com/facebookresearch/fairchem/edit/main/docs/catalysts/examples_tutorials/OCP-introduction.md","exports":[{"format":"md","filename":"OCP-introduction.md","url":"/build/OCP-introduction-d4e2b197d0ff9e97f81e97c8aaf2a7a5.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"card","children":[{"type":"cardTitle","children":[{"type":"text","value":"Tutorial Overview","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"VRr4LAm5V6"}],"key":"kvNVjkGwJ9"},{"type":"table","position":{"start":{"line":19,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"tableRow","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"tableCell","header":true,"position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"Property","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"nfh05GMU3x"}],"key":"N5IdrfwwtV"},{"type":"tableCell","header":true,"position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"Value","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"noOMvhunk9"}],"key":"Mv81wLdvpK"}],"key":"LDL9ky52Q0"},{"type":"tableRow","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"strong","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"Difficulty","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"Qf2YHnUIBn"}],"key":"wPRYN3nF06"}],"key":"Vxsoy9XGUO"},{"type":"tableCell","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"Beginner","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"hvJjdQUb9l"}],"key":"T2LvnaZaGM"}],"key":"wXMOwOmlX9"},{"type":"tableRow","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"strong","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"Time","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"gM7Mi4A9KN"}],"key":"yhXkIEGaAW"}],"key":"DkcCachkvs"},{"type":"tableCell","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"15-30 minutes","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"L5fmzMZSzL"}],"key":"mMgR43hLNA"}],"key":"HuLvrYyx3g"},{"type":"tableRow","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"strong","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"Prerequisites","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"WyFyaF4jkc"}],"key":"Cm8nsfKHAe"}],"key":"A2R7SHAqMl"},{"type":"tableCell","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"Basic Python, familiarity with ASE","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"jzSfHW6k26"}],"key":"srgZNgnUS9"}],"key":"TLeuJzQhh2"},{"type":"tableRow","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"strong","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"Goal","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"TvARtZ0YT2"}],"key":"I7bU8jXnYd"}],"key":"TSvHTMk7VQ"},{"type":"tableCell","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"Calculate adsorption energies using UMA models","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"mWffnFeL3b"}],"key":"SaAQXcwyLo"}],"key":"JbIPwdch3S"}],"key":"dSjrIZiooI"}],"key":"dl9x6UgnaD"},{"type":"paragraph","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"text","value":"To introduce OCP we start with using it to calculate adsorption energies for a simple, atomic adsorbate where we specify the site we want to the adsorption energy for. Conceptually, you do this like you would do it with density functional theory. You create a slab model for the surface, place an adsorbate on it as an initial guess, run a relaxation to get the lowest energy geometry, and then compute the adsorption energy using reference states for the adsorbate.","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"zCO7c6GJiu"}],"key":"pNcCd16y3M"},{"type":"admonition","kind":"important","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Important","key":"Y9mwvTLd3k"}],"key":"hHVbXpNII8"},{"type":"paragraph","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"text","value":"Some OCP model/checkpoint combinations return a total energy like density functional theory would, but some return an “adsorption energy” directly. You have to know which one you are using. In this example, the model we use returns an “adsorption energy”.","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"JTwHzkvWhJ"}],"key":"xw2rXIkXEE"}],"key":"rNAzpkbfQE"}],"key":"urE4c58hNy"},{"type":"block","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"text","value":"Intro to Adsorption energies","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"YzgMLK7sSN"}],"label":"intro-to-adsorption-energies","identifier":"intro-to-adsorption-energies","html_id":"intro-to-adsorption-energies","key":"NJFVyVBReh"},{"type":"paragraph","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"children":[{"type":"text","value":"Adsorption energies are always a reaction energy (an adsorbed species relative to some implied combination of reactants). There are many common schemes in the catalysis literature.","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"key":"FdKIxKA2mU"}],"key":"YESLIIKVFS"},{"type":"paragraph","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"children":[{"type":"text","value":"For example, you may want the adsorption energy of oxygen, and you might compute that from this reaction:","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"FzaJCtBeQH"}],"key":"w3w46DSYcR"},{"type":"code","lang":"","value":"1/2 O2 + slab -> slab-O","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"key":"iZ1hHAhzMF"},{"type":"paragraph","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"children":[{"type":"text","value":"DFT has known errors with the energy of a gas-phase O2 molecule, so it’s more common to compute this energy relative to a linear combination of H2O and H2. The suggested reference scheme for consistency with OC20 is a reaction","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"key":"Ovj03JDlYG"}],"key":"Q0xmVqxgZy"},{"type":"code","lang":"","value":"x CO + (x + y/2 - z) H2 + (z-x) H2O + w/2 N2 + * -> CxHyOzNw*","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"key":"v365EpFnQo"},{"type":"paragraph","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"children":[{"type":"text","value":"Here, x=y=w=0, z=1, so the reaction ends up as","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"xbSoFM2MLa"}],"key":"zTHCRQiGJT"},{"type":"code","lang":"","value":"-H2 + H2O + * -> O*","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"X7Nq07k8hn"},{"type":"paragraph","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"children":[{"type":"text","value":"or alternatively,","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"key":"Hq565owYX6"}],"key":"vqDeBM427k"},{"type":"code","lang":"","value":"H2O + * -> O* + H2","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"key":"x5JrkNZnQb"},{"type":"paragraph","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"children":[{"type":"text","value":"It is possible through thermodynamic cycles to compute other reactions. If we can look up rH1 below and compute rH2","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"Rz14HrPgq5"}],"key":"ihQoiZzvem"},{"type":"code","lang":"","value":"H2 + 1/2 O2 -> H2O  re1 = -3.03 eV, from exp\nH2O + * -> O* + H2  re2  # Get from UMA","position":{"start":{"line":58,"column":1},"end":{"line":59,"column":1}},"key":"cqdxfLAlaU"},{"type":"paragraph","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"children":[{"type":"text","value":"Then, the adsorption energy for","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"tCj8GSKPY9"}],"key":"tUlp9gQ1AL"},{"type":"code","lang":"","value":"1/2O2 + * -> O*","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"key":"H313NRhBhI"},{"type":"paragraph","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"children":[{"type":"text","value":"is just re1 + re2.","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"qGXmyOMaPi"}],"key":"mwkySOsjqu"},{"type":"paragraph","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"children":[{"type":"text","value":"Based on ","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"CGK92thH4L"},{"type":"link","url":"https://atct.anl.gov/Thermochemical%20Data/version%201.118/species/?species_number=986","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"children":[{"type":"text","value":"https://atct.anl.gov/Thermochemical Data/version 1.118/species/?species_number=986","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"r0F6vwl5Ly"}],"urlSource":"https://atct.anl.gov/Thermochemical%20Data/version%201.118/species/?species_number=986","key":"U1yAYPBf7S"},{"type":"text","value":", the formation energy of water is about -3.03 eV at standard state experimentally. You could also compute this using DFT, but you would probably get the wrong answer for this.","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"kWNQnqG77R"}],"key":"tfyviB9WWm"},{"type":"paragraph","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"children":[{"type":"text","value":"The first step is getting a checkpoint for the model we want to use. UMA is currently the state-of-the-art model and will provide total energy estimates at the RPBE level of theory if you use the “OC20” task.","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"key":"k2fMzqIcop"}],"key":"ySuhDIzasV"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Need to install fairchem-core or get UMA access or getting permissions/401 errors?","position":{"start":{"line":72,"column":1},"end":{"line":72,"column":1}},"key":"dHg0IeYDjr"}],"key":"JTgYALZ5Qg"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Install the necessary packages using pip, uv etc","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"key":"dPlyjkD0yu"}],"key":"vn0EgdaPx2"}],"key":"ha7Tim6rAf"}],"key":"tZbOXiPIfH"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"! pip install fairchem-core fairchem-data-oc fairchem-applications-cattsunami","visibility":"show","key":"KBHMXPMvnt"},{"type":"outputs","id":"NltuFir2zTHOd72rHUBmE","children":[],"visibility":"show","key":"jlv1KJOaYw"}],"data":{"tags":["skip-execution"]},"visibility":"show","key":"djUgFWMj3g"},{"type":"list","ordered":true,"start":2,"spread":false,"position":{"start":{"line":83,"column":1},"end":{"line":88,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":83,"column":1},"end":{"line":88,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Get access to any necessary huggingface gated models","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"key":"gTxgb1qXJS"}],"key":"wQXpItKvHF"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":84,"column":1},"end":{"line":88,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Get and login to your Huggingface account","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"key":"Eg7etV0gzJ"}],"key":"G10HEabDHW"}],"key":"ixYO0w0tWY"},{"type":"listItem","spread":true,"position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Request access to ","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"key":"fr07K6rd8U"},{"type":"link","url":"https://huggingface.co/facebook/UMA","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"children":[{"type":"text","value":"https://​huggingface​.co​/facebook​/UMA","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"key":"holxUxhqdf"}],"urlSource":"https://huggingface.co/facebook/UMA","key":"jLwFTahvW6"}],"key":"ZTVvnaDEsQ"}],"key":"a3ssaUaBqV"},{"type":"listItem","spread":true,"position":{"start":{"line":86,"column":1},"end":{"line":86,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Create a Huggingface token at ","position":{"start":{"line":86,"column":1},"end":{"line":86,"column":1}},"key":"RHma5J2qAh"},{"type":"link","url":"https://huggingface.co/settings/tokens/","position":{"start":{"line":86,"column":1},"end":{"line":86,"column":1}},"children":[{"type":"text","value":"https://​huggingface​.co​/settings​/tokens/","position":{"start":{"line":86,"column":1},"end":{"line":86,"column":1}},"key":"x9eZ8yepEr"}],"urlSource":"https://huggingface.co/settings/tokens/","key":"RiSKC0idlV"},{"type":"text","value":" with the permission “Permissions: Read access to contents of all public gated repos you can access”","position":{"start":{"line":86,"column":1},"end":{"line":86,"column":1}},"key":"hqsQvTqY5O"}],"key":"rnpmylR5Hc"}],"key":"f2aghEcr60"},{"type":"listItem","spread":true,"position":{"start":{"line":87,"column":1},"end":{"line":88,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Add the token as an environment variable using ","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"eG8mnwmH1z"},{"type":"inlineCode","value":"huggingface-cli login","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"xhYkDqWFhR"},{"type":"text","value":" or by setting the HF_TOKEN environment variable.","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"e99ItUBKGA"}],"key":"FU12NAvW1Y"}],"key":"w6UxbaePf5"}],"key":"XJMMQSZa59"}],"key":"tD4A8WcNvL"}],"key":"hg3nccN2VS"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Login using the huggingface-cli utility\n! huggingface-cli login\n\n# alternatively,\nimport os\nos.environ['HF_TOKEN'] = 'MY_TOKEN'","visibility":"show","key":"LPFbtIyj0h"},{"type":"outputs","id":"8UOzi56flMOCz8NJAxrcS","children":[],"visibility":"show","key":"jvjot2jpVq"}],"data":{"tags":["skip-execution"]},"visibility":"show","key":"CoXN2UCBcw"}],"class":"dropdown","key":"oFwjjsUo27"},{"type":"paragraph","position":{"start":{"line":102,"column":1},"end":{"line":102,"column":1}},"children":[{"type":"text","value":"If you find your kernel is crashing, it probably means you have exceeded the allowed amount of memory. This checkpoint works fine in this example, but it may crash your kernel if you use it in the NRR example.","position":{"start":{"line":102,"column":1},"end":{"line":102,"column":1}},"key":"M78mh1hSp0"}],"key":"m4YIxDeflh"},{"type":"paragraph","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"children":[{"type":"text","value":"This next cell will automatically download the checkpoint from huggingface and load it.","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"key":"qO0M7cmOeH"}],"key":"tusqtdPHht"}],"key":"cAGXjYo7Xu"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from __future__ import annotations\n\nfrom fairchem.core import FAIRChemCalculator, pretrained_mlip\n\npredictor = pretrained_mlip.get_predict_unit(\"uma-s-1p1\")\ncalc = FAIRChemCalculator(predictor, task_name=\"oc20\")","key":"v1SoXL7PSc"},{"type":"outputs","id":"2kCU5m66qi553uHQqSCcp","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Warp DeprecationWarning: The symbol `warp.vec` will soon be removed from the public API. Use `warp.types.vector` instead.\n"},"key":"lHGQUYjUzb"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"WARNING:root:device was not explicitly set, using device='cuda'.\n"},"key":"Qz6meaPx5A"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"WARNING:root:If 'dataset_list' is provided in the config, the code assumes that each dataset maps to itself. Please use 'dataset_mapping' as 'dataset_list' is deprecated and will be removed in the future.\n"},"key":"LVPWDheQiw"}],"key":"j8yG08cGFY"}],"key":"onF8Sge8WZ"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"children":[{"type":"text","value":"Next we can build a slab with an adsorbate on it. Here we use the ASE module to build a Pt slab. We use the experimental lattice constant that is the default. This can introduce some small errors with DFT since the lattice constant can differ by a few percent, and it is common to use DFT lattice constants. In this example, we do not constrain any layers.","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"key":"kMG0SFfqM7"}],"key":"BMRRCG1zAa"}],"key":"w7WCVhJUy5"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from ase.build import add_adsorbate, fcc111\nfrom ase.optimize import BFGS","key":"v83LgehKZy"},{"type":"outputs","id":"eLqY5N_UIouo-RDAsd8W3","children":[],"key":"e7xvQy7Zqh"}],"key":"YEJFHpPXI8"},{"type":"block","children":[],"key":"mWwd7NiuWW"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# reference energies from a linear combination of H2O/N2/CO/H2!\natomic_reference_energies = {\n    \"H\": -3.477,\n    \"N\": -8.083,\n    \"O\": -7.204,\n    \"C\": -7.282,\n}\n\nre1 = -3.03\n\nslab = fcc111(\"Pt\", size=(2, 2, 5), vacuum=20.0)\nslab.pbc = True\n\nadslab = slab.copy()\nadd_adsorbate(adslab, \"O\", height=1.2, position=\"fcc\")\n\nslab.set_calculator(calc)\nopt = BFGS(slab)\nopt.run(fmax=0.05, steps=100)\nslab_e = slab.get_potential_energy()\n\nadslab.set_calculator(calc)\nopt = BFGS(adslab)\nopt.run(fmax=0.05, steps=100)\nadslab_e = adslab.get_potential_energy()\n\n# Energy for ((H2O-H2) + * -> *O) + (H2 + 1/2O2 -> H2) leads to 1/2O2 + * -> *O!\nadslab_e - slab_e - atomic_reference_energies[\"O\"] + re1","key":"Z1hmRPgmkA"},{"type":"outputs","id":"mKT066sDfUDpNcRqA9Mwr","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"/tmp/ipykernel_10908/3752951811.py:17: FutureWarning: Please use atoms.calc = calc\n  slab.set_calculator(calc)\n"},"key":"cz5cDlSuz2"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"      Step     Time          Energy          fmax\nBFGS:    0 22:46:44     -104.695194        0.709590\n"},"key":"r5ceTXn8Jc"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    1 22:46:44     -104.753187        0.607748\n"},"key":"mDHwrUpnRw"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    2 22:46:45     -104.906057        0.369388\n"},"key":"GulhZdNGVB"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    3 22:46:45     -104.938753        0.439757\n"},"key":"Ilz9Ybaq4a"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    4 22:46:45     -105.016144        0.464013\n"},"key":"cpcOC01ZUm"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    5 22:46:45     -105.076561        0.356061\n"},"key":"ckC6n74AT7"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    6 22:46:46     -105.112621        0.189419\n"},"key":"RcWHf4NIY0"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    7 22:46:46     -105.126759        0.045372\n"},"key":"p93Lh8sFrq"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"/tmp/ipykernel_10908/3752951811.py:22: FutureWarning: Please use atoms.calc = calc\n  adslab.set_calculator(calc)\n"},"key":"XVMOsEa8GK"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"      Step     Time          Energy          fmax\nBFGS:    0 22:46:46     -110.048787        1.757516\n"},"key":"jE0PwyNU6x"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    1 22:46:46     -110.230720        0.986273\n"},"key":"aHOhEcBxwT"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    2 22:46:47     -110.379352        0.731503\nBFGS:    3 22:46:47     -110.430290        0.807334\n"},"key":"xwkkDinTYU"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    4 22:46:47     -110.543668        0.692012\n"},"key":"zY208klr2R"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    5 22:46:47     -110.617474        0.492776\n"},"key":"w4OuZbfKcv"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    6 22:46:48     -110.673456        0.666959\n"},"key":"GTGByEGYoe"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    7 22:46:48     -110.721678        0.710534\nBFGS:    8 22:46:48     -110.756901        0.443867\n"},"key":"iwNH2fnGRF"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    9 22:46:48     -110.769294        0.214562\n"},"key":"XhGwMnnCkG"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:   10 22:46:49     -110.772450        0.091757\nBFGS:   11 22:46:49     -110.772965        0.062473\n"},"key":"vs8NNMN19M"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:   12 22:46:49     -110.773259        0.046203\n"},"key":"xd60xVnLTn"},{"type":"output","children":[],"jupyter_data":{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"text/plain":{"content":"-1.472500582439586","content_type":"text/plain"}}},"key":"iO0zQzf09L"}],"key":"xRtdHH6yCJ"}],"key":"uFDvGsEnot"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":153,"column":1},"end":{"line":153,"column":1}},"children":[{"type":"text","value":"It is good practice to look at your geometries to make sure they are what you expect.","position":{"start":{"line":153,"column":1},"end":{"line":153,"column":1}},"key":"XHCnUFR7tx"}],"key":"OtYVF3GP0Z"}],"key":"JCtVRs5YNe"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import matplotlib.pyplot as plt\nfrom ase.visualize.plot import plot_atoms\n\nfig, axs = plt.subplots(1, 2)\nplot_atoms(slab, axs[0])\nplot_atoms(slab, axs[1], rotation=(\"-90x\"))\naxs[0].set_axis_off()\naxs[1].set_axis_off()","key":"g6P0WZMLnq"},{"type":"outputs","id":"c9NzpKOyH2VC_gyKRVXY9","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 640x480 with 2 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"4fd897755393b328b7ee6321f012716a","path":"/build/4fd897755393b328b7ee6321f012716a.png"}}},"key":"OKde8XFFEe"}],"key":"nFdnuTdDm9"}],"key":"uCxPYGK5sc"},{"type":"block","children":[],"key":"vaFjYh0gek"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import matplotlib.pyplot as plt\nfrom ase.visualize.plot import plot_atoms\n\nfig, axs = plt.subplots(1, 2)\nplot_atoms(adslab, axs[0])\nplot_atoms(adslab, axs[1], rotation=(\"-90x\"))\naxs[0].set_axis_off()\naxs[1].set_axis_off()","key":"S5w8DtcWjZ"},{"type":"outputs","id":"4rzkAbNIulimFr9dXhcN4","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 640x480 with 2 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"b427e4e8b413b036d7f767f49a677d4d","path":"/build/b427e4e8b413b036d7f767f49a677d4d.png"}}},"key":"YFnN60GLs5"}],"key":"cFUxWOtzAU"}],"key":"CZa5ewi4wk"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":177,"column":1},"end":{"line":177,"column":1}},"children":[{"type":"text","value":"How did we do? We need a reference point. In the paper below, there is an atomic adsorption energy for O on Pt(111) of about -4.264 eV. This is for the reaction O + * -> O*. To convert this to the dissociative adsorption energy, we have to add the reaction:","position":{"start":{"line":177,"column":1},"end":{"line":177,"column":1}},"key":"frLCf6SMaj"}],"key":"gmv6aM1gi0"},{"type":"code","lang":"","value":"1/2 O2 -> O   D = 2.58 eV (expt)","position":{"start":{"line":179,"column":1},"end":{"line":179,"column":1}},"key":"VACDSlCkBP"},{"type":"paragraph","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"children":[{"type":"text","value":"to get a comparable energy of about -1.68 eV. There is about ~0.2 eV difference (we predicted -1.47 eV above, and the reference comparison is -1.68 eV) to account for. The biggest difference is likely due to the differences in exchange-correlation functional. The reference data used the PBE functional, and eSCN was trained on ","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"MTeRUheQBl"},{"type":"emphasis","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"children":[{"type":"text","value":"RPBE","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"TyqSlfolg4"}],"key":"TOSYNeik4L"},{"type":"text","value":" data. To additional places where there are differences include:","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"ey9ZFSzN9v"}],"key":"y0vwPS1bdw"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":183,"column":1},"end":{"line":186,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Difference in lattice constant","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"key":"xBwvIIMg7b"}],"key":"rexteqY6iB"}],"key":"jioQV2DkNN"},{"type":"listItem","spread":true,"position":{"start":{"line":184,"column":1},"end":{"line":184,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"The reference energy used for the experiment references. These can differ by up to 0.5 eV from comparable DFT calculations.","position":{"start":{"line":184,"column":1},"end":{"line":184,"column":1}},"key":"VG455uo01x"}],"key":"vBAkpPttq8"}],"key":"L3x0iGJIwJ"},{"type":"listItem","spread":true,"position":{"start":{"line":185,"column":1},"end":{"line":186,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"How many layers are relaxed in the calculation","position":{"start":{"line":185,"column":1},"end":{"line":185,"column":1}},"key":"r07ozHulfl"}],"key":"pqONq02xgQ"}],"key":"Z7uF3086Af"}],"key":"IpCHiXE5La"},{"type":"paragraph","position":{"start":{"line":187,"column":1},"end":{"line":187,"column":1}},"children":[{"type":"text","value":"Some of these differences tend to be systematic, and you can calibrate and correct these, especially if you can augment these with your own DFT calculations.","position":{"start":{"line":187,"column":1},"end":{"line":187,"column":1}},"key":"b3PTuFs3rN"}],"key":"IMxUlQHFnV"},{"type":"paragraph","position":{"start":{"line":189,"column":1},"end":{"line":189,"column":1}},"children":[{"type":"text","value":"See ","position":{"start":{"line":189,"column":1},"end":{"line":189,"column":1}},"key":"MOZq2fehIy"},{"type":"crossReference","position":{"start":{"line":189,"column":1},"end":{"line":189,"column":1}},"children":[{"type":"text","value":"convergence study","position":{"start":{"line":189,"column":1},"end":{"line":189,"column":1}},"key":"IxVsYXWVCD"}],"identifier":"convergence-study","label":"convergence-study","kind":"heading","template":"{name}","resolved":true,"html_id":"convergence-study","key":"T8nIp4seG3"},{"type":"text","value":" for some additional studies of factors that influence this number.","position":{"start":{"line":189,"column":1},"end":{"line":189,"column":1}},"key":"UM5nDZCJuL"}],"key":"oM9YT5Q9QX"}],"key":"ozpZ42fJ8N"},{"type":"block","position":{"start":{"line":191,"column":1},"end":{"line":191,"column":1}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":193,"column":1},"end":{"line":193,"column":1}},"children":[{"type":"text","value":"Exercises","position":{"start":{"line":193,"column":1},"end":{"line":193,"column":1}},"key":"Exj8WsxMx4"}],"identifier":"exercises","label":"Exercises","html_id":"exercises","implicit":true,"key":"dhJOdaoYWX"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":195,"column":1},"end":{"line":197,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":195,"column":1},"end":{"line":195,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Explore the effect of the lattice constant on the adsorption energy.","position":{"start":{"line":195,"column":1},"end":{"line":195,"column":1}},"key":"y3yiq7ITAr"}],"key":"vJSGX13qQ0"}],"key":"B8nfBRPmTr"},{"type":"listItem","spread":true,"position":{"start":{"line":196,"column":1},"end":{"line":197,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Try different sites, including the bridge and top sites. Compare the energies, and inspect the resulting geometries.","position":{"start":{"line":196,"column":1},"end":{"line":196,"column":1}},"key":"k2uSkNdNta"}],"key":"vkmcmrsWf3"}],"key":"vtfK5rQ2dt"}],"key":"PWhEH81OeX"}],"key":"TIitaM497s"},{"type":"block","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"children":[{"type":"text","value":"Trends in adsorption energies across metals.","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"mv9rA2O38Y"}],"identifier":"trends-in-adsorption-energies-across-metals","label":"Trends in adsorption energies across metals.","html_id":"trends-in-adsorption-energies-across-metals","implicit":true,"key":"wvL0rKBnj1"},{"type":"paragraph","position":{"start":{"line":202,"column":1},"end":{"line":202,"column":1}},"children":[{"type":"text","value":"Xu, Z., & Kitchin, J. R. (2014). Probing the coverage dependence of site and adsorbate configurational correlations on (111) surfaces of late transition metals. J. Phys. Chem. C, 118(44), 25597–25602. ","position":{"start":{"line":202,"column":1},"end":{"line":202,"column":1}},"key":"JiwuuDRby3"},{"type":"cite","url":"http://dx.doi.org/10.1021/jp508805h","position":{"start":{"line":202,"column":1},"end":{"line":202,"column":1}},"children":[{"type":"text","value":"Xu & Kitchin (2014)","key":"wCkgSKNcKI"}],"kind":"narrative","label":"Xu_2014","identifier":"http://dx.doi.org/10.1021/jp508805h","enumerator":"1","key":"xjfJhAzvmp"}],"key":"nKflT2doRq"},{"type":"paragraph","position":{"start":{"line":204,"column":1},"end":{"line":204,"column":1}},"children":[{"type":"cite","url":"https://pubs.acs.org/doi/suppl/10.1021/jp508805h/suppl_file/jp508805h_si_001.pdf","position":{"start":{"line":204,"column":1},"end":{"line":204,"column":1}},"children":[{"type":"text","value":"Supporting information","position":{"start":{"line":204,"column":1},"end":{"line":204,"column":1}},"key":"fZB8tXY69t"}],"kind":"narrative","label":"Xu_2014","identifier":"https://pubs.acs.org/doi/suppl/10.1021/jp508805h/suppl_file/jp508805h_si_001.pdf","enumerator":"1","key":"NNrkSXQWyK"},{"type":"text","value":".","position":{"start":{"line":204,"column":1},"end":{"line":204,"column":1}},"key":"a90ey7nUu4"}],"key":"ZKqJ3c1xTc"},{"type":"paragraph","position":{"start":{"line":206,"column":1},"end":{"line":206,"column":1}},"children":[{"type":"text","value":"These are atomic adsorption energies:","position":{"start":{"line":206,"column":1},"end":{"line":206,"column":1}},"key":"gIWB735eRo"}],"key":"OE4mToRjui"},{"type":"code","lang":"","value":"O + * -> O*","position":{"start":{"line":208,"column":1},"end":{"line":208,"column":1}},"key":"ijB8iTedqC"},{"type":"paragraph","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"children":[{"type":"text","value":"We have to do some work to get comparable numbers from OCP","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"key":"evz09P7tmA"}],"key":"hIrhXfAuU3"},{"type":"code","lang":"","value":"H2 + 1/2 O2 -> H2O  re1 = -3.03 eV\nH2O + * -> O* + H2  re2   # Get from UMA\nO -> 1/2 O2         re3 = -2.58 eV","position":{"start":{"line":212,"column":1},"end":{"line":214,"column":1}},"key":"UmkYTaL0es"},{"type":"paragraph","position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"children":[{"type":"text","value":"Then, the adsorption energy for","position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"key":"u37Gryacwg"}],"key":"m0y6fLBfb6"},{"type":"code","lang":"","value":"O + * -> O*","position":{"start":{"line":218,"column":1},"end":{"line":218,"column":1}},"key":"VE9m1JJIW0"},{"type":"paragraph","position":{"start":{"line":220,"column":1},"end":{"line":220,"column":1}},"children":[{"type":"text","value":"is just re1 + re2 + re3.","position":{"start":{"line":220,"column":1},"end":{"line":220,"column":1}},"key":"Lc5hWX7Q4G"}],"key":"nwU2zIWsY1"},{"type":"paragraph","position":{"start":{"line":222,"column":1},"end":{"line":222,"column":1}},"children":[{"type":"text","value":"Here we just look at the fcc site on Pt. First, we get the data stored in the paper.","position":{"start":{"line":222,"column":1},"end":{"line":222,"column":1}},"key":"iUp5I7Bked"}],"key":"FzA1wVRRtZ"},{"type":"paragraph","position":{"start":{"line":224,"column":1},"end":{"line":224,"column":1}},"children":[{"type":"text","value":"Next we get the structures and compute their energies. Some subtle points are that we have to account for stoichiometry, and normalize the adsorption energy by the number of oxygens.","position":{"start":{"line":224,"column":1},"end":{"line":224,"column":1}},"key":"Zepd261CeY"}],"key":"aX0m7gshNs"}],"key":"H3Rvkj9KsB"},{"type":"block","position":{"start":{"line":226,"column":1},"end":{"line":226,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":228,"column":1},"end":{"line":228,"column":1}},"children":[{"type":"text","value":"First we get a reference energy from the paper (PBE, 0.25 ML O on Pt(111)).","position":{"start":{"line":228,"column":1},"end":{"line":228,"column":1}},"key":"PzRLAjAQ9O"}],"key":"VKpupey0zA"}],"key":"ePLCZSXouF"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import json\n\nwith open(\"energies.json\") as f:\n    edata = json.load(f)\n\nwith open(\"structures.json\") as f:\n    sdata = json.load(f)\n\nedata[\"Pt\"][\"O\"][\"fcc\"][\"0.25\"]","key":"W5zp4Wdtfd"},{"type":"outputs","id":"4nrF5V0zd1xqQFlq0f1QS","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"text/plain":{"content":"-4.263842000000002","content_type":"text/plain"}}},"key":"DCkoM8tZ5N"}],"key":"YZC2gBq88j"}],"key":"LSpVWqjppw"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":242,"column":1},"end":{"line":242,"column":1}},"children":[{"type":"text","value":"Next, we load data from the SI to get the geometry to start from.","position":{"start":{"line":242,"column":1},"end":{"line":242,"column":1}},"key":"R4QRUIHOn5"}],"key":"KFWlHwTDqc"}],"key":"QodI4GgEuk"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"with open(\"structures.json\") as f:\n    s = json.load(f)\n\nsfcc = s[\"Pt\"][\"O\"][\"fcc\"][\"0.25\"]","key":"udf4mndQIy"},{"type":"outputs","id":"BiquCsdatxR7-uzPdsJZ4","children":[],"key":"Tsvprju6Ku"}],"key":"XsTmrxJzqa"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":251,"column":1},"end":{"line":251,"column":1}},"children":[{"type":"text","value":"Next, we construct the atomic geometry, run the geometry optimization, and compute the energy.","position":{"start":{"line":251,"column":1},"end":{"line":251,"column":1}},"key":"XoGwPtG4d6"}],"key":"zq7oEIsJ40"}],"key":"CkEXBmx2ZX"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"re3 = -2.58  # O -> 1/2 O2         re3 = -2.58 eV\n\nfrom ase import Atoms\n\nadslab = Atoms(sfcc[\"symbols\"], positions=sfcc[\"pos\"], cell=sfcc[\"cell\"], pbc=True)\n\n# Grab just the metal surface atoms\nslab = adslab[adslab.arrays[\"numbers\"] == adslab.arrays[\"numbers\"][0]]\nadsorbates = adslab[~(adslab.arrays[\"numbers\"] == adslab.arrays[\"numbers\"][0])]\nslab.set_calculator(calc)\nopt = BFGS(slab)\nopt.run(fmax=0.05, steps=100)\n\nadslab.set_calculator(calc)\nopt = BFGS(adslab)\n\nopt.run(fmax=0.05, steps=100)\nre2 = (\n    adslab.get_potential_energy()\n    - slab.get_potential_energy()\n    - sum([atomic_reference_energies[x] for x in adsorbates.get_chemical_symbols()])\n)\n\nnO = 0\nfor atom in adslab:\n    if atom.symbol == \"O\":\n        nO += 1\n        re2 += re1 + re3\n\nprint(re2 / nO)","key":"vYBuyd1UXO"},{"type":"outputs","id":"xtMNhcFsPZf7aZkof-BKJ","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"/tmp/ipykernel_10908/647904475.py:10: FutureWarning: Please use atoms.calc = calc\n  slab.set_calculator(calc)\n"},"key":"ako7Mjw5Yl"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"      Step     Time          Energy          fmax\nBFGS:    0 22:46:52      -82.862062        1.000262\n"},"key":"cSHAPN8KQn"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    1 22:46:53      -82.918113        0.752920\n"},"key":"inaGBiGxx0"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    2 22:46:53      -83.011694        0.335860\nBFGS:    3 22:46:53      -83.016496        0.303120\n"},"key":"udA6DtC4rB"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    4 22:46:53      -83.024495        0.224963\n"},"key":"myBmC5zgZW"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    5 22:46:54      -83.030036        0.152566\n"},"key":"JIjdHZKzqT"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    6 22:46:54      -83.033361        0.088624\n"},"key":"h8XNlvjaWf"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    7 22:46:54      -83.034469        0.065748\n"},"key":"Dm9kk4nNcG"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    8 22:46:55      -83.035208        0.068688\n"},"key":"sPuFyeaWCb"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    9 22:46:55      -83.035564        0.046753\n"},"key":"PFv9dUvf5z"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"/tmp/ipykernel_10908/647904475.py:14: FutureWarning: Please use atoms.calc = calc\n  adslab.set_calculator(calc)\n"},"key":"eCw83gg3SS"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"      Step     Time          Energy          fmax\nBFGS:    0 22:46:55      -88.770343        0.312349\n"},"key":"dPLmT5FyO4"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    1 22:46:56      -88.773631        0.271703\nBFGS:    2 22:46:56      -88.784473        0.104050\n"},"key":"gHUu9yP69q"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    3 22:46:56      -88.786014        0.101458\n"},"key":"tGrJEFfDFf"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    4 22:46:56      -88.788552        0.106393\nBFGS:    5 22:46:57      -88.790502        0.089090\n"},"key":"q492rpCXFj"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    6 22:46:57      -88.791972        0.096440\n"},"key":"iSJ5oxnKxw"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    7 22:46:57      -88.792657        0.099421\nBFGS:    8 22:46:57      -88.793180        0.077379\n"},"key":"fXTNRQi5Hq"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    9 22:46:57      -88.793679        0.036101\n"},"key":"YQQ9oCTGIb"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"-4.164115286571666\n"},"key":"iZs4d15vbi"}],"key":"qG71TyG8Vt"}],"key":"KuGdFSj3qc"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":286,"column":1},"end":{"line":286,"column":1}},"children":[{"type":"text","value":"Site correlations","position":{"start":{"line":286,"column":1},"end":{"line":286,"column":1}},"key":"dAysBh2EE3"}],"identifier":"site-correlations","label":"Site correlations","html_id":"site-correlations","implicit":true,"key":"wF0KSBkEwb"},{"type":"paragraph","position":{"start":{"line":288,"column":1},"end":{"line":288,"column":1}},"children":[{"type":"text","value":"This cell reproduces a portion of a figure in the paper. We compare oxygen adsorption energies in the fcc and hcp sites across metals and coverages. These adsorption energies are highly correlated with each other because the adsorption sites are so similar.","position":{"start":{"line":288,"column":1},"end":{"line":288,"column":1}},"key":"QKzmwLXU8W"}],"key":"GxYuwbHe2N"},{"type":"paragraph","position":{"start":{"line":290,"column":1},"end":{"line":290,"column":1}},"children":[{"type":"text","value":"At higher coverages, the agreement is not as good. This is likely because the model is extrapolating and needs to be fine-tuned.","position":{"start":{"line":290,"column":1},"end":{"line":290,"column":1}},"key":"J0ybH5dgOF"}],"key":"kj6SUSdJqJ"}],"key":"knLRg4ANoL"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import time\n\nfrom tqdm import tqdm\n\nt0 = time.time()\n\ndata = {\"fcc\": [], \"hcp\": []}\n\nrefdata = {\"fcc\": [], \"hcp\": []}\n\n\nfor metal in [\"Cu\", \"Ag\", \"Pd\", \"Pt\", \"Rh\", \"Ir\"]:\n    print(metal)\n    for site in [\"fcc\", \"hcp\"]:\n        for adsorbate in [\"O\"]:\n            for coverage in tqdm([\"0.25\"]):\n\n                entry = s[metal][adsorbate][site][coverage]\n\n                adslab = Atoms(\n                    entry[\"symbols\"],\n                    positions=entry[\"pos\"],\n                    cell=entry[\"cell\"],\n                    pbc=True,\n                )\n\n                # Grab just the metal surface atoms\n                adsorbates = adslab[\n                    ~(adslab.arrays[\"numbers\"] == adslab.arrays[\"numbers\"][0])\n                ]\n\n                slab = adslab[adslab.arrays[\"numbers\"] == adslab.arrays[\"numbers\"][0]]\n                slab.set_calculator(calc)\n                opt = BFGS(slab)\n                opt.run(fmax=0.05, steps=100)\n\n                adslab.set_calculator(calc)\n                opt = BFGS(adslab)\n                opt.run(fmax=0.05, steps=100)\n\n                re2 = (\n                    adslab.get_potential_energy()\n                    - slab.get_potential_energy()\n                    - sum(\n                        [\n                            atomic_reference_energies[x]\n                            for x in adsorbates.get_chemical_symbols()\n                        ]\n                    )\n                )\n\n                nO = 0\n                for atom in adslab:\n                    if atom.symbol == \"O\":\n                        nO += 1\n                        re2 += re1 + re3\n\n                data[site] += [re2 / nO]\n                refdata[site] += [edata[metal][adsorbate][site][coverage]]\n\nf\"Elapsed time = {time.time() - t0} seconds\"","key":"Wfti9s23bY"},{"type":"outputs","id":"nbiEjC4NVfx0jpFH6Wz0T","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Cu\n"},"key":"tSXa4BlKfQ"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r  0%|          | 0/1 [00:00<?, ?it/s]"},"key":"w5kgVm6OPo"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"/tmp/ipykernel_10908/1356342052.py:33: FutureWarning: Please use atoms.calc = calc\n  slab.set_calculator(calc)\n"},"key":"rIJ0UzMnxx"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"      Step     Time          Energy          fmax\nBFGS:    0 22:46:58      -48.910948        0.646351\n"},"key":"xP9Dw9YBBZ"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    1 22:46:58      -48.934031        0.539303\nBFGS:    2 22:46:58      -49.000043        0.280103\n"},"key":"i9EOl7x08F"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    3 22:46:59      -49.002374        0.251321\nBFGS:    4 22:46:59      -49.008810        0.158909\n"},"key":"viiDaaVwV1"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    5 22:46:59      -49.013986        0.134401\nBFGS:    6 22:46:59      -49.016869        0.071526\n"},"key":"tTp3pvNX07"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    7 22:46:59      -49.017633        0.051269\nBFGS:    8 22:47:00      -49.018011        0.047563\n"},"key":"c0hdUHVSdf"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"/tmp/ipykernel_10908/1356342052.py:37: FutureWarning: Please use atoms.calc = calc\n  adslab.set_calculator(calc)\n"},"key":"Xy96ycFsWd"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"      Step     Time          Energy          fmax\nBFGS:    0 22:47:00      -55.204221        0.339046\n"},"key":"aaESu0X9fQ"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    1 22:47:00      -55.206662        0.267938\n"},"key":"XK2GN6vPOW"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    2 22:47:00      -55.213711        0.160041\nBFGS:    3 22:47:01      -55.215874        0.166181\n"},"key":"d6hM04fAsa"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    4 22:47:01      -55.219676        0.116686\n"},"key":"o1wD3bNzyv"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    5 22:47:01      -55.221814        0.079418\nBFGS:    6 22:47:01      -55.223359        0.075349\n"},"key":"dUXaS2rMVW"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    7 22:47:02      -55.224365        0.090296\n"},"key":"XFFlZuiOIC"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    8 22:47:02      -55.225517        0.098891\nBFGS:    9 22:47:02      -55.226530        0.068551\n"},"key":"dXkjShMGO3"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:   10 22:47:02      -55.226977        0.043000\n"},"key":"jcW9FWJJSr"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r100%|██████████| 1/1 [00:04<00:00,  4.84s/it]"},"key":"EzT2WSE6Dm"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r100%|██████████| 1/1 [00:04<00:00,  4.84s/it]"},"key":"bwMs7kwnTv"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\n"},"key":"iOXri8tnFe"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r  0%|          | 0/1 [00:00<?, ?it/s]"},"key":"yA6HB0OWur"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"      Step     Time          Energy          fmax\nBFGS:    0 22:47:03      -48.936503        0.552695\n"},"key":"B2as4IbSUx"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    1 22:47:03      -48.954084        0.470533\n"},"key":"TGJ1kKDzb5"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    2 22:47:03      -49.008577        0.210998\n"},"key":"OuebYkDsUT"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    3 22:47:03      -49.009768        0.197685\n"},"key":"VXClFxT0BJ"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    4 22:47:04      -49.017745        0.041126\n"},"key":"P99ztRYfjd"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"      Step     Time          Energy          fmax\nBFGS:    0 22:47:04      -55.119069        0.305598\nBFGS:    1 22:47:04      -55.120918        0.239016\n"},"key":"uKtm9acrh6"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    2 22:47:04      -55.125705        0.129129\nBFGS:    3 22:47:05      -55.127340        0.147616\n"},"key":"XqYHFdZal2"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    4 22:47:05      -55.130397        0.128639\n"},"key":"s9Ln4pXIdn"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    5 22:47:05      -55.132308        0.103137\n"},"key":"nLMcdw5ZXW"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    6 22:47:05      -55.133381        0.051684\nBFGS:    7 22:47:06      -55.133851        0.056044\n"},"key":"RsaK0ooQCL"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    8 22:47:06      -55.134357        0.071228\n"},"key":"CHUQLrezs2"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    9 22:47:06      -55.135043        0.069444\n"},"key":"NswrlsNAa9"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:   10 22:47:06      -55.135574        0.039937\n"},"key":"KwgBMJzqO9"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r100%|██████████| 1/1 [00:04<00:00,  4.07s/it]"},"key":"SM4YkY0PD4"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r100%|██████████| 1/1 [00:04<00:00,  4.07s/it]"},"key":"h9abUrs75x"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\n"},"key":"WtUuaEAmqv"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Ag\n"},"key":"Q7L4vSjJUw"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r  0%|          | 0/1 [00:00<?, ?it/s]"},"key":"aLMyXkgouo"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"      Step     Time          Energy          fmax\nBFGS:    0 22:47:07      -33.034314        0.634820\n"},"key":"T2dqoT48NR"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    1 22:47:07      -33.053470        0.551048\n"},"key":"vPxUvnxstg"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    2 22:47:07      -33.120905        0.172021\nBFGS:    3 22:47:07      -33.122778        0.157330\n"},"key":"uKyvIysRMR"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    4 22:47:08      -33.124181        0.143386\nBFGS:    5 22:47:08      -33.126944        0.112458\n"},"key":"z7GPhO48MD"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    6 22:47:08      -33.130771        0.110655\nBFGS:    7 22:47:08      -33.133993        0.067529\n"},"key":"T8sBM6ynJK"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    8 22:47:08      -33.134833        0.034888\n      Step     Time          Energy          fmax\nBFGS:    0 22:47:09      -38.173509        0.098015\n"},"key":"T29z3WkZx9"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    1 22:47:09      -38.174435        0.094365\n"},"key":"r1hVZWaJzV"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    2 22:47:09      -38.184908        0.084030\nBFGS:    3 22:47:09      -38.185732        0.085432\n"},"key":"v8THOWahZh"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    4 22:47:10      -38.189034        0.086086\n"},"key":"uaVyXwuECj"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    5 22:47:10      -38.190952        0.068845\n"},"key":"oXqcqS3x3F"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    6 22:47:10      -38.192255        0.087461\nBFGS:    7 22:47:10      -38.193188        0.076899\n"},"key":"O8DT1ZBWdZ"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    8 22:47:10      -38.193673        0.042595\n"},"key":"iYUzhOZB2d"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r100%|██████████| 1/1 [00:04<00:00,  4.04s/it]"},"key":"qekc6oVIZY"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r100%|██████████| 1/1 [00:04<00:00,  4.04s/it]"},"key":"VQ4yyB8RQc"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\n"},"key":"MIz1A9teuQ"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r  0%|          | 0/1 [00:00<?, ?it/s]"},"key":"SKjhJPwQFu"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"      Step     Time          Energy          fmax\nBFGS:    0 22:47:11      -33.056750        0.557366\n"},"key":"LDfWWIq0Xg"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    1 22:47:11      -33.071228        0.489412\n"},"key":"DtMpNmVmbv"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    2 22:47:12      -33.126396        0.123825\n"},"key":"bvQ1gyg1ow"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    3 22:47:12      -33.127308        0.112960\n"},"key":"Cr7FjRyQYu"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    4 22:47:12      -33.128516        0.097373\n"},"key":"GjVxF8Kl5k"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    5 22:47:12      -33.130260        0.079536\n"},"key":"w6w2EkZ8eO"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    6 22:47:12      -33.133159        0.076345\nBFGS:    7 22:47:13      -33.134743        0.040730\n"},"key":"HHHwMOANbD"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"      Step     Time          Energy          fmax\nBFGS:    0 22:47:13      -38.102025        0.092717\n"},"key":"M1bEVGF3D4"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    1 22:47:13      -38.102856        0.088836\n"},"key":"kFk83z6rWR"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    2 22:47:13      -38.111088        0.134656\n"},"key":"ZYszDYA3r8"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    3 22:47:14      -38.112012        0.120323\n"},"key":"KQtDivLT95"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    4 22:47:14      -38.115289        0.063997\nBFGS:    5 22:47:14      -38.116155        0.056403\n"},"key":"Nihlqsv5fa"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    6 22:47:14      -38.116710        0.058200\n"},"key":"faoohQofuF"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    7 22:47:15      -38.117580        0.073168\n"},"key":"Diz7N872DA"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    8 22:47:15      -38.118451        0.057891\n"},"key":"DkZKvwnBL8"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    9 22:47:15      -38.118835        0.026055\n"},"key":"Inzgjlr1Lc"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r100%|██████████| 1/1 [00:04<00:00,  4.63s/it]"},"key":"m4GkUFMmgy"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r100%|██████████| 1/1 [00:04<00:00,  4.63s/it]"},"key":"pgHYuIxeDc"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\n"},"key":"AMrQbfhKGc"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Pd\n"},"key":"vNRVUQywIP"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r  0%|          | 0/1 [00:00<?, ?it/s]"},"key":"okNmuIRsfH"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"      Step     Time          Energy          fmax\nBFGS:    0 22:47:16      -70.165062        0.631446\n"},"key":"kYLsoC6QtB"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    1 22:47:16      -70.189910        0.508128\nBFGS:    2 22:47:16      -70.241648        0.191934\n"},"key":"GSFbmcs0Z6"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    3 22:47:16      -70.243346        0.182565\n"},"key":"HVgXOirFt7"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    4 22:47:16      -70.248575        0.144558\n"},"key":"iHuYtYACm5"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    5 22:47:17      -70.251930        0.115933\n"},"key":"EhbU6wFLau"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    6 22:47:17      -70.254308        0.074837\n"},"key":"lxMKVbb3BL"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    7 22:47:17      -70.255204        0.059446\n"},"key":"GnufzWzOby"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    8 22:47:17      -70.255944        0.041108\n"},"key":"YihJcIIZ3l"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"      Step     Time          Energy          fmax\nBFGS:    0 22:47:18      -76.130241        0.213656\n"},"key":"gg4OL4yy3t"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    1 22:47:18      -76.133242        0.190305\nBFGS:    2 22:47:18      -76.148717        0.169645\n"},"key":"Ad6Kcn1gbG"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    3 22:47:18      -76.150812        0.152254\n"},"key":"mXOZIA4SPL"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    4 22:47:19      -76.154313        0.130503\nBFGS:    5 22:47:19      -76.157058        0.106137\n"},"key":"TDhqJe3Ens"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    6 22:47:19      -76.159303        0.088115\n"},"key":"NRHKJUG0pK"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    7 22:47:19      -76.160431        0.080499\nBFGS:    8 22:47:19      -76.161130        0.064501\n"},"key":"jhx52kk2vH"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    9 22:47:20      -76.161614        0.042988\n"},"key":"GpUc5rNXZD"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r100%|██████████| 1/1 [00:04<00:00,  4.90s/it]"},"key":"wGWeMjthGa"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r100%|██████████| 1/1 [00:04<00:00,  4.90s/it]"},"key":"S0cjsQksXD"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\n"},"key":"k45s8TeLzM"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r  0%|          | 0/1 [00:00<?, ?it/s]"},"key":"SEe1oignjI"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"      Step     Time          Energy          fmax\nBFGS:    0 22:47:20      -70.197711        0.454636\nBFGS:    1 22:47:21      -70.211774        0.373893\n"},"key":"MxrMScKsKV"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    2 22:47:21      -70.245977        0.178178\n"},"key":"AZG80YtHaS"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    3 22:47:21      -70.247162        0.164572\n"},"key":"b6T7OeqUQl"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    4 22:47:22      -70.253348        0.078707\n"},"key":"ikGle3dALV"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    5 22:47:22      -70.254511        0.075507\n"},"key":"BLRqdqdDKI"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    6 22:47:22      -70.255272        0.058127\n"},"key":"SFRQG5EcuH"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    7 22:47:22      -70.255844        0.036952\n"},"key":"eO4Tksy0Ek"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"      Step     Time          Energy          fmax\nBFGS:    0 22:47:22      -75.892388        0.169440\nBFGS:    1 22:47:23      -75.895233        0.150799\n"},"key":"KGqJlx7Ptg"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    2 22:47:23      -75.906632        0.144107\n"},"key":"plpQhyailp"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    3 22:47:23      -75.908424        0.135675\nBFGS:    4 22:47:23      -75.912427        0.129021\n"},"key":"CvBA9Uxdvq"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    5 22:47:24      -75.915496        0.108685\n"},"key":"heEhNkfhwY"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    6 22:47:24      -75.917928        0.075294\nBFGS:    7 22:47:24      -75.918955        0.067272\n"},"key":"nYtZELzzNv"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    8 22:47:24      -75.919478        0.044574\n"},"key":"hdwDvFumlZ"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r100%|██████████| 1/1 [00:04<00:00,  4.44s/it]"},"key":"eZceS282bL"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r100%|██████████| 1/1 [00:04<00:00,  4.44s/it]"},"key":"OQoGkZ3dx4"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\n"},"key":"WvTMfhHccW"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Pt\n"},"key":"uxpjyxZSzZ"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r  0%|          | 0/1 [00:00<?, ?it/s]"},"key":"xRmcwiBiDV"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"      Step     Time          Energy          fmax\nBFGS:    0 22:47:25      -82.862062        1.000262\n"},"key":"yuGxyPZq5E"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    1 22:47:25      -82.918113        0.752920\n"},"key":"wkHa9Vy8wR"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    2 22:47:25      -83.011694        0.335860\n"},"key":"aLWBEXQBk8"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    3 22:47:26      -83.016496        0.303120\nBFGS:    4 22:47:26      -83.024496        0.224962\n"},"key":"DUb2Nc8yZG"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    5 22:47:26      -83.030036        0.152567\n"},"key":"BkdBzohQJS"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    6 22:47:26      -83.033360        0.088625\nBFGS:    7 22:47:27      -83.034470        0.065747\n"},"key":"z9XJJ1QV09"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    8 22:47:27      -83.035209        0.068689\n"},"key":"wBo17OHHfv"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    9 22:47:27      -83.035563        0.046755\n      Step     Time          Energy          fmax\nBFGS:    0 22:47:27      -88.770343        0.312348\n"},"key":"GjNn3B8xKK"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    1 22:47:27      -88.773631        0.271703\n"},"key":"nEhTp4uxyh"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    2 22:47:28      -88.784473        0.104050\n"},"key":"mZ38j7LtUV"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    3 22:47:28      -88.786014        0.101458\n"},"key":"W2RQPvxtCp"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    4 22:47:28      -88.788552        0.106389\n"},"key":"uMIDWmlA3Y"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    5 22:47:29      -88.790503        0.089090\n"},"key":"DiMFhDwylL"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    6 22:47:29      -88.791972        0.096440\n"},"key":"jgxdeze8Ka"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    7 22:47:29      -88.792659        0.099421\n"},"key":"d617ejwmSQ"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    8 22:47:30      -88.793179        0.077367\n"},"key":"TbuF9TfxHF"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    9 22:47:30      -88.793678        0.036096\n"},"key":"yf8f2VrwZk"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r100%|██████████| 1/1 [00:05<00:00,  5.37s/it]"},"key":"dxYCcyFWNK"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r100%|██████████| 1/1 [00:05<00:00,  5.38s/it]"},"key":"UCg4BNDIN5"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\n"},"key":"YTjFOGtFyc"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r  0%|          | 0/1 [00:00<?, ?it/s]"},"key":"kpBS5Z73he"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"      Step     Time          Energy          fmax\nBFGS:    0 22:47:30      -82.946997        0.675644\nBFGS:    1 22:47:31      -82.973149        0.546704\n"},"key":"JMJyKEL6c2"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    2 22:47:31      -83.026505        0.203005\n"},"key":"KeA0ptGnNR"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    3 22:47:31      -83.028070        0.183991\nBFGS:    4 22:47:31      -83.033699        0.083392\n"},"key":"X9ON8Y6P9o"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    5 22:47:31      -83.034396        0.061068\nBFGS:    6 22:47:31      -83.035121        0.048402\n"},"key":"w1BT4WLdk4"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"      Step     Time          Energy          fmax\nBFGS:    0 22:47:32      -88.350562        0.234982\n"},"key":"Apt8iu0jk5"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    1 22:47:32      -88.353607        0.203898\n"},"key":"P2nJXCzGpC"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    2 22:47:32      -88.362977        0.117094\n"},"key":"zQHnJHVsBO"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    3 22:47:32      -88.364342        0.121252\n"},"key":"YFvdCgN7xu"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    4 22:47:33      -88.368500        0.090132\n"},"key":"X7xFWKpgg5"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    5 22:47:33      -88.370482        0.073281\n"},"key":"IOHm1WZ6oF"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    6 22:47:33      -88.371785        0.075227\n"},"key":"MmHZU7ns9t"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    7 22:47:34      -88.372317        0.079580\n"},"key":"KtSP0umxr2"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    8 22:47:34      -88.372730        0.061424\nBFGS:    9 22:47:34      -88.373018        0.027200\n"},"key":"NGjBXm49KZ"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r100%|██████████| 1/1 [00:04<00:00,  4.27s/it]"},"key":"dz4krSQU1l"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r100%|██████████| 1/1 [00:04<00:00,  4.27s/it]"},"key":"fAcFfwEoE6"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\n"},"key":"iSq0iBzEPF"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Rh\n"},"key":"u0kVQB6FFa"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r  0%|          | 0/1 [00:00<?, ?it/s]"},"key":"ZARWkMCPs3"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"      Step     Time          Energy          fmax\nBFGS:    0 22:47:35     -100.192566        0.688933\n"},"key":"w4SKiMP8NK"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    1 22:47:35     -100.218240        0.600213\n"},"key":"j21Yxe6b8u"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    2 22:47:35     -100.286834        0.174739\n"},"key":"Xobx4emUDz"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    3 22:47:35     -100.289767        0.129382\n"},"key":"pZFIcsbu75"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    4 22:47:35     -100.298130        0.066639\nBFGS:    5 22:47:36     -100.299264        0.053478\n"},"key":"e9HPoaY3LJ"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    6 22:47:36     -100.299778        0.045082\n"},"key":"FSQEzKi5qw"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"      Step     Time          Energy          fmax\nBFGS:    0 22:47:36     -106.921794        0.203149\n"},"key":"ykVp3Shl9A"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    1 22:47:37     -106.924541        0.168907\n"},"key":"cU56qeMRaT"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    2 22:47:37     -106.930976        0.052441\n"},"key":"cgkK98qWFj"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    3 22:47:37     -106.931584        0.045559\n"},"key":"k85DVuYCpt"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r100%|██████████| 1/1 [00:03<00:00,  3.03s/it]"},"key":"XOIHsYULln"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r100%|██████████| 1/1 [00:03<00:00,  3.03s/it]"},"key":"SC7xonePzl"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\n"},"key":"Q7fGX0Jfth"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r  0%|          | 0/1 [00:00<?, ?it/s]"},"key":"GyyVC6bgCm"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"      Step     Time          Energy          fmax\nBFGS:    0 22:47:38     -100.171740        0.714774\n"},"key":"UgK6V56Asq"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    1 22:47:38     -100.203866        0.626030\nBFGS:    2 22:47:38     -100.287846        0.263191\n"},"key":"pfRbRgfrrM"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    3 22:47:38     -100.290543        0.195991\nBFGS:    4 22:47:38     -100.297167        0.080377\n"},"key":"TdwA9GNCV5"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    5 22:47:39     -100.299033        0.056460\nBFGS:    6 22:47:39     -100.299772        0.043871\n"},"key":"Yjao8WADT2"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"      Step     Time          Energy          fmax\nBFGS:    0 22:47:39     -106.876839        0.168839\nBFGS:    1 22:47:39     -106.879420        0.139490\n"},"key":"VScvB1jsf1"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    2 22:47:39     -106.885549        0.071255\nBFGS:    3 22:47:39     -106.886238        0.064286\n"},"key":"SEBSxE76LI"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    4 22:47:40     -106.886580        0.054980\n"},"key":"q7m7scKXBq"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    5 22:47:40     -106.886842        0.043052\n"},"key":"b2YXaTQYTh"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r100%|██████████| 1/1 [00:02<00:00,  2.79s/it]"},"key":"hOBuAC55nC"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r100%|██████████| 1/1 [00:02<00:00,  2.79s/it]"},"key":"HbPayj7iO8"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\n"},"key":"muNnA0n7ob"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Ir\n"},"key":"W0fPOkwgTE"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r  0%|          | 0/1 [00:00<?, ?it/s]"},"key":"TQfg4Cn0L0"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"      Step     Time          Energy          fmax\nBFGS:    0 22:47:40     -124.235610        1.189926\n"},"key":"aianxy5QJp"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    1 22:47:41     -124.310841        0.937184\n"},"key":"Iydzggboc4"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    2 22:47:41     -124.422188        0.140826\n"},"key":"BIvsdbN1yu"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    3 22:47:41     -124.425270        0.133780\n"},"key":"o3fcOoCjkh"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    4 22:47:41     -124.429598        0.060642\nBFGS:    5 22:47:42     -124.430258        0.038672\n"},"key":"gDHIHJjwWA"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"      Step     Time          Energy          fmax\nBFGS:    0 22:47:42     -130.605622        0.371646\n"},"key":"ISAEoVrYio"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    1 22:47:42     -130.616145        0.265890\n"},"key":"hKanaMEUfd"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    2 22:47:42     -130.630317        0.110764\n"},"key":"FCqoAHAa8P"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    3 22:47:43     -130.633615        0.094357\n"},"key":"K4wGKvorvS"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    4 22:47:43     -130.634275        0.075692\nBFGS:    5 22:47:43     -130.634990        0.065690\n"},"key":"yOmgJJchyb"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    6 22:47:43     -130.636199        0.083043\n"},"key":"uRMFgLLfmy"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    7 22:47:43     -130.636656        0.075132\n"},"key":"yqLsncHAEv"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    8 22:47:44     -130.637049        0.047437\n"},"key":"j4nSqbBjpq"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r100%|██████████| 1/1 [00:03<00:00,  3.79s/it]"},"key":"hhcrLesxdt"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r100%|██████████| 1/1 [00:03<00:00,  3.79s/it]"},"key":"Hrn4td3Pvf"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\n"},"key":"iQBeLIaAO2"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r  0%|          | 0/1 [00:00<?, ?it/s]"},"key":"mFVkJUKAcv"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"      Step     Time          Energy          fmax\nBFGS:    0 22:47:44     -124.227592        1.165685\n"},"key":"XWNTbQTNSL"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    1 22:47:44     -124.311475        0.915619\n"},"key":"gw0HNGIRDM"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    2 22:47:45     -124.422556        0.165136\n"},"key":"YuYufCC7E7"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    3 22:47:45     -124.425477        0.200267\n"},"key":"CNQxmVpBLd"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    4 22:47:45     -124.428763        0.168861\nBFGS:    5 22:47:45     -124.430253        0.088397\n"},"key":"dYuEo4MhlV"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    6 22:47:45     -124.430559        0.041796\n      Step     Time          Energy          fmax\nBFGS:    0 22:47:46     -130.496158        0.405482\n"},"key":"q4hFvNpSsc"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    1 22:47:46     -130.507203        0.266991\nBFGS:    2 22:47:46     -130.518616        0.126414\n"},"key":"Kakw98P2cz"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    3 22:47:46     -130.522315        0.080268\nBFGS:    4 22:47:46     -130.523180        0.066553\n"},"key":"L15rcSmqBl"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    5 22:47:46     -130.523452        0.056611\n"},"key":"PDu5Oo5uyJ"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"BFGS:    6 22:47:47     -130.524510        0.055660\nBFGS:    7 22:47:47     -130.524677        0.042696\n"},"key":"yjC4ChXTUi"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r100%|██████████| 1/1 [00:03<00:00,  3.21s/it]"},"key":"p3QGkOtm3A"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\r100%|██████████| 1/1 [00:03<00:00,  3.21s/it]"},"key":"ur1YdFIdHM"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\n"},"key":"RhxBXHfcEg"},{"type":"output","children":[],"jupyter_data":{"output_type":"execute_result","execution_count":9,"metadata":{},"data":{"text/plain":{"content":"'Elapsed time = 49.474629640579224 seconds'","content_type":"text/plain"}}},"key":"hoevYUqZfH"}],"key":"KhfZD1p0IU"}],"key":"XKitLXavwO"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":356,"column":1},"end":{"line":356,"column":1}},"children":[{"type":"text","value":"First, we compare the computed data and reference data. There is a systematic difference of about 0.5 eV due to the difference between RPBE and PBE functionals, and other subtle differences like lattice constant differences and reference energy differences. This is pretty typical, and an expected deviation.","position":{"start":{"line":356,"column":1},"end":{"line":356,"column":1}},"key":"kWVbFXnBXU"}],"key":"xmMBA8jZNq"}],"key":"gk9DgQUJcz"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot(refdata[\"fcc\"], data[\"fcc\"], \"r.\", label=\"fcc\")\nplt.plot(refdata[\"hcp\"], data[\"hcp\"], \"b.\", label=\"hcp\")\nplt.plot([-5.5, -3.5], [-5.5, -3.5], \"k-\")\nplt.xlabel(\"Ref. data (DFT)\")\nplt.ylabel(\"UMA-OC20 prediction\");","key":"Gbhso15PMm"},{"type":"outputs","id":"XJB9PsDRFKrwcZOK-1OWc","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"36d850a7ac41e9bd3477161594f52931","path":"/build/36d850a7ac41e9bd3477161594f52931.png"}}},"key":"W6hyoL0cLW"}],"key":"FKDJj0B6pt"}],"key":"v6Fj0ZGrZe"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":366,"column":1},"end":{"line":366,"column":1}},"children":[{"type":"text","value":"Next we compare the correlation between the hcp and fcc sites. Here we see the same trends. The data falls below the parity line because the hcp sites tend to be a little weaker binding than the fcc sites.","position":{"start":{"line":366,"column":1},"end":{"line":366,"column":1}},"key":"R7hSUNC2Aj"}],"key":"etNi5XswLP"}],"key":"Spq6JdDcV3"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot(refdata[\"hcp\"], refdata[\"fcc\"], \"r.\")\nplt.plot(data[\"hcp\"], data[\"fcc\"], \".\")\nplt.plot([-6, -1], [-6, -1], \"k-\")\nplt.xlabel(\"$H_{ads, hcp}$\")\nplt.ylabel(\"$H_{ads, fcc}$\")\nplt.legend([\"DFT (PBE)\", \"UMA-OC20\"]);","key":"uspyI6Yr64"},{"type":"outputs","id":"n0BVm06xH3ivqiDbXDiVY","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"0e744ac205735b9263d9c884dbf78d3b","path":"/build/0e744ac205735b9263d9c884dbf78d3b.png"}}},"key":"ySPemyozef"}],"key":"U3cbgiJMdH"}],"key":"RtTgG60g2P"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":377,"column":1},"end":{"line":377,"column":1}},"children":[{"type":"text","value":"Exercises","position":{"start":{"line":377,"column":1},"end":{"line":377,"column":1}},"key":"NKGVc8FGqN"}],"identifier":"exercises","label":"Exercises","html_id":"exercises-1","implicit":true,"key":"INHmsy7uAp"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":379,"column":1},"end":{"line":381,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":379,"column":1},"end":{"line":379,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"You can also explore a few other adsorbates: C, H, N.","position":{"start":{"line":379,"column":1},"end":{"line":379,"column":1}},"key":"KvOKuVb5Ym"}],"key":"GdXjjap2nK"}],"key":"Lt2om0v0j0"},{"type":"listItem","spread":true,"position":{"start":{"line":380,"column":1},"end":{"line":381,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Explore the higher coverages. The deviations from the reference data are expected to be higher, but relative differences tend to be better. You probably need fine tuning to improve this performance. This data set doesn’t have forces though, so it isn’t practical to do it here.","position":{"start":{"line":380,"column":1},"end":{"line":380,"column":1}},"key":"Ik65KnHbwV"}],"key":"mgOmI4o8TR"}],"key":"Qe4RhaxfBb"}],"key":"oJ9RI5MO2o"}],"key":"PlxyxdFB2B"},{"type":"block","position":{"start":{"line":382,"column":1},"end":{"line":382,"column":1}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":384,"column":1},"end":{"line":384,"column":1}},"children":[{"type":"text","value":"Next steps","position":{"start":{"line":384,"column":1},"end":{"line":384,"column":1}},"key":"PU3R4Y9XkF"}],"identifier":"next-steps","label":"Next steps","html_id":"next-steps","implicit":true,"key":"If4JCgF7fj"},{"type":"paragraph","position":{"start":{"line":386,"column":1},"end":{"line":386,"column":1}},"children":[{"type":"text","value":"In the next step, we consider some more complex adsorbates in nitrogen reduction, and how we can leverage OCP to automate the search for the most stable adsorbate geometry. See ","position":{"start":{"line":386,"column":1},"end":{"line":386,"column":1}},"key":"HVG6zBJm5s"},{"type":"link","url":"./NRR/NRR_example-gemnet","position":{"start":{"line":386,"column":1},"end":{"line":386,"column":1}},"children":[{"type":"text","value":"the next step","position":{"start":{"line":386,"column":1},"end":{"line":386,"column":1}},"key":"wN3bDLlvd7"}],"urlSource":"./NRR/NRR_example-gemnet","key":"cASGnWtqPu"},{"type":"text","value":".","position":{"start":{"line":386,"column":1},"end":{"line":386,"column":1}},"key":"wBQnnEx53n"}],"key":"Tw3feaXrOf"}],"key":"QmSqpCYqbn"},{"type":"block","position":{"start":{"line":388,"column":1},"end":{"line":388,"column":1}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":391,"column":1},"end":{"line":391,"column":1}},"children":[{"type":"text","value":"Convergence study","position":{"start":{"line":391,"column":1},"end":{"line":391,"column":1}},"key":"DSrowSjCWZ"}],"label":"convergence-study","identifier":"convergence-study","html_id":"convergence-study","key":"AOl2PWa754"},{"type":"paragraph","position":{"start":{"line":393,"column":1},"end":{"line":393,"column":1}},"children":[{"type":"text","value":"In ","position":{"start":{"line":393,"column":1},"end":{"line":393,"column":1}},"key":"uQBuFKLZHv"},{"type":"crossReference","position":{"start":{"line":393,"column":1},"end":{"line":393,"column":1}},"children":[{"type":"text","value":"the adsorption energies section","position":{"start":{"line":393,"column":1},"end":{"line":393,"column":1}},"key":"iElJj7rKqF"}],"identifier":"intro-to-adsorption-energies","label":"intro-to-adsorption-energies","kind":"heading","template":"{name}","resolved":true,"html_id":"intro-to-adsorption-energies","key":"UlEZiZHrDy"},{"type":"text","value":" we discussed some possible reasons we might see a discrepancy. Here we investigate some factors that impact the computed energies.","position":{"start":{"line":393,"column":1},"end":{"line":393,"column":1}},"key":"UNs0TD9RVI"}],"key":"HkUFaMTAHG"},{"type":"paragraph","position":{"start":{"line":395,"column":1},"end":{"line":395,"column":1}},"children":[{"type":"text","value":"In this section, the energies refer to the reaction 1/2 O2 -> O*.","position":{"start":{"line":395,"column":1},"end":{"line":395,"column":1}},"key":"FA1jnEgjG5"}],"key":"YgSG2RKj1p"}],"key":"ZrXcJqnrUV"},{"type":"block","position":{"start":{"line":397,"column":1},"end":{"line":397,"column":1}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":399,"column":1},"end":{"line":399,"column":1}},"children":[{"type":"text","value":"Effects of number of layers","position":{"start":{"line":399,"column":1},"end":{"line":399,"column":1}},"key":"VEWXKBAaTk"}],"identifier":"effects-of-number-of-layers","label":"Effects of number of layers","html_id":"effects-of-number-of-layers","implicit":true,"key":"chZsLrFx5L"},{"type":"paragraph","position":{"start":{"line":401,"column":1},"end":{"line":401,"column":1}},"children":[{"type":"text","value":"Slab thickness could be a factor. Here we relax the whole slab, and see by about 4 layers the energy is converged to ~0.02 eV.","position":{"start":{"line":401,"column":1},"end":{"line":401,"column":1}},"key":"DHsqlPQfg2"}],"key":"xy2RvNeXak"}],"key":"LlH6FESPPc"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"for nlayers in [3, 4, 5, 6, 7, 8]:\n    slab = fcc111(\"Pt\", size=(2, 2, nlayers), vacuum=10.0)\n\n    slab.pbc = True\n    slab.set_calculator(calc)\n    opt_slab = BFGS(slab, logfile=None)\n    opt_slab.run(fmax=0.05, steps=100)\n    slab_e = slab.get_potential_energy()\n\n    adslab = slab.copy()\n    add_adsorbate(adslab, \"O\", height=1.2, position=\"fcc\")\n\n    adslab.pbc = True\n    adslab.set_calculator(calc)\n    opt_adslab = BFGS(adslab, logfile=None)\n    opt_adslab.run(fmax=0.05, steps=100)\n    adslab_e = adslab.get_potential_energy()\n\n    print(\n        f\"nlayers = {nlayers}: {adslab_e - slab_e - atomic_reference_energies['O'] + re1:1.2f} eV\"\n    )","key":"B22jJNEuxe"},{"type":"outputs","id":"DZkUSNPKwa_AIeoZzNNo-","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"/tmp/ipykernel_10908/338101817.py:5: FutureWarning: Please use atoms.calc = calc\n  slab.set_calculator(calc)\n"},"key":"KlzLyvvGbM"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"/tmp/ipykernel_10908/338101817.py:14: FutureWarning: Please use atoms.calc = calc\n  adslab.set_calculator(calc)\n"},"key":"KHE6qBVdeA"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"nlayers = 3: -1.58 eV\n"},"key":"VZiyWu06br"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"nlayers = 4: -1.47 eV\n"},"key":"JJoi2pzOUU"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"nlayers = 5: -1.47 eV\n"},"key":"cJ2U0w461p"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"nlayers = 6: -1.46 eV\n"},"key":"ULoOqqh5S0"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"nlayers = 7: -1.47 eV\n"},"key":"RJSGp4TMR0"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"nlayers = 8: -1.47 eV\n"},"key":"u5XfQH4bvO"}],"key":"yN93d4Re4a"}],"key":"X3JfyKrHbq"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":427,"column":1},"end":{"line":427,"column":1}},"children":[{"type":"text","value":"Effects of relaxation","position":{"start":{"line":427,"column":1},"end":{"line":427,"column":1}},"key":"JcAoFVLqeP"}],"identifier":"effects-of-relaxation","label":"Effects of relaxation","html_id":"effects-of-relaxation","implicit":true,"key":"IvWBcaNgUE"},{"type":"paragraph","position":{"start":{"line":429,"column":1},"end":{"line":429,"column":1}},"children":[{"type":"text","value":"It is common to only relax a few layers, and constrain lower layers to bulk coordinates. We do that here. We only relax the adsorbate and the top layer.","position":{"start":{"line":429,"column":1},"end":{"line":429,"column":1}},"key":"aS6hHB7ZDG"}],"key":"KxqpfrWGPS"},{"type":"paragraph","position":{"start":{"line":431,"column":1},"end":{"line":431,"column":1}},"children":[{"type":"text","value":"This has a small effect (0.1 eV).","position":{"start":{"line":431,"column":1},"end":{"line":431,"column":1}},"key":"vgyaiGoUA8"}],"key":"TKaOXwqzfA"}],"key":"YwkzvRp8fC"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from ase.constraints import FixAtoms\n\nfor nlayers in [3, 4, 5, 6, 7, 8]:\n    slab = fcc111(\"Pt\", size=(2, 2, nlayers), vacuum=10.0)\n\n    slab.set_constraint(FixAtoms(mask=[atom.tag > 1 for atom in slab]))\n    slab.pbc = True\n    slab.set_calculator(calc)\n    opt_slab = BFGS(slab, logfile=None)\n    opt_slab.run(fmax=0.05, steps=100)\n    slab_e = slab.get_potential_energy()\n\n    adslab = slab.copy()\n    add_adsorbate(adslab, \"O\", height=1.2, position=\"fcc\")\n\n    adslab.set_constraint(FixAtoms(mask=[atom.tag > 1 for atom in adslab]))\n    adslab.pbc = True\n    adslab.set_calculator(calc)\n    opt_adslab = BFGS(adslab, logfile=None)\n    opt_adslab.run(fmax=0.05, steps=100)\n    adslab_e = adslab.get_potential_energy()\n\n    print(\n        f\"nlayers = {nlayers}: {adslab_e - slab_e - atomic_reference_energies['O'] + re1:1.2f} eV\"\n    )","key":"s6l8Y6dIsn"},{"type":"outputs","id":"zgIFBy5Oxe13XD4DsBh0g","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"/tmp/ipykernel_10908/1426773950.py:8: FutureWarning: Please use atoms.calc = calc\n  slab.set_calculator(calc)\n"},"key":"ygWDnqPrHC"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"/tmp/ipykernel_10908/1426773950.py:18: FutureWarning: Please use atoms.calc = calc\n  adslab.set_calculator(calc)\n"},"key":"vz8PyRoZQC"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"nlayers = 3: -1.47 eV\n"},"key":"Z9CEbwqIW8"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"nlayers = 4: -1.35 eV\n"},"key":"FxpkRscRlK"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"nlayers = 5: -1.35 eV\n"},"key":"dr7znN5r3X"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"nlayers = 6: -1.34 eV\n"},"key":"kZgVFeDMa6"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"nlayers = 7: -1.35 eV\n"},"key":"CdMpq6DlMe"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"nlayers = 8: -1.35 eV\n"},"key":"zoYWBkDdRC"}],"key":"Rcv2zdy0F6"}],"key":"anFLyogqYD"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":461,"column":1},"end":{"line":461,"column":1}},"children":[{"type":"text","value":"Unit cell size","position":{"start":{"line":461,"column":1},"end":{"line":461,"column":1}},"key":"Ooi4RaH7or"}],"identifier":"unit-cell-size","label":"Unit cell size","html_id":"unit-cell-size","implicit":true,"key":"tKePTbcwUE"},{"type":"paragraph","position":{"start":{"line":463,"column":1},"end":{"line":463,"column":1}},"children":[{"type":"text","value":"Coverage effects are quite noticeable with oxygen. Here we consider larger unit cells. This effect is large, and the results don’t look right, usually adsorption energies get more favorable at lower coverage, not less. This suggests fine-tuning could be important even at low coverages.","position":{"start":{"line":463,"column":1},"end":{"line":463,"column":1}},"key":"MqpLrXkvSG"}],"key":"ybi9mQWATs"}],"key":"PhtRa4evYx"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"for size in [1, 2, 3, 4, 5]:\n\n    slab = fcc111(\"Pt\", size=(size, size, 5), vacuum=10.0)\n\n    slab.set_constraint(FixAtoms(mask=[atom.tag > 1 for atom in slab]))\n    slab.pbc = True\n    slab.set_calculator(calc)\n    opt_slab = BFGS(slab, logfile=None)\n    opt_slab.run(fmax=0.05, steps=100)\n    slab_e = slab.get_potential_energy()\n\n    adslab = slab.copy()\n    add_adsorbate(adslab, \"O\", height=1.2, position=\"fcc\")\n\n    adslab.set_constraint(FixAtoms(mask=[atom.tag > 1 for atom in adslab]))\n    adslab.pbc = True\n    adslab.set_calculator(calc)\n    opt_adslab = BFGS(adslab, logfile=None)\n    opt_adslab.run(fmax=0.05, steps=100)\n    adslab_e = adslab.get_potential_energy()\n\n    print(\n        f\"({size}x{size}): {adslab_e - slab_e - atomic_reference_energies['O'] + re1:1.2f} eV\"\n    )","key":"aqTJ13YF9w"},{"type":"outputs","id":"g3-M6O9eb97D9hIuPsDW2","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"/tmp/ipykernel_10908/3371624330.py:7: FutureWarning: Please use atoms.calc = calc\n  slab.set_calculator(calc)\n"},"key":"RZAt90BwzH"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"/tmp/ipykernel_10908/3371624330.py:17: FutureWarning: Please use atoms.calc = calc\n  adslab.set_calculator(calc)\n"},"key":"hW58sYdkSV"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"(1x1): -0.12 eV\n"},"key":"NYoWfLzKRK"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"(2x2): -1.35 eV\n"},"key":"rbcas3aDPj"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"(3x3): -1.38 eV\n"},"key":"ti6U6LMmGf"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"(4x4): -1.41 eV\n"},"key":"QzSM3tI3kj"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"(5x5): -1.42 eV\n"},"key":"fVCZbu9guD"}],"key":"yofh7VWcvJ"}],"key":"yRx7ITEU34"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":492,"column":1},"end":{"line":492,"column":1}},"children":[{"type":"text","value":"Summary","position":{"start":{"line":492,"column":1},"end":{"line":492,"column":1}},"key":"J9kLSLWhM9"}],"identifier":"summary","label":"Summary","html_id":"summary","implicit":true,"key":"QKGeDxpYRx"},{"type":"paragraph","position":{"start":{"line":494,"column":1},"end":{"line":494,"column":1}},"children":[{"type":"text","value":"As with DFT, you should take care to see how these kinds of decisions affect your results, and determine if they would change any interpretations or not.","position":{"start":{"line":494,"column":1},"end":{"line":494,"column":1}},"key":"daZ8oWWjpB"}],"key":"tMQ5COGWl6"}],"key":"DXqCvA5MRt"}],"key":"nSJyMTPOVN"},"references":{"cite":{"order":["Xu_2014"],"data":{"Xu_2014":{"label":"Xu_2014","enumerator":"1","doi":"10.1021/jp508805h","html":"Xu, Z., & Kitchin, J. R. (2014). Probing the Coverage Dependence of Site and Adsorbate Configurational Correlations on (111) Surfaces of Late Transition Metals. <i>The Journal of Physical Chemistry C</i>, <i>118</i>(44), 25597–25602. <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.1021/jp508805h\">10.1021/jp508805h</a>","url":"https://doi.org/10.1021/jp508805h"}}}},"footer":{"navigation":{"prev":{"title":"Examples & Tutorials","url":"/summary-4","group":"Heterogeneous Catalysis"},"next":{"title":"Expert Adsorption Energies","url":"/adsorption-energies","group":"Heterogeneous Catalysis"}}},"domain":"http://localhost:3000"}