#fairchem -c puma_speed.yaml +run_dir_root=/path/to/run_dir
run_dir_root: /checkpoint/ocp/rgao/speed

job:
  scheduler:
    mode: LOCAL
    ranks_per_node: 2
  graph_parallel_group_size: 2

runner:
  _target_: fairchem.core.components.benchmark.uma_speed_benchmark.InferenceBenchRunner
  timeiters: 10
  natoms_list: [10000]
  input_system: null
  model_checkpoints: {
    "uma_sm_cons": "/checkpoint/ocp/shared/uma/release/uma_sm_osc_name_fix.pt"
  }
  run_dir_root: ${run_dir_root}
  # for large number atoms (ie: 1000+) turn off compile and turn on activation_checkpointing
  # for profiling, we substract the graph generation time by using external_graph_gen=True
  inference_settings:
    _target_: fairchem.core.units.mlip_unit.api.inference.InferenceSettings
    tf32: True
    activation_checkpointing: True
    merge_mole: True
    compile: False
    wigner_cuda: True
    external_graph_gen: False
    internal_graph_gen_version: 2
  generate_traces: True
